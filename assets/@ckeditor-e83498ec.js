import{r as Wf}from"./vue-b18129cc.js";import{c as Kd}from"./color-convert-41c7f574.js";import"./vanilla-colorful-3f59310b.js";import{i as We,a as Ba,b as De,c as Or,d as Rt,e as ys,f as Jd,u as $f,g as Cs,m as Qd,s as Uf,h as Yd,j as Vt,k as qf,l as Ct,n as $i,o as Vn,t as zn,p as jf,q as Gf,r as Kf,v as Jf,w as Gn}from"./lodash-es-7e2e2ee0.js";import{p as Ma}from"./color-parse-f4088c3b.js";var Ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function A5(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var s=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return i[n]}})}),t}var Xd={exports:{}};/*!
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(i,e){(function(t,n){i.exports=n(Wf)})(self,t=>(()=>{var n={976:a=>{a.exports=t}},s={};function o(a){var l=s[a];if(l!==void 0)return l.exports;var c=s[a]={exports:{}};return n[a](c,c.exports,o),c.exports}o.d=(a,l)=>{for(var c in l)o.o(l,c)&&!o.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},o.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l);var r={};return(()=>{o.d(r,{default:()=>zf});var a=o(976);const l=function(k){var z=typeof k;return k!=null&&(z=="object"||z=="function")},c=typeof Ui=="object"&&Ui&&Ui.Object===Object&&Ui;var d=typeof self=="object"&&self&&self.Object===Object&&self;const u=c||d||Function("return this")(),h=function(){return u.Date.now()};var m=/\s/;const f=function(k){for(var z=k.length;z--&&m.test(k.charAt(z)););return z};var p=/^\s+/;const w=function(k){return k&&k.slice(0,f(k)+1).replace(p,"")},v=u.Symbol;var C=Object.prototype,B=C.hasOwnProperty,D=C.toString,Z=v?v.toStringTag:void 0;const P=function(k){var z=B.call(k,Z),he=k[Z];try{k[Z]=void 0;var Ge=!0}catch{}var Ht=D.call(k);return Ge&&(z?k[Z]=he:delete k[Z]),Ht};var N=Object.prototype.toString;const S=function(k){return N.call(k)};var ee=v?v.toStringTag:void 0;const ct=function(k){return k==null?k===void 0?"[object Undefined]":"[object Null]":ee&&ee in Object(k)?P(k):S(k)},Di=function(k){return k!=null&&typeof k=="object"},Vf=function(k){return typeof k=="symbol"||Di(k)&&ct(k)=="[object Symbol]"};var Bf=/^[-+]0x[0-9a-f]+$/i,Mf=/^0b[01]+$/i,Of=/^0o[0-7]+$/i,Nf=parseInt;const xa=function(k){if(typeof k=="number")return k;if(Vf(k))return NaN;if(l(k)){var z=typeof k.valueOf=="function"?k.valueOf():k;k=l(z)?z+"":z}if(typeof k!="string")return k===0?k:+k;k=w(k);var he=Mf.test(k);return he||Of.test(k)?Nf(k.slice(2),he?2:8):Bf.test(k)?NaN:+k};var Ff=Math.max,Lf=Math.min;const Df=function(k,z,he){var Ge,Ht,Un,qn,Fe,Wt,jn=0,Ia=!1,zi=!1,oo=!0;if(typeof k!="function")throw new TypeError("Expected a function");function ro(ve){var dt=Ge,Wi=Ht;return Ge=Ht=void 0,jn=ve,qn=k.apply(Wi,dt)}function Hf(ve){return jn=ve,Fe=setTimeout(Hi,z),Ia?ro(ve):qn}function Ra(ve){var dt=ve-Wt;return Wt===void 0||dt>=z||dt<0||zi&&ve-jn>=Un}function Hi(){var ve=h();if(Ra(ve))return Va(ve);Fe=setTimeout(Hi,function(dt){var Wi=z-(dt-Wt);return zi?Lf(Wi,Un-(dt-jn)):Wi}(ve))}function Va(ve){return Fe=void 0,oo&&Ge?ro(ve):(Ge=Ht=void 0,qn)}function ao(){var ve=h(),dt=Ra(ve);if(Ge=arguments,Ht=this,Wt=ve,dt){if(Fe===void 0)return Hf(Wt);if(zi)return clearTimeout(Fe),Fe=setTimeout(Hi,z),ro(Wt)}return Fe===void 0&&(Fe=setTimeout(Hi,z)),qn}return z=xa(z)||0,l(he)&&(Ia=!!he.leading,Un=(zi="maxWait"in he)?Ff(xa(he.maxWait)||0,z):Un,oo="trailing"in he?!!he.trailing:oo),ao.cancel=function(){Fe!==void 0&&clearTimeout(Fe),jn=0,Ge=Wt=Ht=Fe=void 0},ao.flush=function(){return Fe===void 0?qn:Va(h())},ao},Pa=(0,a.defineComponent)({name:"Ckeditor",model:{prop:"modelValue",event:"update:modelValue"},props:{editor:{type:Function,required:!0},config:{type:Object,default:()=>({})},modelValue:{type:String,default:""},tagName:{type:String,default:"div"},disabled:{type:Boolean,default:!1},disableTwoWayDataBinding:{type:Boolean,default:!1}},emits:["ready","destroy","blur","focus","input","update:modelValue"],data:()=>({instance:null,lastEditorData:null}),watch:{modelValue(k){this.instance&&k!==this.lastEditorData&&this.instance.data.set(k)},disabled(k){k?this.instance.enableReadOnlyMode("Integration Sample"):this.instance.disableReadOnlyMode("Integration Sample")}},created(){const{CKEDITOR_VERSION:k}=window;if(k){const[z]=k.split(".").map(Number);z<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')},mounted(){const k=Object.assign({},this.config);this.modelValue&&(k.initialData=this.modelValue),this.editor.create(this.$el,k).then(z=>{this.instance=(0,a.markRaw)(z),this.setUpEditorEvents(),this.modelValue!==k.initialData&&z.data.set(this.modelValue),this.disabled&&z.enableReadOnlyMode("Integration Sample"),this.$emit("ready",z)}).catch(z=>{console.error(z)})},beforeUnmount(){this.instance&&(this.instance.destroy(),this.instance=null),this.$emit("destroy",this.instance)},methods:{setUpEditorEvents(){const k=this.instance,z=Df(he=>{if(this.disableTwoWayDataBinding)return;const Ge=this.lastEditorData=k.data.get();this.$emit("update:modelValue",Ge,he,k),this.$emit("input",Ge,he,k)},300,{leading:!0});k.model.document.on("change:data",z),k.editing.view.document.on("focus",he=>{this.$emit("focus",he,k)}),k.editing.view.document.on("blur",he=>{this.$emit("blur",he,k)})}},render(){return(0,a.h)(this.tagName)}});if(!a.version||!a.version.startsWith("3."))throw new Error("The CKEditor plugin works only with Vue 3+. For more information, please refer to https://ckeditor.com/docs/ckeditor5/latest/builds/guides/integration/frameworks/vuejs-v3.html");const zf={install(k){k.component("Ckeditor",Pa)},component:Pa}})(),r=r.default})())})(Xd);var Yf=Xd.exports;const E5=Qf(Yf);/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ii({emitter:i,activator:e,callback:t,contextElements:n}){i.listenTo(document,"mousedown",(s,o)=>{if(!e())return;const r=typeof o.composedPath=="function"?o.composedPath():[],a=typeof n=="function"?n():n;for(const l of a)if(l.contains(o.target)||r.includes(l))return;t()})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Zd(i){class e extends i{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...n){super(...n),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ds({view:i}){i.listenTo(i.element,"submit",(e,t)=>{t.preventDefault(),i.fire("submit")},{useCapture:!0})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zs({keystrokeHandler:i,focusTracker:e,gridItems:t,numberOfColumns:n,uiLanguageDirection:s}){const o=typeof n=="number"?()=>n:n;i.set("arrowright",r((c,d)=>s==="rtl"?l(c,d.length):a(c,d.length))),i.set("arrowleft",r((c,d)=>s==="rtl"?a(c,d.length):l(c,d.length))),i.set("arrowup",r((c,d)=>{let u=c-o();return u<0&&(u=c+o()*Math.floor(d.length/o()),u>d.length-1&&(u-=o())),u})),i.set("arrowdown",r((c,d)=>{let u=c+o();return u>d.length-1&&(u=c%o()),u}));function r(c){return d=>{const u=t.find(f=>f.element===e.focusedElement),h=t.getIndex(u),m=c(h,t);t.get(m).focus(),d.stopPropagation(),d.preventDefault()}}function a(c,d){return c===d-1?0:c+1}function l(c,d){return c===0?d-1:c-1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Xf(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const $t=Xf(),V={isMac:eu($t),isWindows:Zf($t),isGecko:eg($t),isSafari:tg($t),isiOS:ng($t),isAndroid:ig($t),isBlink:sg($t),features:{isRegExpUnicodePropertySupported:og()}};function eu(i){return i.indexOf("macintosh")>-1}function Zf(i){return i.indexOf("windows")>-1}function eg(i){return!!i.match(/gecko\/\d+/)}function tg(i){return i.indexOf(" applewebkit/")>-1&&i.indexOf("chrome")===-1}function ng(i){return!!i.match(/iphone|ipad/i)||eu(i)&&navigator.maxTouchPoints>0}function ig(i){return i.indexOf("android")>-1}function sg(i){return i.indexOf("chrome/")>-1&&i.indexOf("edge/")<0}function og(){let i=!1;try{i="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tu(i,e,t,n){t=t||function(l,c){return l===c};const s=Array.isArray(i)?i:Array.prototype.slice.call(i),o=Array.isArray(e)?e:Array.prototype.slice.call(e),r=rg(s,o,t);return n?lg(r,o.length):ag(o,r)}function rg(i,e,t){const n=Oa(i,e,t);if(n===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=Na(i,n),o=Na(e,n),r=Oa(s,o,t),a=i.length-r,l=e.length-r;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l}}function Oa(i,e,t){for(let n=0;n<Math.max(i.length,e.length);n++)if(i[n]===void 0||e[n]===void 0||!t(i[n],e[n]))return n;return-1}function Na(i,e){return i.slice(e).reverse()}function ag(i,e){const t=[],{firstIndex:n,lastIndexOld:s,lastIndexNew:o}=e;return o-n>0&&t.push({index:n,type:"insert",values:i.slice(n,o)}),s-n>0&&t.push({index:n+(o-n),type:"delete",howMany:s-n}),t}function lg(i,e){const{firstIndex:t,lastIndexOld:n,lastIndexNew:s}=i;if(t===-1)return Array(e).fill("equal");let o=[];return t>0&&(o=o.concat(Array(t).fill("equal"))),s-t>0&&(o=o.concat(Array(s-t).fill("insert"))),n-t>0&&(o=o.concat(Array(n-t).fill("delete"))),s<e&&(o=o.concat(Array(e-s).fill("equal"))),o}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function oi(i,e,t){t=t||function(p,w){return p===w};const n=i.length,s=e.length;if(n>200||s>200||n+s>300)return oi.fastDiff(i,e,t,!0);let o,r;if(s<n){const p=i;i=e,e=p,o="delete",r="insert"}else o="insert",r="delete";const a=i.length,l=e.length,c=l-a,d={},u={};function h(p){const w=(u[p-1]!==void 0?u[p-1]:-1)+1,v=u[p+1]!==void 0?u[p+1]:-1,C=w>v?-1:1;d[p+C]&&(d[p]=d[p+C].slice(0)),d[p]||(d[p]=[]),d[p].push(w>v?o:r);let B=Math.max(w,v),D=B-p;for(;D<a&&B<l&&t(i[D],e[B]);)D++,B++,d[p].push("equal");return B}let m=0,f;do{for(f=-m;f<c;f++)u[f]=h(f);for(f=c+m;f>c;f--)u[f]=h(f);u[c]=h(c),m++}while(u[c]!==l);return d[c].slice(1)}oi.fastDiff=tu;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fa(){return function i(){i.called=!0}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bt{constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=Fa(),this.off=Fa()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ye=new Array(256).fill("").map((i,e)=>("0"+e.toString(16)).slice(-2));function Se(){const i=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,t=Math.random()*4294967296>>>0,n=Math.random()*4294967296>>>0;return"e"+ye[i>>0&255]+ye[i>>8&255]+ye[i>>16&255]+ye[i>>24&255]+ye[e>>0&255]+ye[e>>8&255]+ye[e>>16&255]+ye[e>>24&255]+ye[t>>0&255]+ye[t>>8&255]+ye[t>>16&255]+ye[t>>24&255]+ye[n>>0&255]+ye[n>>8&255]+ye[n>>16&255]+ye[n>>24&255]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Be={get(i="normal"){return typeof i!="number"?this[i]||this.normal:i},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function nu(i,e){const t=Be.get(e.priority);for(let n=0;n<i.length;n++)if(Be.get(i[n].priority)<t){i.splice(n,0,e);return}i.push(e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const cg="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class g extends Error{constructor(e,t,n){super(dg(e,n)),this.name="CKEditorError",this.context=t,this.data=n}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;const n=new g(e.message,t);throw n.stack=e.stack,n}}function K(i,e){console.warn(...ug(i,e))}function iu(i){return`
Read more: ${cg}#error-${i}`}function dg(i,e){const t=new WeakSet,s=e?` ${JSON.stringify(e,(r,a)=>{if(typeof a=="object"&&a!==null){if(t.has(a))return`[object ${a.constructor.name}]`;t.add(a)}return a})}`:"",o=iu(i);return i+s+o}function ug(i,e){const t=iu(i);return e?[i,e,t]:[i,t]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hg="39.0.0",mg=new Date(2023,7,2);/* istanbul ignore next -- @preserve */const La=typeof window=="object"?window:global;/* istanbul ignore next -- @preserve */if(La.CKEDITOR_VERSION)throw new g("ckeditor-duplicated-modules",null);La.CKEDITOR_VERSION=hg;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tn=Symbol("listeningTo"),Uo=Symbol("emitterId"),ut=Symbol("delegations"),su=J(Object);function J(i){if(!i)return su;class e extends i{on(n,s,o){this.listenTo(this,n,s,o)}once(n,s,o){let r=!1;const a=(l,...c)=>{r||(r=!0,l.off(),s.call(this,l,...c))};this.listenTo(this,n,a,o)}off(n,s){this.stopListening(this,n,s)}listenTo(n,s,o,r={}){let a,l;this[Tn]||(this[Tn]={});const c=this[Tn];lo(n)||ou(n);const d=lo(n);(a=c[d])||(a=c[d]={emitter:n,callbacks:{}}),(l=a.callbacks[s])||(l=a.callbacks[s]=[]),l.push(o),bg(this,n,s,o,r)}stopListening(n,s,o){const r=this[Tn];let a=n&&lo(n);const l=r&&a?r[a]:void 0,c=l&&s?l.callbacks[s]:void 0;if(!(!r||n&&!l||s&&!c))if(o)co(this,n,s,o),c.indexOf(o)!==-1&&(c.length===1?delete l.callbacks[s]:co(this,n,s,o));else if(c){for(;o=c.pop();)co(this,n,s,o);delete l.callbacks[s]}else if(l){for(s in l.callbacks)this.stopListening(n,s);delete r[a]}else{for(a in r)this.stopListening(r[a].emitter);delete this[Tn]}}fire(n,...s){try{const o=n instanceof bt?n:new bt(this,n),r=o.name;let a=au(this,r);if(o.path.push(this),a){const c=[o,...s];a=Array.from(a);for(let d=0;d<a.length&&(a[d].callback.apply(this,c),o.off.called&&(delete o.off.called,this._removeEventListener(r,a[d].callback)),!o.stop.called);d++);}const l=this[ut];if(l){const c=l.get(r),d=l.get("*");c&&Da(c,o,s),d&&Da(d,o,s)}return o.return}catch(o){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(o,this)}}delegate(...n){return{to:(s,o)=>{this[ut]||(this[ut]=new Map),n.forEach(r=>{const a=this[ut].get(r);a?a.set(s,o):this[ut].set(r,new Map([[s,o]]))})}}}stopDelegating(n,s){if(this[ut])if(!n)this[ut].clear();else if(!s)this[ut].delete(n);else{const o=this[ut].get(n);o&&o.delete(s)}}_addEventListener(n,s,o){pg(this,n);const r=qo(this,n),a=Be.get(o.priority),l={callback:s,priority:a};for(const c of r)nu(c,l)}_removeEventListener(n,s){const o=qo(this,n);for(const r of o)for(let a=0;a<r.length;a++)r[a].callback==s&&(r.splice(a,1),a--)}}return e}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{J[i]=su.prototype[i]});function fg(i,e){const t=i[Tn];return t&&t[e]?t[e].emitter:null}function ou(i,e){i[Uo]||(i[Uo]=e||Se())}function lo(i){return i[Uo]}function ru(i){return i._events||Object.defineProperty(i,"_events",{value:{}}),i._events}function gg(){return{callbacks:[],childEvents:[]}}function pg(i,e){const t=ru(i);if(t[e])return;let n=e,s=null;const o=[];for(;n!==""&&!t[n];)t[n]=gg(),o.push(t[n]),s&&t[n].childEvents.push(s),s=n,n=n.substr(0,n.lastIndexOf(":"));if(n!==""){for(const r of o)r.callbacks=t[n].callbacks.slice();t[n].childEvents.push(s)}}function qo(i,e){const t=ru(i)[e];if(!t)return[];let n=[t.callbacks];for(let s=0;s<t.childEvents.length;s++){const o=qo(i,t.childEvents[s]);n=n.concat(o)}return n}function au(i,e){let t;return!i._events||!(t=i._events[e])||!t.callbacks.length?e.indexOf(":")>-1?au(i,e.substr(0,e.lastIndexOf(":"))):null:t.callbacks}function Da(i,e,t){for(let[n,s]of i){s?typeof s=="function"&&(s=s(e.name)):s=e.name;const o=new bt(e.source,s);o.path=[...e.path],n.fire(o,...t)}}function bg(i,e,t,n,s){e._addEventListener?e._addEventListener(t,n,s):i._addEventListener.call(e,t,n,s)}function co(i,e,t,n){e._removeEventListener?e._removeEventListener(t,n):i._removeEventListener.call(e,t,n)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ks=Symbol("observableProperties"),Hs=Symbol("boundObservables"),As=Symbol("boundProperties"),pn=Symbol("decoratedMethods"),za=Symbol("decoratedOriginal"),lu=$(J());function $(i){if(!i)return lu;class e extends i{set(n,s){if(We(n)){Object.keys(n).forEach(r=>{this.set(r,n[r])},this);return}uo(this);const o=this[ks];if(n in this&&!o.has(n))throw new g("observable-set-cannot-override",this);Object.defineProperty(this,n,{enumerable:!0,configurable:!0,get(){return o.get(n)},set(r){const a=o.get(n);let l=this.fire(`set:${n}`,n,r,a);l===void 0&&(l=r),(a!==l||!o.has(n))&&(o.set(n,l),this.fire(`change:${n}`,n,l,a))}}),this[n]=s}bind(...n){if(!n.length||!Ha(n))throw new g("observable-bind-wrong-properties",this);if(new Set(n).size!==n.length)throw new g("observable-bind-duplicate-properties",this);uo(this);const s=this[As];n.forEach(r=>{if(s.has(r))throw new g("observable-bind-rebind",this)});const o=new Map;return n.forEach(r=>{const a={property:r,to:[]};s.set(r,a),o.set(r,a)}),{to:wg,toMany:_g,_observable:this,_bindProperties:n,_to:[],_bindings:o}}unbind(...n){if(!this[ks])return;const s=this[As],o=this[Hs];if(n.length){if(!Ha(n))throw new g("observable-unbind-wrong-properties",this);n.forEach(r=>{const a=s.get(r);a&&(a.to.forEach(([l,c])=>{const d=o.get(l),u=d[c];u.delete(a),u.size||delete d[c],Object.keys(d).length||(o.delete(l),this.stopListening(l,"change"))}),s.delete(r))})}else o.forEach((r,a)=>{this.stopListening(a,"change")}),o.clear(),s.clear()}decorate(n){uo(this);const s=this[n];if(!s)throw new g("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:n});this.on(n,(o,r)=>{o.return=s.apply(this,r)}),this[n]=function(...o){return this.fire(n,o)},this[n][za]=s,this[pn]||(this[pn]=[]),this[pn].push(n)}stopListening(n,s,o){if(!n&&this[pn]){for(const r of this[pn])this[r]=this[r][za];delete this[pn]}super.stopListening(n,s,o)}}return e}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{$[i]=lu.prototype[i]});function uo(i){i[ks]||(Object.defineProperty(i,ks,{value:new Map}),Object.defineProperty(i,Hs,{value:new Map}),Object.defineProperty(i,As,{value:new Map}))}function wg(...i){const e=yg(...i),t=Array.from(this._bindings.keys()),n=t.length;if(!e.callback&&e.to.length>1)throw new g("observable-bind-to-no-callback",this);if(n>1&&e.callback)throw new g("observable-bind-to-extra-callback",this);e.to.forEach(s=>{if(s.properties.length&&s.properties.length!==n)throw new g("observable-bind-to-properties-length",this);s.properties.length||(s.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(t[0]).callback=e.callback),Ag(this._observable,this._to),kg(this),this._bindProperties.forEach(s=>{cu(this._observable,s)})}function _g(i,e,t){if(this._bindings.size>1)throw new g("observable-bind-to-many-not-one-binding",this);this.to(...vg(i,e),t)}function vg(i,e){const t=i.map(n=>[n,e]);return Array.prototype.concat.apply([],t)}function Ha(i){return i.every(e=>typeof e=="string")}function yg(...i){if(!i.length)throw new g("observable-bind-to-parse-error",null);const e={to:[]};let t;return typeof i[i.length-1]=="function"&&(e.callback=i.pop()),i.forEach(n=>{if(typeof n=="string")t.properties.push(n);else if(typeof n=="object")t={observable:n,properties:[]},e.to.push(t);else throw new g("observable-bind-to-parse-error",null)}),e}function Cg(i,e,t,n){const s=i[Hs],o=s.get(t),r=o||{};r[n]||(r[n]=new Set),r[n].add(e),o||s.set(t,r)}function kg(i){let e;i._bindings.forEach((t,n)=>{i._to.forEach(s=>{e=s.properties[t.callback?0:i._bindProperties.indexOf(n)],t.to.push([s.observable,e]),Cg(i._observable,t,s.observable,e)})})}function cu(i,e){const n=i[As].get(e);let s;n.callback?s=n.callback.apply(i,n.to.map(o=>o[0][o[1]])):(s=n.to[0],s=s[0][s[1]]),Object.prototype.hasOwnProperty.call(i,e)?i[e]=s:i.set(e,s)}function Ag(i,e){e.forEach(t=>{const n=i[Hs];let s;n.get(t.observable)||i.listenTo(t.observable,"change",(o,r)=>{s=n.get(t.observable)[r],s&&s.forEach(a=>{cu(i,a.property)})})})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class du{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jo(i){let e=0;for(const t of i)e++;return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ce(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)if(i[n]!=e[n])return n;return i.length==e.length?"same":i.length<e.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Me(i){return!!(i&&i[Symbol.iterator])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function xt(i,e,t={},n=[]){const s=t&&t.xmlns,o=s?i.createElementNS(s,e):i.createElement(e);for(const r in t)o.setAttribute(r,t[r]);(Ba(n)||!Me(n))&&(n=[n]);for(let r of n)Ba(r)&&(r=i.createTextNode(r)),o.appendChild(r);return o}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uu{constructor(e,t){this._config={},t&&this.define(Wa(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,n,s=!1){if(De(t)){this._setObjectToTarget(e,t,s);return}const o=t.split(".");t=o.pop();for(const r of o)De(e[r])||(e[r]={}),e=e[r];if(De(n)){De(e[t])||(e[t]={}),e=e[t],this._setObjectToTarget(e,n,s);return}s&&typeof e[t]<"u"||(e[t]=n)}_getFromSource(e,t){const n=t.split(".");t=n.pop();for(const s of n){if(!De(e[s])){e=null;break}e=e[s]}return e?Wa(e[t]):void 0}_setObjectToTarget(e,t,n){Object.keys(t).forEach(s=>{this._setToTarget(e,s,t[s],n)})}}function Wa(i){return Or(i,Eg)}function Eg(i){return Rt(i)?i:void 0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Bt(i){if(i){if(i.defaultView)return i instanceof i.defaultView.Document;if(i.ownerDocument&&i.ownerDocument.defaultView)return i instanceof i.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Es(i){const e=Object.prototype.toString.apply(i);return e=="[object Window]"||e=="[object global]"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hu=rt(J());function rt(i){if(!i)return hu;class e extends i{listenTo(n,s,o,r={}){if(Bt(n)||Es(n)){const a={capture:!!r.useCapture,passive:!!r.usePassive},l=this._getProxyEmitter(n,a)||new Tg(n,a);this.listenTo(l,s,o,r)}else super.listenTo(n,s,o,r)}stopListening(n,s,o){if(Bt(n)||Es(n)){const r=this._getAllProxyEmitters(n);for(const a of r)this.stopListening(a,s,o)}else super.stopListening(n,s,o)}_getProxyEmitter(n,s){return fg(this,mu(n,s))}_getAllProxyEmitters(n){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(s=>this._getProxyEmitter(n,s)).filter(s=>!!s)}}return e}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{rt[i]=hu.prototype[i]});class Tg extends J(){constructor(e,t){super(),ou(this,mu(e,t)),this._domNode=e,this._options=t}attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;this._domListeners[e]&&(!(t=this._events[e])||!t.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,t,n){this.attach(e),J().prototype._addEventListener.call(this,e,t,n)}_removeEventListener(e,t){J().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=n=>{this.fire(e,n)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}}function Sg(i){return i["data-ck-expando"]||(i["data-ck-expando"]=Se())}function mu(i,e){let t=Sg(i);for(const n of Object.keys(e).sort())e[n]&&(t+="-"+n);return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Go;try{Go={window,document}}catch{/* istanbul ignore next -- @preserve */Go={window:{},document:{}}}const x=Go;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ko(i){let e=i.parentElement;if(!e)return null;for(;e.tagName!="BODY";){const t=e.style.overflowY||x.window.getComputedStyle(e).overflowY;if(t==="auto"||t==="scroll")break;if(e=e.parentElement,!e)return null}return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function xg(i){const e=[];let t=i;for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ws(i){return Object.prototype.toString.apply(i)=="[object Range]"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fu(i){const e=i.ownerDocument.defaultView.getComputedStyle(i);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function le(i){return Object.prototype.toString.call(i)=="[object Text]"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const gu=["top","right","bottom","left","width","height"];class F{constructor(e){const t=Ws(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),pu(e)||t)if(t){const n=F.getDomRangeRects(e);qi(this,F.getBoundingRect(n))}else qi(this,e.getBoundingClientRect());else if(Es(e)){const{innerWidth:n,innerHeight:s}=e;qi(this,{top:0,right:n,bottom:s,left:0,width:n,height:s})}else qi(this,e)}clone(){return new F(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new F(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if($a(e))return t;let n=e,s=e.parentNode||e.commonAncestorContainer,o;for(;s&&!$a(s);){if(n instanceof HTMLElement&&Ua(n)==="absolute"&&(o=n),o&&(Ua(s)!=="relative"||Pg(s)==="visible")){n=s,s=s.parentNode;continue}const r=new F(s),a=t.getIntersection(r);if(a)a.getArea()<t.getArea()&&(t=a);else return null;n=s,s=s.parentNode}return t}isEqual(e){for(const t of gu)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!!(t&&t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,n,s;if(Es(e))t=e.innerWidth-e.document.documentElement.clientWidth,n=e.innerHeight-e.document.documentElement.clientHeight,s=e.getComputedStyle(e.document.documentElement).direction;else{const o=fu(e);t=e.offsetWidth-e.clientWidth-o.left-o.right,n=e.offsetHeight-e.clientHeight-o.top-o.bottom,s=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,s==="ltr"?this.right-=t:this.left+=t,this.height-=n,this.bottom-=n,this}static getDomRangeRects(e){const t=[],n=Array.from(e.getClientRects());if(n.length)for(const s of n)t.push(new F(s));else{let s=e.startContainer;le(s)&&(s=s.parentNode);const o=new F(s.getBoundingClientRect());o.right=o.left,o.width=0,t.push(o)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let n=0;for(const s of e)n++,t.left=Math.min(t.left,s.left),t.top=Math.min(t.top,s.top),t.right=Math.max(t.right,s.right),t.bottom=Math.max(t.bottom,s.bottom);return n==0?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new F(t))}}function qi(i,e){for(const t of gu)i[t]=e[t]}function $a(i){return pu(i)?i===i.ownerDocument.body:!1}function pu(i){return i!==null&&typeof i=="object"&&i.nodeType===1&&typeof i.getBoundingClientRect=="function"}function Ua(i){return i.ownerDocument.defaultView.getComputedStyle(i).position}function Pg(i){return i.ownerDocument.defaultView.getComputedStyle(i).overflow}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ig(i,e=0){const t=i.map(s=>{if(s instanceof Document){const o=new F(global.window);return o.top+=e,o.height-=e,o}else return new F(s)});let n=t[0];for(const s of t.slice(1))n&&(n=n.getIntersection(s));return n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Rg(i){const e=[];let t=Ko(i);for(;t&&t!==x.document.body;)e.push(t),t=Ko(t);return e.push(x.document),e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vg(i){return i instanceof HTMLTextAreaElement?i.value:i.innerHTML}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y{constructor(e,t){Y._observerInstance||Y._createObserver(),this._element=e,this._callback=t,Y._addElementCallback(e,t),Y._observerInstance.observe(e)}get element(){return this._element}destroy(){Y._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){Y._elementCallbacks||(Y._elementCallbacks=new Map);let n=Y._elementCallbacks.get(e);n||(n=new Set,Y._elementCallbacks.set(e,n)),n.add(t)}static _deleteElementCallback(e,t){const n=Y._getElementCallbacks(e);n&&(n.delete(t),n.size||(Y._elementCallbacks.delete(e),Y._observerInstance.unobserve(e))),Y._elementCallbacks&&!Y._elementCallbacks.size&&(Y._observerInstance=null,Y._elementCallbacks=null)}static _getElementCallbacks(e){return Y._elementCallbacks?Y._elementCallbacks.get(e):null}static _createObserver(){Y._observerInstance=new x.window.ResizeObserver(e=>{for(const t of e){const n=Y._getElementCallbacks(t.target);if(n)for(const s of n)s(t)}})}}Y._observerInstance=null;Y._elementCallbacks=null;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qa(i,e){i instanceof HTMLTextAreaElement&&(i.value=e),i.innerHTML=e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Nr(i){return e=>e+i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ji(i){let e=0;for(;i.previousSibling;)i=i.previousSibling,e++;return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function bu(i,e,t){i.insertBefore(t,i.childNodes[e]||null)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ri(i){return i&&i.nodeType===Node.COMMENT_NODE}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wu(i){try{x.document.createAttribute(i)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function sn(i){return!!(i&&i.getClientRects&&i.getClientRects().length)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Bg(i){return!i||!i.parentNode||i.offsetParent===x.document.body?null:i.offsetParent}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _u({element:i,target:e,positions:t,limiter:n,fitInViewport:s,viewportOffsetConfig:o}){ys(e)&&(e=e()),ys(n)&&(n=n());const r=Bg(i),a=new F(i),l=new F(e);let c;const d=s&&Mg(o)||null,u={targetRect:l,elementRect:a,positionedElementAncestor:r,viewportRect:d};if(!n&&!s)c=new Jo(t[0],u);else{const h=n&&new F(n).getVisible();Object.assign(u,{limiterRect:h,viewportRect:d}),c=Og(t,u)||new Jo(t[0],u)}return c}function Mg(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const e=new F(x.window);return e.top+=i.top,e.height-=i.top,e.bottom-=i.bottom,e.height-=i.bottom,e}function Og(i,e){const{elementRect:t}=e,n=t.getArea(),s=i.map(a=>new Jo(a,e)).filter(a=>!!a.name);let o=0,r=null;for(const a of s){const{limiterIntersectionArea:l,viewportIntersectionArea:c}=a;if(l===n)return a;const d=c**2+l**2;d>o&&(o=d,r=a)}return r}function Ng(i,e){const t=vu(new F(e)),n=fu(e);let s=0,o=0;s-=t.left,o-=t.top,s+=e.scrollLeft,o+=e.scrollTop,s-=n.left,o-=n.top,i.moveBy(s,o)}function vu(i){const{scrollX:e,scrollY:t}=x.window;return i.clone().moveBy(e,t)}class Jo{constructor(e,t){const n=e(t.targetRect,t.elementRect,t.viewportRect);if(!n)return;const{left:s,top:o,name:r,config:a}=n;this.name=r,this.config=a,this._positioningFunctionCorrdinates={left:s,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;if(e){const t=this._options.viewportRect;if(t){const n=e.getIntersection(t);if(n)return n.getIntersectionArea(this._rect)}else return e.getIntersectionArea(this._rect)}return 0}get viewportIntersectionArea(){const e=this._options.viewportRect;return e?e.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=vu(this._rect),this._options.positionedElementAncestor&&Ng(this._cachedAbsoluteRect,this._options.positionedElementAncestor),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ja(i){const e=i.parentNode;e&&e.removeChild(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fg({target:i,viewportOffset:e=0,ancestorOffset:t=0,alignToTop:n,forceScroll:s}){const o=Fr(i);let r=o,a=null;for(e=zg(e);r;){let l;r==o?l=Ga(i):l=Ga(a),Dg({parent:l,getRect:()=>Ka(i,r),alignToTop:n,ancestorOffset:t,forceScroll:s});const c=Ka(i,r);if(Lg({window:r,rect:c,viewportOffset:e,alignToTop:n,forceScroll:s}),r.parent!=r){if(a=r.frameElement,r=r.parent,!a)return}else r=null}}function Lg({window:i,rect:e,alignToTop:t,forceScroll:n,viewportOffset:s}){const o=e.clone().moveBy(0,s.bottom),r=e.clone().moveBy(0,-s.top),a=new F(i).excludeScrollbarsAndBorders(),l=[r,o],c=t&&n,d=l.every(p=>a.contains(p));let{scrollX:u,scrollY:h}=i;const m=u,f=h;c?h-=a.top-e.top+s.top:d||(Cu(r,a)?h-=a.top-e.top+s.top:yu(o,a)&&(t?h+=e.top-a.top-s.top:h+=e.bottom-a.bottom+s.bottom)),d||(ku(e,a)?u-=a.left-e.left+s.left:Au(e,a)&&(u+=e.right-a.right+s.right)),(u!=m||h!==f)&&i.scrollTo(u,h)}function Dg({parent:i,getRect:e,alignToTop:t,forceScroll:n,ancestorOffset:s=0,limiterElement:o}){const r=Fr(i),a=t&&n;let l,c,d;const u=o||r.document.body;for(;i!=u;)c=e(),l=new F(i).excludeScrollbarsAndBorders(),d=l.contains(c),a?i.scrollTop-=l.top-c.top+s:d||(Cu(c,l)?i.scrollTop-=l.top-c.top+s:yu(c,l)&&(t?i.scrollTop+=c.top-l.top-s:i.scrollTop+=c.bottom-l.bottom+s)),d||(ku(c,l)?i.scrollLeft-=l.left-c.left+s:Au(c,l)&&(i.scrollLeft+=c.right-l.right+s)),i=i.parentNode}function yu(i,e){return i.bottom>e.bottom}function Cu(i,e){return i.top<e.top}function ku(i,e){return i.left<e.left}function Au(i,e){return i.right>e.right}function Fr(i){return Ws(i)?i.startContainer.ownerDocument.defaultView:i.ownerDocument.defaultView}function Ga(i){if(Ws(i)){let e=i.commonAncestorContainer;return le(e)&&(e=e.parentNode),e}else return i.parentNode}function Ka(i,e){const t=Fr(i),n=new F(i);if(t===e)return n;{let s=t;for(;s!=e;){const o=s.frameElement,r=new F(o).excludeScrollbarsAndBorders();n.moveBy(r.left,r.top),s=s.parent}}return n}function zg(i){return typeof i=="number"?{top:i,bottom:i,left:i,right:i}:i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Hg={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},Wg={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},O=Gg(),$g=Object.fromEntries(Object.entries(O).map(([i,e])=>[e,i.charAt(0).toUpperCase()+i.slice(1)]));function Bn(i){let e;if(typeof i=="string"){if(e=O[i.toLowerCase()],!e)throw new g("keyboard-unknown-key",null,{key:i})}else e=i.keyCode+(i.altKey?O.alt:0)+(i.ctrlKey?O.ctrl:0)+(i.shiftKey?O.shift:0)+(i.metaKey?O.cmd:0);return e}function $s(i){return typeof i=="string"&&(i=Kg(i)),i.map(e=>typeof e=="string"?qg(e):e).reduce((e,t)=>t+e,0)}function Ja(i){let e=$s(i);return Object.entries(V.isMac?Hg:Wg).reduce((s,[o,r])=>(e&O[o]&&(e&=~O[o],s+=r),s),"")+(e?$g[e]:"")}function Ug(i){return i==O.arrowright||i==O.arrowleft||i==O.arrowup||i==O.arrowdown}function Lr(i,e){const t=e==="ltr";switch(i){case O.arrowleft:return t?"left":"right";case O.arrowright:return t?"right":"left";case O.arrowup:return"up";case O.arrowdown:return"down"}}function qg(i){if(i.endsWith("!"))return Bn(i.slice(0,-1));const e=Bn(i);return V.isMac&&e==O.ctrl?O.cmd:e}function jg(i,e){const t=Lr(i,e);return t==="down"||t==="right"}function Gg(){const i={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let e=65;e<=90;e++){const t=String.fromCharCode(e);i[t.toLowerCase()]=e}for(let e=48;e<=57;e++)i[e-48]=e;for(let e=112;e<=123;e++)i["f"+(e-111)]=e;for(const e of"`-=[];',./\\")i[e]=e.charCodeAt(0);return i}function Kg(i){return i.split("+").map(e=>e.trim())}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Jg=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function Qo(i){return Jg.includes(i)?"rtl":"ltr"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function q(i){return Array.isArray(i)?i:[i]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//* istanbul ignore else -- @preserve */x.window.CKEDITOR_TRANSLATIONS||(x.window.CKEDITOR_TRANSLATIONS={});function Qg(i,e,t=1){if(typeof t!="number")throw new g("translation-service-quantity-not-a-number",null,{quantity:t});const n=Xg();n===1&&(i=Object.keys(x.window.CKEDITOR_TRANSLATIONS)[0]);const s=e.id||e.string;if(n===0||!Yg(i,s))return t!==1?e.plural:e.string;const o=x.window.CKEDITOR_TRANSLATIONS[i].dictionary,r=x.window.CKEDITOR_TRANSLATIONS[i].getPluralForm||(c=>c===1?0:1),a=o[s];if(typeof a=="string")return a;const l=Number(r(t));return a[l]}function Yg(i,e){return!!x.window.CKEDITOR_TRANSLATIONS[i]&&!!x.window.CKEDITOR_TRANSLATIONS[i].dictionary[e]}function Xg(){return Object.keys(x.window.CKEDITOR_TRANSLATIONS).length}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zg{constructor({uiLanguage:e="en",contentLanguage:t}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=Qo(this.uiLanguage),this.contentLanguageDirection=Qo(this.contentLanguage),this.t=(n,s)=>this._t(n,s)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=q(t),typeof e=="string"&&(e={string:e});const s=!!e.plural?t[0]:1,o=Qg(this.uiLanguage,e,s);return ep(o,t)}}function ep(i,e){return i.replace(/%(\d+)/g,(t,n)=>n<e.length?e[n]:t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ge extends J(){constructor(e={},t={}){super();const n=Me(e);if(n||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const s of e)this._items.push(s),this._itemMap.set(this._getItemIdBeforeAdding(s),s)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(t===void 0)t=this._items.length;else if(t>this._items.length||t<0)throw new g("collection-add-item-invalid-index",this);let n=0;for(const s of e){const o=this._getItemIdBeforeAdding(s),r=t+n;this._items.splice(r,0,s),this._itemMap.set(o,s),this.fire("add",s,r),n++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if(typeof e=="string")t=this._itemMap.get(e);else if(typeof e=="number")t=this._items[e];else throw new g("collection-get-invalid-arg",this);return t||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const t=this._idProperty,n=e[t];return n&&this._itemMap.has(n)}}getIndex(e){let t;return typeof e=="string"?t=this._itemMap.get(e):t=e,t?this._items.indexOf(t):-1}remove(e){const[t,n]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:n}),t}map(e,t){return this._items.map(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new g("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:t=>{this._setUpBindToBinding(n=>new t(n))},using:t=>{typeof t=="function"?this._setUpBindToBinding(t):this._setUpBindToBinding(n=>n[t])}}}_setUpBindToBinding(e){const t=this._bindToCollection,n=(s,o,r)=>{const a=t._bindToCollection==this,l=t._bindToInternalToExternalMap.get(o);if(a&&l)this._bindToExternalToInternalMap.set(o,l),this._bindToInternalToExternalMap.set(l,o);else{const c=e(o);if(!c){this._skippedIndexesFromExternal.push(r);return}let d=r;for(const u of this._skippedIndexesFromExternal)r>u&&d--;for(const u of t._skippedIndexesFromExternal)d>=u&&d++;this._bindToExternalToInternalMap.set(o,c),this._bindToInternalToExternalMap.set(c,o),this.add(c,d);for(let u=0;u<t._skippedIndexesFromExternal.length;u++)d<=t._skippedIndexesFromExternal[u]&&t._skippedIndexesFromExternal[u]++}};for(const s of t)n(null,s,t.getIndex(s));this.listenTo(t,"add",n),this.listenTo(t,"remove",(s,o,r)=>{const a=this._bindToExternalToInternalMap.get(o);a&&this.remove(a),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((l,c)=>(r<c&&l.push(c-1),r>c&&l.push(c),l),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let n;if(t in e){if(n=e[t],typeof n!="string")throw new g("collection-add-invalid-id",this);if(this.get(n))throw new g("collection-add-item-already-exists",this)}else e[t]=n=Se();return n}_remove(e){let t,n,s,o=!1;const r=this._idProperty;if(typeof e=="string"?(n=e,s=this._itemMap.get(n),o=!s,s&&(t=this._items.indexOf(s))):typeof e=="number"?(t=e,s=this._items[t],o=!s,s&&(n=s[r])):(s=e,n=s[r],t=this._items.indexOf(s),o=t==-1||!this._itemMap.get(n)),o)throw new g("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(n);const a=this._bindToInternalToExternalMap.get(s);return this._bindToInternalToExternalMap.delete(s),this._bindToExternalToInternalMap.delete(a),this.fire("remove",s,t),[s,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Q(i){const e=i.next();return e.done?null:e.value}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ue extends rt($()){constructor(){super(),this._elements=new Set,this._nextEventLoopTimeout=null,this.set("isFocused",!1),this.set("focusedElement",null)}add(e){if(this._elements.has(e))throw new g("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _e{constructor(){this._listener=new(rt())}listenTo(e){this._listener.listenTo(e,"keydown",(t,n)=>{this._listener.fire("_keydown:"+Bn(n),n)})}set(e,t,n={}){const s=$s(e),o=n.priority;this._listener.listenTo(this._listener,"_keydown:"+s,(r,a)=>{t(a,()=>{a.preventDefault(),a.stopPropagation(),r.stop()}),r.return=!0},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+Bn(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tp(i){const e=new Map;for(const t in i)e.set(t,i[t]);return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Mt(i){return Me(i)?new Map(i):tp(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const np=1e4;function ip(i,e,t,n){if(Math.max(e.length,i.length)>np)return i.slice(0,t).concat(e).concat(i.slice(t+n,i.length));{const s=Array.from(i);return s.splice(t,n,...e),s}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Yo(i,e){let t;function n(...s){n.cancel(),t=setTimeout(()=>i(...s),e)}return n.cancel=()=>{clearTimeout(t)},n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function sp(i){function e(u){return u.length>=40&&u.length<=255?"VALID":"INVALID"}if(!i)return"INVALID";let t="";try{t=atob(i)}catch{return"INVALID"}const n=t.split("-"),s=n[0],o=n[1];if(!o)return e(i);try{atob(o)}catch{try{if(atob(s),!atob(s).length)return e(i)}catch{return e(i)}}if(s.length<40||s.length>255)return"INVALID";let r="";try{atob(s),r=atob(o)}catch{return"INVALID"}if(r.length!==8)return"INVALID";const a=Number(r.substring(0,4)),l=Number(r.substring(4,6))-1,c=Number(r.substring(6,8)),d=new Date(a,l,c);return d<mg||isNaN(Number(d))?"INVALID":"VALID"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function op(i){return!!i&&i.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(i)}function rp(i){return!!i&&i.length==1&&/[\ud800-\udbff]/.test(i)}function ap(i){return!!i&&i.length==1&&/[\udc00-\udfff]/.test(i)}function Dr(i,e){return rp(i.charAt(e-1))&&ap(i.charAt(e))}function zr(i,e){return op(i.charAt(e))}const lp=cp();function Eu(i,e){const t=String(i).matchAll(lp);return Array.from(t).some(n=>n.index<e&&e<n.index+n[0].length)}function cp(){const i=[/\p{Emoji}[\u{E0020}-\u{E007E}]+\u{E007F}/u,/\p{Emoji}\u{FE0F}?\u{20E3}/u,/\p{Emoji}\u{FE0F}/u,/(?=\p{General_Category=Other_Symbol})\p{Emoji}\p{Emoji_Modifier}*/u],e=/\p{Regional_Indicator}{2}/u.source,t="(?:"+i.map(s=>s.source).join("|")+")",n=`${e}|${t}(?:‍${t})*`;return new RegExp(n,"ug")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qe extends ge{constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(t,n,s)=>{this._renderViewIntoCollectionParent(n,s)}),this.on("remove",(t,n)=>{n.element&&this._parentElement&&n.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...e){if(!e.length||!dp(e))throw new g("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const n of this)for(const s of e)n.delegate(s).to(t);this.on("add",(n,s)=>{for(const o of e)s.delegate(o).to(t)}),this.on("remove",(n,s)=>{for(const o of e)s.stopDelegating(o,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}}function dp(i){return i.every(e=>typeof e=="string")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let E=class extends rt($()){constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new ge,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,n)=>{n.locale=e,n.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=ke.bind(this,this)}createCollection(e){const t=new qe(e);return this._viewCollections.add(t),t}registerChild(e){Me(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){Me(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new ke(e)}extendTemplate(e){ke.extend(this.template,e)}render(){if(this.isRendered)throw new g("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const up="http://www.w3.org/1999/xhtml";class ke extends J(){constructor(e){super(),Object.assign(this,Ya(Qa(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=el(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new g("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(t){if(t.children)for(const n of t.children)Ts(n)?yield n:Hr(n)&&(yield*e(n))}yield*e(this)}static bind(e,t){return{to(n,s){return new hp({eventNameOrFunction:n,attribute:n,observable:e,emitter:t,callback:s})},if(n,s,o){return new Tu({observable:e,emitter:t,attribute:n,valueIfTrue:s,callback:o})}}}static extend(e,t){if(e._isRendered)throw new g("template-extend-render",[this,e]);Iu(e,Ya(Qa(t)))}_renderNode(e){let t;if(e.node?t=this.tag&&this.text:t=this.tag?this.text:!this.text,t)throw new g("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||up,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),us(this.text)?this._bindToObservable({schema:this.text,updater:fp(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,n=e.revertData;for(const s in this.attributes){const o=t.getAttribute(s),r=this.attributes[s];n&&(n.attributes[s]=o);const a=Za(r)?r[0].ns:null;if(us(r)){const l=Za(r)?r[0].value:r;n&&tl(s)&&l.unshift(o),this._bindToObservable({schema:l,updater:gp(t,s,a),data:e})}else if(s=="style"&&typeof r[0]!="string")this._renderStyleAttribute(r[0],e);else{n&&o&&tl(s)&&r.unshift(o);const l=r.map(c=>c&&(c.value||c)).reduce((c,d)=>c.concat(d),[]).reduce(Pu,"");Mn(l)||t.setAttributeNS(a,s,l)}}}_renderStyleAttribute(e,t){const n=t.node;for(const s in e){const o=e[s];us(o)?this._bindToObservable({schema:[o],updater:pp(n,s),data:t}):n.style[s]=o}}_renderElementChildren(e){const t=e.node,n=e.intoFragment?document.createDocumentFragment():t,s=e.isApplying;let o=0;for(const r of this.children)if(Wr(r)){if(!s){r.setParent(t);for(const a of r)n.appendChild(a.element)}}else if(Ts(r))s||(r.isRendered||r.render(),n.appendChild(r.element));else if(Bt(r))n.appendChild(r);else if(s){const a=e.revertData,l=el();a.children.push(l),r._renderNode({intoFragment:!1,node:n.childNodes[o++],isApplying:!0,revertData:l})}else n.appendChild(r.render());e.intoFragment&&t.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const n=this.eventListeners[t].map(s=>{const[o,r]=t.split("@");return s.activateDomEventListener(o,r,e)});e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:t,data:n}){const s=n.revertData;Su(e,t,n);const o=e.filter(r=>!Mn(r)).filter(r=>r.observable).map(r=>r.activateAttributeListener(e,t,n));s&&s.bindings.push(o)}_revertTemplateFromNode(e,t){for(const s of t.bindings)for(const o of s)o();if(t.text){e.textContent=t.text;return}const n=e;for(const s in t.attributes){const o=t.attributes[s];o===null?n.removeAttribute(s):n.setAttribute(s,o)}for(let s=0;s<t.children.length;++s)this._revertTemplateFromNode(n.childNodes[s],t.children[s])}}class Ri{constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,n){const s=()=>Su(e,t,n);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,s),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,s)}}}class hp extends Ri{constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,n){const s=(o,r)=>{(!t||r.target.matches(t))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(r):this.observable.fire(this.eventNameOrFunction,r))};return this.emitter.listenTo(n.node,e,s),()=>{this.emitter.stopListening(n.node,e,s)}}}class Tu extends Ri{constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const t=super.getValue(e);return Mn(t)?!1:this.valueIfTrue||!0}}function us(i){return i?(i.value&&(i=i.value),Array.isArray(i)?i.some(us):i instanceof Ri):!1}function mp(i,e){return i.map(t=>t instanceof Ri?t.getValue(e):t)}function Su(i,e,{node:t}){const n=mp(i,t);let s;i.length==1&&i[0]instanceof Tu?s=n[0]:s=n.reduce(Pu,""),Mn(s)?e.remove():e.set(s)}function fp(i){return{set(e){i.textContent=e},remove(){i.textContent=""}}}function gp(i,e,t){return{set(n){i.setAttributeNS(t,e,n)},remove(){i.removeAttributeNS(t,e)}}}function pp(i,e){return{set(t){i.style[e]=t},remove(){i.style[e]=null}}}function Qa(i){return Or(i,t=>{if(t&&(t instanceof Ri||Hr(t)||Ts(t)||Wr(t)))return t})}function Ya(i){if(typeof i=="string"?i=_p(i):i.text&&vp(i),i.on&&(i.eventListeners=wp(i.on),delete i.on),!i.text){i.attributes&&bp(i.attributes);const e=[];if(i.children)if(Wr(i.children))e.push(i.children);else for(const t of i.children)Hr(t)||Ts(t)||Bt(t)?e.push(t):e.push(new ke(t));i.children=e}return i}function bp(i){for(const e in i)i[e].value&&(i[e].value=q(i[e].value)),xu(i,e)}function wp(i){for(const e in i)xu(i,e);return i}function _p(i){return{text:[i]}}function vp(i){i.text=q(i.text)}function xu(i,e){i[e]=q(i[e])}function Pu(i,e){return Mn(e)?i:Mn(i)?e:`${i} ${e}`}function Xa(i,e){for(const t in e)i[t]?i[t].push(...e[t]):i[t]=e[t]}function Iu(i,e){if(e.attributes&&(i.attributes||(i.attributes={}),Xa(i.attributes,e.attributes)),e.eventListeners&&(i.eventListeners||(i.eventListeners={}),Xa(i.eventListeners,e.eventListeners)),e.text&&i.text.push(...e.text),e.children&&e.children.length){if(i.children.length!=e.children.length)throw new g("ui-template-extend-children-mismatch",i);let t=0;for(const n of e.children)Iu(i.children[t++],n)}}function Mn(i){return!i&&i!==0}function Ts(i){return i instanceof E}function Hr(i){return i instanceof ke}function Wr(i){return i instanceof qe}function Za(i){return We(i[0])&&i[0].ns}function el(){return{children:[],bindings:[],attributes:{}}}function tl(i){return i=="class"||i=="style"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yp extends qe{constructor(e,t=[]){super(t),this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new ke({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=xt(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&e.childElementCount==0&&e.remove()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lt extends E{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon","ck-reset_all-excluded",e.if("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),n=t.getAttribute("viewBox");n&&(this.viewBox=n);for(const{name:s,value:o}of Array.from(t.attributes))Lt.presentationalAttributeNames.includes(s)&&this.element.setAttribute(s,o);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}Lt.presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I extends E{constructor(e){super(e),this._focusDelayed=null;const t=this.bindTemplate,n=Se();this.set("ariaChecked",void 0),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${n}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._createLabelView(),this.iconView=new Lt,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const s={tag:"button",attributes:{class:["ck","ck-button",t.to("class"),t.if("isEnabled","ck-disabled",o=>!o),t.if("isVisible","ck-hidden",o=>!o),t.to("isOn",o=>o?"ck-on":"ck-off"),t.if("withText","ck-button_with-text"),t.if("withKeystroke","ck-button_with-keystroke")],role:t.to("role"),type:t.to("type",o=>o||"button"),tabindex:t.to("tabindex"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy"),"aria-disabled":t.if("isEnabled",!0,o=>!o),"aria-checked":t.to("isOn"),"aria-pressed":t.to("isOn",o=>this.isToggleable?String(!!o):!1),"data-cke-tooltip-text":t.to("_tooltipString"),"data-cke-tooltip-position":t.to("tooltipPosition")},children:this.children,on:{click:t.to(o=>{this.isEnabled?this.fire("execute"):o.preventDefault()})}};V.isSafari&&(this._focusDelayed||(this._focusDelayed=Yo(()=>this.focus(),0)),s.on.mousedown=t.to(()=>{this._focusDelayed()}),s.on.mouseup=t.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(s)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_createLabelView(){const e=new E,t=this.bindTemplate;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:t.to("labelStyle"),id:this.ariaLabelledBy},children:[{text:t.to("label")}]}),e}_createKeystrokeView(){const e=new E;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>Ja(t))}]}),e}_getTooltipString(e,t,n){return e?typeof e=="string"?e:(n&&(n=Ja(n)),e instanceof Function?e(t,n):`${t}${n?` (${n})`:""}`):""}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Us extends I{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new E;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function gi(i,e){const t=i.t,n={Black:t("Black"),"Dim grey":t("Dim grey"),Grey:t("Grey"),"Light grey":t("Light grey"),White:t("White"),Red:t("Red"),Orange:t("Orange"),Yellow:t("Yellow"),"Light green":t("Light green"),Green:t("Green"),Aquamarine:t("Aquamarine"),Turquoise:t("Turquoise"),"Light blue":t("Light blue"),Blue:t("Blue"),Purple:t("Purple")};return e.map(s=>{const o=n[s.label];return o&&o!=s.label&&(s.label=o),s})}function pi(i){return i.map(Cp).filter(e=>!!e)}function Cp(i){return typeof i=="string"?{model:i,label:i,hasBorder:!1,view:{name:"span",styles:{color:i}}}:{model:i.color,label:i.label||i.color,hasBorder:i.hasBorder===void 0?!1:i.hasBorder,view:{name:"span",styles:{color:`${i.color}`}}}}const kp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ru extends I{constructor(e){super(e);const t=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=kp,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color")},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nl extends E{constructor(e,t){super(e);const n=t&&t.colorDefinitions?t.colorDefinitions:[];this.columns=t&&t.columns?t.columns:5;const s={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new ue,this.keystrokes=new _e,this.items.on("add",(o,r)=>{r.isOn=r.color===this.selectedColor}),n.forEach(o=>{const r=new Ru;r.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),r.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(r)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:s}}),this.on("change:selectedColor",(o,r,a)=>{for(const l of this.items)l.isOn=l.color===a})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),zs({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vu(i,e){if(!i)return"";const t=Bu(i);if(!t)return"";if(t.space===e)return i;if(!Tp(t))return"";const s=Kd[t.space][e];if(!s)return"";const o=s(t.space==="hex"?t.hexValue:t.values);return Ep(o,e)}function Ap(i){if(!i)return"";const e=Bu(i);return e?e.space==="hex"?e.hexValue:Vu(i,"hex"):"#000"}function Ep(i,e){switch(e){case"hex":return`#${i}`;case"rgb":return`rgb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"hsl":return`hsl( ${i[0]}, ${i[1]}%, ${i[2]}% )`;case"hwb":return`hwb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"lab":return`lab( ${i[0]}% ${i[1]} ${i[2]} )`;case"lch":return`lch( ${i[0]}% ${i[1]} ${i[2]} )`;default:return""}}function Bu(i){if(i.startsWith("#")){const t=Ma(i);return{space:"hex",values:t.values,hexValue:i,alpha:t.alpha}}const e=Ma(i);return e.space?e:null}function Tp(i){return Object.keys(Kd).includes(i.space)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ze extends E{constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${Se()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pe extends E{constructor(e,t){super(e);const n=`ck-labeled-field-view-${Se()}`,s=`ck-labeled-field-view-status-${Se()}`;this.fieldView=t(this,n,s),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(n),this.statusView=this._createStatusView(s),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(r,a)=>r||a);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",r=>!r),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const t=new ze(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new E(this.locale),n=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",n.if("errorText","ck-labeled-field-view__status_error"),n.if("_statusText","ck-hidden",s=>!s)],id:e,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),t}focus(){this.fieldView.focus()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mu extends E{constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.focusTracker=new ue,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0),this.set("inputMode","text");const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),inputmode:t.to("inputMode"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to((...n)=>{this.fire("input",...n),this._updateIsEmpty()}),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,n)=>{this._setDomElementValue(n),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=Sp(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function Sp(i){return!i.value}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ou extends Mu{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xp extends Mu{constructor(e,{min:t,max:n,step:s}={}){super(e);const o=this.bindTemplate;this.set("min",t),this.set("max",n),this.set("step",s),this.extendTemplate({attributes:{type:"number",class:["ck-input-number"],min:o.to("min"),max:o.to("max"),step:o.to("step")}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Pp extends E{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",n=>`ck-dropdown__panel_${n}`),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():K("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class On extends E{constructor(e,t,n){super(e);const s=this.bindTemplate;this.buttonView=t,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.keystrokes=new _e,this.focusTracker=new ue,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",s.to("class"),s.if("isEnabled","ck-disabled",o=>!o)],id:s.to("id"),"aria-describedby":s.to("ariaDescribedById")},children:[t,n]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":s.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",(t,n,s)=>{s&&(this.panelPosition==="auto"?this.panelView.position=On._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)}),this.keystrokes.listenTo(this.element);const e=(t,n)=>{this.isOpen&&(this.isOpen=!1,n())};this.keystrokes.set("arrowdown",(t,n)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,n())}),this.keystrokes.set("arrowright",(t,n)=>{this.isOpen&&n()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:n,southWest:s,northEast:o,northWest:r,southMiddleEast:a,southMiddleWest:l,northMiddleEast:c,northMiddleWest:d}=On.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[n,s,a,l,e,o,r,c,d,t]:[s,n,l,a,e,r,o,d,c,t]}}On.defaultPanelPositions={south:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)/2,name:"s"}),southEast:i=>({top:i.bottom,left:i.left,name:"se"}),southWest:(i,e)=>({top:i.bottom,left:i.left-e.width+i.width,name:"sw"}),southMiddleEast:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)/4,name:"sme"}),southMiddleWest:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)*3/4,name:"smw"}),north:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)/2,name:"n"}),northEast:(i,e)=>({top:i.top-e.height,left:i.left,name:"ne"}),northWest:(i,e)=>({top:i.top-e.height,left:i.left-e.width+i.width,name:"nw"}),northMiddleEast:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)/4,name:"nme"}),northMiddleWest:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)*3/4,name:"nmw"})};On._getOptimalPosition=_u;const $r='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Nu extends I{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",t=>String(t))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Lt;return e.content=$r,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class at{constructor(e){if(this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let n=e.actions[t];typeof n=="string"&&(n=[n]);for(const s of n)e.keystrokeHandler.set(s,(o,r)=>{this[t](),r()})}}get first(){return this.focusables.find(ho)||null}get last(){return this.focusables.filter(ho).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((t,n)=>{const s=t.element===this.focusTracker.focusedElement;return s&&(e=n),s}),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,n=this.focusables.length;if(!n)return null;if(t===null)return this[e===1?"first":"last"];let s=(t+n+e)%n;do{const o=this.focusables.get(s);if(ho(o))return o;s=(s+n+e)%n}while(s!==t);return null}}function ho(i){return!!(i.focus&&sn(i.element))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ur extends E{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ip extends E{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Rp(i){return i.bindTemplate.to(e=>{e.target===i.element&&e.preventDefault()})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fu(i){return Array.isArray(i)?{items:i,removeItems:[]}:i?Object.assign({items:[],removeItems:[]},i):{items:[],removeItems:[]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class b extends $(){constructor(e){super(),this._disableStack=new Set,this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",il,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",il),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function il(i){i.return=!1,i.stop()}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class T extends $(){constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",t=>{if(!this.affectsData)return;const n=e.model.document.selection,o=!(n.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(n);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(t.return=!1,t.stop())},{priority:"highest"}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",sl,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",sl),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function sl(i){i.return=!1,i.stop()}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ol extends T{constructor(){super(...arguments),this._childCommandsDefinitions=[]}refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return!!t&&t.execute(e)}registerChildCommand(e,t={}){nu(this._childCommandsDefinitions,{command:e,priority:t.priority||"normal"}),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){const e=this._childCommandsDefinitions.find(({command:t})=>t.isEnabled);return e&&e.command}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lu extends J(){constructor(e,t=[],n=[]){super(),this._plugins=new Map,this._context=e,this._availablePlugins=new Map;for(const s of t)s.pluginName&&this._availablePlugins.set(s.pluginName,s);this._contextPlugins=new Map;for(const[s,o]of n)this._contextPlugins.set(s,o),this._contextPlugins.set(o,s),s.pluginName&&this._availablePlugins.set(s.pluginName,s)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let n=e;throw typeof e=="function"&&(n=e.pluginName||e.name),new g("plugincollection-plugin-not-loaded",this._context,{plugin:n})}return t}has(e){return this._plugins.has(e)}init(e,t=[],n=[]){const s=this,o=this._context;m(e),p(e);const r=e.filter(P=>!u(P,t)),a=[...f(r)];Z(a,n);const l=B(a);return D(l,"init").then(()=>D(l,"afterInit")).then(()=>l);function c(P){return typeof P=="function"}function d(P){return c(P)&&!!P.isContextPlugin}function u(P,N){return N.some(S=>S===P||h(P)===S||h(S)===P)}function h(P){return c(P)?P.pluginName||P.name:P}function m(P,N=new Set){P.forEach(S=>{c(S)&&(N.has(S)||(N.add(S),S.pluginName&&!s._availablePlugins.has(S.pluginName)&&s._availablePlugins.set(S.pluginName,S),S.requires&&m(S.requires,N)))})}function f(P,N=new Set){return P.map(S=>c(S)?S:s._availablePlugins.get(S)).reduce((S,ee)=>N.has(ee)?S:(N.add(ee),ee.requires&&(p(ee.requires,ee),f(ee.requires,N).forEach(ct=>S.add(ct))),S.add(ee)),new Set)}function p(P,N=null){P.map(S=>c(S)?S:s._availablePlugins.get(S)||S).forEach(S=>{w(S,N),v(S,N),C(S,N)})}function w(P,N){if(!c(P))throw N?new g("plugincollection-soft-required",o,{missingPlugin:P,requiredBy:h(N)}):new g("plugincollection-plugin-not-found",o,{plugin:P})}function v(P,N){if(d(N)&&!d(P))throw new g("plugincollection-context-required",o,{plugin:h(P),requiredBy:h(N)})}function C(P,N){if(N&&u(P,t))throw new g("plugincollection-required",o,{plugin:h(P),requiredBy:h(N)})}function B(P){return P.map(N=>{let S=s._contextPlugins.get(N);return S=S||new N(o),s._add(N,S),S})}function D(P,N){return P.reduce((S,ee)=>!ee[N]||s._contextPlugins.has(ee)?S:S.then(ee[N].bind(ee)),Promise.resolve())}function Z(P,N){for(const S of N){if(typeof S!="function")throw new g("plugincollection-replace-plugin-invalid-type",null,{pluginItem:S});const ee=S.pluginName;if(!ee)throw new g("plugincollection-replace-plugin-missing-name",null,{pluginItem:S});if(S.requires&&S.requires.length)throw new g("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:ee});const ct=s._availablePlugins.get(ee);if(!ct)throw new g("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:ee});const Di=P.indexOf(ct);if(Di===-1){if(s._contextPlugins.has(ct))return;throw new g("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:ee})}if(ct.requires&&ct.requires.length)throw new g("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:ee});P.splice(Di,1,S),s._availablePlugins.set(ee,S)}}}destroy(){const e=[];for(const[,t]of this)typeof t.destroy=="function"&&!this._contextPlugins.has(t)&&e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new g("plugincollection-plugin-name-conflict",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,t)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Du{constructor(e){this._contextOwner=null,this.config=new uu(e,this.constructor.defaultConfig);const t=this.constructor.builtinPlugins;this.config.define("plugins",t),this.plugins=new Lu(this,t);const n=this.config.get("language")||{};this.locale=new Zg({uiLanguage:typeof n=="string"?n:n.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new ge}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const n of e.concat(t)){if(typeof n!="function")throw new g("context-initplugins-constructor-only",null,{Plugin:n});if(n.isContextPlugin!==!0)throw new g("context-initplugins-invalid-plugin",null,{Plugin:n})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new g("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const n=new this(e);t(n.initPlugins().then(()=>n))})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qs extends $(){constructor(e){super(),this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hs=new WeakMap;function qr({view:i,element:e,isDirectHost:t=!0,keepOnFocus:n=!1}){const s=i.document;hs.has(s)||(hs.set(s,new Map),s.registerPostFixer(r=>mo(s,r)),s.on("change:isComposing",()=>{i.change(r=>mo(s,r))},{priority:"high"})),e.is("editableElement")&&e.on("change:placeholder",(r,a,l)=>{o(l)}),e.placeholder&&o(e.placeholder);function o(r){hs.get(s).set(e,{text:r,isDirectHost:t,keepOnFocus:n,hostElement:t?e:null}),i.change(a=>mo(s,a))}}function zu(i,e){return e.hasClass("ck-placeholder")?!1:(i.addClass("ck-placeholder",e),!0)}function Xo(i,e){return e.hasClass("ck-placeholder")?(i.removeClass("ck-placeholder",e),!0):!1}function Hu(i,e){if(!i.isAttached()||Array.from(i.getChildren()).some(r=>!r.is("uiElement")))return!1;const n=i.document,o=n.selection.anchor;return n.isComposing&&o&&o.parent===i?!1:e||!n.isFocused?!0:!!o&&o.parent!==i}function mo(i,e){const t=hs.get(i),n=[];let s=!1;for(const[o,r]of t)r.isDirectHost&&(n.push(o),rl(e,o,r)&&(s=!0));for(const[o,r]of t){if(r.isDirectHost)continue;const a=Vp(o);a&&(n.includes(a)||(r.hostElement=a,rl(e,o,r)&&(s=!0)))}return s}function rl(i,e,t){const{text:n,isDirectHost:s,hostElement:o}=t;let r=!1;return o.getAttribute("data-placeholder")!==n&&(i.setAttribute("data-placeholder",n,o),r=!0),(s||e.childCount==1)&&Hu(o,t.keepOnFocus)?zu(i,o)&&(r=!0):Xo(i,o)&&(r=!0),r}function Vp(i){if(i.childCount){const e=i.getChild(0);if(e.is("element")&&!e.is("uiElement")&&!e.is("attributeElement"))return e}return null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let rn=class{is(){throw new Error("is() method is abstract")}};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let an=class extends J(rn){constructor(e){super(),this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new g("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Ce(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire(`change:${e}`,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=Jd(this);return delete e.parent,e}};an.prototype.is=function(i){return i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let X=class Zo extends an{constructor(e,t){super(e),this._textData=t}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof Zo?this===e||this.data===e.data:!1}_clone(){return new Zo(this.document,this.data)}};X.prototype.is=function(i){return i==="$text"||i==="view:$text"||i==="text"||i==="view:text"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let et=class extends rn{constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.data.length)throw new g("view-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.data.length)throw new g("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const t=[];let n=e.includeSelf?this.textNode:this.parent;for(;n!==null;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}};et.prototype.is=function(i){return i==="$textProxy"||i==="view:$textProxy"||i==="textProxy"||i==="view:textProxy"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Oe{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)(typeof t=="string"||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const n of this._patterns){const s=al(t,n);if(s)return{element:t,pattern:n,match:s}}return null}matchAll(...e){const t=[];for(const n of e)for(const s of this._patterns){const o=al(n,s);o&&t.push({element:n,pattern:s,match:o})}return t.length>0?t:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],t=e.name;return typeof e!="function"&&t&&!(t instanceof RegExp)?t:null}}function al(i,e){if(typeof e=="function")return e(i);const t={};return e.name&&(t.name=Bp(e.name,i.name),!t.name)||e.attributes&&(t.attributes=Fp(e.attributes,i),!t.attributes)||e.classes&&(t.classes=Lp(e.classes,i),!t.classes)||e.styles&&(t.styles=Dp(e.styles,i),!t.styles)?null:t}function Bp(i,e){return i instanceof RegExp?!!e.match(i):i===e}function jr(i,e,t){const n=Mp(i),s=Array.from(e),o=[];if(n.forEach(([r,a])=>{s.forEach(l=>{Op(r,l)&&Np(a,l,t)&&o.push(l)})}),!(!n.length||o.length<n.length))return o}function Mp(i){return Array.isArray(i)?i.map(e=>De(e)?((e.key===void 0||e.value===void 0)&&K("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0]):De(i)?Object.entries(i):[[i,!0]]}function Op(i,e){return i===!0||i===e||i instanceof RegExp&&e.match(i)}function Np(i,e,t){if(i===!0)return!0;const n=t(e);return i===n||i instanceof RegExp&&!!String(n).match(i)}function Fp(i,e){const t=new Set(e.getAttributeKeys());return De(i)?(i.style!==void 0&&K("matcher-pattern-deprecated-attributes-style-key",i),i.class!==void 0&&K("matcher-pattern-deprecated-attributes-class-key",i)):(t.delete("style"),t.delete("class")),jr(i,t,n=>e.getAttribute(n))}function Lp(i,e){return jr(i,e.getClassNames(),()=>{})}function Dp(i,e){return jr(i,e.getStyleNames(!0),t=>e.getStyle(t))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zp{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles);return!Array.from(e).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=Array.from(Wp(e).entries());for(const[n,s]of t)this._styleProcessor.toNormalizedForm(n,s,this._styles)}has(e){if(this.isEmpty)return!1;const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);return Array.isArray(n)}set(e,t){if(We(e))for(const[n,s]of Object.entries(e))this._styleProcessor.toNormalizedForm(n,s,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=er(e);$f(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!We(this._styles[e]))return this._styles[e];const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);if(Array.isArray(n))return n[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?this._styleProcessor.getStyleNames(this._styles):this._getStylesEntries().map(([n])=>n)}clear(){this._styles={}}_getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const n of t)e.push(...this._styleProcessor.getReducedForm(n,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split(".");if(!(t.length>1))return;const s=t.splice(0,t.length-1).join("."),o=Cs(this._styles,s);if(!o)return;!Array.from(Object.keys(o)).length&&this.remove(s)}}class Hp{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,n){if(We(t)){fo(n,er(e),t);return}if(this._normalizers.has(e)){const s=this._normalizers.get(e),{path:o,value:r}=s(t);fo(n,o,r)}else fo(n,e,t)}getNormalized(e,t){if(!e)return Qd({},t);if(t[e]!==void 0)return t[e];if(this._extractors.has(e)){const n=this._extractors.get(e);if(typeof n=="string")return Cs(t,n);const s=n(e,t);if(s)return s}return Cs(t,er(e))}getReducedForm(e,t){const n=this.getNormalized(e,t);return n===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(n):[[e,n]]}getStyleNames(e){const t=Array.from(this._consumables.keys()).filter(s=>{const o=this.getNormalized(s,e);return o&&typeof o=="object"?Object.keys(o).length:o}),n=new Set([...t,...Object.keys(e)]);return Array.from(n.values())}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const n of t)this._mapStyleNames(n,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function Wp(i){let e=null,t=0,n=0,s=null;const o=new Map;if(i==="")return o;i.charAt(i.length-1)!=";"&&(i=i+";");for(let r=0;r<i.length;r++){const a=i.charAt(r);if(e===null)switch(a){case":":s||(s=i.substr(t,r-t),n=r+1);break;case'"':case"'":e=a;break;case";":{const l=i.substr(n,r-n);s&&o.set(s.trim(),l.trim()),s=null,t=r+1;break}}else a===e&&(e=null)}return o}function er(i){return i.replace("-",".")}function fo(i,e,t){let n=t;We(t)&&(n=Qd({},Cs(i,e),t)),Uf(i,e,n)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Ye=class Wu extends an{constructor(e,t,n,s){if(super(e),this._unsafeAttributesToRender=[],this._customProperties=new Map,this.name=t,this._attrs=$p(n),this._children=[],s&&this._insertChild(0,s),this._classes=new Set,this._attrs.has("class")){const o=this._attrs.get("class");ll(this._classes,o),this._attrs.delete("class")}this._styles=new zp(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const t=this._styles.toString();return t==""?void 0:t}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof Wu))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,n]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==n)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e){return this._styles.getStyleNames(e)}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Oe(...e);let n=this.parent;for(;n&&!n.is("documentFragment");){if(t.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),n=Array.from(this._attrs).map(s=>`${s[0]}="${s[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(t?` style="${t}"`:"")+(n==""?"":` ${n}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const t=[];if(e)for(const s of this.getChildren())t.push(s._clone(e));const n=new this.constructor(this.document,this.name,this._attrs,t);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n._unsafeAttributesToRender=this._unsafeAttributesToRender,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let n=0;const s=Up(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){const n=String(t);this._fireChange("attributes",this),e=="class"?ll(this._classes,n):e=="style"?this._styles.setTo(n):this._attrs.set(e,n)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of q(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of q(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),typeof e!="string"?this._styles.set(e):this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of q(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}};Ye.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="view:element"):i==="element"||i==="view:element"||i==="node"||i==="view:node"};function $p(i){const e=Mt(i);for(const[t,n]of e)n===null?e.delete(t):typeof n!="string"&&e.set(t,String(n));return e}function ll(i,e){const t=e.split(/\s+/);i.clear(),t.forEach(n=>i.add(n))}function Up(i,e){return typeof e=="string"?[new X(i,e)]:(Me(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new X(i,t):t instanceof et?new X(i,t.data):t))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bi extends Ye{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=qp}}bi.prototype.is=function(i,e){return e?e===this.name&&(i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function qp(){const i=[...this.getChildren()],e=i[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const t of i)if(!t.is("uiElement"))return null;return this.childCount}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class js extends $(bi){constructor(e,t,n,s){super(e,t,n,s),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",o=>o&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}}js.prototype.is=function(i,e){return e?e===this.name&&(i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const cl=Symbol("rootName");class $u extends js{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(cl)}set rootName(e){this._setCustomProperty(cl,e)}set _name(e){this.name=e}}$u.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Yt=class{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new g("view-tree-walker-no-start-position",null);if(e.direction&&e.direction!="forward"&&e.direction!="backward")throw new g("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=A._createAt(e.startPosition):this._position=A._createAt(e.boundaries[e.direction=="backward"?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n;do n=this.position,t=this.next();while(!t.done&&e(t.value));t.done||(this._position=n)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===n.childCount)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let s;if(n instanceof X){if(e.isAtEnd)return this._position=A._createAfter(n),this._next();s=n.data[e.offset]}else s=n.getChild(e.offset);if(s instanceof Ye){if(!this.shallow)e=new A(s,0);else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,this._formatReturnValue("elementStart",s,t,e,1)}if(s instanceof X){if(this.singleCharacters)return e=new A(s,0),this._position=e,this._next();let o=s.data.length,r;return s==this._boundaryEndParent?(o=this.boundaries.end.offset,r=new et(s,0,o),e=A._createAfter(r)):(r=new et(s,0,s.data.length),e.offset++),this._position=e,this._formatReturnValue("text",r,t,e,o)}if(typeof s=="string"){let o;this.singleCharacters?o=1:o=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-e.offset;const r=new et(n,e.offset,o);return e.offset+=o,this._position=e,this._formatReturnValue("text",r,t,e,o)}return e=A._createAfter(n),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,t,e)}_previous(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let s;if(n instanceof X){if(e.isAtStart)return this._position=A._createBefore(n),this._previous();s=n.data[e.offset-1]}else s=n.getChild(e.offset-1);if(s instanceof Ye)return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",s,t,e,1)):(e=new A(s,s.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",s,t,e));if(s instanceof X){if(this.singleCharacters)return e=new A(s,s.data.length),this._position=e,this._previous();let o=s.data.length,r;if(s==this._boundaryStartParent){const a=this.boundaries.start.offset;r=new et(s,a,s.data.length-a),o=r.data.length,e=A._createBefore(r)}else r=new et(s,0,s.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",r,t,e,o)}if(typeof s=="string"){let o;if(this.singleCharacters)o=1;else{const a=n===this._boundaryStartParent?this.boundaries.start.offset:0;o=e.offset-a}e.offset-=o;const r=new et(n,e.offset,o);return this._position=e,this._formatReturnValue("text",r,t,e,o)}return e=A._createBefore(n),this._position=e,this._formatReturnValue("elementStart",n,t,e,1)}_formatReturnValue(e,t,n,s,o){return t instanceof et&&(t.offsetInText+t.data.length==t.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(s=A._createAfter(t.textNode),this._position=s):n=A._createAfter(t.textNode)),t.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(s=A._createBefore(t.textNode),this._position=s):n=A._createBefore(t.textNode))),{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:s,length:o}}}};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let A=class ht extends rn{constructor(e,t){super(),this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof js);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const t=ht._createAt(this),n=t.offset+e;return t.offset=n<0?0:n,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Yt(t);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),n.push(e.offset);const s=Ce(t,n);switch(s){case"prefix":return"before";case"extension":return"after";default:return t[s]<n[s]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Yt(e)}clone(){return new ht(this.parent,this.offset)}static _createAt(e,t){if(e instanceof ht)return new this(e.parent,e.offset);{const n=e;if(t=="end")t=n.is("$text")?n.data.length:n.childCount;else{if(t=="before")return this._createBefore(n);if(t=="after")return this._createAfter(n);if(t!==0&&!t)throw new g("view-createpositionat-offset-required",n)}return new ht(n,t)}}static _createAfter(e){if(e.is("$textProxy"))return new ht(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new g("view-position-after-root",e,{root:e});return new ht(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new ht(e.textNode,e.offsetInText);if(!e.parent)throw new g("view-position-before-root",e,{root:e});return new ht(e.parent,e.index)}};A.prototype.is=function(i){return i==="position"||i==="view:position"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let M=class Tt extends rn{constructor(e,t=null){super(),this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Yt({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Gi,{direction:"backward"}),t=this.end.getLastMatchingPosition(Gi);return e.parent.is("$text")&&e.isAtStart&&(e=A._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=A._createAfter(t.parent)),new Tt(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Gi);if(e.isAfter(this.end)||e.isEqual(this.end))return new Tt(e,e);let t=this.end.getLastMatchingPosition(Gi,{direction:"backward"});const n=e.nodeAfter,s=t.nodeBefore;return n&&n.is("$text")&&(e=new A(n,0)),s&&s.is("$text")&&(t=new A(s,s.data.length)),new Tt(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new Tt(this.start,e.start)),this.containsPosition(e.end)&&t.push(new Tt(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new Tt(t,n)}return null}getWalker(e={}){return e.boundaries=this,new Yt(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new Tt(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Yt(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new Yt(e);yield t.position;for(const n of t)yield n.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,n,s){return new this(new A(e,t),new A(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(A._createBefore(e),t)}};M.prototype.is=function(i){return i==="range"||i==="view:range"};function Gi(i){return!!(i.item.is("attributeElement")||i.item.is("uiElement"))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Ot=class Uu extends J(rn){constructor(...e){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=jo(this.getRanges()),n=jo(e.getRanges());if(t!=n)return!1;if(t==0)return!0;for(let s of this.getRanges()){s=s.getTrimmed();let o=!1;for(let r of e.getRanges())if(r=r.getTrimmed(),s.start.isEqual(r.start)&&s.end.isEqual(r.end)){o=!0;break}if(!o)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]),this._setFakeOptions(s);else if(t instanceof Uu||t instanceof Gr)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof M)this._setRanges([t],s&&s.backward),this._setFakeOptions(s);else if(t instanceof A)this._setRanges([new M(t)]),this._setFakeOptions(s);else if(t instanceof an){const o=!!s&&!!s.backward;let r;if(n===void 0)throw new g("view-selection-setto-required-second-parameter",this);n=="in"?r=M._createIn(t):n=="on"?r=M._createOn(t):r=new M(A._createAt(t,n)),this._setRanges([r],o),this._setFakeOptions(s)}else if(Me(t))this._setRanges(t,s&&s.backward),this._setFakeOptions(s);else throw new g("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,t){if(this.anchor===null)throw new g("view-selection-setfocus-no-ranges",this);const n=A._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.pop(),n.compareWith(s)=="before"?this._addRange(new M(n,s),!0):this._addRange(new M(s,n)),this.fire("change")}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const n of e)this._addRange(n);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof M))throw new g("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new g("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new M(e.start,e.end))}};Ot.prototype.is=function(i){return i==="selection"||i==="view:selection"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Gr=class extends J(rn){constructor(...e){super(),this._selection=new Ot,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,t){this._selection.setFocus(e,t)}};Gr.prototype.is=function(i){return i==="selection"||i=="documentSelection"||i=="view:selection"||i=="view:documentSelection"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hn extends bt{constructor(e,t,n){super(e,t),this.startRange=n,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const go=Symbol("bubbling contexts");function tr(i){class e extends i{fire(n,...s){try{const o=n instanceof bt?n:new bt(this,n),r=po(this);if(!r.size)return;if(Kn(o,"capturing",this),bn(r,"$capture",o,...s))return o.return;const a=o.startRange||this.selection.getFirstRange(),l=a?a.getContainedElement():null,c=l?!!qu(r,l):!1;let d=l||jp(a);if(Kn(o,"atTarget",d),!c){if(bn(r,"$text",o,...s))return o.return;Kn(o,"bubbling",d)}for(;d;){if(d.is("rootElement")){if(bn(r,"$root",o,...s))return o.return}else if(d.is("element")&&bn(r,d.name,o,...s))return o.return;if(bn(r,d,o,...s))return o.return;d=d.parent,Kn(o,"bubbling",d)}return Kn(o,"bubbling",this),bn(r,"$document",o,...s),o.return}catch(o){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(o,this)}}_addEventListener(n,s,o){const r=q(o.context||"$document"),a=po(this);for(const l of r){let c=a.get(l);c||(c=new(J()),a.set(l,c)),this.listenTo(c,n,s,o)}}_removeEventListener(n,s){const o=po(this);for(const r of o.values())this.stopListening(r,n,s)}}return e}{const i=tr(Object);["fire","_addEventListener","_removeEventListener"].forEach(e=>{tr[e]=i.prototype[e]})}function Kn(i,e,t){i instanceof Hn&&(i._eventPhase=e,i._currentTarget=t)}function bn(i,e,t,...n){const s=typeof e=="string"?i.get(e):qu(i,e);return s?(s.fire(t,...n),t.stop.called):!1}function qu(i,e){for(const[t,n]of i)if(typeof t=="function"&&t(e))return n;return null}function po(i){return i[go]||(i[go]=new Map),i[go]}function jp(i){if(!i)return null;const e=i.start.parent,t=i.end.parent,n=e.getPath(),s=t.getPath();return n.length>s.length?e:t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Gs=class extends tr($()){constructor(e){super(),this._postFixers=new Set,this.selection=new Gr,this.roots=new ge({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(t=n(e),t)break;while(t)}};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ju=10;class Xt extends Ye{constructor(e,t,n,s){super(e,t,n,s),this._priority=ju,this._id=null,this._clonesGroup=null,this.getFillerOffset=Gp}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new g("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}Xt.DEFAULT_PRIORITY=ju;Xt.prototype.is=function(i,e){return e?e===this.name&&(i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"):i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Gp(){if(bo(this))return null;let i=this.parent;for(;i&&i.is("attributeElement");){if(bo(i)>1)return null;i=i.parent}return!i||bo(i)>1?null:this.childCount}function bo(i){return Array.from(i.getChildren()).filter(e=>!e.is("uiElement")).length}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kr extends Ye{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=Kp}_insertChild(e,t){if(t&&(t instanceof an||Array.from(t).length>0))throw new g("view-emptyelement-cannot-add",[this,t]);return 0}}Kr.prototype.is=function(i,e){return e?e===this.name&&(i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"):i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Kp(){return null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ks extends Ye{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=Qp}_insertChild(e,t){if(t&&(t instanceof an||Array.from(t).length>0))throw new g("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const n of this.getAttributeKeys())t.setAttribute(n,this.getAttribute(n));return t}}Ks.prototype.is=function(i,e){return e?e===this.name&&(i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"):i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Jp(i){i.document.on("arrowKey",(e,t)=>Yp(e,t,i.domConverter),{priority:"low"})}function Qp(){return null}function Yp(i,e,t){if(e.keyCode==O.arrowright){const n=e.domTarget.ownerDocument.defaultView.getSelection(),s=n.rangeCount==1&&n.getRangeAt(0).collapsed;if(s||e.shiftKey){const o=n.focusNode,r=n.focusOffset,a=t.domPositionToView(o,r);if(a===null)return;let l=!1;const c=a.getLastMatchingPosition(d=>(d.item.is("uiElement")&&(l=!0),!!(d.item.is("uiElement")||d.item.is("attributeElement"))));if(l){const d=t.viewPositionToDom(c);s?n.collapse(d.parent,d.offset):n.extend(d.parent,d.offset)}}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Jr extends Ye{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=Xp}_insertChild(e,t){if(t&&(t instanceof an||Array.from(t).length>0))throw new g("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}}Jr.prototype.is=function(i,e){return e?e===this.name&&(i==="rawElement"||i==="view:rawElement"||i==="element"||i==="view:element"):i==="rawElement"||i==="view:rawElement"||i===this.name||i==="view:"+this.name||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Xp(){return null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Zt=class extends J(rn){constructor(e,t){super(),this._children=[],this._customProperties=new Map,this.document=e,t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let n=0;const s=Zp(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}};Zt.prototype.is=function(i){return i==="documentFragment"||i==="view:documentFragment"};function Zp(i,e){return typeof e=="string"?[new X(i,e)]:(Me(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new X(i,t):t instanceof et?new X(i,t.data):t))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qr{constructor(e){this._cloneGroups=new Map,this._slotFactory=null,this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new Zt(this.document,e)}createText(e){return new X(this.document,e)}createAttributeElement(e,t,n={}){const s=new Xt(this.document,e,t);return typeof n.priority=="number"&&(s._priority=n.priority),n.id&&(s._id=n.id),n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createContainerElement(e,t,n={},s={}){let o=null;De(n)?s=n:o=n;const r=new bi(this.document,e,t,o);return s.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),r}createEditableElement(e,t,n={}){const s=new js(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createEmptyElement(e,t,n={}){const s=new Kr(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createUIElement(e,t,n){const s=new Ks(this.document,e,t);return n&&(s.render=n),s}createRawElement(e,t,n,s={}){const o=new Jr(this.document,e,t);return n&&(o.render=n),s.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),o}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){De(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof A?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new g("view-writer-break-non-container-element",this.document);if(!t.parent)throw new g("view-writer-break-root",this.document);if(e.isAtStart)return A._createBefore(t);if(!e.isAtEnd){const n=t._clone(!1);this.insert(A._createAfter(t),n);const s=new M(e,A._createAt(t,"end")),o=new A(n,0);this.move(s,o)}return A._createAfter(t)}mergeAttributes(e){const t=e.offset,n=e.parent;if(n.is("$text"))return e;if(n.is("attributeElement")&&n.childCount===0){const r=n.parent,a=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new A(r,a))}const s=n.getChild(t-1),o=n.getChild(t);if(!s||!o)return e;if(s.is("$text")&&o.is("$text"))return ul(s,o);if(s.is("attributeElement")&&o.is("attributeElement")&&s.isSimilar(o)){const r=s.childCount;return s._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new A(s,r))}return e}mergeContainers(e){const t=e.nodeBefore,n=e.nodeAfter;if(!t||!n||!t.is("containerElement")||!n.is("containerElement"))throw new g("view-writer-merge-containers-invalid-position",this.document);const s=t.getChild(t.childCount-1),o=s instanceof X?A._createAt(s,"end"):A._createAt(t,"end");return this.move(M._createIn(n),A._createAt(t,"end")),this.remove(M._createOn(n)),o}insert(e,t){t=Me(t)?[...t]:[t],Gu(t,this.document);const n=t.reduce((r,a)=>{const l=r[r.length-1],c=!a.is("uiElement");return!l||l.breakAttributes!=c?r.push({breakAttributes:c,nodes:[a]}):l.nodes.push(a),r},[]);let s=null,o=e;for(const{nodes:r,breakAttributes:a}of n){const l=this._insertNodes(o,r,a);s||(s=l.start),o=l.end}return s?new M(s,o):new M(e)}remove(e){const t=e instanceof M?e:M._createOn(e);if(Jn(t,this.document),t.isCollapsed)return new Zt(this.document);const{start:n,end:s}=this._breakAttributesRange(t,!0),o=n.parent,r=s.offset-n.offset,a=o._removeChildren(n.offset,r);for(const c of a)this._removeFromClonedElementsGroup(c);const l=this.mergeAttributes(n);return t.start=l,t.end=l.clone(),new Zt(this.document,a)}clear(e,t){Jn(e,this.document);const n=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const s of n){const o=s.item;let r;if(o.is("element")&&t.isSimilar(o))r=M._createOn(o);else if(!s.nextPosition.isAfter(e.start)&&o.is("$textProxy")){const a=o.getAncestors().find(l=>l.is("element")&&t.isSimilar(l));a&&(r=M._createIn(a))}r&&(r.end.isAfter(e.end)&&(r.end=e.end),r.start.isBefore(e.start)&&(r.start=e.start),this.remove(r))}}move(e,t){let n;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const s=t.parent,o=s.childCount;e=this._breakAttributesRange(e,!0),n=this.remove(e),t.offset+=s.childCount-o}else n=this.remove(e);return this.insert(t,n)}wrap(e,t){if(!(t instanceof Xt))throw new g("view-writer-wrap-invalid-attribute",this.document);if(Jn(e,this.document),e.isCollapsed){let n=e.start;n.parent.is("element")&&!eb(n.parent)&&(n=n.getLastMatchingPosition(o=>o.item.is("uiElement"))),n=this._wrapPosition(n,t);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(e.start)&&this.setSelection(n),new M(n)}else return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof Xt))throw new g("view-writer-unwrap-invalid-attribute",this.document);if(Jn(e,this.document),e.isCollapsed)return e;const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,r=this._unwrapChildren(o,n.offset,s.offset,t),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new M(a,l)}rename(e,t){const n=new bi(this.document,e,t.getAttributes());return this.insert(A._createAfter(t),n),this.move(M._createIn(t),A._createAt(n,0)),this.remove(M._createOn(t)),n}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return A._createAt(e,t)}createPositionAfter(e){return A._createAfter(e)}createPositionBefore(e){return A._createBefore(e)}createRange(e,t){return new M(e,t)}createRangeOn(e){return M._createOn(e)}createRangeIn(e){return M._createIn(e)}createSelection(...e){return new Ot(...e)}createSlot(e="children"){if(!this._slotFactory)throw new g("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,n){let s;if(n?s=nr(e):s=e.parent.is("$text")?e.parent.parent:e.parent,!s)throw new g("view-writer-invalid-position-container",this.document);let o;n?o=this._breakAttributes(e,!0):o=e.parent.is("$text")?wo(e):e;const r=s._insertChild(o.offset,t);for(const d of t)this._addToClonedElementsGroup(d);const a=o.getShiftedBy(r),l=this.mergeAttributes(o);l.isEqual(o)||a.offset--;const c=this.mergeAttributes(a);return new M(l,c)}_wrapChildren(e,t,n,s){let o=t;const r=[];for(;o<n;){const l=e.getChild(o),c=l.is("$text"),d=l.is("attributeElement");if(d&&this._wrapAttributeElement(s,l))r.push(new A(e,o));else if(c||!d||tb(s,l)){const u=s._clone();l._remove(),u._appendChild(l),e._insertChild(o,u),this._addToClonedElementsGroup(u),r.push(new A(e,o))}else this._wrapChildren(l,0,l.childCount,s);o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==t)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return M._createFromParentsAndOffsets(e,t,e,n)}_unwrapChildren(e,t,n,s){let o=t;const r=[];for(;o<n;){const l=e.getChild(o);if(!l.is("attributeElement")){o++;continue}if(l.isSimilar(s)){const c=l.getChildren(),d=l.childCount;l._remove(),e._insertChild(o,c),this._removeFromClonedElementsGroup(l),r.push(new A(e,o),new A(e,o+d)),o+=d,n+=d-1;continue}if(this._unwrapAttributeElement(s,l)){r.push(new A(e,o),new A(e,o+1)),o++;continue}this._unwrapChildren(l,0,l.childCount,s),o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==t||l.offset==n)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return M._createFromParentsAndOffsets(e,t,e,n)}_wrapRange(e,t){const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,r=this._wrapChildren(o,n.offset,s.offset,t),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new M(a,l)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return dl(e.clone());e.parent.is("$text")&&(e=wo(e));const n=this.createAttributeElement("_wrapPosition-fake-element");n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,e.parent._insertChild(e.offset,n);const s=new M(e,e.getShiftedBy(1));this.wrap(s,t);const o=new A(n.parent,n.index);n._remove();const r=o.nodeBefore,a=o.nodeAfter;return r instanceof X&&a instanceof X?ul(r,a):dl(o)}_wrapAttributeElement(e,t){if(!hl(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if(!(n==="class"||n==="style")&&t.hasAttribute(n)&&t.getAttribute(n)!==e.getAttribute(n))return!1;for(const n of e.getStyleNames())if(t.hasStyle(n)&&t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())n==="class"||n==="style"||t.hasAttribute(n)||this.setAttribute(n,e.getAttribute(n),t);for(const n of e.getStyleNames())t.hasStyle(n)||this.setStyle(n,e.getStyle(n),t);for(const n of e.getClassNames())t.hasClass(n)||this.addClass(n,t);return!0}_unwrapAttributeElement(e,t){if(!hl(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if(!(n==="class"||n==="style")&&(!t.hasAttribute(n)||t.getAttribute(n)!==e.getAttribute(n)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const n of e.getStyleNames())if(!t.hasStyle(n)||t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())n==="class"||n==="style"||this.removeAttribute(n,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const n=e.start,s=e.end;if(Jn(e,this.document),e.isCollapsed){const l=this._breakAttributes(e.start,t);return new M(l,l)}const o=this._breakAttributes(s,t),r=o.parent.childCount,a=this._breakAttributes(n,t);return o.offset+=o.parent.childCount-r,new M(a,o)}_breakAttributes(e,t=!1){const n=e.offset,s=e.parent;if(e.parent.is("emptyElement"))throw new g("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new g("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new g("view-writer-cannot-break-raw-element",this.document);if(!t&&s.is("$text")&&ir(s.parent)||ir(s))return e.clone();if(s.is("$text"))return this._breakAttributes(wo(e),t);const o=s.childCount;if(n==o){const r=new A(s.parent,s.index+1);return this._breakAttributes(r,t)}else if(n===0){const r=new A(s.parent,s.index);return this._breakAttributes(r,t)}else{const r=s.index+1,a=s._clone();s.parent._insertChild(r,a),this._addToClonedElementsGroup(a);const l=s.childCount-n,c=s._removeChildren(n,l);a._appendChild(c);const d=new A(s.parent,r);return this._breakAttributes(d,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const s of e.getChildren())this._addToClonedElementsGroup(s);const t=e.id;if(!t)return;let n=this._cloneGroups.get(t);n||(n=new Set,this._cloneGroups.set(t,n)),n.add(e),e._clonesGroup=n}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const s of e.getChildren())this._removeFromClonedElementsGroup(s);const t=e.id;if(!t)return;const n=this._cloneGroups.get(t);n&&n.delete(e)}}function eb(i){return Array.from(i.getChildren()).some(e=>!e.is("uiElement"))}function nr(i){let e=i.parent;for(;!ir(e);){if(!e)return;e=e.parent}return e}function tb(i,e){return i.priority<e.priority?!0:i.priority>e.priority?!1:i.getIdentity()<e.getIdentity()}function dl(i){const e=i.nodeBefore;if(e&&e.is("$text"))return new A(e,e.data.length);const t=i.nodeAfter;return t&&t.is("$text")?new A(t,0):i}function wo(i){if(i.offset==i.parent.data.length)return new A(i.parent.parent,i.parent.index+1);if(i.offset===0)return new A(i.parent.parent,i.parent.index);const e=i.parent.data.slice(i.offset);return i.parent._data=i.parent.data.slice(0,i.offset),i.parent.parent._insertChild(i.parent.index+1,new X(i.root.document,e)),new A(i.parent.parent,i.parent.index+1)}function ul(i,e){const t=i.data.length;return i._data+=e.data,e._remove(),new A(i,t)}const nb=[X,Xt,bi,Kr,Jr,Ks];function Gu(i,e){for(const t of i){if(!nb.some(n=>t instanceof n))throw new g("view-writer-insert-invalid-node-type",e);t.is("$text")||Gu(t.getChildren(),e)}}function ir(i){return i&&(i.is("containerElement")||i.is("documentFragment"))}function Jn(i,e){const t=nr(i.start),n=nr(i.end);if(!t||!n||t!==n)throw new g("view-writer-invalid-range-container",e)}function hl(i,e){return i.id===null&&e.id===null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ku=i=>i.createTextNode(" "),Ju=i=>{const e=i.createElement("span");return e.dataset.ckeFiller="true",e.innerText=" ",e},Qu=i=>{const e=i.createElement("br");return e.dataset.ckeFiller="true",e},Je=7,wi="⁠".repeat(Je);function Re(i){return typeof i=="string"?i.substr(0,Je)===wi:le(i)&&i.data.substr(0,Je)===wi}function ni(i){return i.data.length==Je&&Re(i)}function ml(i){const e=typeof i=="string"?i:i.data;return Re(i)?e.slice(Je):e}function ib(i){i.document.on("arrowKey",sb,{priority:"low"})}function sb(i,e){if(e.keyCode==O.arrowleft){const t=e.domTarget.ownerDocument.defaultView.getSelection();if(t.rangeCount==1&&t.getRangeAt(0).collapsed){const n=t.getRangeAt(0).startContainer,s=t.getRangeAt(0).startOffset;Re(n)&&s<=Je&&t.collapse(n,0)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ob extends $(){constructor(e,t){super(),this.domDocuments=new Set,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this._inlineFiller=null,this._fakeSelectionContainer=null,this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),V.isBlink&&!V.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this.set("isComposing",!1),this.on("change:isComposing",()=>{this.isComposing||this.render()})}markToSync(e,t){if(e==="text")this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if(e==="attributes")this.markedAttributes.add(t);else if(e==="children")this.markedChildren.add(t);else throw new g("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!V.isAndroid)return;let e=null;const t=V.isBlink&&!V.isAndroid?!this.isSelecting:!0;for(const n of this.markedChildren)this._updateChildrenMappings(n);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=A._createBefore(e.parent)));for(const n of this.markedAttributes)this._updateAttrs(n);for(const n of this.markedChildren)this._updateChildren(n,{inlineFillerPosition:e});for(const n of this.markedTexts)!this.markedChildren.has(n.parent)&&this.domConverter.mapViewToDom(n.parent)&&this._updateText(n,{inlineFillerPosition:e});if(t)if(e){const n=this.domConverter.viewPositionToDom(e),s=n.parent.ownerDocument;Re(n.parent)?this._inlineFiller=n.parent:this._inlineFiller=fl(s,n.parent,n.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){if(!this.domConverter.mapViewToDom(e))return;const n=Array.from(this.domConverter.mapViewToDom(e).childNodes),s=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(n,s),r=this._findUpdateActions(o,n,s,ab);if(r.indexOf("update")!==-1){const a={equal:0,insert:0,delete:0};for(const l of r)if(l==="update"){const c=a.equal+a.insert,d=a.equal+a.delete,u=e.getChild(c);u&&!(u.is("uiElement")||u.is("rawElement"))&&this._updateElementMappings(u,n[d]),ja(s[c]),a.equal++}else a[l]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?A._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&le(t.parent)&&Re(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Re(e))throw new g("view-renderer-filler-was-lost",this);ni(e)?e.remove():e.data=e.data.substr(Je),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(t.root)||!t.is("element")||!rb(t)||n===t.getFillerOffset())return!1;const s=e.nodeBefore,o=e.nodeAfter;return!(s instanceof X||o instanceof X||V.isAndroid&&(s||o))}_updateText(e,t){const n=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const r=t.inlineFillerPosition;r&&r.parent==e.parent&&r.offset==e.index&&(o=wi+o),gl(n,o)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.attributes).map(o=>o.name),s=e.getAttributeKeys();for(const o of s)this.domConverter.setDomElementAttribute(t,o,e.getAttribute(o),e);for(const o of n)e.hasAttribute(o)||this.domConverter.removeDomElementAttribute(t,o)}_updateChildren(e,t){const n=this.domConverter.mapViewToDom(e);if(!n)return;if(V.isAndroid){let u=null;for(const h of Array.from(n.childNodes)){if(u&&le(u)&&le(h)){n.normalize();break}u=h}}const s=t.inlineFillerPosition,o=n.childNodes,r=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));s&&s.parent===e&&fl(n.ownerDocument,r,s.offset);const a=this._diffNodeLists(o,r),l=this._findUpdateActions(a,o,r,lb);let c=0;const d=new Set;for(const u of l)u==="delete"?(d.add(o[c]),ja(o[c])):(u==="equal"||u==="update")&&c++;c=0;for(const u of l)u==="insert"?(bu(n,c,r[c]),c++):u==="update"?(gl(o[c],r[c].data),c++):u==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(r[c])),c++);for(const u of d)u.parentNode||this.domConverter.unbindDomElement(u)}_diffNodeLists(e,t){return e=ub(e,this._fakeSelectionContainer),oi(e,t,cb.bind(null,this.domConverter))}_findUpdateActions(e,t,n,s){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],r=[],a=[];const l={equal:0,insert:0,delete:0};for(const c of e)c==="insert"?a.push(n[l.equal+l.insert]):c==="delete"?r.push(t[l.equal+l.delete]):(o=o.concat(oi(r,a,s).map(d=>d==="equal"?"update":d)),o.push("equal"),r=[],a=[]),l[c]++;return o.concat(oi(r,a,s).map(c=>c==="equal"?"update":c))}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}}_updateSelection(){if(V.isBlink&&!V.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&V.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=hb(t));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!n.parentElement||n.parentElement!=e)&&e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const s=t.getSelection(),o=t.createRange();s.removeAllRanges(),o.selectNodeContents(n),s.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),s=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(n.parent,n.offset,s.parent,s.offset),V.isGecko&&db(s,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!t||t.parentElement!==e||n.anchorNode!==t&&!t.contains(n.anchorNode)?!0:t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const n=e.activeElement,s=this.domConverter.mapDomToView(n);n&&s&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function rb(i){if(i.getAttribute("contenteditable")=="false")return!1;const e=i.findAncestor(t=>t.hasAttribute("contenteditable"));return!e||e.getAttribute("contenteditable")=="true"}function fl(i,e,t){const n=e instanceof Array?e:e.childNodes,s=n[t];if(le(s))return s.data=wi+s.data,s;{const o=i.createTextNode(wi);return Array.isArray(e)?n.splice(t,0,o):bu(e,t,o),o}}function ab(i,e){return Bt(i)&&Bt(e)&&!le(i)&&!le(e)&&!ri(i)&&!ri(e)&&i.tagName.toLowerCase()===e.tagName.toLowerCase()}function lb(i,e){return Bt(i)&&Bt(e)&&le(i)&&le(e)}function cb(i,e,t){return e===t?!0:le(e)&&le(t)?e.data===t.data:!!(i.isBlockFiller(e)&&i.isBlockFiller(t))}function db(i,e){const t=i.parent;if(t.nodeType!=Node.ELEMENT_NODE||i.offset!=t.childNodes.length-1)return;const n=t.childNodes[i.offset];n&&n.tagName=="BR"&&e.addRange(e.getRangeAt(0))}function ub(i,e){const t=Array.from(i);return t.length==0||!e||t[t.length-1]==e&&t.pop(),t}function hb(i){const e=i.createElement("div");return e.className="ck-fake-selection-container",Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent=" ",e}function gl(i,e){const t=i.data;if(t==e)return;const n=tu(t,e);for(const s of n)s.type==="insert"?i.insertData(s.index,s.values.join("")):i.deleteData(s.index,s.howMany)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mb=Qu(x.document),fb=Ku(x.document),gb=Ju(x.document),Ki="data-ck-unsafe-attribute-",pl="data-ck-unsafe-element";class Js{constructor(e,{blockFillerMode:t,renderingMode:n="editing"}={}){this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new Oe,this._inlineObjectElementMatcher=new Oe,this.document=e,this.renderingMode=n,this.blockFillerMode=t||(n==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?x.document:x.document.implementation.createHTMLDocument("")}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Ot(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const n of Array.from(e.children))this.unbindDomElement(n)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,n){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:n==="img"&&(e==="src"||e==="srcset")||n==="source"&&e==="srcset"?!0:!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,t){if(this.renderingMode==="data"){e.innerHTML=t;return}const n=new DOMParser().parseFromString(t,"text/html"),s=n.createDocumentFragment(),o=n.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);const r=n.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),a=[];let l;for(;l=r.nextNode();)a.push(l);for(const c of a){for(const u of c.getAttributeNames())this.setDomElementAttribute(c,u,c.getAttribute(u));const d=c.tagName.toLowerCase();this._shouldRenameElement(d)&&(wl(d),c.replaceWith(this._createReplacementDomElement(d,c)))}for(;e.firstChild;)e.firstChild.remove();e.append(s)}viewToDom(e,t={}){if(e.is("$text")){const n=this._processDataFromViewText(e);return this._domDocument.createTextNode(n)}else{if(this.mapViewToDom(e))return this.mapViewToDom(e);let n;if(e.is("documentFragment"))n=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(n,e);else{if(e.is("uiElement"))return e.name==="$comment"?n=this._domDocument.createComment(e.getCustomProperty("$rawContent")):n=e.render(this._domDocument,this),t.bind&&this.bindElements(n,e),n;this._shouldRenameElement(e.name)?(wl(e.name),n=this._createReplacementDomElement(e.name)):e.hasAttribute("xmlns")?n=this._domDocument.createElementNS(e.getAttribute("xmlns"),e.name):n=this._domDocument.createElement(e.name),e.is("rawElement")&&e.render(n,this),t.bind&&this.bindElements(n,e);for(const s of e.getAttributeKeys())this.setDomElementAttribute(n,s,e.getAttribute(s),e)}if(t.withChildren!==!1)for(const s of this.viewChildrenToDom(e,t))n.appendChild(s);return n}}setDomElementAttribute(e,t,n,s){const o=this.shouldRenderAttribute(t,n,e.tagName.toLowerCase())||s&&s.shouldRenderUnsafeAttribute(t);if(o||K("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:n}),!wu(t)){K("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:n});return}e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute(Ki+t)&&o&&e.removeAttribute(Ki+t),e.setAttribute(o?t:Ki+t,n)}removeDomElementAttribute(e,t){t!=pl&&(e.removeAttribute(t),e.removeAttribute(Ki+t))}*viewChildrenToDom(e,t={}){const n=e.getFillerOffset&&e.getFillerOffset();let s=0;for(const o of e.getChildren()){n===s&&(yield this._getBlockFiller());const r=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!Q(o.getAttributes());r&&this.renderingMode=="data"?yield*this.viewChildrenToDom(o,t):(r&&K("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,t)),s++}n===s&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),n=this.viewPositionToDom(e.end),s=this._domDocument.createRange();return s.setStart(t.parent,t.offset),s.setEnd(n.parent,n.offset),s}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const n=this.findCorrespondingDomText(t);if(!n)return null;let s=e.offset;return Re(n)&&(s+=Je),{parent:n,offset:s}}else{let n,s,o;if(e.offset===0){if(n=this.mapViewToDom(t),!n)return null;o=n.childNodes[0]}else{const a=e.nodeBefore;if(s=a.is("$text")?this.findCorrespondingDomText(a):this.mapViewToDom(a),!s)return null;n=s.parentNode,o=s.nextSibling}if(le(o)&&Re(o))return{parent:o,offset:Je};const r=s?ji(s)+1:0;return{parent:n,offset:r}}}domToView(e,t={}){const n=[],s=this._domToView(e,t,n),o=s.next().value;return!o||(s.next(),this._processDomInlineNodes(null,n,t),o.is("$text")&&o.data.length==0)?null:o}*domChildrenToView(e,t={},n=[]){for(let s=0;s<e.childNodes.length;s++){const o=e.childNodes[s],r=this._domToView(o,t,n),a=r.next().value;a!==null&&(this._isBlockViewElement(a)&&this._processDomInlineNodes(e,n,t),yield a,r.next())}this._processDomInlineNodes(e,n,t)}domSelectionToView(e){if(e.rangeCount===1){let s=e.getRangeAt(0).startContainer;le(s)&&(s=s.parentNode);const o=this.fakeSelectionToView(s);if(o)return o}const t=this.isDomSelectionBackward(e),n=[];for(let s=0;s<e.rangeCount;s++){const o=e.getRangeAt(s),r=this.domRangeToView(o);r&&n.push(r)}return new Ot(n,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),n=this.domPositionToView(e.endContainer,e.endOffset);return t&&n?new M(t,n):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ji(e));const n=this.mapDomToView(e);if(n&&(n.is("uiElement")||n.is("rawElement")))return A._createBefore(n);if(le(e)){if(ni(e))return this.domPositionToView(e.parentNode,ji(e));const s=this.findCorrespondingViewText(e);let o=t;return s?(Re(e)&&(o-=Je,o=o<0?0:o),new A(s,o)):null}else{if(t===0){const s=this.mapDomToView(e);if(s)return new A(s,0)}else{const s=e.childNodes[t-1];if(le(s)&&ni(s)||s&&this.isBlockFiller(s))return this.domPositionToView(s.parentNode,ji(s));const o=le(s)?this.findCorrespondingViewText(s):this.mapDomToView(s);if(o&&o.parent)return new A(o.parent,o.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(ni(e))return null;const t=this.getHostViewElement(e);if(t)return t;const n=e.previousSibling;if(n){if(!this.isElement(n))return null;const s=this.mapDomToView(n);if(s){const o=s.nextSibling;return o instanceof X?o:null}}else{const s=this.mapDomToView(e.parentNode);if(s){const o=s.getChild(0);return o instanceof X?o:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:n,scrollY:s}=x.window,o=[];bl(t,r=>{const{scrollLeft:a,scrollTop:l}=r;o.push([a,l])}),t.focus(),bl(t,r=>{const[a,l]=o.shift();r.scrollLeft=a,r.scrollTop=l}),x.window.scrollTo(n,s)}}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),n=this.domSelectionToView(t);n&&n.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(mb):e.tagName==="BR"&&Yu(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:e.isEqualNode(gb)||bb(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const n=t.collapsed;return t.detach(),n}getHostViewElement(e){const t=xg(e);for(t.pop();t.length;){const n=t.pop(),s=this._domToViewMapping.get(n);if(s&&(s.is("uiElement")||s.is("rawElement")))return s}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return Ku(this._domDocument);case"markedNbsp":return Ju(this._domDocument);case"br":return Qu(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(le(e)&&Re(e)&&t<Je||this.isElement(e)&&Re(e.childNodes[t]))return!1;const n=this.mapDomToView(e);return!(n&&(n.is("uiElement")||n.is("rawElement")))}*_domToView(e,t,n){if(this.isBlockFiller(e))return null;const s=this.getHostViewElement(e);if(s)return s;if(ri(e)&&t.skipComments)return null;if(le(e)){if(ni(e))return null;{const o=e.data;if(o==="")return null;const r=new X(this.document,o);return n.push(r),r}}else{let o=this.mapDomToView(e);if(o)return this._isInlineObjectElement(o)&&n.push(o),o;if(this.isDocumentFragment(e))o=new Zt(this.document),t.bind&&this.bindDocumentFragments(e,o);else{o=this._createViewElement(e,t),t.bind&&this.bindElements(e,o);const a=e.attributes;if(a)for(let l=a.length,c=0;c<l;c++)o._setAttribute(a[c].name,a[c].value);if(this._isViewElementWithRawContent(o,t))return o._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(o)||n.push(o),o;if(ri(e))return o._setCustomProperty("$rawContent",e.data),o}yield o;const r=[];if(t.withChildren!==!1)for(const a of this.domChildrenToView(e,t,r))o._appendChild(a);if(this._isInlineObjectElement(o))n.push(o);else for(const a of r)n.push(a)}}_processDomInlineNodes(e,t,n){if(!t.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let s=!1;for(let o=0;o<t.length;o++){const r=t[o];if(!r.is("$text")){s=!1;continue}let a,l=!1;if(pb(r,this.preElements))a=ml(r.data);else{a=r.data.replace(/[ \n\t\r]{1,}/g," "),l=/[^\S\u00A0]/.test(a.charAt(a.length-1));const c=o>0?t[o-1]:null,d=o+1<t.length?t[o+1]:null,u=!c||c.is("element")&&c.name=="br"||s,h=d?!1:!Re(r.data);n.withChildren!==!1&&(u&&(a=a.replace(/^ /,"")),h&&(a=a.replace(/ $/,""))),a=ml(a),a=a.replace(/ \u00A0/g,"  ");const m=d&&d.is("element")&&d.name!="br",f=d&&d.is("$text")&&d.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(a)||!d||m||f)&&(a=a.replace(/\u00A0$/," ")),(u||c&&c.is("element")&&c.name!="br")&&(a=a.replace(/^\u00A0/," "))}a.length==0&&r.parent?(r._remove(),t.splice(o,1),o--):(r._data=a,s=l)}t.length=0}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some(n=>this.preElements.includes(n.name)))return t;if(t.charAt(0)==" "){const n=this._getTouchingInlineViewNode(e,!1);(n&&n.is("$textProxy")&&this._nodeEndsWithSpace(n)||!n)&&(t=" "+t.substr(1))}if(t.charAt(t.length-1)==" "){const n=this._getTouchingInlineViewNode(e,!0),s=n&&n.is("$textProxy")&&n.data.charAt(0)==" ";(t.charAt(t.length-2)==" "||!n||s)&&(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some(n=>this.preElements.includes(n.name)))return!1;const t=this._processDataFromViewText(e);return t.charAt(t.length-1)==" "}_getTouchingInlineViewNode(e,t){const n=new Yt({startPosition:t?A._createAfter(e):A._createBefore(e),direction:t?"forward":"backward"});for(const s of n){if(s.item.is("element","br"))return null;if(this._isInlineObjectElement(s.item))return s.item;if(s.item.is("containerElement"))return null;if(s.item.is("$textProxy"))return s.item}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,t){if(ri(e))return new Ks(this.document,"$comment");const n=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Ye(this.document,n)}_isViewElementWithRawContent(e,t){return t.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const n=this._domDocument.createElement("span");if(n.setAttribute(pl,e),t){for(;t.firstChild;)n.appendChild(t.firstChild);for(const s of t.getAttributeNames())n.setAttribute(s,t.getAttribute(s))}return n}}function pb(i,e){return i.getAncestors().some(t=>t.is("element")&&e.includes(t.name))}function bl(i,e){let t=i;for(;t;)e(t),t=t.parentElement}function bb(i,e){return i.isEqualNode(fb)&&Yu(i,e)&&i.parentNode.childNodes.length===1}function Yu(i,e){const t=i.parentNode;return!!t&&!!t.tagName&&e.includes(t.tagName.toLowerCase())}function wl(i){i==="script"&&K("domconverter-unsafe-script-element-detected"),i==="style"&&K("domconverter-unsafe-style-element-detected")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lt extends rt(){constructor(e){super(),this._isEnabled=!1,this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Nn{constructor(e,t,n){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,Yd(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ln extends lt{constructor(){super(...arguments),this.useCapture=!1}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(n=>{this.listenTo(e,n,(s,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture})})}stopObserving(e){this.stopListening(e)}fire(e,t,n){this.isEnabled&&this.document.fire(e,new Nn(this.view,t,n))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wb extends ln{constructor(){super(...arguments),this.domEventType=["keydown","keyup"]}onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return Bn(this)}};this.fire(e.type,e,t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _b extends lt{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=Vt(t=>{this.document.fire("selectionChangeDone",t)},200)}observe(){const e=this.document;e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&n.preventDefault()},{context:"$capture"}),e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(n.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,n=new Ot(t.getRanges(),{backward:t.isBackward,fake:!1});(e==O.arrowleft||e==O.arrowup)&&n.setTo(n.getFirstPosition()),(e==O.arrowright||e==O.arrowdown)&&n.setTo(n.getLastPosition());const s={oldSelection:t,newSelection:n,domSelection:null};this.document.fire("selectionChange",s),this._fireSelectionChangeDoneDebounced(s)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xu extends lt{constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const t=this.domConverter,n=new Set,s=new Set;for(const r of e){const a=t.mapDomToView(r.target);a&&(a.is("uiElement")||a.is("rawElement")||r.type==="childList"&&!this._isBogusBrMutation(r)&&s.add(a))}for(const r of e){const a=t.mapDomToView(r.target);if(!(a&&(a.is("uiElement")||a.is("rawElement")))&&r.type==="characterData"){const l=t.findCorrespondingViewText(r.target);l&&!s.has(l.parent)?n.add(l):!l&&Re(r.target)&&s.add(t.mapDomToView(r.target.parentNode))}}let o=!1;for(const r of n)o=!0,this.renderer.markToSync("text",r);for(const r of s){const a=t.mapViewToDom(r),l=Array.from(r.getChildren()),c=Array.from(t.domChildrenToView(a,{withChildren:!1}));qf(l,c,vb)||(o=!0,this.renderer.markToSync("children",r))}o&&this.view.forceRender()}_isBogusBrMutation(e){let t=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}function vb(i,e){if(!Array.isArray(i))return i===e?!0:i.is("$text")&&e.is("$text")?i.data===e.data:!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ss extends ln{constructor(e){super(e),this._isFocusChanging=!1,this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",()=>{this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this.flush(),e.change(()=>{})},50)}),t.on("blur",(n,s)=>{const o=t.selection.editableElement;(o===null||o===s.target)&&(t.isFocused=!1,this._isFocusChanging=!1,e.change(()=>{}))})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yb extends lt{constructor(e){super(e),this.mutationObserver=e.getObserver(Xu),this.focusObserver=e.getObserver(Ss),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Vt(t=>{this.document.fire("selectionChangeDone",t)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Vt(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,n=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},s=()=>{this.document.isSelecting&&(this._handleSelectionChange(null,t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",n,{priority:"highest"}),this.listenTo(e,"keydown",s,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",s,{priority:"highest",useCapture:!0}),!this._documents.has(t)&&(this.listenTo(t,"mouseup",s,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",(o,r)=>{this.document.isComposing&&!V.isAndroid||(this._handleSelectionChange(r,t),this._documentIsSelectingInactivityTimeoutDebounced())}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e,t){if(!this.isEnabled)return;const n=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(n.anchorNode))return;this.mutationObserver.flush();const s=this.domConverter.domSelectionToView(n);if(s.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(s)&&this.domConverter.isDomSelectionCorrect(n))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(s))this.view.forceRender();else{const o={oldSelection:this.selection,newSelection:s,domSelection:n};this.document.fire("selectionChange",o),this._fireSelectionChangeDoneDebounced(o)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Cb extends ln{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0},{priority:"low"}),t.on("compositionend",()=>{t.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zu{constructor(e,t={}){this._files=t.cacheFiles?_l(e):null,this._native=e}get files(){return this._files||(this._files=_l(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,n){this._native.setDragImage(e,t,n)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function _l(i){const e=Array.from(i.files||[]),t=Array.from(i.items||[]);return e.length?e:t.filter(n=>n.kind==="file").map(n=>n.getAsFile())}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kb extends ln{constructor(){super(...arguments),this.domEventType="beforeinput"}onDomEvent(e){const t=e.getTargetRanges(),n=this.view,s=n.document;let o=null,r=null,a=[];if(e.dataTransfer&&(o=new Zu(e.dataTransfer)),e.data!==null?r=e.data:o&&(r=o.getData("text/plain")),s.selection.isFake)a=Array.from(s.selection.getRanges());else if(t.length)a=t.map(l=>{const c=n.domConverter.domPositionToView(l.startContainer,l.startOffset),d=n.domConverter.domPositionToView(l.endContainer,l.endOffset);if(c)return n.createRange(c,d);if(d)return n.createRange(d)}).filter(l=>!!l);else if(V.isAndroid){const l=e.target.ownerDocument.defaultView.getSelection();a=Array.from(n.domConverter.domSelectionToView(l).getRanges())}if(V.isAndroid&&e.inputType=="insertCompositionText"&&r&&r.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[n.createRange(a[0].end)]});return}if(e.inputType=="insertText"&&r&&r.includes(`
`)){const l=r.split(/\n{1,2}/g);let c=a;for(let d=0;d<l.length;d++){const u=l[d];u!=""&&(this.fire(e.type,e,{data:u,dataTransfer:o,targetRanges:c,inputType:e.inputType,isComposing:e.isComposing}),c=[s.selection.getFirstRange()]),d+1<l.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:c}),c=[s.selection.getFirstRange()])}return}this.fire(e.type,e,{data:r,dataTransfer:o,targetRanges:a,inputType:e.inputType,isComposing:e.isComposing})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ab extends lt{constructor(e){super(e),this.document.on("keydown",(t,n)=>{if(this.isEnabled&&Ug(n.keyCode)){const s=new Hn(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(s,n),s.stop.called&&t.stop()}})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Eb extends lt{constructor(e){super(e);const t=this.document;t.on("keydown",(n,s)=>{if(!this.isEnabled||s.keyCode!=O.tab||s.ctrlKey)return;const o=new Hn(t,"tab",t.selection.getFirstRange());t.fire(o,s),o.stop.called&&n.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Tb extends $(){constructor(e){super(),this.domRoots=new Map,this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this.document=new Gs(e),this.domConverter=new Js(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new ob(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new Qr(this.document),this.addObserver(Xu),this.addObserver(Ss),this.addObserver(yb),this.addObserver(wb),this.addObserver(_b),this.addObserver(Cb),this.addObserver(Ab),this.addObserver(kb),this.addObserver(Eb),ib(this),Jp(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),V.isiOS&&this.listenTo(this.document,"blur",(t,n)=>{this.domConverter.mapDomToView(n.domEvent.relatedTarget)||this.domConverter._clearDomSelection()})}attachDomRoot(e,t="main"){const n=this.document.getRoot(t);n._name=e.tagName.toLowerCase();const s={};for(const{name:r,value:a}of Array.from(e.attributes))s[r]=a,r==="class"?this._writer.addClass(a.split(" "),n):this._writer.setAttribute(r,a,n);this._initialDomRootAttributes.set(e,s);const o=()=>{this._writer.setAttribute("contenteditable",(!n.isReadOnly).toString(),n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",(r,a)=>this._renderer.markToSync("children",a)),n.on("change:attributes",(r,a)=>this._renderer.markToSync("attributes",a)),n.on("change:text",(r,a)=>this._renderer.markToSync("text",a)),n.on("change:isReadOnly",()=>this.change(o)),n.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const r of this._observers.values())r.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:s})=>t.removeAttribute(s));const n=this._initialDomRootAttributes.get(t);for(const s in n)t.setAttribute(s,n[s]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const s of this._observers.values())s.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[n,s]of this.domRoots)t.observe(s,n);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:n=20,ancestorOffset:s=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const r=Ct({alignToTop:e,forceScroll:t,viewportOffset:n,ancestorOffset:s});typeof n=="number"&&(n={top:n,bottom:n,left:n,right:n});const a={target:this.domConverter.viewRangeToDom(o),viewportOffset:n,ancestorOffset:s,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",a,r),Fg(a)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new g("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(Ss).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return A._createAt(e,t)}createPositionAfter(e){return A._createAfter(e)}createPositionBefore(e){return A._createBefore(e)}createRange(e,t){return new M(e,t)}createRangeOn(e){return M._createOn(e)}createRangeIn(e){return M._createIn(e)}createSelection(...e){return new Ot(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Dt{is(){throw new Error("is() method is abstract")}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let cn=class extends Dt{constructor(e){super(),this.parent=null,this._attrs=Mt(e)}get document(){return null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new g("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new g("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Ce(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((t,n)=>(t[n[0]]=n[1],t),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Mt(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};cn.prototype.is=function(i){return i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ai{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((e,t)=>e+t.offsetSize,0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return t==-1?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return t===null?null:this._nodes.slice(0,t).reduce((n,s)=>n+s.offsetSize,0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new g("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const n of this._nodes){if(e>=t&&e<t+n.offsetSize)return this.getNodeIndex(n);t+=n.offsetSize}if(t!=e)throw new g("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const n of t)if(!(n instanceof cn))throw new g("model-nodelist-insertnodes-not-node",this);this._nodes=ip(this._nodes,Array.from(t),e,0)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map(e=>e.toJSON())}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class j extends cn{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new j(this.data,this.getAttributes())}static fromJSON(e){return new j(e.data,e.attributes)}}j.prototype.is=function(i){return i==="$text"||i==="model:$text"||i==="text"||i==="model:text"||i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qe extends Dt{constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new g("model-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.offsetSize)throw new g("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Qe.prototype.is=function(i){return i==="$textProxy"||i==="model:$textProxy"||i==="textProxy"||i==="model:textProxy"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class U extends cn{constructor(e,t,n){super(t),this._children=new ai,this.name=e,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}findAncestor(e,t={}){let n=t.includeSelf?this:this.parent;for(;n;){if(n.name===e)return n;n=n.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map(n=>n._clone(!0)):void 0;return new U(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=Sb(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}static fromJSON(e){let t;if(e.children){t=[];for(const n of e.children)n.name?t.push(U.fromJSON(n)):t.push(j.fromJSON(n))}return new U(e.name,e.attributes,t)}}U.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="model:element"):i==="element"||i==="model:element"||i==="node"||i==="model:node"};function Sb(i){return typeof i=="string"?[new j(i)]:(Me(i)||(i=[i]),Array.from(i).map(e=>typeof e=="string"?new j(e):e instanceof Qe?new j(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class It{constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new g("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if(t!="forward"&&t!="backward")throw new g("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=y._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n,s,o;do s=this.position,o=this._visitedParent,{done:t,value:n}=this.next();while(!t&&e(n));t||(this._position=s,this._visitedParent=o)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===n.maxOffset)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const s=li(t,n),o=s||eh(t,n,s);if(o instanceof U){if(!this.shallow)t.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,Ut("elementStart",o,e,t,1)}if(o instanceof j){let r;if(this.singleCharacters)r=1;else{let c=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<c&&(c=this.boundaries.end.offset),r=c-t.offset}const a=t.offset-o.startOffset,l=new Qe(o,a,r);return t.offset+=r,this._position=t,Ut("text",l,e,t,r)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():Ut("elementEnd",n,e,t)}_previous(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const s=t.parent,o=li(t,s),r=o||th(t,s,o);if(r instanceof U)return t.offset--,this.shallow?(this._position=t,Ut("elementStart",r,e,t,1)):(t.path.push(r.maxOffset),this._position=t,this._visitedParent=r,this.ignoreElementEnd?this._previous():Ut("elementEnd",r,e,t));if(r instanceof j){let a;if(this.singleCharacters)a=1;else{let d=r.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>d&&(d=this.boundaries.start.offset),a=t.offset-d}const l=t.offset-r.startOffset,c=new Qe(r,l-a,a);return t.offset-=a,this._position=t,Ut("text",c,e,t,a)}return t.path.pop(),this._position=t,this._visitedParent=n.parent,Ut("elementStart",n,e,t,1)}}function Ut(i,e,t,n,s){return{done:!1,value:{type:i,item:e,previousPosition:t,nextPosition:n,length:s}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class y extends Dt{constructor(e,t,n="toNone"){if(super(),!e.is("element")&&!e.is("documentFragment"))throw new g("model-position-root-invalid",e);if(!(t instanceof Array)||t.length===0)throw new g("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new g("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new g("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return li(this,this.parent)}get nodeAfter(){const e=this.parent;return eh(this,e,li(this,e))}get nodeBefore(){const e=this.parent;return th(this,e,li(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=Ce(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new It(t);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=Ce(this.path,e.path),n=typeof t=="string"?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,n)}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}getShiftedBy(e){const t=this.clone(),n=t.offset+e;return t.offset=n<0?0:n,t}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const t=Math.min(this.path.length,e.path.length);for(let n=0;n<t;n++){const s=this.path[n]-e.path[n];if(s<-1||s>1)return!1;if(s===1)return vl(e,this,n);if(s===-1)return vl(this,e,n)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?sr(this.path,t):sr(e.path,t)}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),n=e.getParentPath();return Ce(t,n)=="same"}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=y._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,n=t.containsPosition(this)||t.start.isEqual(this);let s;return n?(s=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(s=s._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?s=y._createAt(e.deletionPosition):s=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),s}_getTransformedByDeletion(e,t){const n=y._createAt(this);if(this.root!=e.root)return n;if(Ce(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;n.offset-=t}}else if(Ce(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;if(e.offset<=this.path[s]){if(e.offset+t>this.path[s])return null;n.path[s]-=t}}return n}_getTransformedByInsertion(e,t){const n=y._createAt(this);if(this.root!=e.root)return n;if(Ce(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(n.offset+=t);else if(Ce(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;e.offset<=this.path[s]&&(n.path[s]+=t)}return n}_getTransformedByMove(e,t,n){if(t=t._getTransformedByDeletion(e,n),e.isEqual(t))return y._createAt(this);const s=this._getTransformedByDeletion(e,n);return s===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(n).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,t):s._getTransformedByInsertion(t,n)}_getCombined(e,t){const n=e.path.length-1,s=y._createAt(t);return s.stickiness=this.stickiness,s.offset=s.offset+this.path[n]-e.offset,s.path=[...s.path,...this.path.slice(n+1)],s}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,n="toNone"){if(e instanceof y)return new y(e.root,e.path,e.stickiness);{const s=e;if(t=="end")t=s.maxOffset;else{if(t=="before")return this._createBefore(s,n);if(t=="after")return this._createAfter(s,n);if(t!==0&&!t)throw new g("model-createpositionat-offset-required",[this,e])}if(!s.is("element")&&!s.is("documentFragment"))throw new g("model-position-parent-incorrect",[this,e]);const o=s.getPath();return o.push(t),new this(s.root,o,n)}}static _createAfter(e,t){if(!e.parent)throw new g("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new g("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if(e.root==="$graveyard"){const n=new y(t.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!t.getRoot(e.root))throw new g("model-position-fromjson-no-root",t,{rootName:e.root});return new y(t.getRoot(e.root),e.path,e.stickiness)}}y.prototype.is=function(i){return i==="position"||i==="model:position"};function li(i,e){const t=e.getChild(e.offsetToIndex(i.offset));return t&&t.is("$text")&&t.startOffset<i.offset?t:null}function eh(i,e,t){return t!==null?null:e.getChild(e.offsetToIndex(i.offset))}function th(i,e,t){return t!==null?null:e.getChild(e.offsetToIndex(i.offset)-1)}function vl(i,e,t){return!(t+1===i.path.length||!sr(e.path,t+1)||!xb(i,t+1))}function sr(i,e){for(;e<i.length;){if(i[e]!==0)return!1;e++}return!0}function xb(i,e){let t=i.parent,n=i.path.length-1,s=0;for(;n>=e;){if(i.path[n]+s!==t.maxOffset)return!1;s=1,n--,t=t.parent}return!0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _ extends Dt{constructor(e,t){super(),this.start=y._createAt(e),this.end=t?y._createAt(t):y._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new It({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return Ce(e,t)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}containsItem(e){const t=y._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new _(this.start,e.start)),this.containsPosition(e.end)&&t.push(new _(e.end,this.end))):t.push(new _(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new _(t,n)}return null}getJoined(e,t=!1){let n=this.isIntersecting(e);if(n||(this.start.isBefore(e.start)?n=t?this.end.isTouching(e.start):this.end.isEqual(e.start):n=t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!n)return null;let s=this.start,o=this.end;return e.start.isBefore(s)&&(s=e.start),e.end.isAfter(o)&&(o=e.end),new _(s,o)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,n=y._createAt(this.start);let s=n.parent;for(;n.path.length>t+1;){const o=s.maxOffset-n.offset;o!==0&&e.push(new _(n,n.getShiftedBy(o))),n.path=n.path.slice(0,-1),n.offset++,s=s.parent}for(;n.path.length<=this.end.path.length;){const o=this.end.path[n.path.length-1],r=o-n.offset;r!==0&&e.push(new _(n,n.getShiftedBy(r))),n.offset=o,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new It(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new It(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new It(e);yield t.position;for(const n of t)yield n.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new _(this.start,this.end)]}getTransformedByOperations(e){const t=[new _(this.start,this.end)];for(const n of e)for(let s=0;s<t.length;s++){const o=t[s].getTransformedByOperation(n);t.splice(s,1,...o),s+=o.length-1}for(let n=0;n<t.length;n++){const s=t[n];for(let o=n+1;o<t.length;o++){const r=t[o];(s.containsRange(r)||r.containsRange(s)||s.isEqual(r))&&t.splice(o,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const n=e.sourcePosition,s=e.howMany,o=e.targetPosition;return this._getTransformedByMove(n,o,s,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),t.root!=n.root&&(n=this.end.getShiftedBy(-1)),new _(t,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new _(this.start);let t=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return t.root!=n.root&&(n=this.end.getShiftedBy(-1)),t.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(t=y._createAt(n),t.offset=0):(e.deletionPosition.isEqual(t)||(n=e.deletionPosition),t=e.targetPosition),new _(t,n)):new _(t,n)}_getTransformedByInsertion(e,t,n=!1){if(n&&this.containsPosition(e))return[new _(this.start,e),new _(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const s=new _(this.start,this.end);return s.start=s.start._getTransformedByInsertion(e,t),s.end=s.end._getTransformedByInsertion(e,t),[s]}}_getTransformedByMove(e,t,n,s=!1){if(this.isCollapsed){const u=this.start._getTransformedByMove(e,t,n);return[new _(u)]}const o=_._createFromPositionAndShift(e,n),r=t._getTransformedByDeletion(e,n);if(this.containsPosition(t)&&!s&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const u=this.start._getTransformedByMove(e,t,n),h=this.end._getTransformedByMove(e,t,n);return[new _(u,h)]}let a;const l=this.getDifference(o);let c=null;const d=this.getIntersection(o);if(l.length==1?c=new _(l[0].start._getTransformedByDeletion(e,n),l[0].end._getTransformedByDeletion(e,n)):l.length==2&&(c=new _(this.start,this.end._getTransformedByDeletion(e,n))),c?a=c._getTransformedByInsertion(r,n,d!==null||s):a=[],d){const u=new _(d.start._getCombined(o.start,r),d.end._getCombined(o.start,r));a.length==2?a.splice(1,0,u):a.push(u)}return a}_getTransformedByDeletion(e,t){let n=this.start._getTransformedByDeletion(e,t),s=this.end._getTransformedByDeletion(e,t);return n==null&&s==null?null:(n==null&&(n=e),s==null&&(s=e),new _(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return new this(y._createAt(e,0),y._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(y._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new g("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const t=e[0];e.sort((o,r)=>o.start.isAfter(r.start)?1:-1);const n=e.indexOf(t),s=new this(t.start,t.end);if(n>0)for(let o=n-1;e[o].end.isEqual(s.start);o++)s.start=y._createAt(e[o].start);for(let o=n+1;o<e.length&&e[o].start.isEqual(s.end);o++)s.end=y._createAt(e[o].end);return s}static fromJSON(e,t){return new this(y.fromJSON(e.start,t),y.fromJSON(e.end,t))}}_.prototype.is=function(i){return i==="range"||i==="model:range"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nh extends J(){constructor(){super(),this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._deferredBindingRemovals=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const n=this._modelToViewMapping.get(t.modelPosition.parent);if(!n)throw new g("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(n,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const n=this.findMappedViewAncestor(t.viewPosition),s=this._viewToModelMapping.get(n),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,n);t.modelPosition=y._createAt(s,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const n=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const s of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(s);t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(n)==e&&this._modelToViewMapping.delete(n))}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const n=this._markerNameToElements.get(t)||new Set;n.add(e);const s=this._elementToMarkerNames.get(e)||new Set;s.add(t),this._markerNameToElements.set(t,n),this._elementToMarkerNames.set(e,s)}unbindElementFromMarkerName(e,t){const n=this._markerNameToElements.get(t);n&&(n.delete(e),n.size==0&&this._markerNameToElements.delete(t));const s=this._elementToMarkerNames.get(e);s&&(s.delete(t),s.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new _(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new M(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const n={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const n=new Set;for(const s of t)if(s.is("attributeElement"))for(const o of s.getElementsWithSameId())n.add(o);else n.add(s);return n}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,n){if(n!=e){const o=this._toModelOffset(e.parent,e.index,n),r=this._toModelOffset(e,t,e);return o+r}if(e.is("$text"))return t;let s=0;for(let o=0;o<t;o++)s+=this.getModelLength(e.getChild(o));return s}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const n of e.getChildren())t+=this.getModelLength(n);return t}}findPositionIn(e,t){let n,s=0,o=0,r=0;if(e.is("$text"))return new A(e,t);for(;o<t;)n=e.getChild(r),s=this.getModelLength(n),o+=s,r++;return o==t?this._moveViewPositionToTextNode(new A(e,r)):this.findPositionIn(n,t-(o-s))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,n=e.nodeAfter;return t instanceof X?new A(t,t.data.length):n instanceof X?new A(n,0):e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Pb{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=Ji(t),e instanceof Qe&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=Ji(t),e instanceof Qe&&(e=this._getSymbolForTextProxy(e)),this.test(e,t)?(this._consumable.get(e).set(t,!1),!0):!1}test(e,t){t=Ji(t),e instanceof Qe&&(e=this._getSymbolForTextProxy(e));const n=this._consumable.get(e);if(n===void 0)return null;const s=n.get(t);return s===void 0?null:s}revert(e,t){t=Ji(t),e instanceof Qe&&(e=this._getSymbolForTextProxy(e));const n=this.test(e,t);return n===!1?(this._consumable.get(e).set(t,!0),!0):n===!0?!1:null}verifyAllConsumed(e){const t=[];for(const[n,s]of this._consumable)for(const[o,r]of s){const a=o.split(":")[0];r&&e==a&&t.push({event:o,item:n.name||n.description})}if(t.length)throw new g("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const n=this._textProxyRegistry.get(e.startOffset);if(n){const s=n.get(e.endOffset);s&&(t=s.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,n=e.endOffset,s=e.parent,o=Symbol("$textProxy:"+e.data);let r,a;return r=this._textProxyRegistry.get(t),r||(r=new Map,this._textProxyRegistry.set(t,r)),a=r.get(n),a||(a=new Map,r.set(n,a)),a.set(s,o),o}}function Ji(i){const e=i.split(":");return e[0]=="insert"?e[0]:e[0]=="addMarker"||e[0]=="removeMarker"?i:e.length>1?e[0]+":"+e[1]:e[0]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ih extends J(){constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,n){const s=this._createConversionApi(n,e.getRefreshedItems());for(const r of e.getMarkersToRemove())this._convertMarkerRemove(r.name,r.range,s);const o=this._reduceChanges(e.getChanges());for(const r of o)r.type==="insert"?this._convertInsert(_._createFromPositionAndShift(r.position,r.length),s):r.type==="reinsert"?this._convertReinsert(_._createFromPositionAndShift(r.position,r.length),s):r.type==="remove"?this._convertRemove(r.position,r.length,r.name,s):this._convertAttribute(r.range,r.attributeKey,r.attributeOldValue,r.attributeNewValue,s);for(const r of s.mapper.flushUnboundMarkerNames()){const a=t.get(r).getRange();this._convertMarkerRemove(r,a,s),this._convertMarkerAdd(r,a,s)}for(const r of e.getMarkersToAdd())this._convertMarkerAdd(r.name,r.range,s);s.mapper.flushDeferredBindings(),s.consumable.verifyAllConsumed("insert")}convert(e,t,n,s={}){const o=this._createConversionApi(n,void 0,s);this._convertInsert(e,o);for(const[r,a]of t)this._convertMarkerAdd(r,a,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,t,n){const s=this._createConversionApi(n);this.fire("cleanSelection",{selection:e},s);const o=e.getFirstPosition().root;if(!s.mapper.toViewElement(o))return;const r=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(s.consumable,e,r),this.fire("selection",{selection:e},s),!!e.isCollapsed){for(const a of r)if(s.consumable.test(e,"addMarker:"+a.name)){const l=a.getRange();if(!Ib(e.getFirstPosition(),a,s.mapper))continue;const c={item:e,markerName:a.name,markerRange:l};this.fire(`addMarker:${a.name}`,c,s)}for(const a of e.getAttributeKeys())if(s.consumable.test(e,"attribute:"+a)){const l={item:e,range:e.getFirstRange(),attributeKey:a,attributeOldValue:null,attributeNewValue:e.getAttribute(a)};this.fire(`attribute:${a}:$text`,l,s)}}}_convertInsert(e,t,n={}){n.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,Array.from(e));for(const s of Array.from(e.getWalker({shallow:!0})).map(yl))this._testAndFire("insert",s,t)}_convertRemove(e,t,n,s){this.fire(`remove:${n}`,{position:e,length:t},s)}_convertAttribute(e,t,n,s,o){this._addConsumablesForRange(o.consumable,e,`attribute:${t}`);for(const r of e){const a={item:r.item,range:_._createFromPositionAndShift(r.previousPosition,r.length),attributeKey:t,attributeOldValue:n,attributeNewValue:s};this._testAndFire(`attribute:${t}`,a,o)}}_convertReinsert(e,t){const n=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,n);for(const s of n.map(yl))this._testAndFire("insert",{...s,reconversion:!0},t)}_convertMarkerAdd(e,t,n){if(t.root.rootName=="$graveyard")return;const s=`addMarker:${e}`;if(n.consumable.add(t,s),this.fire(s,{markerName:e,markerRange:t},n),!!n.consumable.consume(t,s)){this._addConsumablesForRange(n.consumable,t,s);for(const o of t.getItems()){if(!n.consumable.test(o,s))continue;const r={item:o,range:_._createOn(o),markerName:e,markerRange:t};this.fire(s,r,n)}}}_convertMarkerRemove(e,t,n){t.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},n)}_reduceChanges(e){const t={changes:e};return this.fire("reduceChanges",t),t.changes}_addConsumablesForInsert(e,t){for(const n of t){const s=n.item;if(e.test(s,"insert")===null){e.add(s,"insert");for(const o of s.getAttributeKeys())e.add(s,"attribute:"+o)}}return e}_addConsumablesForRange(e,t,n){for(const s of t.getItems())e.add(s,n);return e}_addConsumablesForSelection(e,t,n){e.add(t,"selection");for(const s of n)e.add(t,"addMarker:"+s.name);for(const s of t.getAttributeKeys())e.add(t,"attribute:"+s);return e}_testAndFire(e,t,n){const s=Rb(e,t),o=t.item.is("$textProxy")?n.consumable._getSymbolForTextProxy(t.item):t.item,r=this._firedEventsMap.get(n),a=r.get(o);if(!a)r.set(o,new Set([s]));else if(!a.has(s))a.add(s);else return;this.fire(s,t,n)}_testAndFireAddAttributes(e,t){const n={item:e,range:_._createOn(e)};for(const s of n.item.getAttributeKeys())n.attributeKey=s,n.attributeOldValue=null,n.attributeNewValue=n.item.getAttribute(s),this._testAndFire(`attribute:${s}`,n,t)}_createConversionApi(e,t=new Set,n={}){const s={...this._conversionApi,consumable:new Pb,writer:e,options:n,convertItem:o=>this._convertInsert(_._createOn(o),s),convertChildren:o=>this._convertInsert(_._createIn(o),s,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,s),canReuseView:o=>!t.has(s.mapper.toModelElement(o))};return this._firedEventsMap.set(s,new Map),s}}function Ib(i,e,t){const n=e.getRange(),s=Array.from(i.getAncestors());return s.shift(),s.reverse(),!s.some(r=>{if(n.containsItem(r))return!!t.toViewElement(r).getCustomProperty("addHighlight")})}function Rb(i,e){const t=e.item.is("element")?e.item.name:"$text";return`${i}:${t}`}function yl(i){const e=i.item,t=_._createFromPositionAndShift(i.previousPosition,i.length);return{item:e,range:t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ve extends J(Dt){constructor(...e){super(),this._lastRangeBackward=!1,this._attrs=new Map,this._ranges=[],e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new _(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?new _(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?new _(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]);else if(t instanceof Ve)this._setRanges(t.getRanges(),t.isBackward);else if(t&&typeof t.getRanges=="function")this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof _)this._setRanges([t],!!s&&!!s.backward);else if(t instanceof y)this._setRanges([new _(t)]);else if(t instanceof cn){const o=!!s&&!!s.backward;let r;if(n=="in")r=_._createIn(t);else if(n=="on")r=_._createOn(t);else if(n!==void 0)r=new _(y._createAt(t,n));else throw new g("model-selection-setto-required-second-parameter",[this,t]);this._setRanges([r],o)}else if(Me(t))this._setRanges(t,s&&!!s.backward);else throw new g("model-selection-setto-not-selectable",[this,t])}_setRanges(e,t=!1){const n=Array.from(e),s=n.some(o=>{if(!(o instanceof _))throw new g("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(r=>!r.isEqual(o))});n.length===this._ranges.length&&!s||(this._replaceAllRanges(n),this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0}))}setFocus(e,t){if(this.anchor===null)throw new g("model-selection-setfocus-no-ranges",[this,e]);const n=y._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.length&&this._popRange(),n.compareWith(s)=="before"?(this._pushRange(new _(n,s)),this._lastRangeBackward=!0):(this._pushRange(new _(s,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const n=Cl(t.start,e);Bb(n,t)&&(yield n);for(const o of t.getWalker()){const r=o.item;o.type=="elementEnd"&&Vb(r,e,t)&&(yield r)}const s=Cl(t.end,e);Mb(s,t)&&(yield s)}}containsEntireContent(e=this.anchor.root){const t=y._createAt(e,0),n=y._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new _(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new g("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_replaceAllRanges(e){this._removeAllRanges();for(const t of e)this._pushRange(t)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}Ve.prototype.is=function(i){return i==="selection"||i==="model:selection"};function sh(i,e){return e.has(i)?!1:(e.add(i),i.root.document.model.schema.isBlock(i)&&!!i.parent)}function Vb(i,e,t){return sh(i,e)&&Yr(i,t)}function Cl(i,e){const n=i.parent.root.document.model.schema,s=i.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const r=s.find(a=>o?!1:(o=n.isLimit(a),!o&&sh(a,e)));return s.forEach(a=>e.add(a)),r}function Yr(i,e){const t=Ob(i);return t?!e.containsRange(_._createOn(t),!0):!0}function Bb(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.start.isTouching(y._createAt(i,i.maxOffset))?!1:Yr(i,e):!1}function Mb(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.end.isTouching(y._createAt(i,0))?!1:Yr(i,e):!1}function Ob(i){const e=i.root.document.model.schema;let t=i.parent;for(;t;){if(e.isBlock(t))return t;t=t.parent}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $e extends J(_){constructor(e,t){super(e,t),Nb.call(this)}detach(){this.stopListening()}toRange(){return new _(this.start,this.end)}static fromRange(e){return new $e(e.start,e.end)}}$e.prototype.is=function(i){return i==="liveRange"||i==="model:liveRange"||i=="range"||i==="model:range"};function Nb(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&Fb.call(this,t)},{priority:"low"})}function Fb(i){const e=this.getTransformedByOperation(i),t=_._createFromRanges(e),n=!t.isEqual(this),s=Lb(this,i);let o=null;if(n){t.root.rootName=="$graveyard"&&(i.type=="remove"?o=i.sourcePosition:o=i.deletionPosition);const r=this.toRange();this.start=t.start,this.end=t.end,this.fire("change:range",r,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function Lb(i,e){switch(e.type){case"insert":return i.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return i.containsPosition(e.sourcePosition)||i.start.isEqual(e.sourcePosition)||i.containsPosition(e.targetPosition);case"split":return i.containsPosition(e.splitPosition)||i.containsPosition(e.insertionPosition)}return!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const _i="selection:";class Xe extends J(Dt){constructor(e){super(),this._selection=new Db(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return _i+e}static _isStoreAttributeKey(e){return e.startsWith(_i)}}Xe.prototype.is=function(i){return i==="selection"||i=="model:selection"||i=="documentSelection"||i=="model:documentSelection"};class Db extends Ve{constructor(e){super(),this.markers=new ge({idProperty:"name"}),this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(t,n)=>{const s=n[0];!s.isDocumentOperation||s.type=="marker"||s.type=="rename"||s.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(t,n,s,o)=>{this._updateMarker(n,o)}),this.listenTo(this._document,"change",(t,n)=>{zb(this._model,n)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const n=[e];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=Se();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new g("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new g("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=$e.fromRange(e);return t.on("change:range",(n,s,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const r=this._ranges.indexOf(t);this._ranges.splice(r,1),t.detach()}}),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const s of this._model.markers){const o=s.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const r=s.getRange();for(const a of this.getRanges())r.containsRange(a,!a.isCollapsed)&&e.push(s)}const n=Array.from(this.markers);for(const s of e)this.markers.has(s)||(this.markers.add(s),t=!0);for(const s of Array.from(this.markers))e.includes(s)||(this.markers.remove(s),t=!0);t&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateMarker(e,t){const n=e.name.split(":",1)[0];if(!this._observedMarkers.has(n))return;let s=!1;const o=Array.from(this.markers),r=this.markers.has(e);if(!t)r&&(this.markers.remove(e),s=!0);else{let a=!1;for(const l of this.getRanges())if(t.containsRange(l,!l.isCollapsed)){a=!0;break}a&&!r?(this.markers.add(e),s=!0):!a&&r&&(this.markers.remove(e),s=!0)}s&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=Mt(this._getSurroundingAttributes()),n=Mt(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,r]of this._attributePriority)r=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const s=[];for(const[o,r]of this.getAttributes())(!n.has(o)||n.get(o)!==r)&&s.push(o);for(const[o]of n)this.hasAttribute(o)||s.push(o);s.length>0&&this.fire("change:attribute",{attributeKeys:s,directChange:!1})}_setAttribute(e,t,n=!0){const s=n?"normal":"low";return s=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===t?!1:(this._attrs.set(e,t),this._attributePriority.set(e,s),!0)}_removeAttribute(e,t=!0){const n=t?"normal":"low";return n=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,n),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const t=new Set;for(const[n,s]of this.getAttributes())e.get(n)!==s&&this._removeAttribute(n,!1);for(const[n,s]of e)this._setAttribute(n,s,!1)&&t.add(n);return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())t.startsWith(_i)&&(yield[t.substr(_i.length),e.getAttribute(t)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if(e.root.rootName=="$graveyard")return null;let n=null;if(this.isCollapsed){const s=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=Qn(s,t)),n||(n=Qn(o,t)),!this.isGravityOverridden&&!n){let r=s;for(;r&&!n;)r=r.previousSibling,n=Qn(r,t)}if(!n){let r=o;for(;r&&!n;)r=r.nextSibling,n=Qn(r,t)}n||(n=this.getStoredAttributes())}else{const s=this.getFirstRange();for(const o of s){if(o.item.is("element")&&t.isObject(o.item)){n=Qn(o.item,t);break}if(o.type=="text"){n=o.item.getAttributes();break}}}return n}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Qn(i,e){if(!i)return null;if(i instanceof Qe||i instanceof j)return i.getAttributes();if(!e.isInline(i))return null;if(!e.isObject(i))return[];const t=[];for(const[n,s]of i.getAttributes())e.checkAttribute("$text",n)&&e.getAttributeProperties(n).copyFromObject!==!1&&t.push([n,s]);return t}function zb(i,e){const t=i.document.differ;for(const n of t.getChanges()){if(n.type!="insert")continue;const s=n.position.parent;n.length===s.maxOffset&&i.enqueueChange(e,r=>{const a=Array.from(s.getAttributeKeys()).filter(l=>l.startsWith(_i));for(const l of a)r.removeAttribute(l,s)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oh{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hb extends oh{elementToElement(e){return this.add(ow(e))}elementToStructure(e){return this.add(rw(e))}attributeToElement(e){return this.add(aw(e))}attributeToAttribute(e){return this.add(lw(e))}markerToElement(e){return this.add(cw(e))}markerToHighlight(e){return this.add(uw(e))}markerToData(e){return this.add(dw(e))}}function rh(){return(i,e,t)=>{if(!t.consumable.consume(e.item,i.name))return;const n=t.writer,s=t.mapper.toViewPosition(e.range.start),o=n.createText(e.item.data);n.insert(s,o)}}function ah(){return(i,e,t)=>{t.convertAttributes(e.item),!e.reconversion&&e.item.is("element")&&!e.item.isEmpty&&t.convertChildren(e.item)}}function Wb(){return(i,e,t)=>{const n=t.mapper.toViewPosition(e.position),s=e.position.getShiftedBy(e.length),o=t.mapper.toViewPosition(s,{isPhantom:!0}),r=t.writer.createRange(n,o),a=t.writer.remove(r.getTrimmed());for(const l of t.writer.createRangeIn(a).getItems())t.mapper.unbindViewElement(l,{defer:!0})}}function lh(i,e){const t=i.createAttributeElement("span",e.attributes);return e.classes&&t._addClass(e.classes),typeof e.priority=="number"&&(t._priority=e.priority),t._id=e.id,t}function $b(){return(i,e,t)=>{const n=e.selection;if(n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=[];for(const o of n.getRanges())s.push(t.mapper.toViewRange(o));t.writer.setSelection(s,{backward:n.isBackward})}}function Ub(){return(i,e,t)=>{const n=e.selection;if(!n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=t.writer,o=n.getFirstPosition(),r=t.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a)}}function qb(){return(i,e,t)=>{const n=t.writer,s=n.document.selection;for(const o of s.getRanges())o.isCollapsed&&o.end.parent.isAttached()&&t.writer.mergeAttributes(o.start);n.setSelection(null)}}function jb(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const r=n.writer,a=r.document.selection;if(t.item instanceof Ve||t.item instanceof Xe)r.wrap(a.getFirstRange(),o);else{let l=n.mapper.toViewRange(t.range);t.attributeOldValue!==null&&s&&(l=r.unwrap(l,s)),t.attributeNewValue!==null&&o&&r.wrap(l,o)}}}function Gb(i,e=ww){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=i(n.item,s,n);if(!o)return;e(n.item,s.consumable);const r=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,o),s.writer.insert(r,o),s.convertAttributes(n.item),mh(o,n.item.getChildren(),s,{reconversion:n.reconversion})}}function Kb(i,e){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=new Map;s.writer._registerSlotFactory(fw(n.item,o,s));const r=i(n.item,s,n);if(s.writer._clearSlotFactory(),!r)return;gw(n.item,o,s),e(n.item,s.consumable);const a=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,r),s.writer.insert(a,r),s.convertAttributes(n.item),pw(r,o,s,{reconversion:n.reconversion})}}function Jb(i){return(e,t,n)=>{t.isOpening=!0;const s=i(t,n);t.isOpening=!1;const o=i(t,n);if(!s||!o)return;const r=t.markerRange;if(r.isCollapsed&&!n.consumable.consume(r,e.name))return;for(const c of r)if(!n.consumable.consume(c.item,e.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(r.start),s),n.mapper.bindElementToMarker(s,t.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),n.mapper.bindElementToMarker(o,t.markerName)),e.stop()}}function Qb(){return(i,e,t)=>{const n=t.mapper.markerNameToElements(e.markerName);if(n){for(const s of n)t.mapper.unbindElementFromMarkerName(s,e.markerName),t.writer.clear(t.writer.createRangeOn(s),s);t.writer.clearClonedElementsGroup(e.markerName),i.stop()}}}function Yb(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=t.markerRange;n.consumable.consume(o,e.name)&&(kl(o,!1,n,t,s),kl(o,!0,n,t,s),e.stop())}}function kl(i,e,t,n,s){const o=e?i.start:i.end,r=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(r||a){let c,d;e&&r||!e&&!a?(c=r,d=!0):(c=a,d=!1);const u=t.mapper.toViewElement(c);if(u){Xb(u,e,d,t,n,s);return}}const l=t.mapper.toViewPosition(o);Zb(l,e,t,n,s)}function Xb(i,e,t,n,s,o){const r=`data-${o.group}-${e?"start":"end"}-${t?"before":"after"}`,a=i.hasAttribute(r)?i.getAttribute(r).split(","):[];a.unshift(o.name),n.writer.setAttribute(r,a.join(","),i),n.mapper.bindElementToMarker(i,s.markerName)}function Zb(i,e,t,n,s){const o=`${s.group}-${e?"start":"end"}`,r=s.name?{name:s.name}:null,a=t.writer.createUIElement(o,r);t.writer.insert(i,a),t.mapper.bindElementToMarker(a,n.markerName)}function ew(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=n.mapper.markerNameToElements(t.markerName);if(!o)return;for(const a of o)n.mapper.unbindElementFromMarkerName(a,t.markerName),a.is("containerElement")?(r(`data-${s.group}-start-before`,a),r(`data-${s.group}-start-after`,a),r(`data-${s.group}-end-before`,a),r(`data-${s.group}-end-after`,a)):n.writer.clear(n.writer.createRangeOn(a),a);n.writer.clearClonedElementsGroup(t.markerName),e.stop();function r(a,l){if(l.hasAttribute(a)){const c=new Set(l.getAttribute(a).split(","));c.delete(s.name),c.size==0?n.writer.removeAttribute(a,l):n.writer.setAttribute(a,Array.from(c).join(","),l)}}}}function tw(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const r=n.mapper.toViewElement(t.item),a=n.writer;if(!r)throw new g("conversion-attribute-to-attribute-on-text",n.dispatcher,t);if(t.attributeOldValue!==null&&s)if(s.key=="class"){const l=q(s.value);for(const c of l)a.removeClass(c,r)}else if(s.key=="style"){const l=Object.keys(s.value);for(const c of l)a.removeStyle(c,r)}else a.removeAttribute(s.key,r);if(t.attributeNewValue!==null&&o)if(o.key=="class"){const l=q(o.value);for(const c of l)a.addClass(c,r)}else if(o.key=="style"){const l=Object.keys(o.value);for(const c of l)a.setStyle(c,o.value[c],r)}else a.setAttribute(o.key,o.value,r)}}function nw(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof Ve||t.item instanceof Xe)&&!t.item.is("$textProxy"))return;const s=Xr(i,t,n);if(!s||!n.consumable.consume(t.item,e.name))return;const o=n.writer,r=lh(o,s),a=o.document.selection;if(t.item instanceof Ve||t.item instanceof Xe)o.wrap(a.getFirstRange(),r);else{const l=n.mapper.toViewRange(t.range),c=o.wrap(l,r);for(const d of c.getItems())if(d.is("attributeElement")&&d.isSimilar(r)){n.mapper.bindElementToMarker(d,t.markerName);break}}}}function iw(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof U))return;const s=Xr(i,t,n);if(!s||!n.consumable.test(t.item,e.name))return;const o=n.mapper.toViewElement(t.item);if(o&&o.getCustomProperty("addHighlight")){n.consumable.consume(t.item,e.name);for(const a of _._createIn(t.item))n.consumable.consume(a.item,e.name);o.getCustomProperty("addHighlight")(o,s,n.writer),n.mapper.bindElementToMarker(o,t.markerName)}}}function sw(i){return(e,t,n)=>{if(t.markerRange.isCollapsed)return;const s=Xr(i,t,n);if(!s)return;const o=lh(n.writer,s),r=n.mapper.markerNameToElements(t.markerName);if(r){for(const a of r)n.mapper.unbindElementFromMarkerName(a,t.markerName),a.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(a),o):a.getCustomProperty("removeHighlight")(a,s.id,n.writer);n.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function ow(i){const e=ch(i.model),t=vi(i.view,"container");return e.attributes.length&&(e.children=!0),n=>{n.on(`insert:${e.name}`,Gb(t,hh(e)),{priority:i.converterPriority||"normal"}),(e.children||e.attributes.length)&&n.on("reduceChanges",uh(e),{priority:"low"})}}function rw(i){const e=ch(i.model),t=vi(i.view,"container");return e.children=!0,n=>{if(n._conversionApi.schema.checkChild(e.name,"$text"))throw new g("conversion-element-to-structure-disallowed-text",n,{elementName:e.name});n.on(`insert:${e.name}`,Kb(t,hh(e)),{priority:i.converterPriority||"normal"}),n.on("reduceChanges",uh(e),{priority:"low"})}}function aw(i){i=Ct(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=vi(i.view[s],"attribute");else i.view=vi(i.view,"attribute");const n=dh(i);return s=>{s.on(t,jb(n),{priority:i.converterPriority||"normal"})}}function lw(i){i=Ct(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=Al(i.view[s]);else i.view=Al(i.view);const n=dh(i);return s=>{s.on(t,tw(n),{priority:i.converterPriority||"normal"})}}function cw(i){const e=vi(i.view,"ui");return t=>{t.on(`addMarker:${i.model}`,Jb(e),{priority:i.converterPriority||"normal"}),t.on(`removeMarker:${i.model}`,Qb(),{priority:i.converterPriority||"normal"})}}function dw(i){i=Ct(i);const e=i.model;let t=i.view;return t||(t=n=>({group:e,name:n.substr(i.model.length+1)})),n=>{n.on(`addMarker:${e}`,Yb(t),{priority:i.converterPriority||"normal"}),n.on(`removeMarker:${e}`,ew(t),{priority:i.converterPriority||"normal"})}}function uw(i){return e=>{e.on(`addMarker:${i.model}`,nw(i.view),{priority:i.converterPriority||"normal"}),e.on(`addMarker:${i.model}`,iw(i.view),{priority:i.converterPriority||"normal"}),e.on(`removeMarker:${i.model}`,sw(i.view),{priority:i.converterPriority||"normal"})}}function ch(i){return typeof i=="string"&&(i={name:i}),i.attributes?Array.isArray(i.attributes)||(i.attributes=[i.attributes]):i.attributes=[],i.children=!!i.children,i}function vi(i,e){return typeof i=="function"?i:(t,n)=>hw(i,n,e)}function hw(i,e,t){typeof i=="string"&&(i={name:i});let n;const s=e.writer,o=Object.assign({},i.attributes);if(t=="container")n=s.createContainerElement(i.name,o);else if(t=="attribute"){const r={priority:i.priority||Xt.DEFAULT_PRIORITY};n=s.createAttributeElement(i.name,o,r)}else n=s.createUIElement(i.name,o);if(i.styles){const r=Object.keys(i.styles);for(const a of r)s.setStyle(a,i.styles[a],n)}if(i.classes){const r=i.classes;if(typeof r=="string")s.addClass(r,n);else for(const a of r)s.addClass(a,n)}return n}function dh(i){return i.model.values?(e,t,n)=>{const s=i.view[e];return s?s(e,t,n):null}:i.view}function Al(i){return typeof i=="string"?e=>({key:i,value:e}):typeof i=="object"?i.value?()=>i:e=>({key:i.key,value:e}):i}function Xr(i,e,t){const n=typeof i=="function"?i(e,t):i;return n?(n.priority||(n.priority=10),n.id||(n.id=e.markerName),n):null}function mw(i){return(e,t)=>{if(!e.is("element",i.name))return!1;if(t.type=="attribute"){if(i.attributes.includes(t.attributeKey))return!0}else{/* istanbul ignore else: This is always true because otherwise it would not register a reducer callback. -- @preserve */if(i.children)return!0}return!1}}function uh(i){const e=mw(i);return(t,n)=>{const s=[];n.reconvertedElements||(n.reconvertedElements=new Set);for(const o of n.changes){const r=o.type=="attribute"?o.range.start.nodeAfter:o.position.parent;if(!r||!e(r,o)){s.push(o);continue}if(!n.reconvertedElements.has(r)){n.reconvertedElements.add(r);const a=y._createBefore(r);let l=s.length;for(let c=s.length-1;c>=0;c--){const d=s[c],h=(d.type=="attribute"?d.range.start:d.position).compareWith(a);if(h=="before"||d.type=="remove"&&h=="same")break;l=c}s.splice(l,0,{type:"remove",name:r.name,position:a,length:1},{type:"reinsert",name:r.name,position:a,length:1})}}n.changes=s}}function hh(i){return(e,t,n={})=>{const s=["insert"];for(const o of i.attributes)e.hasAttribute(o)&&s.push(`attribute:${o}`);return s.every(o=>t.test(e,o))?(n.preflight||s.forEach(o=>t.consume(e,o)),!0):!1}}function fw(i,e,t){return(n,s)=>{const o=n.createContainerElement("$slot");let r=null;if(s==="children")r=Array.from(i.getChildren());else if(typeof s=="function")r=Array.from(i.getChildren()).filter(a=>s(a));else throw new g("conversion-slot-mode-unknown",t.dispatcher,{modeOrFilter:s});return e.set(o,r),o}}function gw(i,e,t){const n=Array.from(e.values()).flat(),s=new Set(n);if(s.size!=n.length)throw new g("conversion-slot-filter-overlap",t.dispatcher,{element:i});if(s.size!=i.childCount)throw new g("conversion-slot-filter-incomplete",t.dispatcher,{element:i})}function pw(i,e,t,n){t.mapper.on("modelToViewPosition",r,{priority:"highest"});let s=null,o=null;for([s,o]of e)mh(i,o,t,n),t.writer.move(t.writer.createRangeIn(s),t.writer.createPositionBefore(s)),t.writer.remove(s);t.mapper.off("modelToViewPosition",r);function r(a,l){const c=l.modelPosition.nodeAfter,d=o.indexOf(c);d<0||(l.viewPosition=l.mapper.findPositionIn(s,d))}}function mh(i,e,t,n){for(const s of e)bw(i.root,s,t,n)||t.convertItem(s)}function bw(i,e,t,n){const{writer:s,mapper:o}=t;if(!n.reconversion)return!1;const r=o.toViewElement(e);return!r||r.root==i||!t.canReuseView(r)?!1:(s.move(s.createRangeOn(r),o.toViewPosition(y._createBefore(e))),!0)}function ww(i,e,{preflight:t}={}){return t?e.test(i,"insert"):e.consume(i,"insert")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fh(i){const{schema:e,document:t}=i.model;for(const n of t.getRoots())if(n.isEmpty&&!e.checkChild(n,"$text")&&e.checkChild(n,"paragraph"))return i.insertElement("paragraph",n),!0;return!1}function gh(i,e,t){const n=t.createContext(i);return!(!t.checkChild(n,"paragraph")||!t.checkChild(n.push("paragraph"),e))}function ph(i,e){const t=e.createElement("paragraph");return e.insert(t,i),e.createPositionAt(t,0)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _w extends oh{elementToElement(e){return this.add(bh(e))}elementToAttribute(e){return this.add(Cw(e))}attributeToAttribute(e){return this.add(kw(e))}elementToMarker(e){return this.add(Aw(e))}dataToMarker(e){return this.add(Ew(e))}}function El(){return(i,e,t)=>{if(!e.modelRange&&t.consumable.consume(e.viewItem,{name:!0})){const{modelRange:n,modelCursor:s}=t.convertChildren(e.viewItem,e.modelCursor);e.modelRange=n,e.modelCursor=s}}}function vw(){return(i,e,{schema:t,consumable:n,writer:s})=>{let o=e.modelCursor;if(!n.test(e.viewItem))return;if(!t.checkChild(o,"$text")){if(!gh(o,"$text",t)||e.viewItem.data.trim().length==0)return;const a=o.nodeBefore;o=ph(o,s),a&&a.is("element","$marker")&&(s.move(s.createRangeOn(a),o),o=s.createPositionAfter(a))}n.consume(e.viewItem);const r=s.createText(e.viewItem.data);s.insert(r,o),e.modelRange=s.createRange(o,o.getShiftedBy(r.offsetSize)),e.modelCursor=e.modelRange.end}}function yw(i,e){return(t,n)=>{const s=n.newSelection,o=[];for(const a of s.getRanges())o.push(e.toModelRange(a));const r=i.createSelection(o,{backward:s.isBackward});r.isEqual(i.document.selection)||i.change(a=>{a.setSelection(r)})}}function bh(i){i=Ct(i);const e=or(i),t=Zr(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"normal"})}}function Cw(i){i=Ct(i),wh(i);const e=_h(i,!1),t=Zr(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"low"})}}function kw(i){i=Ct(i);let e=null;(typeof i.view=="string"||i.view.key)&&(e=xw(i)),wh(i,e);const t=_h(i,!0);return n=>{n.on("element",t,{priority:i.converterPriority||"low"})}}function Aw(i){const e=Rw(i.model);return bh({...i,model:e})}function Ew(i){i=Ct(i),i.model||(i.model=s=>s?i.view+":"+s:i.view);const e={view:i.view,model:i.model},t=or(Tl(e,"start")),n=or(Tl(e,"end"));return s=>{s.on(`element:${i.view}-start`,t,{priority:i.converterPriority||"normal"}),s.on(`element:${i.view}-end`,n,{priority:i.converterPriority||"normal"});const o=Be.low,r=Be.highest,a=Be.get(i.converterPriority)/r;s.on("element",Tw(e),{priority:o+a})}}function Tw(i){return(e,t,n)=>{const s=`data-${i.view}`;if(!n.consumable.test(t.viewItem,{attributes:s+"-end-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-end-before"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-before"}))return;t.modelRange||Object.assign(t,n.convertChildren(t.viewItem,t.modelCursor)),n.consumable.consume(t.viewItem,{attributes:s+"-end-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-end-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-start-before").split(","));function o(r,a){for(const l of a){const c=i.model(l,n),d=n.writer.createElement("$marker",{"data-name":c});n.writer.insert(d,r),t.modelCursor.isEqual(r)?t.modelCursor=t.modelCursor.getShiftedBy(1):t.modelCursor=t.modelCursor._getTransformedByInsertion(r,1),t.modelRange=t.modelRange._getTransformedByInsertion(r,1)[0]}}}}function Zr(i){return typeof i=="string"?i:typeof i=="object"&&typeof i.name=="string"?i.name:null}function or(i){const e=new Oe(i.view);return(t,n,s)=>{const o=e.match(n.viewItem);if(!o)return;const r=o.match;if(r.name=!0,!s.consumable.test(n.viewItem,r))return;const a=Sw(i.model,n.viewItem,s);a&&s.safeInsert(a,n.modelCursor)&&(s.consumable.consume(n.viewItem,r),s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n))}}function Sw(i,e,t){return i instanceof Function?i(e,t):t.writer.createElement(i)}function xw(i){typeof i.view=="string"&&(i.view={key:i.view});const e=i.view.key;let t;if(e=="class"||e=="style")t={[e=="class"?"classes":"styles"]:i.view.value};else{const n=typeof i.view.value>"u"?/[\s\S]*/:i.view.value;t={attributes:{[e]:n}}}return i.view.name&&(t.name=i.view.name),i.view=t,e}function wh(i,e=null){const t=e===null?!0:o=>o.getAttribute(e),n=typeof i.model!="object"?i.model:i.model.key,s=typeof i.model!="object"||typeof i.model.value>"u"?t:i.model.value;i.model={key:n,value:s}}function _h(i,e){const t=new Oe(i.view);return(n,s,o)=>{if(!s.modelRange&&e)return;const r=t.match(s.viewItem);if(!r||(Pw(i.view,s.viewItem)?r.match.name=!0:delete r.match.name,!o.consumable.test(s.viewItem,r.match)))return;const a=i.model.key,l=typeof i.model.value=="function"?i.model.value(s.viewItem,o):i.model.value;if(l===null)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor)),Iw(s.modelRange,{key:a,value:l},e,o)&&(o.consumable.test(s.viewItem,{name:!0})&&(r.match.name=!0),o.consumable.consume(s.viewItem,r.match))}}function Pw(i,e){const t=typeof i=="function"?i(e):i;return typeof t=="object"&&!Zr(t)?!1:!t.classes&&!t.attributes&&!t.styles}function Iw(i,e,t,n){let s=!1;for(const o of Array.from(i.getItems({shallow:t})))n.schema.checkAttribute(o,e.key)&&(s=!0,!o.hasAttribute(e.key)&&n.writer.setAttribute(e.key,e.value,o));return s}function Rw(i){return(e,t)=>{const n=typeof i=="string"?i:i(e,t);return t.writer.createElement("$marker",{"data-name":n})}}function Tl(i,e){const t=(n,s)=>{const o=n.getAttribute("name"),r=i.model(o,s);return s.writer.createElement("$marker",{"data-name":r})};return{view:`${i.view}-${e}`,model:t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vw(i){i.document.registerPostFixer(e=>Bw(e,i))}function Bw(i,e){const t=e.document.selection,n=e.schema,s=[];let o=!1;for(const r of t.getRanges()){const a=vh(r,n);a&&!a.isEqual(r)?(s.push(a),o=!0):s.push(r)}return o&&i.setSelection(Fw(s),{backward:t.isBackward}),!1}function vh(i,e){return i.isCollapsed?Mw(i,e):Ow(i,e)}function Mw(i,e){const t=i.start,n=e.getNearestSelectionRange(t);if(!n){const o=t.getAncestors().reverse().find(r=>e.isObject(r));return o?_._createOn(o):null}if(!n.isCollapsed)return n;const s=n.start;return t.isEqual(s)?null:new _(s)}function Ow(i,e){const{start:t,end:n}=i,s=e.checkChild(t,"$text"),o=e.checkChild(n,"$text"),r=e.getLimitElement(t),a=e.getLimitElement(n);if(r===a){if(s&&o)return null;if(Nw(t,n,e)){const u=t.nodeAfter&&e.isSelectable(t.nodeAfter)?null:e.getNearestSelectionRange(t,"forward"),m=n.nodeBefore&&e.isSelectable(n.nodeBefore)?null:e.getNearestSelectionRange(n,"backward"),f=u?u.start:t,p=m?m.end:n;return new _(f,p)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const d=t.nodeAfter&&n.nodeBefore&&t.nodeAfter.parent===n.nodeBefore.parent,u=l&&(!d||!xl(t.nodeAfter,e)),h=c&&(!d||!xl(n.nodeBefore,e));let m=t,f=n;return u&&(m=y._createBefore(Sl(r,e))),h&&(f=y._createAfter(Sl(a,e))),new _(m,f)}return null}function Sl(i,e){let t=i,n=t;for(;e.isLimit(n)&&n.parent;)t=n,n=n.parent;return t}function Nw(i,e,t){const n=i.nodeAfter&&!t.isLimit(i.nodeAfter)||t.checkChild(i,"$text"),s=e.nodeBefore&&!t.isLimit(e.nodeBefore)||t.checkChild(e,"$text");return n||s}function Fw(i){const e=[...i],t=new Set;let n=1;for(;n<e.length;){const o=e[n],r=e.slice(0,n);for(const[a,l]of r.entries())if(!t.has(a)){if(o.isEqual(l))t.add(a);else if(o.isIntersecting(l)){t.add(a),t.add(n);const c=o.getJoined(l);e.push(c)}}n++}return e.filter((o,r)=>!t.has(r))}function xl(i,e){return i&&e.isSelectable(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lw extends $(){constructor(e,t){super(),this.model=e,this.view=new Tb(t),this.mapper=new nh,this.downcastDispatcher=new ih({mapper:this.mapper,schema:e.schema});const n=this.model.document,s=n.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(n,"change",()=>{this.view.change(r=>{this.downcastDispatcher.convertChanges(n.differ,o,r),this.downcastDispatcher.convertSelection(s,o,r)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",yw(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",Dw(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",rh(),{priority:"lowest"}),this.downcastDispatcher.on("insert",ah(),{priority:"lowest"}),this.downcastDispatcher.on("remove",Wb(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",qb()),this.downcastDispatcher.on("selection",$b(),{priority:"low"}),this.downcastDispatcher.on("selection",Ub(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(r=>{if(r.rootName=="$graveyard")return null;const a=new $u(this.view.document,r.name);return a.rootName=r.rootName,this.mapper.bindElements(r,a),a})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t=typeof e=="string"?e:e.name,n=this.model.markers.get(t);if(!n)throw new g("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(()=>{this.model.markers._refresh(n)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}function Dw(i,e,t){return(n,s)=>{if(!(t.document.isComposing&&!V.isAndroid))for(let o=0;o<s.targetRanges.length;o++){const r=s.targetRanges[o],a=i.toModelRange(r),l=vh(a,e);!l||l.isEqual(a)||(s.targetRanges[o]=i.toViewRange(l))}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ci{constructor(){this._consumables=new Map}add(e,t){let n;if(e.is("$text")||e.is("documentFragment")){this._consumables.set(e,!0);return}this._consumables.has(e)?n=this._consumables.get(e):(n=new zw(e),this._consumables.set(e,n)),n.add(t)}test(e,t){const n=this._consumables.get(e);return n===void 0?null:e.is("$text")||e.is("documentFragment")?n:n.test(t)}consume(e,t){return this.test(e,t)?(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0):!1}revert(e,t){const n=this._consumables.get(e);n!==void 0&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):n.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},n=e.getAttributeKeys();for(const r of n)r=="style"||r=="class"||t.attributes.push(r);const s=e.getClassNames();for(const r of s)t.classes.push(r);const o=e.getStyleNames();for(const r of o)t.styles.push(r);return t}static createFrom(e,t){if(t||(t=new ci),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,ci.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const n of e.getChildren())t=ci.createFrom(n,t);return t}}const Qi=["attributes","classes","styles"];class zw{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t of Qi)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t of Qi)if(t in e){const n=this._test(t,e[t]);if(n!==!0)return n}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t of Qi)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t of Qi)t in e&&this._revert(t,e[t])}_add(e,t){const n=$i(t)?t:[t],s=this._consumables[e];for(const o of n){if(e==="attributes"&&(o==="class"||o==="style"))throw new g("viewconsumable-invalid-attribute",this);if(s.set(o,!0),e==="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!0)}}_test(e,t){const n=$i(t)?t:[t],s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles",a=this._test(r,[...this._consumables[r].keys()]);if(a!==!0)return a}else{const r=s.get(o);if(r===void 0)return null;if(!r)return!1}return!0}_consume(e,t){const n=$i(t)?t:[t],s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._consume(r,[...this._consumables[r].keys()])}else if(s.set(o,!1),e=="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!1)}_revert(e,t){const n=$i(t)?t:[t],s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._revert(r,[...this._consumables[r].keys()])}else s.get(o)===!1&&s.set(o,!0)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hw extends $(){constructor(){super(),this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new en(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new en(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new g("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new g("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return typeof e=="string"?t=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?t="$text":t=e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!!(t&&t.isBlock)}isLimit(e){const t=this.getDefinition(e);return t?!!(t.isLimit||t.isObject):!1}isObject(e){const t=this.getDefinition(e);return t?!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent):!1}isInline(e){const t=this.getDefinition(e);return!!(t&&t.isInline)}isSelectable(e){const t=this.getDefinition(e);return t?!!(t.isSelectable||t.isObject):!1}isContent(e){const t=this.getDefinition(e);return t?!!(t.isContent||t.isObject):!1}checkChild(e,t){return t?this._checkContextMatch(t,e):!1}checkAttribute(e,t){const n=this.getDefinition(e.last);return n?n.allowAttributes.includes(t):!1}checkMerge(e,t){if(e instanceof y){const n=e.nodeBefore,s=e.nodeAfter;if(!(n instanceof U))throw new g("schema-check-merge-no-element-before",this);if(!(s instanceof U))throw new g("schema-check-merge-no-element-after",this);return this.checkMerge(n,s)}for(const n of t.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e){this.on("checkChild",(t,[n,s])=>{if(!s)return;const o=e(n,s);typeof o=="boolean"&&(t.stop(),t.return=o)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(t,[n,s])=>{const o=e(n,s);typeof o=="boolean"&&(t.stop(),t.return=o)},{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;for(e instanceof y?t=e.parent:t=(e instanceof _?[e]:Array.from(e.getRanges())).reduce((s,o)=>{const r=o.getCommonAncestor();return s?s.getCommonAncestor(r,{includeSelf:!0}):r},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const s=[...e.getFirstPosition().getAncestors(),new j("",e.getAttributes())];return this.checkAttribute(s,t)}else{const n=e.getRanges();for(const s of n)for(const o of s)if(this.checkAttribute(o.item,t))return!0}return!1}*getValidRanges(e,t){e=i1(e);for(const n of e)yield*this._getValidRangesForRange(n,t)}getNearestSelectionRange(e,t="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new _(e);let n,s;const o=e.getAncestors().reverse().find(r=>this.isLimit(r))||e.root;(t=="both"||t=="backward")&&(n=new It({boundaries:_._createIn(o),startPosition:e,direction:"backward"})),(t=="both"||t=="forward")&&(s=new It({boundaries:_._createIn(o),startPosition:e}));for(const r of n1(n,s)){const a=r.walker==n?"elementEnd":"elementStart",l=r.value;if(l.type==a&&this.isObject(l.item))return _._createOn(l.item);if(this.checkChild(l.nextPosition,"$text"))return new _(l.nextPosition)}return null}findAllowedParent(e,t){let n=e.parent;for(;n;){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}setAllowedAttributes(e,t,n){const s=n.model;for(const[o,r]of Object.entries(t))s.schema.checkAttribute(e,o)&&n.setAttribute(o,r,e)}removeDisallowedAttributes(e,t){for(const n of e)if(n.is("$text"))Pl(this,n,t);else{const o=_._createIn(n).getPositions();for(const r of o){const a=r.nodeBefore||r.parent;Pl(this,a,t)}}}getAttributesWithProperty(e,t,n){const s={};for(const[o,r]of e.getAttributes()){const a=this.getAttributeProperties(o);a[t]!==void 0&&(n===void 0||n===a[t])&&(s[o]=r)}return s}createContext(e){return new en(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,n=Object.keys(t);for(const s of n)e[s]=Ww(t[s],s);for(const s of n)$w(e,s);for(const s of n)Uw(e,s);for(const s of n)qw(e,s);for(const s of n)jw(e,s),Gw(e,s);for(const s of n)Kw(e,s),Jw(e,s),Qw(e,s);this._compiledDefinitions=e}_checkContextMatch(e,t,n=t.length-1){const s=t.getItem(n);if(e.allowIn.includes(s.name)){if(n==0)return!0;{const o=this.getDefinition(s);return this._checkContextMatch(o,t,n-1)}}else return!1}*_getValidRangesForRange(e,t){let n=e.start,s=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(_._createIn(o),t)),this.checkAttribute(o,t)||(n.isEqual(s)||(yield new _(n,s)),n=y._createAfter(o)),s=y._createAfter(o);n.isEqual(s)||(yield new _(n,s))}}class en{constructor(e){if(e instanceof en)return e;let t;typeof e=="string"?t=[e]:Array.isArray(e)?t=e:t=e.getAncestors({includeSelf:!0}),this._items=t.map(t1)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new en([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function Ww(i,e){const t={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return Yw(i,t),qt(i,t,"allowIn"),qt(i,t,"allowContentOf"),qt(i,t,"allowWhere"),qt(i,t,"allowAttributes"),qt(i,t,"allowAttributesOf"),qt(i,t,"allowChildren"),qt(i,t,"inheritTypesFrom"),Xw(i,t),t}function $w(i,e){const t=i[e];for(const n of t.allowChildren){const s=i[n];s&&s.allowIn.push(e)}t.allowChildren.length=0}function Uw(i,e){for(const t of i[e].allowContentOf)i[t]&&Zw(i,t).forEach(s=>{s.allowIn.push(e)});delete i[e].allowContentOf}function qw(i,e){for(const t of i[e].allowWhere){const n=i[t];if(n){const s=n.allowIn;i[e].allowIn.push(...s)}}delete i[e].allowWhere}function jw(i,e){for(const t of i[e].allowAttributesOf){const n=i[t];if(n){const s=n.allowAttributes;i[e].allowAttributes.push(...s)}}delete i[e].allowAttributesOf}function Gw(i,e){const t=i[e];for(const n of t.inheritTypesFrom){const s=i[n];if(s){const o=Object.keys(s).filter(r=>r.startsWith("is"));for(const r of o)r in t||(t[r]=s[r])}}delete t.inheritTypesFrom}function Kw(i,e){const t=i[e],n=t.allowIn.filter(s=>i[s]);t.allowIn=Array.from(new Set(n))}function Jw(i,e){const t=i[e];for(const n of t.allowIn)i[n].allowChildren.push(e)}function Qw(i,e){const t=i[e];t.allowAttributes=Array.from(new Set(t.allowAttributes))}function Yw(i,e){for(const t of i){const n=Object.keys(t).filter(s=>s.startsWith("is"));for(const s of n)e[s]=!!t[s]}}function qt(i,e,t){for(const n of i){const s=n[t];typeof s=="string"?e[t].push(s):Array.isArray(s)&&e[t].push(...s)}}function Xw(i,e){for(const t of i){const n=t.inheritAllFrom;n&&(e.allowContentOf.push(n),e.allowWhere.push(n),e.allowAttributesOf.push(n),e.inheritTypesFrom.push(n))}}function Zw(i,e){const t=i[e];return e1(i).filter(n=>n.allowIn.includes(t.name))}function e1(i){return Object.keys(i).map(e=>i[e])}function t1(i){return typeof i=="string"||i.is("documentFragment")?{name:typeof i=="string"?i:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:i.is("element")?i.name:"$text",*getAttributeKeys(){yield*i.getAttributeKeys()},getAttribute(e){return i.getAttribute(e)}}}function*n1(i,e){let t=!1;for(;!t;){if(t=!0,i){const n=i.next();n.done||(t=!1,yield{walker:i,value:n.value})}if(e){const n=e.next();n.done||(t=!1,yield{walker:e,value:n.value})}}}function*i1(i){for(const e of i)yield*e.getMinimalFlatRanges()}function Pl(i,e,t){for(const n of e.getAttributeKeys())i.checkAttribute(e,n)||t.removeAttribute(n,e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class s1 extends J(){constructor(e){super(),this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this._emptyElementsToKeep=new Set,this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(t,n)=>this._convertItem(t,n),convertChildren:(t,n)=>this._convertChildren(t,n),safeInsert:(t,n)=>this._safeInsert(t,n),updateConversionResult:(t,n)=>this._updateConversionResult(t,n),splitToAllowedParent:(t,n)=>this._splitToAllowedParent(t,n),getSplitParts:t=>this._getSplitParts(t),keepEmptyElement:t=>this._keepEmptyElement(t)}}convert(e,t,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=r1(n,t),this.conversionApi.writer=t,this.conversionApi.consumable=ci.createFrom(e),this.conversionApi.store={};const{modelRange:s}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(s){this._removeEmptyElements();for(const r of Array.from(this._modelCursor.parent.getChildren()))t.append(r,o);o.markers=o1(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const n={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,n,this.conversionApi):e.is("$text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof _))throw new g("view-conversion-dispatcher-incorrect-result",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,t){let n=t.is("position")?t:y._createAt(t,0);const s=new _(n);for(const o of Array.from(e.getChildren())){const r=this._convertItem(o,n);r.modelRange instanceof _&&(s.end=r.modelRange.end,n=r.modelCursor)}return{modelRange:s,modelCursor:n}}_safeInsert(e,t){const n=this._splitToAllowedParent(e,t);return n?(this.conversionApi.writer.insert(e,n.position),!0):!1}_updateConversionResult(e,t){const n=this._getSplitParts(e),s=this.conversionApi.writer;t.modelRange||(t.modelRange=s.createRange(s.createPositionBefore(e),s.createPositionAfter(n[n.length-1])));const o=this._cursorParents.get(e);o?t.modelCursor=s.createPositionAt(o,0):t.modelCursor=t.modelRange.end}_splitToAllowedParent(e,t){const{schema:n,writer:s}=this.conversionApi;let o=n.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return gh(t,e,n)?{position:ph(t,s)}:null;const r=this.conversionApi.writer.split(t,o),a=[];for(const c of r.range.getWalker())if(c.type=="elementEnd")a.push(c.item);else{const d=a.pop(),u=c.item;this._registerSplitPair(d,u)}const l=r.range.end.parent;return this._cursorParents.set(e,l),{position:r.position,cursorParent:l}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(t,n),n.push(t)}_getSplitParts(e){let t;return this._splitParts.has(e)?t=this._splitParts.get(e):t=[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&!this._emptyElementsToKeep.has(t)&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}function o1(i,e){const t=new Set,n=new Map,s=_._createIn(i).getItems();for(const o of s)o.is("element","$marker")&&t.add(o);for(const o of t){const r=o.getAttribute("data-name"),a=e.createPositionBefore(o);n.has(r)?n.get(r).end=a.clone():n.set(r,new _(a.clone())),e.remove(o)}return n}function r1(i,e){let t;for(const n of new en(i)){const s={};for(const r of n.getAttributeKeys())s[r]=n.getAttribute(r);const o=e.createElement(n.name,s);t&&e.insert(o,t),t=y._createAt(o,0)}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class a1{getHtml(e){const n=document.implementation.createHTMLDocument("").createElement("div");return n.appendChild(e),n.innerHTML}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class l1{constructor(e){this.skipComments=!0,this.domParser=new DOMParser,this.domConverter=new Js(e,{renderingMode:"data"}),this.htmlWriter=new a1}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){e.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i)||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),n=t.createDocumentFragment(),s=t.body.childNodes;for(;s.length>0;)n.appendChild(s[0]);return n}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class c1 extends J(){constructor(e,t){super(),this.model=e,this.mapper=new nh,this.downcastDispatcher=new ih({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",rh(),{priority:"lowest"}),this.downcastDispatcher.on("insert",ah(),{priority:"lowest"}),this.upcastDispatcher=new s1({schema:e.schema}),this.viewDocument=new Gs(t),this.stylesProcessor=t,this.htmlProcessor=new l1(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new Qr(this.viewDocument),this.upcastDispatcher.on("text",vw(),{priority:"lowest"}),this.upcastDispatcher.on("element",El(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",El(),{priority:"lowest"}),$().prototype.decorate.call(this,"init"),$().prototype.decorate.call(this,"set"),$().prototype.decorate.call(this,"get"),$().prototype.decorate.call(this,"toView"),$().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},fh)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:n="empty"}=e;if(!this._checkIfRootsExists([t]))throw new g("datacontroller-get-non-existent-root",this);const s=this.model.document.getRoot(t);return s.isAttached()||K("datacontroller-get-detached-root",this),n==="empty"&&!this.model.hasContent(s,{ignoreWhitespaces:!0})?"":this.stringify(s,e)}stringify(e,t={}){const n=this.toView(e,t);return this.processor.toData(n)}toView(e,t={}){const n=this.viewDocument,s=this._viewWriter;this.mapper.clearBindings();const o=_._createIn(e),r=new Zt(n);this.mapper.bindElements(e,r);const a=e.is("documentFragment")?e.markers:d1(e);return this.downcastDispatcher.convert(o,a,s,t),r}init(e){if(this.model.document.version)throw new g("datacontroller-init-document-not-empty",this);let t={};if(typeof e=="string"?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new g("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},n=>{for(const s of Object.keys(t)){const o=this.model.document.getRoot(s);n.insert(this.parse(t[s],o),o,0)}}),Promise.resolve()}set(e,t={}){let n={};if(typeof e=="string"?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new g("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},s=>{s.setSelection(null),s.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(n)){const r=this.model.document.getRoot(o);s.remove(s.createRangeIn(r)),s.insert(this.parse(n[o],r),r,0)}})}parse(e,t="$root"){const n=this.processor.toView(e);return this.toModel(n,t)}toModel(e,t="$root"){return this.model.change(n=>this.upcastDispatcher.convert(e,n,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}}function d1(i){const e=[],t=i.root.document;if(!t)return new Map;const n=_._createIn(i);for(const s of t.model.markers){const o=s.getRange(),r=o.isCollapsed,a=o.start.isEqual(n.start)||o.end.isEqual(n.end);if(r&&a)e.push([s.name,o]);else{const l=n.getIntersection(o);l&&e.push([s.name,l])}}return e.sort(([s,o],[r,a])=>{if(o.end.compareWith(a.start)!=="after")return 1;if(o.start.compareWith(a.end)!=="before")return-1;switch(o.start.compareWith(a.start)){case"before":return 1;case"after":return-1;default:switch(o.end.compareWith(a.end)){case"before":return 1;case"after":return-1;default:return r.localeCompare(s)}}}),new Map(e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class u1{constructor(e,t){this._helpers=new Map,this._downcast=q(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=q(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const n=this._downcast.includes(t);if(!this._upcast.includes(t)&&!n)throw new g("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:n})}for(e){if(!this._helpers.has(e))throw new g("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:n}of _o(e))this.for("upcast").elementToElement({model:t,view:n,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:n}of _o(e))this.for("upcast").elementToAttribute({view:n,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:n}of _o(e))this.for("upcast").attributeToAttribute({view:n,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:n}){if(this._helpers.has(e))throw new g("conversion-group-exists",this);const s=n?new Hb(t):new _w(t);this._helpers.set(e,s)}}function*_o(i){if(i.model.values)for(const e of i.model.values){const t={key:i.model.key,value:e},n=i.view[e],s=i.upcastAlso?i.upcastAlso[e]:void 0;yield*Il(t,n,s)}else yield*Il(i.model,i.view,i.upcastAlso)}function*Il(i,e,t){if(yield{model:i,view:e},t)for(const n of q(t))yield{model:i,view:n}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ne{constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ea(i,e){const t=Ch(e),n=t.reduce((r,a)=>r+a.offsetSize,0),s=i.parent;ki(i);const o=i.index;return s._insertChild(o,t),Ci(s,o+t.length),Ci(s,o),new _(i,i.getShiftedBy(n))}function yh(i){if(!i.isFlat)throw new g("operation-utils-remove-range-not-flat",this);const e=i.start.parent;ki(i.start),ki(i.end);const t=e._removeChildren(i.start.index,i.end.index-i.start.index);return Ci(e,i.start.index),t}function yi(i,e){if(!i.isFlat)throw new g("operation-utils-move-range-not-flat",this);const t=yh(i);return e=e._getTransformedByDeletion(i.start,i.end.offset-i.start.offset),ea(e,t)}function h1(i,e,t){ki(i.start),ki(i.end);for(const n of i.getItems({shallow:!0})){const s=n.is("$textProxy")?n.textNode:n;t!==null?s._setAttribute(e,t):s._removeAttribute(e),Ci(s.parent,s.index)}Ci(i.end.parent,i.end.index)}function Ch(i){const e=[];function t(n){if(typeof n=="string")e.push(new j(n));else if(n instanceof Qe)e.push(new j(n.data,n.getAttributes()));else if(n instanceof cn)e.push(n);else if(Me(n))for(const s of n)t(s)}t(i);for(let n=1;n<e.length;n++){const s=e[n],o=e[n-1];s instanceof j&&o instanceof j&&kh(s,o)&&(e.splice(n-1,2,new j(o.data+s.data,o.getAttributes())),n--)}return e}function Ci(i,e){const t=i.getChild(e-1),n=i.getChild(e);if(t&&n&&t.is("$text")&&n.is("$text")&&kh(t,n)){const s=new j(t.data+n.data,t.getAttributes());i._removeChildren(e-1,2),i._insertChild(e-1,s)}}function ki(i){const e=i.textNode,t=i.parent;if(e){const n=i.offset-e.startOffset,s=e.index;t._removeChildren(s,1);const o=new j(e.data.substr(0,n),e.getAttributes()),r=new j(e.data.substr(n),e.getAttributes());t._insertChild(s,[o,r])}}function kh(i,e){const t=i.getAttributes(),n=e.getAttributes();for(const s of t){if(s[1]!==e.getAttribute(s[0]))return!1;n.next()}return n.next().done}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class H extends Ne{constructor(e,t,n,s){super(s),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[_._createFromPositionAndShift(this.sourcePosition,this.howMany),_._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new H(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new H(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,n=this.sourcePosition.offset,s=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new g("move-operation-nodes-do-not-exist",this);if(e===t&&n<s&&s<n+this.howMany)throw new g("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&Ce(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const o=this.sourcePosition.path.length-1;if(this.targetPosition.path[o]>=n&&this.targetPosition.path[o]<n+this.howMany)throw new g("move-operation-node-into-itself",this)}}_execute(){yi(_._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const n=y.fromJSON(e.sourcePosition,t),s=y.fromJSON(e.targetPosition,t);return new this(n,e.howMany,s,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fe extends Ne{constructor(e,t,n){super(n),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new ai(Ch(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new ai([...this.nodes].map(n=>n._clone(!0))),t=new fe(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new y(e,[0]);return new H(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new g("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new ai([...e].map(t=>t._clone(!0))),ea(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const n=[];for(const o of e.nodes)o.name?n.push(U.fromJSON(o)):n.push(j.fromJSON(o));const s=new fe(y.fromJSON(e.position,t),n,e.baseVersion);return s.shouldReceiveAttributes=e.shouldReceiveAttributes,s}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class G extends Ne{constructor(e,t,n,s,o){super(o),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=n,this.graveyardPosition=s?s.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new y(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new _(this.splitPosition,e)}get affectedSelectable(){const e=[_._createFromPositionAndShift(this.splitPosition,0),_._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(_._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new G(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new y(e,[0]);return new ie(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new g("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new g("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new g("split-operation-graveyard-position-invalid",this)}else throw new g("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)yi(_._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const n=e._clone();ea(this.insertionPosition,n)}const t=new _(y._createAt(e,this.splitPosition.offset),y._createAt(e,e.maxOffset));yi(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new y(e.root,t,"toPrevious")}static fromJSON(e,t){const n=y.fromJSON(e.splitPosition,t),s=y.fromJSON(e.insertionPosition,t),o=e.graveyardPosition?y.fromJSON(e.graveyardPosition,t):null;return new this(n,e.howMany,s,o,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ie extends Ne{constructor(e,t,n,s,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=s.clone()}get type(){return"merge"}get deletionPosition(){return new y(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new _(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[_._createOn(e),_._createFromPositionAndShift(this.targetPosition,0),_._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new ie(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),n=new y(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new G(e,this.howMany,n,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(e.parent)if(t.parent){if(this.howMany!=e.maxOffset)throw new g("merge-operation-how-many-invalid",this)}else throw new g("merge-operation-target-position-invalid",this);else throw new g("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,t=_._createIn(e);yi(t,this.targetPosition),yi(_._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const n=y.fromJSON(e.sourcePosition,t),s=y.fromJSON(e.targetPosition,t),o=y.fromJSON(e.graveyardPosition,t);return new this(n,e.howMany,s,o,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ee extends Ne{constructor(e,t,n,s,o,r){super(r),this.name=e,this.oldRange=t?t.clone():null,this.newRange=n?n.clone():null,this.affectsData=o,this._markers=s}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new Ee(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Ee(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new Ee(e.name,e.oldRange?_.fromJSON(e.oldRange,t):null,e.newRange?_.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oe extends Ne{constructor(e,t,n,s,o){super(o),this.range=e.clone(),this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new oe(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new oe(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new g("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!Vn(e.getAttribute(this.key),this.oldValue))throw new g("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new g("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){Vn(this.oldValue,this.newValue)||h1(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new oe(_.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ce extends Ne{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new ce(this.baseVersion)}getReversed(){return new ce(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Te extends Ne{constructor(e,t,n,s){super(s),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=n}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new Te(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Te(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof U){if(e.name!==this.oldName)throw new g("rename-operation-wrong-name",this)}else throw new g("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new Te(y.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pt extends Ne{constructor(e,t,n,s,o){super(o),this.root=e,this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new pt(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new pt(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new g("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new g("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new g("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new g("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new pt(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class it extends Ne{constructor(e,t,n,s,o){if(super(o),this.rootName=e,this.elementName=t,this.isAdd=n,this._document=s,!this._document.getRoot(this.rootName)){const r=this._document.createRoot(this.elementName,this.rootName);r._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new it(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new it(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,t){return new it(e.rootName,e.elementName,e.isAdd,t,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const je={};je[oe.className]=oe;je[fe.className]=fe;je[Ee.className]=Ee;je[H.className]=H;je[ce.className]=ce;je[Ne.className]=Ne;je[Te.className]=Te;je[pt.className]=pt;je[it.className]=it;je[G.className]=G;je[ie.className]=ie;class m1{static fromJSON(e,t){return je[e.__className].fromJSON(e,t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const rr=new Map;function L(i,e,t){let n=rr.get(i);n||(n=new Map,rr.set(i,n)),n.set(e,t)}function f1(i,e){const t=rr.get(i);return t&&t.has(e)?t.get(e):g1}function g1(i){return[i]}function Rl(i,e,t={}){const n=f1(i.constructor,e.constructor);try{return i=i.clone(),n(i,e,t)}catch(s){throw s}}function p1(i,e,t){i=i.slice(),e=e.slice();const n=new b1(t.document,t.useRelations,t.forceWeakRemove);n.setOriginalOperations(i),n.setOriginalOperations(e);const s=n.originalOperations;if(i.length==0||e.length==0)return{operationsA:i,operationsB:e,originalOperations:s};const o=new WeakMap;for(const l of i)o.set(l,0);const r={nextBaseVersionA:i[i.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:i.length,originalOperationsBCount:e.length};let a=0;for(;a<i.length;){const l=i[a],c=o.get(l);if(c==e.length){a++;continue}const d=e[c],u=Rl(l,d,n.getContext(l,d,!0)),h=Rl(d,l,n.getContext(d,l,!1));n.updateRelation(l,d),n.setOriginalOperations(u,l),n.setOriginalOperations(h,d);for(const m of u)o.set(m,c+h.length);i.splice(a,1,...u),e.splice(c,1,...h)}if(t.padWithNoOps){const l=i.length-r.originalOperationsACount,c=e.length-r.originalOperationsBCount;Bl(i,c-l),Bl(e,l-c)}return Vl(i,r.nextBaseVersionB),Vl(e,r.nextBaseVersionA),{operationsA:i,operationsB:e,originalOperations:s}}class b1{constructor(e,t,n=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(e,t=null){const n=t?this.originalOperations.get(t):null;for(const s of e)this.originalOperations.set(s,n||s)}updateRelation(e,t){if(e instanceof H)t instanceof ie?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter"):t instanceof H&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof G){if(t instanceof ie)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof H)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const n=_._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const s=n.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-n.start.offset;this._setRelation(e,t,{howMany:s,offset:o})}}}else if(e instanceof ie)t instanceof ie?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof G&&e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource");else if(e instanceof Ee){const n=e.newRange;if(!n)return;if(t instanceof H){const s=_._createFromPositionAndShift(t.sourcePosition,t.howMany),o=s.containsPosition(n.start)||s.start.isEqual(n.start),r=s.containsPosition(n.end)||s.end.isEqual(n.end);(o||r)&&!s.containsRange(n)&&this._setRelation(e,t,{side:o?"left":"right",path:o?n.start.path.slice():n.end.path.slice()})}else if(t instanceof ie){const s=n.start.isEqual(t.targetPosition),o=n.start.isEqual(t.deletionPosition),r=n.end.isEqual(t.deletionPosition),a=n.end.isEqual(t.sourcePosition);(s||o||r||a)&&this._setRelation(e,t,{wasInLeftElement:s,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:r,wasInRightElement:a})}}}getContext(e,t,n){return{aIsStrong:n,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const n=this.originalOperations.get(t),s=this._history.getUndoneOperation(n);if(!s)return null;const o=this.originalOperations.get(e),r=this._relations.get(o);return r&&r.get(s)||null}_setRelation(e,t,n){const s=this.originalOperations.get(e),o=this.originalOperations.get(t);let r=this._relations.get(s);r||(r=new Map,this._relations.set(s,r)),r.set(o,n)}}function Vl(i,e){for(const t of i)t.baseVersion=e++}function Bl(i,e){for(let t=0;t<e;t++)i.push(new ce(0))}L(oe,oe,(i,e,t)=>{if(i.key===e.key&&i.range.start.hasSameParentAs(e.range.start)){const n=i.range.getDifference(e.range).map(o=>new oe(o,i.key,i.oldValue,i.newValue,0)),s=i.range.getIntersection(e.range);return s&&t.aIsStrong&&n.push(new oe(s,e.key,e.newValue,i.newValue,0)),n.length==0?[new ce(0)]:n}else return[i]});L(oe,fe,(i,e)=>{if(i.range.start.hasSameParentAs(e.position)&&i.range.containsPosition(e.position)){const n=i.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(s=>new oe(s,i.key,i.oldValue,i.newValue,i.baseVersion));if(e.shouldReceiveAttributes){const s=Ah(e,i.key,i.oldValue);s&&n.unshift(s)}return n}return i.range=i.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[i]});function Ah(i,e,t){const s=i.nodes.getNode(0).getAttribute(e);if(s==t)return null;const o=new _(i.position,i.position.getShiftedBy(i.howMany));return new oe(o,e,s,t,0)}L(oe,ie,(i,e)=>{const t=[];i.range.start.hasSameParentAs(e.deletionPosition)&&(i.range.containsPosition(e.deletionPosition)||i.range.start.isEqual(e.deletionPosition))&&t.push(_._createFromPositionAndShift(e.graveyardPosition,1));const n=i.range._getTransformedByMergeOperation(e);return n.isCollapsed||t.push(n),t.map(s=>new oe(s,i.key,i.oldValue,i.newValue,i.baseVersion))});L(oe,H,(i,e)=>w1(i.range,e).map(n=>new oe(n,i.key,i.oldValue,i.newValue,i.baseVersion)));function w1(i,e){const t=_._createFromPositionAndShift(e.sourcePosition,e.howMany);let n=null,s=[];t.containsRange(i,!0)?n=i:i.start.hasSameParentAs(t.start)?(s=i.getDifference(t),n=i.getIntersection(t)):s=[i];const o=[];for(let r of s){r=r._getTransformedByDeletion(e.sourcePosition,e.howMany);const a=e.getMovedRangeStart(),l=r.start.hasSameParentAs(a),c=r._getTransformedByInsertion(a,e.howMany,l);o.push(...c)}return n&&o.push(n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),o}L(oe,G,(i,e)=>{if(i.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||i.range.end.offset++,[i];if(i.range.start.hasSameParentAs(e.splitPosition)&&i.range.containsPosition(e.splitPosition)){const t=i.clone();return t.range=new _(e.moveTargetPosition.clone(),i.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),i.range.end=e.splitPosition.clone(),i.range.end.stickiness="toPrevious",[i,t]}return i.range=i.range._getTransformedBySplitOperation(e),[i]});L(fe,oe,(i,e)=>{const t=[i];if(i.shouldReceiveAttributes&&i.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(i.position)){const n=Ah(i,e.key,e.newValue);n&&t.push(n)}return t});L(fe,fe,(i,e,t)=>i.position.isEqual(e.position)&&t.aIsStrong?[i]:(i.position=i.position._getTransformedByInsertOperation(e),[i]));L(fe,H,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i]));L(fe,G,(i,e)=>(i.position=i.position._getTransformedBySplitOperation(e),[i]));L(fe,ie,(i,e)=>(i.position=i.position._getTransformedByMergeOperation(e),[i]));L(Ee,fe,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByInsertOperation(e)[0]),i.newRange&&(i.newRange=i.newRange._getTransformedByInsertOperation(e)[0]),[i]));L(Ee,Ee,(i,e,t)=>{if(i.name==e.name)if(t.aIsStrong)i.oldRange=e.newRange?e.newRange.clone():null;else return[new ce(0)];return[i]});L(Ee,ie,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByMergeOperation(e)),i.newRange&&(i.newRange=i.newRange._getTransformedByMergeOperation(e)),[i]));L(Ee,H,(i,e,t)=>{if(i.oldRange&&(i.oldRange=_._createFromRanges(i.oldRange._getTransformedByMoveOperation(e))),i.newRange){if(t.abRelation){const n=_._createFromRanges(i.newRange._getTransformedByMoveOperation(e));if(t.abRelation.side=="left"&&e.targetPosition.isEqual(i.newRange.start))return i.newRange.end=n.end,i.newRange.start.path=t.abRelation.path,[i];if(t.abRelation.side=="right"&&e.targetPosition.isEqual(i.newRange.end))return i.newRange.start=n.start,i.newRange.end.path=t.abRelation.path,[i]}i.newRange=_._createFromRanges(i.newRange._getTransformedByMoveOperation(e))}return[i]});L(Ee,G,(i,e,t)=>{if(i.oldRange&&(i.oldRange=i.oldRange._getTransformedBySplitOperation(e)),i.newRange){if(t.abRelation){const n=i.newRange._getTransformedBySplitOperation(e);return i.newRange.start.isEqual(e.splitPosition)&&t.abRelation.wasStartBeforeMergedElement?i.newRange.start=y._createAt(e.insertionPosition):i.newRange.start.isEqual(e.splitPosition)&&!t.abRelation.wasInLeftElement&&(i.newRange.start=y._createAt(e.moveTargetPosition)),i.newRange.end.isEqual(e.splitPosition)&&t.abRelation.wasInRightElement?i.newRange.end=y._createAt(e.moveTargetPosition):i.newRange.end.isEqual(e.splitPosition)&&t.abRelation.wasEndBeforeMergedElement?i.newRange.end=y._createAt(e.insertionPosition):i.newRange.end=n.end,[i]}i.newRange=i.newRange._getTransformedBySplitOperation(e)}return[i]});L(ie,fe,(i,e)=>(i.sourcePosition.hasSameParentAs(e.position)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByInsertOperation(e),i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e),[i]));L(ie,ie,(i,e,t)=>{if(i.sourcePosition.isEqual(e.sourcePosition)&&i.targetPosition.isEqual(e.targetPosition))if(t.bWasUndone){const n=e.graveyardPosition.path.slice();return n.push(0),i.sourcePosition=new y(e.graveyardPosition.root,n),i.howMany=0,[i]}else return[new ce(0)];if(i.sourcePosition.isEqual(e.sourcePosition)&&!i.targetPosition.isEqual(e.targetPosition)&&!t.bWasUndone&&t.abRelation!="splitAtSource"){const n=i.targetPosition.root.rootName=="$graveyard",s=e.targetPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const l=e.targetPosition._getTransformedByMergeOperation(e),c=i.targetPosition._getTransformedByMergeOperation(e);return[new H(l,i.howMany,c,0)]}else return[new ce(0)]}return i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByMergeOperation(e),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),(!i.graveyardPosition.isEqual(e.graveyardPosition)||!t.aIsStrong)&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]});L(ie,H,(i,e,t)=>{const n=_._createFromPositionAndShift(e.sourcePosition,e.howMany);return e.type=="remove"&&!t.bWasUndone&&!t.forceWeakRemove&&i.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.sourcePosition)?[new ce(0)]:(i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition.hasSameParentAs(e.sourcePosition)&&(i.howMany-=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByMoveOperation(e),i.targetPosition=i.targetPosition._getTransformedByMoveOperation(e),i.graveyardPosition.isEqual(e.targetPosition)||(i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)),[i])});L(ie,G,(i,e,t)=>{if(e.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),i.deletionPosition.isEqual(e.graveyardPosition)&&(i.howMany=e.howMany)),i.targetPosition.isEqual(e.splitPosition)){const n=e.howMany!=0,s=e.graveyardPosition&&i.deletionPosition.isEqual(e.graveyardPosition);if(n||s||t.abRelation=="mergeTargetNotMoved")return i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),[i]}if(i.sourcePosition.isEqual(e.splitPosition)){if(t.abRelation=="mergeSourceNotMoved")return i.howMany=0,i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i];if(t.abRelation=="mergeSameElement"||i.sourcePosition.offset>0)return i.sourcePosition=e.moveTargetPosition.clone(),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]}return i.sourcePosition.hasSameParentAs(e.splitPosition)&&(i.howMany=e.splitPosition.offset),i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]});L(H,fe,(i,e)=>{const n=_._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByInsertOperation(e,!1)[0];return i.sourcePosition=n.start,i.howMany=n.end.offset-n.start.offset,i.targetPosition.isEqual(e.position)||(i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e)),[i]});L(H,H,(i,e,t)=>{const n=_._createFromPositionAndShift(i.sourcePosition,i.howMany),s=_._createFromPositionAndShift(e.sourcePosition,e.howMany);let o=t.aIsStrong,r=!t.aIsStrong;t.abRelation=="insertBefore"||t.baRelation=="insertAfter"?r=!0:(t.abRelation=="insertAfter"||t.baRelation=="insertBefore")&&(r=!1);let a;if(i.targetPosition.isEqual(e.targetPosition)&&r?a=i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):a=i.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Ml(i,e)&&Ml(e,i))return[e.getReversed()];if(n.containsPosition(e.targetPosition)&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Rn([n],a);if(s.containsPosition(i.targetPosition)&&s.containsRange(n,!0))return n.start=n.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),n.end=n.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),Rn([n],a);const d=Ce(i.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if(d=="prefix"||d=="extension")return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Rn([n],a);i.type=="remove"&&e.type!="remove"&&!t.aWasUndone&&!t.forceWeakRemove?o=!0:i.type!="remove"&&e.type=="remove"&&!t.bWasUndone&&!t.forceWeakRemove&&(o=!1);const u=[],h=n.getDifference(s);for(const f of h){f.start=f.start._getTransformedByDeletion(e.sourcePosition,e.howMany),f.end=f.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const p=Ce(f.start.getParentPath(),e.getMovedRangeStart().getParentPath())=="same",w=f._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,p);u.push(...w)}const m=n.getIntersection(s);return m!==null&&o&&(m.start=m.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),m.end=m.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),u.length===0?u.push(m):u.length==1?s.start.isBefore(n.start)||s.start.isEqual(n.start)?u.unshift(m):u.push(m):u.splice(1,0,m)),u.length===0?[new ce(i.baseVersion)]:Rn(u,a)});L(H,G,(i,e,t)=>{let n=i.targetPosition.clone();(!i.targetPosition.isEqual(e.insertionPosition)||!e.graveyardPosition||t.abRelation=="moveTargetAfter")&&(n=i.targetPosition._getTransformedBySplitOperation(e));const s=_._createFromPositionAndShift(i.sourcePosition,i.howMany);if(s.end.isEqual(e.insertionPosition))return e.graveyardPosition||i.howMany++,i.targetPosition=n,[i];if(s.start.hasSameParentAs(e.splitPosition)&&s.containsPosition(e.splitPosition)){let a=new _(e.splitPosition,s.end);a=a._getTransformedBySplitOperation(e);const l=[new _(s.start,e.splitPosition),a];return Rn(l,n)}i.targetPosition.isEqual(e.splitPosition)&&t.abRelation=="insertAtSource"&&(n=e.moveTargetPosition),i.targetPosition.isEqual(e.insertionPosition)&&t.abRelation=="insertBetween"&&(n=i.targetPosition);const r=[s._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const a=s.start.isEqual(e.graveyardPosition)||s.containsPosition(e.graveyardPosition);i.howMany>1&&a&&!t.aWasUndone&&r.push(_._createFromPositionAndShift(e.insertionPosition,1))}return Rn(r,n)});L(H,ie,(i,e,t)=>{const n=_._createFromPositionAndShift(i.sourcePosition,i.howMany);if(e.deletionPosition.hasSameParentAs(i.sourcePosition)&&n.containsPosition(e.sourcePosition)){if(i.type=="remove"&&!t.forceWeakRemove){if(!t.aWasUndone){const r=[];let a=e.graveyardPosition.clone(),l=e.targetPosition._getTransformedByMergeOperation(e);i.howMany>1&&(r.push(new H(i.sourcePosition,i.howMany-1,i.targetPosition,0)),a=a._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1),l=l._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1));const c=e.deletionPosition._getCombined(i.sourcePosition,i.targetPosition),d=new H(a,1,c,0),u=d.getMovedRangeStart().path.slice();u.push(0);const h=new y(d.targetPosition.root,u);l=l._getTransformedByMove(a,c,1);const m=new H(l,e.howMany,h,0);return r.push(d),r.push(m),r}}else if(i.howMany==1)return t.bWasUndone?(i.sourcePosition=e.graveyardPosition.clone(),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]):[new ce(0)]}const o=_._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByMergeOperation(e);return i.sourcePosition=o.start,i.howMany=o.end.offset-o.start.offset,i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]});L(Te,fe,(i,e)=>(i.position=i.position._getTransformedByInsertOperation(e),[i]));L(Te,ie,(i,e)=>i.position.isEqual(e.deletionPosition)?(i.position=e.graveyardPosition.clone(),i.position.stickiness="toNext",[i]):(i.position=i.position._getTransformedByMergeOperation(e),[i]));L(Te,H,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i]));L(Te,Te,(i,e,t)=>{if(i.position.isEqual(e.position))if(t.aIsStrong)i.oldName=e.newName;else return[new ce(0)];return[i]});L(Te,G,(i,e)=>{const t=i.position.path,n=e.splitPosition.getParentPath();if(Ce(t,n)=="same"&&!e.graveyardPosition){const s=new Te(i.position.getShiftedBy(1),i.oldName,i.newName,0);return[i,s]}return i.position=i.position._getTransformedBySplitOperation(e),[i]});L(pt,pt,(i,e,t)=>{if(i.root===e.root&&i.key===e.key){if(!t.aIsStrong||i.newValue===e.newValue)return[new ce(0)];i.oldValue=e.newValue}return[i]});L(it,it,(i,e)=>i.rootName===e.rootName&&i.isAdd===e.isAdd?[new ce(0)]:[i]);L(G,fe,(i,e)=>(i.splitPosition.hasSameParentAs(e.position)&&i.splitPosition.offset<e.position.offset&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByInsertOperation(e),i.insertionPosition=i.insertionPosition._getTransformedByInsertOperation(e),[i]));L(G,ie,(i,e,t)=>{if(!i.graveyardPosition&&!t.bWasUndone&&i.splitPosition.hasSameParentAs(e.sourcePosition)){const n=e.graveyardPosition.path.slice();n.push(0);const s=new y(e.graveyardPosition.root,n),o=G.getInsertionPosition(new y(e.graveyardPosition.root,n)),r=new G(s,0,o,null,0);return i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=G.getInsertionPosition(i.splitPosition),i.graveyardPosition=r.insertionPosition.clone(),i.graveyardPosition.stickiness="toNext",[r,i]}return i.splitPosition.hasSameParentAs(e.deletionPosition)&&!i.splitPosition.isAfter(e.deletionPosition)&&i.howMany--,i.splitPosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=G.getInsertionPosition(i.splitPosition),i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]});L(G,H,(i,e,t)=>{const n=_._createFromPositionAndShift(e.sourcePosition,e.howMany);if(i.graveyardPosition){const o=n.start.isEqual(i.graveyardPosition)||n.containsPosition(i.graveyardPosition);if(!t.bWasUndone&&o){const r=i.splitPosition._getTransformedByMoveOperation(e),a=i.graveyardPosition._getTransformedByMoveOperation(e),l=a.path.slice();l.push(0);const c=new y(a.root,l);return[new H(r,i.howMany,c,0)]}i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)}const s=i.splitPosition.isEqual(e.targetPosition);if(s&&(t.baRelation=="insertAtSource"||t.abRelation=="splitBefore"))return i.howMany+=e.howMany,i.splitPosition=i.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),i.insertionPosition=G.getInsertionPosition(i.splitPosition),[i];if(s&&t.abRelation&&t.abRelation.howMany){const{howMany:o,offset:r}=t.abRelation;return i.howMany+=o,i.splitPosition=i.splitPosition.getShiftedBy(r),[i]}if(i.splitPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.splitPosition)){const o=e.howMany-(i.splitPosition.offset-e.sourcePosition.offset);return i.howMany-=o,i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany),i.splitPosition=e.sourcePosition.clone(),i.insertionPosition=G.getInsertionPosition(i.splitPosition),[i]}return e.sourcePosition.isEqual(e.targetPosition)||(i.splitPosition.hasSameParentAs(e.sourcePosition)&&i.splitPosition.offset<=e.sourcePosition.offset&&(i.howMany-=e.howMany),i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany)),i.splitPosition.stickiness="toNone",i.splitPosition=i.splitPosition._getTransformedByMoveOperation(e),i.splitPosition.stickiness="toNext",i.graveyardPosition?i.insertionPosition=i.insertionPosition._getTransformedByMoveOperation(e):i.insertionPosition=G.getInsertionPosition(i.splitPosition),[i]});L(G,G,(i,e,t)=>{if(i.splitPosition.isEqual(e.splitPosition)){if(!i.graveyardPosition&&!e.graveyardPosition)return[new ce(0)];if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition))return[new ce(0)];if(t.abRelation=="splitBefore")return i.howMany=0,i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e),[i]}if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition)){const n=i.splitPosition.root.rootName=="$graveyard",s=e.splitPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const l=[];return e.howMany&&l.push(new H(e.moveTargetPosition,e.howMany,e.splitPosition,0)),i.howMany&&l.push(new H(i.splitPosition,i.howMany,i.moveTargetPosition,0)),l}else return[new ce(0)]}if(i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e)),i.splitPosition.isEqual(e.insertionPosition)&&t.abRelation=="splitBefore")return i.howMany++,[i];if(e.splitPosition.isEqual(i.insertionPosition)&&t.baRelation=="splitBefore"){const n=e.insertionPosition.path.slice();n.push(0);const s=new y(e.insertionPosition.root,n),o=new H(i.insertionPosition,1,s,0);return[i,o]}return i.splitPosition.hasSameParentAs(e.splitPosition)&&i.splitPosition.offset<e.splitPosition.offset&&(i.howMany-=e.howMany),i.splitPosition=i.splitPosition._getTransformedBySplitOperation(e),i.insertionPosition=G.getInsertionPosition(i.splitPosition),[i]});function Ml(i,e){return i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)===null}function Rn(i,e){const t=[];for(let n=0;n<i.length;n++){const s=i[n],o=new H(s.start,s.end.offset-s.start.offset,e,0);t.push(o);for(let r=n+1;r<i.length;r++)i[r]=i[r]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];e=e._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ae extends J(y){constructor(e,t,n="toNone"){if(super(e,t,n),!this.root.is("rootElement"))throw new g("model-liveposition-root-not-rootelement",e);_1.call(this)}detach(){this.stopListening()}toPosition(){return new y(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}ae.prototype.is=function(i){return i==="livePosition"||i==="model:livePosition"||i=="position"||i==="model:position"};function _1(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&v1.call(this,t)},{priority:"low"})}function v1(i){const e=this.getTransformedByOperation(i);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wn{constructor(e={}){typeof e=="string"&&(e=e==="transparent"?{isUndoable:!1}:{},K("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:n=!0,isUndo:s=!1,isTyping:o=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=n,this.isUndo=s,this.isTyping=o}get type(){return K("batch-type-deprecated"),"default"}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class y1{constructor(e){this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changedRoots=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null,this._refreshedItems=new Set,this._markerCollection=e}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(e){const t=e;switch(t.type){case"insert":{if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const n of t.range.getItems({shallow:!0}))this._isInInsertedElement(n.parent)||this._markAttribute(n);break}case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const n=this._isInInsertedElement(t.sourcePosition.parent),s=this._isInInsertedElement(t.targetPosition.parent);n||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),s||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const n=_._createFromPositionAndShift(t.position,1);for(const s of this._markerCollection.getMarkersIntersectingRange(n)){const o=s.getData();this.bufferMarkerChange(s.name,o,o)}break}case"split":{const n=t.splitPosition.parent;this._isInInsertedElement(n)||this._markRemove(n,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break}case"merge":{const n=t.sourcePosition.parent;this._isInInsertedElement(n.parent)||this._markRemove(n.parent,n.startOffset,1);const s=t.graveyardPosition.parent;this._markInsert(s,t.graveyardPosition.offset,1);const o=t.targetPosition.parent;this._isInInsertedElement(o)||this._markInsert(o,t.targetPosition.offset,n.maxOffset);break}case"detachRoot":case"addRoot":{const n=t.affectedSelectable;if(!n._isLoaded||n.isAttached()==t.isAdd)return;this._bufferRootStateChange(t.rootName,t.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!t.root._isLoaded)return;const n=t.root.rootName;this._bufferRootAttributeChange(n,t.key,t.oldValue,t.newValue);break}}this._cachedChanges=null}bufferMarkerChange(e,t,n){t.range&&t.range.root.is("rootElement")&&!t.range.root._isLoaded&&(t.range=null),n.range&&n.range.root.is("rootElement")&&!n.range.root._isLoaded&&(n.range=null);let s=this._changedMarkers.get(e);s?s.newMarkerData=n:(s={newMarkerData:n,oldMarkerData:t},this._changedMarkers.set(e,s)),s.oldMarkerData.range==null&&n.range==null&&this._changedMarkers.delete(e)}getMarkersToRemove(){const e=[];for(const[t,n]of this._changedMarkers)n.oldMarkerData.range!=null&&e.push({name:t,range:n.oldMarkerData.range});return e}getMarkersToAdd(){const e=[];for(const[t,n]of this._changedMarkers)n.newMarkerData.range!=null&&e.push({name:t,range:n.newMarkerData.range});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(([e,t])=>({name:e,data:{oldRange:t.oldMarkerData.range,newRange:t.newMarkerData.range}}))}hasDataChanges(){if(this._changesInElement.size>0||this._changedRoots.size>0)return!0;for(const{newMarkerData:e,oldMarkerData:t}of this._changedMarkers.values()){if(e.affectsData!==t.affectsData)return!0;if(e.affectsData){const n=e.range&&!t.range,s=!e.range&&t.range,o=e.range&&t.range&&!e.range.isEqual(t.range);if(n||s||o)return!0}}return!1}getChanges(e={}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const n of this._changesInElement.keys()){const s=this._changesInElement.get(n).sort((d,u)=>d.offset===u.offset?d.type!=u.type?d.type=="remove"?-1:1:0:d.offset<u.offset?-1:1),o=this._elementSnapshots.get(n),r=Ol(n.getChildren()),a=C1(o.length,s);let l=0,c=0;for(const d of a)if(d==="i")t.push(this._getInsertDiff(n,l,r[l])),l++;else if(d==="r")t.push(this._getRemoveDiff(n,l,o[c])),c++;else if(d==="a"){const u=r[l].attributes,h=o[c].attributes;let m;if(r[l].name=="$text")m=new _(y._createAt(n,l),y._createAt(n,l+1));else{const f=n.offsetToIndex(l);m=new _(y._createAt(n,l),y._createAt(n.getChild(f),0))}t.push(...this._getAttributesDiff(m,h,u)),l++,c++}else l++,c++}t.sort((n,s)=>n.position.root!=s.position.root?n.position.root.rootName<s.position.root.rootName?-1:1:n.position.isEqual(s.position)?n.changeCount-s.changeCount:n.position.isBefore(s.position)?-1:1);for(let n=1,s=0;n<t.length;n++){const o=t[s],r=t[n],a=o.type=="remove"&&r.type=="remove"&&o.name=="$text"&&r.name=="$text"&&o.position.isEqual(r.position),l=o.type=="insert"&&r.type=="insert"&&o.name=="$text"&&r.name=="$text"&&o.position.parent==r.position.parent&&o.position.offset+o.length==r.position.offset,c=o.type=="attribute"&&r.type=="attribute"&&o.position.parent==r.position.parent&&o.range.isFlat&&r.range.isFlat&&o.position.offset+o.length==r.position.offset&&o.attributeKey==r.attributeKey&&o.attributeOldValue==r.attributeOldValue&&o.attributeNewValue==r.attributeNewValue;a||l||c?(o.length++,c&&(o.range.end=o.range.end.getShiftedBy(1)),t[n]=null):s=n}t=t.filter(n=>n);for(const n of t)delete n.changeCount,n.type=="attribute"&&(delete n.position,delete n.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t,this._cachedChanges=t.filter(k1),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(e=>{const t={...e};return t.state!==void 0&&delete t.attributes,t})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems=new Set,this._cachedChanges=null}_bufferRootStateChange(e,t){if(!this._changedRoots.has(e)){this._changedRoots.set(e,{name:e,state:t?"attached":"detached"});return}const n=this._changedRoots.get(e);n.state!==void 0?(delete n.state,n.attributes===void 0&&this._changedRoots.delete(e)):n.state=t?"attached":"detached"}_bufferRootAttributeChange(e,t,n,s){const o=this._changedRoots.get(e)||{name:e},r=o.attributes||{};if(r[t]){const a=r[t];s===a.oldValue?delete r[t]:a.newValue=s}else r[t]={oldValue:n,newValue:s};Object.entries(r).length===0?(delete o.attributes,o.state===void 0&&this._changedRoots.delete(e)):(o.attributes=r,this._changedRoots.set(e,o))}_refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e);const t=_._createOn(e);for(const n of this._markerCollection.getMarkersIntersectingRange(t)){const s=n.getData();this.bufferMarkerChange(n.name,s,s)}this._cachedChanges=null}_bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);for(const t of e.getAttributeKeys())this._bufferRootAttributeChange(e.rootName,t,null,e.getAttribute(t));for(const t of this._markerCollection)if(t.getRange().root==e){const n=t.getData();this.bufferMarkerChange(t.name,{...n,range:null},n)}}}_markInsert(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"insert",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s)}_markRemove(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"remove",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s),this._removeAllNestedChanges(e,t,n)}_markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const n=this._getChangesForElement(e);this._handleChange(t,n),n.push(t);for(let s=0;s<n.length;s++)n[s].howMany<1&&(n.splice(s,1),s--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,Ol(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const n of t){const s=e.offset+e.howMany,o=n.offset+n.howMany;if(e.type=="insert"&&(n.type=="insert"&&(e.offset<=n.offset?n.offset+=e.howMany:e.offset<o&&(n.howMany+=e.nodesToHandle,e.nodesToHandle=0)),n.type=="remove"&&e.offset<n.offset&&(n.offset+=e.howMany),n.type=="attribute")){if(e.offset<=n.offset)n.offset+=e.howMany;else if(e.offset<o){const r=n.howMany;n.howMany=e.offset-n.offset,t.unshift({type:"attribute",offset:s,howMany:r-n.howMany,count:this._changeCount++})}}if(e.type=="remove"){if(n.type=="insert"){if(s<=n.offset)n.offset-=e.howMany;else if(s<=o)if(e.offset<n.offset){const r=s-n.offset;n.offset=e.offset,n.howMany-=r,e.nodesToHandle-=r}else n.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=n.offset)e.nodesToHandle-=n.howMany,n.howMany=0;else if(e.offset<o){const r=o-e.offset;n.howMany-=r,e.nodesToHandle-=r}}if(n.type=="remove"&&(s<=n.offset?n.offset-=e.howMany:e.offset<n.offset&&(e.nodesToHandle+=n.howMany,n.howMany=0)),n.type=="attribute"){if(s<=n.offset)n.offset-=e.howMany;else if(e.offset<n.offset){const r=s-n.offset;n.offset=e.offset,n.howMany-=r}else if(e.offset<o)if(s<=o){const r=n.howMany;n.howMany=e.offset-n.offset;const a=r-n.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:a,count:this._changeCount++})}else n.howMany-=o-e.offset}}if(e.type=="attribute"){if(n.type=="insert")if(e.offset<n.offset&&s>n.offset){if(s>o){const r={type:"attribute",offset:o,howMany:s-o,count:this._changeCount++};this._handleChange(r,t),t.push(r)}e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=n.offset&&e.offset<o&&(s>o?(e.nodesToHandle=s-o,e.offset=o):e.nodesToHandle=0);if(n.type=="remove"&&e.offset<n.offset&&s>n.offset){const r={type:"attribute",offset:n.offset,howMany:s-n.offset,count:this._changeCount++};this._handleChange(r,t),t.push(r),e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}n.type=="attribute"&&(e.offset>=n.offset&&s<=o?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=n.offset&&s>=o&&(n.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,n){return{type:"insert",position:y._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,n){return{type:"remove",position:y._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,n){const s=[];n=new Map(n);for(const[o,r]of t){const a=n.has(o)?n.get(o):null;a!==r&&s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:r,attributeNewValue:a,changeCount:this._changeCount++}),n.delete(o)}for(const[o,r]of n)s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:r,changeCount:this._changeCount++});return s}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const n=this._changesInElement.get(t),s=e.startOffset;if(n){for(const o of n)if(o.type=="insert"&&s>=o.offset&&s<o.offset+o.howMany)return!0}return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,n){const s=new _(y._createAt(e,t),y._createAt(e,t+n));for(const o of s.getItems({shallow:!0}))o.is("element")&&(this._elementSnapshots.delete(o),this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}}function Ol(i){const e=[];for(const t of i)if(t.is("$text"))for(let n=0;n<t.data.length;n++)e.push({name:"$text",attributes:new Map(t.getAttributes())});else e.push({name:t.name,attributes:new Map(t.getAttributes())});return e}function C1(i,e){const t=[];let n=0,s=0;for(const o of e){if(o.offset>n){for(let r=0;r<o.offset-n;r++)t.push("e");s+=o.offset-n}if(o.type=="insert"){for(let r=0;r<o.howMany;r++)t.push("i");n=o.offset+o.howMany}else if(o.type=="remove"){for(let r=0;r<o.howMany;r++)t.push("r");n=o.offset,s+=o.howMany}else t.push(..."a".repeat(o.howMany).split("")),n=o.offset+o.howMany,s+=o.howMany}if(s<i)for(let o=0;o<i-s-n;o++)t.push("e");return t}function k1(i){const e="position"in i&&i.position.root.rootName=="$graveyard",t="range"in i&&i.range.root.rootName=="$graveyard";return!e&&!t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class A1{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set,this._baseVersionToOperationIndex=new Map,this._version=0,this._gaps=new Map}get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new g("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const n=this._operations[0];e===void 0&&(e=n.baseVersion);let s=t-1;for(const[a,l]of this._gaps)e>a&&e<l&&(e=l),s>a&&s<l&&(s=a-1);if(s<n.baseVersion||e>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(e);o===void 0&&(o=0);let r=this._baseVersionToOperationIndex.get(s);return r===void 0&&(r=this._operations.length-1),this._operations.slice(o,r+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(t!==void 0)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xs extends U{constructor(e,t,n="main"){super(t),this._isAttached=!0,this._isLoaded=!0,this._document=e,this.rootName=n}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}xs.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"):i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"||i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Nl="$graveyard";let E1=class extends J(){constructor(e){super(),this.model=e,this.history=new A1,this.selection=new Xe(this),this.roots=new ge({idProperty:"rootName"}),this.differ=new y1(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",Nl),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.differ.bufferOperation(s)},{priority:"high"}),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.history.addOperation(s)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(t,n,s,o,r)=>{const a={...n.getData(),range:o};this.differ.bufferMarkerChange(n.name,r,a),s===null&&n.on("change",(l,c)=>{const d=n.getData();this.differ.bufferMarkerChange(n.name,{...d,range:c},d)})}),this.registerPostFixer(t=>{let n=!1;for(const s of this.roots)!s.isAttached()&&!s.isEmpty&&(t.remove(t.createRangeIn(s)),n=!0);for(const s of this.model.markers)s.getRange().root.isAttached()||(t.removeMarker(s),n=!0);return n})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(Nl)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new g("model-document-createroot-name-exists",this,{name:t});const n=new xs(this,e,t);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(t=>t.rootName)}getRoots(e=!1){return Array.from(this.roots).filter(t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=Jd(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,n=t.schema,s=t.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(s)||t.createRange(s)}_validateSelectionRange(e){return Fl(e.start)&&Fl(e.end)}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(this.selection.refresh(),t=n(e),t)break;while(t)}};function Fl(i){const e=i.textNode;if(e){const t=e.data,n=i.offset-e.startOffset;return!Dr(t,n)&&!zr(t,n)}return!0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class T1 extends J(){constructor(){super(...arguments),this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Sn?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,n=!1,s=!1){const o=e instanceof Sn?e.name:e;if(o.includes(","))throw new g("markercollection-incorrect-marker-name",this);const r=this._markers.get(o);if(r){const c=r.getData(),d=r.getRange();let u=!1;return d.isEqual(t)||(r._attachLiveRange($e.fromRange(t)),u=!0),n!=r.managedUsingOperations&&(r._managedUsingOperations=n,u=!0),typeof s=="boolean"&&s!=r.affectsData&&(r._affectsData=s,u=!0),u&&this.fire(`update:${o}`,r,d,t,c),r}const a=$e.fromRange(t),l=new Sn(o,a,n,s);return this._markers.set(o,l),this.fire(`update:${o}`,l,null,t,{...l.getData(),range:null}),l}_remove(e){const t=e instanceof Sn?e.name:e,n=this._markers.get(t);return n?(this._markers.delete(t),this.fire(`update:${t}`,n,n.getRange(),null,n.getData()),this._destroyMarker(n),!0):!1}_refresh(e){const t=e instanceof Sn?e.name:e,n=this._markers.get(t);if(!n)throw new g("markercollection-refresh-marker-not-exists",this);const s=n.getRange();this.fire(`update:${t}`,n,s,s,n.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)t.getRange().getIntersection(e)!==null&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class Sn extends J(Dt){constructor(e,t,n,s){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=n,this._affectsData=s}get managedUsingOperations(){if(!this._liveRange)throw new g("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new g("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new g("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new g("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new g("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}Sn.prototype.is=function(i){return i==="marker"||i==="model:marker"};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class S1 extends Ne{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new g("detach-operation-on-document-node",this)}_execute(){yh(_._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ft extends Dt{constructor(e){super(),this.markers=new Map,this._children=new ai,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const n of e)n.name?t.push(U.fromJSON(n)):t.push(j.fromJSON(n));return new ft(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=x1(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}}ft.prototype.is=function(i){return i==="documentFragment"||i==="model:documentFragment"};function x1(i){return typeof i=="string"?[new j(i)]:(Me(i)||(i=[i]),Array.from(i).map(e=>typeof e=="string"?new j(e):e instanceof Qe?new j(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P1{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new j(e,t)}createElement(e,t){return new U(e,t)}createDocumentFragment(){return new ft}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,n=0){if(this._assertWriterUsedCorrectly(),e instanceof j&&e.data=="")return;const s=y._createAt(t,n);if(e.parent)if(zl(e.root,s.root)){this.move(_._createOn(e),s);return}else{if(e.root.document)throw new g("model-writer-insert-forbidden-move",this);this.remove(e)}const o=s.root.document?s.root.document.version:null,r=new fe(s,e,o);if(e instanceof j&&(r.shouldReceiveAttributes=!0),this.batch.addOperation(r),this.model.applyOperation(r),e instanceof ft)for(const[a,l]of e.markers){const c=y._createAt(l.root,0),u={range:new _(l.start._getCombined(c,s),l.end._getCombined(c,s)),usingOperation:!0,affectsData:!0};this.model.markers.has(a)?this.updateMarker(a,u):this.addMarker(a,u)}}insertText(e,t,n,s){t instanceof ft||t instanceof U||t instanceof y?this.insert(this.createText(e),t,n):this.insert(this.createText(e,t),n,s)}insertElement(e,t,n,s){t instanceof ft||t instanceof U||t instanceof y?this.insert(this.createElement(e),t,n):this.insert(this.createElement(e,t),n,s)}append(e,t){this.insert(e,t,"end")}appendText(e,t,n){t instanceof ft||t instanceof U?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),n,"end")}appendElement(e,t,n){t instanceof ft||t instanceof U?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),n,"end")}setAttribute(e,t,n){if(this._assertWriterUsedCorrectly(),n instanceof _){const s=n.getMinimalFlatRanges();for(const o of s)Ll(this,e,t,o)}else Dl(this,e,t,n)}setAttributes(e,t){for(const[n,s]of Mt(e))this.setAttribute(n,s,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof _){const n=t.getMinimalFlatRanges();for(const s of n)Ll(this,e,null,s)}else Dl(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=n=>{for(const s of n.getAttributeKeys())this.removeAttribute(s,n)};if(!(e instanceof _))t(e);else for(const n of e.getItems())t(n)}move(e,t,n){if(this._assertWriterUsedCorrectly(),!(e instanceof _))throw new g("writer-move-invalid-range",this);if(!e.isFlat)throw new g("writer-move-range-not-flat",this);const s=y._createAt(t,n);if(s.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!zl(e.root,s.root))throw new g("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,r=new H(e.start,e.end.offset-e.start.offset,s,o);this.batch.addOperation(r),this.model.applyOperation(r)}remove(e){this._assertWriterUsedCorrectly();const n=(e instanceof _?e:_._createOn(e)).getMinimalFlatRanges().reverse();for(const s of n)this._addOperationForAffectedMarkers("move",s),I1(s.start,s.end.offset-s.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,n=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof U))throw new g("writer-merge-no-element-before",this);if(!(n instanceof U))throw new g("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,n){return this.model.createPositionFromPath(e,t,n)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,n=e.nodeAfter;this.move(_._createIn(n),y._createAt(t,"end")),this.remove(n)}_merge(e){const t=y._createAt(e.nodeBefore,"end"),n=y._createAt(e.nodeAfter,0),s=e.root.document.graveyard,o=new y(s,[0]),r=e.root.document.version,a=new ie(n,e.nodeAfter.maxOffset,t,o,r);this.batch.addOperation(a),this.model.applyOperation(a)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof U))throw new g("writer-rename-not-element-instance",this);const n=e.root.document?e.root.document.version:null,s=new Te(y._createBefore(e),e.name,t,n);this.batch.addOperation(s),this.model.applyOperation(s)}split(e,t){this._assertWriterUsedCorrectly();let n=e.parent;if(!n.parent)throw new g("writer-split-element-no-parent",this);if(t||(t=n.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new g("writer-split-invalid-limit-element",this);let s,o;do{const r=n.root.document?n.root.document.version:null,a=n.maxOffset-e.offset,l=G.getInsertionPosition(e),c=new G(e,a,l,null,r);this.batch.addOperation(c),this.model.applyOperation(c),!s&&!o&&(s=n,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),n=e.parent}while(n!==t);return{position:e,range:new _(y._createAt(s,"end"),y._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new g("writer-wrap-range-not-flat",this);const n=t instanceof U?t:new U(t);if(n.childCount>0)throw new g("writer-wrap-element-not-empty",this);if(n.parent!==null)throw new g("writer-wrap-element-attached",this);this.insert(n,e.start);const s=new _(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(s,y._createAt(n,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new g("writer-unwrap-element-no-parent",this);this.move(_._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||typeof t.usingOperation!="boolean")throw new g("writer-addmarker-no-usingoperation",this);const n=t.usingOperation,s=t.range,o=t.affectsData===void 0?!1:t.affectsData;if(this.model.markers.has(e))throw new g("writer-addmarker-marker-exists",this);if(!s)throw new g("writer-addmarker-no-range",this);return n?(Yn(this,e,null,s,o),this.model.markers.get(e)):this.model.markers._set(e,s,n,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const n=typeof e=="string"?e:e.name,s=this.model.markers.get(n);if(!s)throw new g("writer-updatemarker-marker-not-exists",this);if(!t){K("writer-updatemarker-reconvert-using-editingcontroller",{markerName:n}),this.model.markers._refresh(s);return}const o=typeof t.usingOperation=="boolean",r=typeof t.affectsData=="boolean",a=r?t.affectsData:s.affectsData;if(!o&&!t.range&&!r)throw new g("writer-updatemarker-wrong-options",this);const l=s.getRange(),c=t.range?t.range:l;if(o&&t.usingOperation!==s.managedUsingOperations){t.usingOperation?Yn(this,n,null,c,a):(Yn(this,n,l,null,a),this.model.markers._set(n,c,void 0,a));return}s.managedUsingOperations?Yn(this,n,l,c,a):this.model.markers._set(n,c,void 0,a)}removeMarker(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?e:e.name;if(!this.model.markers.has(t))throw new g("writer-removemarker-no-marker",this);const n=this.model.markers.get(t);if(!n.managedUsingOperations){this.model.markers._remove(t);return}const s=n.getRange();Yn(this,t,s,null,n.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const n=this.model.document.getRoot(e);if(n&&n.isAttached())throw new g("writer-addroot-root-exists",this);const s=this.model.document,o=new it(e,t,!0,s,s.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new g("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===t&&this.removeMarker(o);for(const o of t.getAttributeKeys())this.removeAttribute(o,t);this.remove(this.createRangeIn(t));const n=this.model.document,s=new it(t.rootName,t.name,!1,n,n.version);this.batch.addOperation(s),this.model.applyOperation(s)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,t);else for(const[n,s]of Mt(e))this._setSelectionAttribute(n,s)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const s=Xe._getStoreAttributeKey(e);this.setAttribute(s,t,n.anchor.parent)}n._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const n=Xe._getStoreAttributeKey(e);this.removeAttribute(n,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new g("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const s=n.getRange();let o=!1;if(e==="move"){const r=t;o=r.containsPosition(s.start)||r.start.isEqual(s.start)||r.containsPosition(s.end)||r.end.isEqual(s.end)}else{const r=t,a=r.nodeBefore,l=r.nodeAfter,c=s.start.parent==a&&s.start.isAtEnd,d=s.end.parent==l&&s.end.offset==0,u=s.end.nodeAfter==l,h=s.start.nodeAfter==l;o=c||d||u||h}o&&this.updateMarker(n.name,{range:s})}}}function Ll(i,e,t,n){const s=i.model,o=s.document;let r=n.start,a,l,c;for(const u of n.getWalker({shallow:!0}))c=u.item.getAttribute(e),a&&l!=c&&(l!=t&&d(),r=a),a=u.nextPosition,l=c;a instanceof y&&a!=r&&l!=t&&d();function d(){const u=new _(r,a),h=u.root.document?o.version:null,m=new oe(u,e,l,t,h);i.batch.addOperation(m),s.applyOperation(m)}}function Dl(i,e,t,n){const s=i.model,o=s.document,r=n.getAttribute(e);let a,l;if(r!=t){if(n.root===n){const d=n.document?o.version:null;l=new pt(n,e,r,t,d)}else{a=new _(y._createBefore(n),i.createPositionAfter(n));const d=a.root.document?o.version:null;l=new oe(a,e,r,t,d)}i.batch.addOperation(l),s.applyOperation(l)}}function Yn(i,e,t,n,s){const o=i.model,r=o.document,a=new Ee(e,t,n,o.markers,!!s,r.version);i.batch.addOperation(a),o.applyOperation(a)}function I1(i,e,t,n){let s;if(i.root.document){const o=n.document,r=new y(o.graveyard,[0]);s=new H(i,e,r,o.version)}else s=new S1(i,e);t.addOperation(s),n.applyOperation(s)}function zl(i,e){return i===e||i instanceof xs&&e instanceof xs}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function R1(i,e,t={}){if(e.isCollapsed)return;const n=e.getFirstRange();if(n.root.rootName=="$graveyard")return;const s=i.schema;i.change(o=>{if(!t.doNotResetEntireContent&&z1(s,e)){D1(o,e);return}const r={};if(!t.doNotAutoparagraph){const c=e.getSelectedElement();c&&Object.assign(r,s.getAttributesWithProperty(c,"copyOnReplace",!0))}const[a,l]=V1(n);a.isTouching(l)||o.remove(o.createRange(a,l)),t.leaveUnmerged||(M1(o,a,l),s.removeDisallowedAttributes(a.parent.getChildren(),o)),xh(o,e,a),!t.doNotAutoparagraph&&F1(s,a)&&Sh(o,a,e,r),a.detach(),l.detach()})}function V1(i){const e=i.root.document.model,t=i.start;let n=i.end;if(e.hasContent(i,{ignoreMarkers:!0})){const s=B1(n);if(s&&n.isTouching(e.createPositionAt(s,0))){const o=e.createSelection(i);e.modifySelection(o,{direction:"backward"});const r=o.getLastPosition(),a=e.createRange(r,n);e.hasContent(a,{ignoreMarkers:!0})||(n=r)}}return[ae.fromPosition(t,"toPrevious"),ae.fromPosition(n,"toNext")]}function B1(i){const e=i.parent,t=e.root.document.model.schema,n=e.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of n){if(t.isLimit(s))return null;if(t.isBlock(s))return s}}function M1(i,e,t){const n=i.model;if(!ta(i.model.schema,e,t))return;const[s,o]=N1(e,t);!s||!o||(!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(o,{ignoreMarkers:!0})?Th(i,e,t,s.parent):Eh(i,e,t,s.parent))}function Eh(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(o,e),i.merge(e);t.parent.isEmpty;){const r=t.parent;t=i.createPositionBefore(r),i.remove(r)}ta(i.model.schema,e,t)&&Eh(i,e,t,n)}}function Th(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(s,t);e.parent.isEmpty;){const r=e.parent;e=i.createPositionBefore(r),i.remove(r)}t=i.createPositionBefore(o),O1(i,t),ta(i.model.schema,e,t)&&Th(i,e,t,n)}}function O1(i,e){const t=e.nodeBefore,n=e.nodeAfter;t.name!=n.name&&i.rename(t,n.name),i.clearAttributes(t),i.setAttributes(Object.fromEntries(n.getAttributes()),t),i.merge(e)}function ta(i,e,t){const n=e.parent,s=t.parent;return n==s||i.isLimit(n)||i.isLimit(s)?!1:L1(e,t,i)}function N1(i,e){const t=i.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]&&t[s]==n[s];)s++;return[t[s],n[s]]}function F1(i,e){const t=i.checkChild(e,"$text"),n=i.checkChild(e,"paragraph");return!t&&n}function L1(i,e,t){const n=new _(i,e);for(const s of n.getWalker())if(t.isLimit(s.item))return!1;return!0}function Sh(i,e,t,n={}){const s=i.createElement("paragraph");i.model.schema.setAllowedAttributes(s,n,i),i.insert(s,e),xh(i,t,i.createPositionAt(s,0))}function D1(i,e){const t=i.model.schema.getLimitElement(e);i.remove(i.createRangeIn(t)),Sh(i,i.createPositionAt(t,0),e)}function z1(i,e){const t=i.getLimitElement(e);if(!e.containsEntireContent(t))return!1;const n=e.getFirstRange();return n.start.parent==n.end.parent?!1:i.checkChild(t,"paragraph")}function xh(i,e,t){e instanceof Xe?i.setSelection(t):e.setTo(t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function H1(i,e){return i.change(t=>{const n=t.createDocumentFragment(),s=e.getFirstRange();if(!s||s.isCollapsed)return n;const o=s.start.root,r=s.start.getCommonPath(s.end),a=o.getNodeByPath(r);let l;s.start.parent==s.end.parent?l=s:l=t.createRange(t.createPositionAt(a,s.start.path[r.length]),t.createPositionAt(a,s.end.path[r.length]+1));const c=l.end.offset-l.start.offset;for(const d of l.getItems({shallow:!0}))d.is("$textProxy")?t.appendText(d.data,d.getAttributes(),n):t.append(t.cloneElement(d,!0),n);if(l!=s){const d=s._getTransformedByMove(l.start,t.createPositionAt(n,0),c)[0],u=t.createRange(t.createPositionAt(n,0),d.start),h=t.createRange(d.end,t.createPositionAt(n,"end"));Hl(h,t),Hl(u,t)}return n})}function Hl(i,e){const t=[];Array.from(i.getItems({direction:"backward"})).map(n=>e.createRangeOn(n)).filter(n=>(n.start.isAfter(i.start)||n.start.isEqual(i.start))&&(n.end.isBefore(i.end)||n.end.isEqual(i.end))).forEach(n=>{t.push(n.start.parent),e.remove(n)}),t.forEach(n=>{let s=n;for(;s.parent&&s.isEmpty;){const o=e.createRangeOn(s);s=s.parent,e.remove(o)}})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function W1(i,e,t){return i.change(n=>{const s=t||i.document.selection;s.isCollapsed||i.deleteContent(s,{doNotAutoparagraph:!0});const o=new $1(i,n,s.anchor),r=[];let a;if(e.is("documentFragment")){if(e.markers.size){const d=[];for(const[u,h]of e.markers){const{start:m,end:f}=h,p=m.isEqual(f);d.push({position:m,name:u,isCollapsed:p},{position:f,name:u,isCollapsed:p})}d.sort(({position:u},{position:h})=>u.isBefore(h)?1:-1);for(const{position:u,name:h,isCollapsed:m}of d){let f=null,p=null;const w=u.parent===e&&u.isAtStart,v=u.parent===e&&u.isAtEnd;!w&&!v?(f=n.createElement("$marker"),n.insert(f,u)):m&&(p=w?"start":"end"),r.push({name:h,element:f,collapsed:p})}}a=e.getChildren()}else a=[e];o.handleNodes(a);let l=o.getSelectionRange();if(e.is("documentFragment")&&r.length){const d=l?$e.fromRange(l):null,u={};for(let h=r.length-1;h>=0;h--){const{name:m,element:f,collapsed:p}=r[h],w=!u[m];if(w&&(u[m]=[]),f){const v=n.createPositionAt(f,"before");u[m].push(v),n.remove(f)}else{const v=o.getAffectedRange();if(!v){p&&u[m].push(o.position);continue}p?u[m].push(v[p]):u[m].push(w?v.start:v.end)}}for(const[h,[m,f]]of Object.entries(u))m&&f&&m.root===f.root&&n.addMarker(h,{usingOperation:!0,affectsData:!0,range:new _(m,f)});d&&(l=d.toRange(),d.detach())}/* istanbul ignore else -- @preserve */l&&(s instanceof Xe?n.setSelection(l):s.setTo(l));const c=o.getAffectedRange()||i.createRange(s.anchor);return o.destroy(),c})}class $1{constructor(e,t,n){this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null,this._nodeToSelect=null,this.model=e,this.writer=t,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),n=this.writer.createPositionAfter(e);if(n.isAfter(t)){this._lastNode=e;/* istanbul ignore if -- @preserve */if(this.position.parent!=e||!this.position.isAtEnd)throw new g("insertcontent-invalid-insertion-position",this);this.position=n,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?_._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new _(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(this.schema.isObject(e)){this._handleObject(e);return}let t=this._checkAndAutoParagraphToAllowedPosition(e);if(!t&&(t=this._checkAndSplitToAllowedPosition(e),!t)){this._handleDisallowedNode(e);return}this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=ae.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,e))throw new g("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=ae.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=ae.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof U)||!this._canMergeLeft(e))return;const t=ae._createBefore(e);t.stickiness="toNext";const n=ae.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=ae._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=ae._createAt(t.nodeBefore,"end","toNext")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof U)||!this._canMergeRight(e))return;const t=ae._createAfter(e);t.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(t))throw new g("insertcontent-invalid-insertion-position",this);this.position=y._createAt(t.nodeBefore,"end");const n=ae.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=ae._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=ae._createAt(t.nodeBefore,0,"toPrevious")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof U&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof U&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,t)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndAutoParagraphToAllowedPosition(e){if(this.schema.checkChild(this.position.parent,e))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",e))return!1;this._insertPartialFragment();const t=this.writer.createElement("paragraph");return this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0),!0}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const n=this.position.parent;this.position=this.writer.createPositionBefore(n),n.isEmpty&&n.parent===t&&this.writer.remove(n)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const n=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=n,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ph(i,e,t="auto"){const n=i.getSelectedElement();if(n&&e.schema.isObject(n)&&!e.schema.isInline(n))return t=="before"||t=="after"?e.createRange(e.createPositionAt(n,t)):e.createRangeOn(n);const s=Q(i.getSelectedBlocks());if(!s)return e.createRange(i.focus);if(s.isEmpty)return e.createRange(e.createPositionAt(s,0));const o=e.createPositionAfter(s);return i.focus.isTouching(o)?e.createRange(o):e.createRange(e.createPositionBefore(s))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function U1(i,e,t,n={}){if(!i.schema.isObject(e))throw new g("insertobject-element-not-an-object",i,{object:e});const s=t||i.document.selection;let o=s;n.findOptimalPosition&&i.schema.isBlock(e)&&(o=i.createSelection(Ph(s,i,n.findOptimalPosition)));const r=Q(s.getSelectedBlocks()),a={};return r&&Object.assign(a,i.schema.getAttributesWithProperty(r,"copyOnReplace",!0)),i.change(l=>{o.isCollapsed||i.deleteContent(o,{doNotAutoparagraph:!0});let c=e;const d=o.anchor.parent;!i.schema.checkChild(d,e)&&i.schema.checkChild(d,"paragraph")&&i.schema.checkChild("paragraph",e)&&(c=l.createElement("paragraph"),l.insert(e,c)),i.schema.setAllowedAttributes(c,a,l);const u=i.insertContent(c,o);return u.isCollapsed||n.setSelection&&q1(l,e,n.setSelection,a),u})}function q1(i,e,t,n){const s=i.model;if(t=="on"){i.setSelection(e,"on");return}if(t!="after")throw new g("insertobject-invalid-place-parameter-value",s);let o=e.nextSibling;if(s.schema.isInline(e)){i.setSelection(e,"after");return}!(o&&s.schema.checkChild(o,"$text"))&&s.schema.checkChild(e.parent,"paragraph")&&(o=i.createElement("paragraph"),s.schema.setAllowedAttributes(o,n,i),s.insertContent(o,i.createPositionAfter(e))),o&&i.setSelection(o,0)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const j1=' ,.?!:;"-()';function G1(i,e,t={}){const n=i.schema,s=t.direction!="backward",o=t.unit?t.unit:"character",r=!!t.treatEmojiAsSingleUnit,a=e.focus,l=new It({boundaries:Y1(a,s),singleCharacters:!0,direction:s?"forward":"backward"}),c={walker:l,schema:n,isForward:s,unit:o,treatEmojiAsSingleUnit:r};let d;for(;d=l.next();){if(d.done)return;const u=K1(c,d.value);if(u){e instanceof Xe?i.change(h=>{h.setSelectionFocus(u)}):e.setFocus(u);return}}}function K1(i,e){const{isForward:t,walker:n,unit:s,schema:o,treatEmojiAsSingleUnit:r}=i,{type:a,item:l,nextPosition:c}=e;if(a=="text")return i.unit==="word"?Q1(n,t):J1(n,s,r);if(a==(t?"elementStart":"elementEnd")){if(o.isSelectable(l))return y._createAt(l,t?"after":"before");if(o.checkChild(c,"$text"))return c}else{if(o.isLimit(l)){n.skip(()=>!0);return}if(o.checkChild(c,"$text"))return c}}function J1(i,e,t){const n=i.position.textNode;if(n){const s=n.data;let o=i.position.offset-n.startOffset;for(;Dr(s,o)||e=="character"&&zr(s,o)||t&&Eu(s,o);)i.next(),o=i.position.offset-n.startOffset}return i.position}function Q1(i,e){let t=i.position.textNode;for(t||(t=e?i.position.nodeAfter:i.position.nodeBefore);t&&t.is("$text");){const n=i.position.offset-t.startOffset;if(Z1(t,n,e))t=e?i.position.nodeAfter:i.position.nodeBefore;else{if(X1(t.data,n,e))break;i.next()}}return i.position}function Y1(i,e){const t=i.root,n=y._createAt(t,e?"end":0);return e?new _(i,n):new _(n,i)}function X1(i,e,t){const n=e+(t?0:-1);return j1.includes(i.charAt(n))}function Z1(i,e,t){return e===(t?i.offsetSize:0)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let e0=class extends $(){constructor(){super(),this.markers=new T1,this.document=new E1(this),this.schema=new Hw,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,t)=>{t[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((e,t)=>{if(t.name==="$marker")return!0}),Vw(this),this.document.registerPostFixer(fh),this.on("insertContent",(e,[t,n])=>{e.return=W1(this,t,n)}),this.on("insertObject",(e,[t,n,s])=>{e.return=U1(this,t,n,s)}),this.on("canEditAt",e=>{const t=!this.document.isReadOnly;e.return=t,t||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new wn,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{e?typeof e=="function"?(t=e,e=new wn):e instanceof wn||(e=new wn(e)):e=new wn,this._pendingChanges.push({batch:e,callback:t}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(n){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(n,this)}}applyOperation(e){e._execute()}insertContent(e,t,n,...s){const o=vo(t,n);return this.fire("insertContent",[e,o,n,...s])}insertObject(e,t,n,s,...o){const r=vo(t,n);return this.fire("insertObject",[e,r,s,s,...o])}deleteContent(e,t){R1(this,e,t)}modifySelection(e,t){G1(this,e,t)}getSelectedContent(e){return H1(this,e)}hasContent(e,t={}){const n=e instanceof _?e:_._createIn(e);if(n.isCollapsed)return!1;const{ignoreWhitespaces:s=!1,ignoreMarkers:o=!1}=t;if(!o){for(const r of this.markers.getMarkersIntersectingRange(n))if(r.affectsData)return!0}for(const r of n.getItems())if(this.schema.isContent(r))if(r.is("$textProxy"))if(s){if(r.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const t=vo(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,n){return new y(e,t,n)}createPositionAt(e,t){return y._createAt(e,t)}createPositionAfter(e){return y._createAfter(e)}createPositionBefore(e){return y._createBefore(e)}createRange(e,t){return new _(e,t)}createRangeIn(e){return _._createIn(e)}createRangeOn(e){return _._createOn(e)}createSelection(...e){return new Ve(...e)}createBatch(e){return new wn(e)}createOperationFromJSON(e){return m1.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new P1(this,t);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function vo(i,e){if(i)return i instanceof Ve||i instanceof Xe?i:i instanceof cn?e||e===0?new Ve(i,e):i.is("rootElement")?new Ve(i,"in"):new Ve(i,"on"):new Ve(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class na extends ln{constructor(){super(...arguments),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ze{constructor(e){this.document=e}createDocumentFragment(e){return new Zt(this.document,e)}createElement(e,t,n){return new Ye(this.document,e,t,n)}createText(e){return new X(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,n){return n._insertChild(e,t)}removeChildren(e,t,n){return n._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const n=e.parent;if(n){const s=n.getChildIndex(e);return this.removeChildren(s,1,n),this.insertChild(s,t,n),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const n=t.getChildIndex(e);this.remove(e),this.insertChild(n,e.getChildren(),t)}}rename(e,t){const n=new Ye(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,n)?n:null}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){De(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return A._createAt(e,t)}createPositionAfter(e){return A._createAfter(e)}createPositionBefore(e){return A._createBefore(e)}createRange(e,t){return new M(e,t)}createRangeOn(e){return M._createOn(e)}createRangeIn(e){return M._createIn(e)}createSelection(...e){return new Ot(...e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const t0=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,n0=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,i0=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,s0=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,o0=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,r0=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,a0=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Ih(i){return i.startsWith("#")?t0.test(i):i.startsWith("rgb")?n0.test(i)||i0.test(i):i.startsWith("hsl")?s0.test(i)||o0.test(i):a0.has(i.toLowerCase())}const l0=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function c0(i){return l0.includes(i)}const d0=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Qs(i){return d0.test(i)}const u0=/^[+-]?[0-9]*([.][0-9]+)?%$/;function Rh(i){return u0.test(i)}const h0=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function m0(i){return h0.includes(i)}const f0=["center","top","bottom","left","right"];function g0(i){return f0.includes(i)}const p0=["fixed","scroll","local"];function b0(i){return p0.includes(i)}const w0=/^url\(/;function _0(i){return w0.test(i)}function di(i=""){if(i==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const e=ia(i),t=e[0],n=e[2]||t,s=e[1]||t,o=e[3]||s;return{top:t,bottom:n,right:s,left:o}}function ui(i){return e=>{const{top:t,right:n,bottom:s,left:o}=e,r=[];return[t,n,o,s].every(a=>!!a)?r.push([i,v0(e)]):(t&&r.push([i+"-top",t]),n&&r.push([i+"-right",n]),s&&r.push([i+"-bottom",s]),o&&r.push([i+"-left",o])),r}}function v0({top:i,right:e,bottom:t,left:n}){const s=[];return n!==e?s.push(i,e,t,n):t!==i?s.push(i,e,t):e!==i?s.push(i,e):s.push(i),s.join(" ")}function Vh(i){return e=>({path:i,value:di(e)})}function ia(i){const e=i.matchAll(r0);return Array.from(e).map(t=>t[0])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function sa(i){i.setNormalizer("background",y0()),i.setNormalizer("background-color",C0()),i.setReducer("background",k0()),i.setStyleRelation("background",["background-color"])}function y0(){return i=>{const e={},t=ia(i);for(const n of t)m0(n)?(e.repeat=e.repeat||[],e.repeat.push(n)):g0(n)?(e.position=e.position||[],e.position.push(n)):b0(n)?e.attachment=n:Ih(n)?e.color=n:_0(n)&&(e.image=n);return{path:"background",value:e}}}function C0(){return i=>({path:"background.color",value:i})}function k0(){return i=>{const e=[];return e.push(["background-color",i.color]),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Bh(i){i.setNormalizer("border",A0()),i.setNormalizer("border-top",Yi("top")),i.setNormalizer("border-right",Yi("right")),i.setNormalizer("border-bottom",Yi("bottom")),i.setNormalizer("border-left",Yi("left")),i.setNormalizer("border-color",yo("color")),i.setNormalizer("border-width",yo("width")),i.setNormalizer("border-style",yo("style")),i.setNormalizer("border-top-color",Le("color","top")),i.setNormalizer("border-top-style",Le("style","top")),i.setNormalizer("border-top-width",Le("width","top")),i.setNormalizer("border-right-color",Le("color","right")),i.setNormalizer("border-right-style",Le("style","right")),i.setNormalizer("border-right-width",Le("width","right")),i.setNormalizer("border-bottom-color",Le("color","bottom")),i.setNormalizer("border-bottom-style",Le("style","bottom")),i.setNormalizer("border-bottom-width",Le("width","bottom")),i.setNormalizer("border-left-color",Le("color","left")),i.setNormalizer("border-left-style",Le("style","left")),i.setNormalizer("border-left-width",Le("width","left")),i.setExtractor("border-top",Xi("top")),i.setExtractor("border-right",Xi("right")),i.setExtractor("border-bottom",Xi("bottom")),i.setExtractor("border-left",Xi("left")),i.setExtractor("border-top-color","border.color.top"),i.setExtractor("border-right-color","border.color.right"),i.setExtractor("border-bottom-color","border.color.bottom"),i.setExtractor("border-left-color","border.color.left"),i.setExtractor("border-top-width","border.width.top"),i.setExtractor("border-right-width","border.width.right"),i.setExtractor("border-bottom-width","border.width.bottom"),i.setExtractor("border-left-width","border.width.left"),i.setExtractor("border-top-style","border.style.top"),i.setExtractor("border-right-style","border.style.right"),i.setExtractor("border-bottom-style","border.style.bottom"),i.setExtractor("border-left-style","border.style.left"),i.setReducer("border-color",ui("border-color")),i.setReducer("border-style",ui("border-style")),i.setReducer("border-width",ui("border-width")),i.setReducer("border-top",Zi("top")),i.setReducer("border-right",Zi("right")),i.setReducer("border-bottom",Zi("bottom")),i.setReducer("border-left",Zi("left")),i.setReducer("border",T0()),i.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),i.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),i.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),i.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),i.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),i.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function A0(){return i=>{const{color:e,style:t,width:n}=Mh(i);return{path:"border",value:{color:di(e),style:di(t),width:di(n)}}}}function Yi(i){return e=>{const{color:t,style:n,width:s}=Mh(e),o={};return t!==void 0&&(o.color={[i]:t}),n!==void 0&&(o.style={[i]:n}),s!==void 0&&(o.width={[i]:s}),{path:"border",value:o}}}function yo(i){return e=>({path:"border",value:E0(e,i)})}function E0(i,e){return{[e]:di(i)}}function Le(i,e){return t=>({path:"border",value:{[i]:{[e]:t}}})}function Xi(i){return(e,t)=>{if(t.border)return ii(t.border,i)}}function ii(i,e){const t={};return i.width&&i.width[e]&&(t.width=i.width[e]),i.style&&i.style[e]&&(t.style=i.style[e]),i.color&&i.color[e]&&(t.color=i.color[e]),t}function Mh(i){const e={},t=ia(i);for(const n of t)Qs(n)||/thin|medium|thick/.test(n)?e.width=n:c0(n)?e.style=n:e.color=n;return e}function T0(){return e=>{const t=ii(e,"top"),n=ii(e,"right"),s=ii(e,"bottom"),o=ii(e,"left"),r=[t,n,s,o],a={width:i(r,"width"),style:i(r,"style"),color:i(r,"color")},l=xn(a,"all");return l.length?l:[...Object.entries(a).reduce((d,[u,h])=>(h&&(d.push([`border-${u}`,h]),r.forEach(m=>delete m[u])),d),[]),...xn(t,"top"),...xn(n,"right"),...xn(s,"bottom"),...xn(o,"left")]};function i(e,t){return e.map(n=>n[t]).reduce((n,s)=>n==s?n:null)}}function Zi(i){return e=>xn(e,i)}function xn(i,e){const t=[];if(i&&i.width&&t.push("width"),i&&i.style&&t.push("style"),i&&i.color&&t.push("color"),t.length==3){const n=t.map(s=>i[s]).join(" ");return[e=="all"?["border",n]:[`border-${e}`,n]]}return e=="all"?[]:t.map(n=>[`border-${e}-${n}`,i[n]])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function S0(i){i.setNormalizer("margin",Vh("margin")),i.setNormalizer("margin-top",e=>({path:"margin.top",value:e})),i.setNormalizer("margin-right",e=>({path:"margin.right",value:e})),i.setNormalizer("margin-bottom",e=>({path:"margin.bottom",value:e})),i.setNormalizer("margin-left",e=>({path:"margin.left",value:e})),i.setReducer("margin",ui("margin")),i.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function x0(i){i.setNormalizer("padding",Vh("padding")),i.setNormalizer("padding-top",e=>({path:"padding.top",value:e})),i.setNormalizer("padding-right",e=>({path:"padding.right",value:e})),i.setNormalizer("padding-bottom",e=>({path:"padding.bottom",value:e})),i.setNormalizer("padding-left",e=>({path:"padding.left",value:e})),i.setReducer("padding",ui("padding")),i.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P0{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const n=this.get(e);if(!n)throw new g("commandcollection-command-not-found",this,{commandName:e});return n.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I0 extends _e{constructor(e){super(),this.editor=e}set(e,t,n={}){if(typeof t=="string"){const s=t;t=(o,r)=>{this.editor.execute(s),r()}}super.set(e,t,n)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R0 extends $(){constructor(e={}){super();const t=this.constructor,n=e.language||t.defaultConfig&&t.defaultConfig.language;this._context=e.context||new Du({language:n}),this._context._addEditor(this,!e.context);const s=Array.from(t.builtinPlugins||[]);this.config=new uu(e,t.defaultConfig),this.config.define("plugins",s),this.config.define(this._context._getEditorConfig()),this.plugins=new Lu(this,s,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new P0,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new e0,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const o=new Hp;this.data=new c1(this.model,o),this.editing=new Lw(this.model,o),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new u1([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new I0(this),this.keystrokes.listenTo(this.editing.view.document)}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new g("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new g("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new g("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}initPlugins(){const e=this.config,t=e.get("plugins"),n=e.get("removePlugins")||[],s=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(s),n,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(t=>this.once("ready",t))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(n){/* istanbul ignore next -- @preserve */g.rethrowUnexpectedError(n,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function V0(i){if(!ys(i.updateSourceElement))throw new g("attachtoform-missing-elementapi-interface",i);const e=i.sourceElement;if(B0(e)&&e.form){let t;const n=e.form,s=()=>i.updateSourceElement();ys(n.submit)&&(t=n.submit,n.submit=()=>{s(),t.apply(n)}),n.addEventListener("submit",s),i.on("destroy",()=>{n.removeEventListener("submit",s),t&&(n.submit=t)})}}function B0(i){return!!i&&i.tagName.toLowerCase()==="textarea"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ms(i){class e extends i{setData(n){this.data.set(n)}getData(n){return this.data.get(n)}}return e}{const i=ms(Object);ms.setData=i.prototype.setData,ms.getData=i.prototype.getData}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ar(i){class e extends i{updateSourceElement(n=this.data.get()){if(!this.sourceElement)throw new g("editor-missing-sourceelement",this);const s=this.config.get("updateSourceElementOnDestroy"),o=this.sourceElement instanceof HTMLTextAreaElement;if(!s&&!o){qa(this.sourceElement,"");return}qa(this.sourceElement,n)}}return e}ar.updateSourceElement=ar(Object).prototype.updateSourceElement;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ps extends qs{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new ge({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new g("pendingactions-add-invalid-message",this);const t=new($());return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}const Oh='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',M0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Nh='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',O0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',Fh='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',N0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',F0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',L0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',D0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',z0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',H0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',W0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',$0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',U0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',q0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',j0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',G0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',K0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',J0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Q0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Y0='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',X0='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',Z0='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',e_='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',t_='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',n_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',i_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',s_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',o_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',r_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',a_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',l_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',c_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',d_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const R={bold:r_,cancel:Oh,caption:M0,check:Nh,cog:O0,eraser:Fh,image:F0,lowVision:N0,importExport:d_,paragraph:a_,plus:l_,text:c_,alignBottom:L0,alignMiddle:D0,alignTop:z0,alignLeft:H0,alignCenter:W0,alignRight:$0,alignJustify:U0,objectLeft:Q0,objectCenter:j0,objectRight:Y0,objectFullWidth:K0,objectInline:J0,objectBlockLeft:q0,objectBlockRight:G0,objectSizeFull:X0,objectSizeLarge:Z0,objectSizeSmall:e_,objectSizeMedium:t_,pencil:n_,pilcrow:i_,quote:s_,threeVerticalDots:o_};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const{threeVerticalDots:Lh}=R,u_={alignLeft:R.alignLeft,bold:R.bold,importExport:R.importExport,paragraph:R.paragraph,plus:R.plus,text:R.text,threeVerticalDots:R.threeVerticalDots};class Fn extends E{constructor(e,t){super(e);const n=this.bindTemplate,s=this.t;this.options=t||{},this.set("ariaLabel",s("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new ue,this.keystrokes=new _e,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new h_(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new at({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const r=["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&r.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:r,role:"toolbar","aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:Rp(this)}}),this._behavior=this.options.shouldGroupWhenFull?new f_(this):new m_(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,n){this.items.addMany(this._buildItemsFromConfig(e,t,n))}_buildItemsFromConfig(e,t,n){const s=Fu(e),o=n||s.removeItems;return this._cleanItemsConfiguration(s.items,t,o).map(a=>We(a)?this._createNestedToolbarDropdown(a,t,o):a==="|"?new Ur:a==="-"?new Ip:t.create(a)).filter(a=>!!a)}_cleanItemsConfiguration(e,t,n){const s=e.filter((o,r,a)=>o==="|"?!0:n.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(K("toolbarview-line-break-ignored-when-grouping-items",a),!1):!0:!We(o)&&!t.has(o)?(K("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(s)}_cleanSeparatorsAndLineBreaks(e){const t=r=>r!=="-"&&r!=="|",n=e.length,s=e.findIndex(t);if(s===-1)return[];const o=n-e.slice().reverse().findIndex(t);return e.slice(s,o).filter((r,a,l)=>t(r)?!0:!(a>0&&l[a-1]===r))}_createNestedToolbarDropdown(e,t,n){let{label:s,icon:o,items:r,tooltip:a=!0,withText:l=!1}=e;if(r=this._cleanItemsConfiguration(r,t,n),!r.length)return null;const c=this.locale,d=de(c);return s||K("toolbarview-nested-toolbar-dropdown-missing-label",e),d.class="ck-toolbar__nested-toolbar-dropdown",d.buttonView.set({label:s,tooltip:a,withText:!!l}),o!==!1?d.buttonView.icon=u_[o]||o||Lh:d.buttonView.withText=!0,Vi(d,()=>d.toolbarView._buildItemsFromConfig(r,t,n)),d}}class h_ extends E{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class m_{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(n=>n),e.focusables.bindTo(e.items).using(n=>n),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class f_{constructor(e){this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("change",this._updateFocusCycleableItems.bind(this)),e.children.on("change",this._updateFocusCycleableItems.bind(this)),e.items.on("change",(t,n)=>{const s=n.index,o=Array.from(n.added);for(const r of n.removed)s>=this.ungroupedItems.length?this.groupedItems.remove(r):this.ungroupedItems.remove(r);for(let r=s;r<s+o.length;r++){const a=o[r-s];r>this.ungroupedItems.length?this.groupedItems.add(a,r-this.ungroupedItems.length):this.ungroupedItems.add(a,r)}this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!sn(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new F(e.lastChild),s=new F(e);if(!this.cachedPadding){const o=x.window.getComputedStyle(e),r=t==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[r])}return t==="ltr"?n.right>s.right-this.cachedPadding:n.left<s.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new Y(this.viewElement,t=>{(!e||e!==t.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new Ur),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,n=de(e);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",Vi(n,this.groupedItems),n.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:e.uiLanguageDirection==="rtl"?"se":"sw",icon:Lh}),n}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Dh extends E{constructor(e){super(e);const t=this.bindTemplate;this.items=this.createCollection(),this.focusTracker=new ue,this.keystrokes=new _e,this._focusCycler=new at({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel")},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oa extends E{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",n=>!n)],role:"presentation"},children:this.children})}focus(){this.children.first.focus()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class g_ extends E{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Wn extends E{constructor(e){super(e);const t=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new _e,this.focusTracker=new ue,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",t.to("class"),t.if("isVisible","ck-hidden",n=>!n),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(){const e=new I;return e.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),e.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),e.delegate("execute").to(this),e}_createArrowView(){const e=new I,t=e.bindTemplate;return e.icon=$r,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",n=>String(n))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function de(i,e=Nu){const t=new e(i),n=new Pp(i),s=new On(i,t,n);return t.bind("isEnabled").to(s),t instanceof Wn?t.arrowView.bind("isOn").to(s,"isOpen"):t.bind("isOn").to(s,"isOpen"),p_(s),s}function Vi(i,e,t={}){i.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),i.isOpen?Wl(i,e,t):i.once("change:isOpen",()=>Wl(i,e,t),{priority:"highest"}),t.enableActiveItemFocusOnDropdownOpen&&Ys(i,()=>i.toolbarView.items.find(n=>n.isOn))}function Wl(i,e,t){const n=i.locale,s=n.t,o=i.toolbarView=new Fn(n),r=typeof e=="function"?e():e;o.ariaLabel=t.ariaLabel||s("Dropdown toolbar"),t.maxWidth&&(o.maxWidth=t.maxWidth),t.class&&(o.class=t.class),t.isCompact&&(o.isCompact=t.isCompact),t.isVertical&&(o.isVertical=!0),r instanceof qe?o.items.bindTo(r).using(a=>a):o.items.addMany(r),i.panelView.children.add(o),o.items.delegate("execute").to(i)}function kt(i,e,t={}){i.isOpen?$l(i,e,t):i.once("change:isOpen",()=>$l(i,e,t),{priority:"highest"}),Ys(i,()=>i.listView.items.find(n=>n instanceof oa?n.children.first.isOn:!1))}function $l(i,e,t){const n=i.locale,s=i.listView=new Dh(n),o=typeof e=="function"?e():e;s.ariaLabel=t.ariaLabel,s.role=t.role,s.items.bindTo(o).using(r=>{if(r.type==="separator")return new g_(n);if(r.type==="button"||r.type==="switchbutton"){const a=new oa(n);let l;return r.type==="button"?l=new I(n):l=new Us(n),l.bind(...Object.keys(r.model)).to(r.model),l.delegate("execute").to(a),a.children.add(l),a}return null}),i.panelView.children.add(s),s.items.delegate("execute").to(i)}function Ys(i,e){i.on("change:isOpen",()=>{if(!i.isOpen)return;const t=e();t&&(typeof t.focus=="function"?t.focus():K("ui-dropdown-focus-child-on-open-child-missing-focus",{view:t}))},{priority:Be.low-10})}function p_(i){b_(i),w_(i),__(i),v_(i),y_(i),C_(i)}function b_(i){i.on("render",()=>{Ii({emitter:i,activator:()=>i.isOpen,callback:()=>{i.isOpen=!1},contextElements:()=>[i.element,...i.focusTracker._elements]})})}function w_(i){i.on("execute",e=>{e.source instanceof Us||(i.isOpen=!1)})}function __(i){i.focusTracker.on("change:isFocused",(e,t,n)=>{i.isOpen&&!n&&(i.isOpen=!1)})}function v_(i){i.keystrokes.set("arrowdown",(e,t)=>{i.isOpen&&(i.panelView.focus(),t())}),i.keystrokes.set("arrowup",(e,t)=>{i.isOpen&&(i.panelView.focusLast(),t())})}function y_(i){i.on("change:isOpen",(e,t,n)=>{if(n)return;const s=i.panelView.element;s&&s.contains(x.document.activeElement)&&i.buttonView.focus()})}function C_(i){i.on("change:isOpen",(e,t,n)=>{n&&i.panelView.focus()},{priority:"low"})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function nt(i,e,t){const n=new Ou(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n}function k_(i,e,t){const n=new xp(i.locale);return n.set({id:e,ariaDescribedById:t,inputMode:"numeric"}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n}function zh(i,e,t){const n=de(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isEnabled").to(i),n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const A_=150;class E_ extends E{constructor(e,t={}){super(e),this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const n=this.createCollection();t.hideInput||n.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:n}),this._config=t,this._debounceColorPickerEvent=Vt(s=>{this.set("color",s),this.fire("colorSelected",{color:this.color})},A_,{leading:!0}),this.on("set:color",(s,o,r)=>{s.return=Vu(r,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=Co(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),Co(this.color)!=Co(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),this.picker=x.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const n=e.detail.value;this._debounceColorPickerEvent(n)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&(V.isGecko||V.isiOS||V.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const n=[...this.picker.shadowRoot.children].filter(s=>s.getAttribute("role")==="slider").map(s=>new T_(s));this.slidersView=this.createCollection(),n.forEach(s=>{this.slidersView.add(s)})}_createInputRow(){const e=new S_,t=this._createColorInput();return new x_(this.locale,[e,t])}_createColorInput(){const e=new pe(this.locale,nt),{t}=this.locale;return e.set({label:t("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",n=>e.isFocused?e.fieldView.value:n.startsWith("#")?n.substring(1):n),e.fieldView.on("input",()=>{const n=e.fieldView.element.value;if(n){const s=n.trim(),o=s.startsWith("#")?s.substring(1):s;[3,4,6,8].includes(o.length)&&/(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})/.test(o)&&this._debounceColorPickerEvent("#"+o)}}),e}}function Co(i){let e=Ap(i);return e||(e="#000"),e.length===4&&(e="#"+[e[1],e[1],e[2],e[2],e[3],e[3]].join("")),e.toLowerCase()}class T_ extends E{constructor(e){super(),this.element=e}focus(){this.element.focus()}}class S_ extends E{constructor(e){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class x_ extends E{constructor(e,t){super(e),this.children=this.createCollection(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P_ extends $(ge){constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(e,t){return this.find(n=>n.color===e.color)?this:super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}}const I_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R_ extends E{constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,focusTracker:l,focusables:c}){super(e);const d=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=l,this.items=this.createCollection(),this.colorDefinitions=t,this.columns=n,this.documentColors=new P_,this.documentColorsCount=r,this._focusables=c,this._removeButtonLabel=s,this._colorPickerLabel=a,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",d.if("isVisible","ck-hidden",u=>!u)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,t){const n=e.document,s=this.documentColorsCount;this.documentColors.clear();for(const o of n.getRoots()){const r=e.createRangeIn(o);for(const a of r.getItems())if(a.is("$textProxy")&&a.hasAttribute(t)&&(this._addColorToDocumentColors(a.getAttribute(t)),this.documentColors.length>=s))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,n=this.selectedColor;t.selectedColor=n,e&&(e.selectedColor=n)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=ke.bind(this.documentColors,this.documentColors),t=new ze(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker(),this.focus()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new I,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:I_,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new I;return e.set({withText:!0,icon:Fh,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new nl(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(t,n)=>{this.fire("execute",{value:n.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=ke.bind(this.documentColors,this.documentColors),t=new nl(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(n=>{const s=new Ru;return s.set({color:n.color,hasBorder:n.options&&n.options.hasBorder}),n.label&&s.set({label:n.label,tooltip:!0}),s.on("execute",()=>{this.fire("execute",{value:n.color,source:"documentColorsGrid"})}),s}),this.documentColors.on("change:isEmpty",(n,s,o)=>{o&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(n=>n.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class V_ extends E{constructor(e,{focusTracker:t,focusables:n,keystrokes:s,colorPickerViewConfig:o}){super(e),this.items=this.createCollection(),this.focusTracker=t,this.keystrokes=s,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=n,this._colorPickerViewConfig=o;const r=this.bindTemplate,{saveButtonView:a,cancelButtonView:l}=this._createActionButtons();this.saveButtonView=a,this.cancelButtonView=l,this.actionBarView=this._createActionBarView({saveButtonView:a,cancelButtonView:l}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",r.if("isVisible","ck-hidden",c=>!c)]},children:this.items})}render(){super.render();const e=new E_(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(t,n,s)=>{e.color=s}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const t of this.colorPickerView.slidersView)this.focusTracker.add(t.element),this._focusables.add(t);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:t}){const n=new E,s=this.createCollection();return s.add(e),s.add(t),n.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:s}),n}_createActionButtons(){const e=this.locale,t=e.t,n=new I(e),s=new I(e);return n.set({icon:Nh,class:"ck-button-save",type:"button",withText:!1,label:t("Accept")}),s.set({icon:Oh,class:"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),n.on("execute",()=>{this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),s.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:n,cancelButtonView:s}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,t)=>{this.fire("execute",{value:t.color,source:"colorPicker"}),this.set("selectedColor",t.color)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hh extends E{constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,colorPickerViewConfig:l}){super(e),this.items=this.createCollection(),this.focusTracker=new ue,this.keystrokes=new _e,this._focusables=new qe,this._colorPickerViewConfig=l,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new R_(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new V_(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:l}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(c,d,u)=>{this.colorGridsFragmentView.set("selectedColor",u),this.colorPickerFragmentView.set("selectedColor",u)}),this.colorGridsFragmentView.on("change:selectedColor",(c,d,u)=>{this.set("selectedColor",u)}),this.colorPickerFragmentView.on("change:selectedColor",(c,d,u)=>{this.set("selectedColor",u)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class B_{constructor(e){this._components=new Map,this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(ko(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new g("componentfactory-item-missing",this,{name:e});return this._components.get(ko(e)).callback(this.editor.locale)}has(e){return this._components.has(ko(e))}}function ko(i){return String(i).toLowerCase()}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ul=Nr("px"),ql=x.document.body;class we extends E{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",n=>`ck-balloon-panel_${n}`),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Ul),left:t.to("left",Ul)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=we.defaultPositions,n=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast,t.viewportStickyNorth],limiter:ql,fitInViewport:!0},e),s=we._getOptimalPosition(n),o=parseInt(s.left),r=parseInt(s.top),a=s.name,l=s.config||{},{withArrow:c=!0}=l;this.top=r,this.left=o,this.position=a,this.withArrow=c}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=lr(e.target),n=e.limiter?lr(e.limiter):ql;this.listenTo(x.document,"scroll",(s,o)=>{const r=o.target,a=t&&r.contains(t),l=n&&r.contains(n);(a||l||!t||!n)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(x.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(x.document,"scroll"),this.stopListening(x.window,"resize")}}we.arrowSideOffset=25;we.arrowHeightOffset=10;we.stickyVerticalOffset=20;we._getOptimalPosition=_u;we.defaultPositions=Wh();function lr(i){return Rt(i)?i:Ws(i)?i.commonAncestorContainer:typeof i=="function"?lr(i()):null}function Wh(i={}){const{sideOffset:e=we.arrowSideOffset,heightOffset:t=we.arrowHeightOffset,stickyVerticalOffset:n=we.stickyVerticalOffset,config:s}=i;return{northWestArrowSouthWest:(a,l)=>({top:o(a,l),left:a.left-e,name:"arrow_sw",...s&&{config:s}}),northWestArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.left-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northWestArrowSouth:(a,l)=>({top:o(a,l),left:a.left-l.width/2,name:"arrow_s",...s&&{config:s}}),northWestArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.left-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northWestArrowSouthEast:(a,l)=>({top:o(a,l),left:a.left-l.width+e,name:"arrow_se",...s&&{config:s}}),northArrowSouthWest:(a,l)=>({top:o(a,l),left:a.left+a.width/2-e,name:"arrow_sw",...s&&{config:s}}),northArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northArrowSouth:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width/2,name:"arrow_s",...s&&{config:s}}),northArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northArrowSouthEast:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width+e,name:"arrow_se",...s&&{config:s}}),northEastArrowSouthWest:(a,l)=>({top:o(a,l),left:a.right-e,name:"arrow_sw",...s&&{config:s}}),northEastArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.right-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northEastArrowSouth:(a,l)=>({top:o(a,l),left:a.right-l.width/2,name:"arrow_s",...s&&{config:s}}),northEastArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.right-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northEastArrowSouthEast:(a,l)=>({top:o(a,l),left:a.right-l.width+e,name:"arrow_se",...s&&{config:s}}),southWestArrowNorthWest:a=>({top:r(a),left:a.left-e,name:"arrow_nw",...s&&{config:s}}),southWestArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.left-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southWestArrowNorth:(a,l)=>({top:r(a),left:a.left-l.width/2,name:"arrow_n",...s&&{config:s}}),southWestArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.left-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southWestArrowNorthEast:(a,l)=>({top:r(a),left:a.left-l.width+e,name:"arrow_ne",...s&&{config:s}}),southArrowNorthWest:a=>({top:r(a),left:a.left+a.width/2-e,name:"arrow_nw",...s&&{config:s}}),southArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southArrowNorth:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width/2,name:"arrow_n",...s&&{config:s}}),southArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southArrowNorthEast:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width+e,name:"arrow_ne",...s&&{config:s}}),southEastArrowNorthWest:a=>({top:r(a),left:a.right-e,name:"arrow_nw",...s&&{config:s}}),southEastArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.right-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southEastArrowNorth:(a,l)=>({top:r(a),left:a.right-l.width/2,name:"arrow_n",...s&&{config:s}}),southEastArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.right-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southEastArrowNorthEast:(a,l)=>({top:r(a),left:a.right-l.width+e,name:"arrow_ne",...s&&{config:s}}),westArrowEast:(a,l)=>({top:a.top+a.height/2-l.height/2,left:a.left-l.width-t,name:"arrow_e",...s&&{config:s}}),eastArrowWest:(a,l)=>({top:a.top+a.height/2-l.height/2,left:a.right+t,name:"arrow_w",...s&&{config:s}}),viewportStickyNorth:(a,l,c)=>a.getIntersection(c)?{top:c.top+n,left:a.left+a.width/2-l.width/2,name:"arrowless",config:{withArrow:!1,...s}}:null};function o(a,l){return a.top-l.height-t}function r(a){return a.bottom+t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const jl="ck-tooltip";class me extends rt(){constructor(e){if(super(),this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this._resizeObserver=null,me._editors.add(e),me._instance)return me._instance;me._instance=this,this.tooltipTextView=new E(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new we(e.locale),this.balloonPanelView.class=jl,this.balloonPanelView.content.add(this.tooltipTextView),this._pinTooltipDebounced=Vt(this._pinTooltip,600),this.listenTo(x.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(x.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(x.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(x.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(x.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const t=e.ui.view&&e.ui.view.body;me._editors.delete(e),this.stopListening(e.ui),t&&t.has(this.balloonPanelView)&&t.remove(this.balloonPanelView),me._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),me._instance=null)}static getPositioningFunctions(e){const t=me.defaultBalloonPositions;return{s:[t.southArrowNorth,t.southArrowNorthEast,t.southArrowNorthWest],n:[t.northArrowSouth],e:[t.eastArrowWest],w:[t.westArrowEast],sw:[t.southArrowNorthEast],se:[t.southArrowNorthWest]}[e]}_onEnterOrFocus(e,{target:t}){const n=Ao(t);n&&n!==this._currentElementWithTooltip&&(this._unpinTooltip(),this._pinTooltipDebounced(n,M_(n)))}_onLeaveOrBlur(e,{target:t,relatedTarget:n}){if(e.name==="mouseleave"){if(!Rt(t)||this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;const s=Ao(t),o=Ao(n);s&&s!==o&&this._unpinTooltip()}else{if(this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;this._unpinTooltip()}}_onScroll(e,{target:t}){this._currentElementWithTooltip&&(t.contains(this.balloonPanelView.element)&&t.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:t,position:n,cssClass:s}){const o=Q(me._editors.values()).ui.view.body;o.has(this.balloonPanelView)||o.add(this.balloonPanelView),this.tooltipTextView.text=t,this.balloonPanelView.pin({target:e,positions:me.getPositioningFunctions(n)}),this._resizeObserver=new Y(e,()=>{sn(e)||this._unpinTooltip()}),this.balloonPanelView.class=[jl,s].filter(r=>r).join(" ");for(const r of me._editors)this.listenTo(r.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=n}_unpinTooltip(){this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of me._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this._resizeObserver&&this._resizeObserver.destroy()}_updateTooltipPosition(){if(!sn(this._currentElementWithTooltip)){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:me.getPositioningFunctions(this._currentTooltipPosition)})}}me.defaultBalloonPositions=Wh({heightOffset:5,sideOffset:13});me._editors=new Set;me._instance=null;function Ao(i){return Rt(i)?i.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function M_(i){return{text:i.dataset.ckeTooltipText,position:i.dataset.ckeTooltipPosition||"s",cssClass:i.dataset.ckeTooltipClass||""}}const O_='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 53 10"><path d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122 2.4 2.4 0 0 1 .69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491Zm.465 2.313-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503Zm6.603 1.598c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02Zm6.501-3.925a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304Zm5.029-.871c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655 1.349 1.349 0 0 0-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768Zm-10.972.86-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016a1.693 1.693 0 0 1-.347-.039.746.746 0 0 1-.45-.262 1.038 1.038 0 0 1-.167-.33 3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852a1.94 1.94 0 0 1 .127-.46.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02 5.09 5.09 0 0 0-.719.041 3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096 7.262 7.262 0 0 0-.042.86c-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const N_=53,F_=10,L_=50,D_=350,z_="Powered by",es={top:-99999,left:-99999,name:"invalid",config:{withArrow:!1}};class H_ extends rt(){constructor(e){super(),this.editor=e,this._balloonView=null,this._lastFocusedEditableElement=null,this._showBalloonThrottled=zn(this._showBalloon.bind(this),50,{leading:!0}),e.on("ready",this._handleEditorReady.bind(this))}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor,t=!!e.config.get("ui.poweredBy.forceVisible");/* istanbul ignore next -- @preserve */!t&&sp(e.config.get("licenseKey"))==="VALID"||e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(n,s,o)=>{this._updateLastFocusedEditableElement(),o?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(n,s,o)=>{this._updateLastFocusedEditableElement(),o&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_createBalloonView(){const e=this.editor,t=this._balloonView=new we,n=Uh(e),s=new W_(e.locale,n.label);t.content.add(s),t.set({class:"ck-powered-by-balloon"}),e.ui.view.body.add(t),e.ui.focusTracker.add(t.element),this._balloonView=t}_showBalloon(){if(!this._lastFocusedEditableElement)return;const e=$_(this.editor,this._lastFocusedEditableElement);e&&(this._balloonView||this._createBalloonView(),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,n=e.ui.focusTracker.focusedElement;if(!t||!n){this._lastFocusedEditableElement=null;return}const s=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));s.includes(n)?this._lastFocusedEditableElement=n:this._lastFocusedEditableElement=s[0]}}class W_ extends E{constructor(e,t){super(e);const n=new Lt,s=this.bindTemplate;n.set({content:O_,isColorInherited:!1}),n.extendTemplate({attributes:{style:{width:N_+"px",height:F_+"px"}}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],n],on:{dragstart:s.to(o=>o.preventDefault())}}]})}}function $_(i,e){const t=Uh(i),n=t.side==="right"?U_(e,t):q_(e,t);return{target:e,positions:[n]}}function U_(i,e){return $h(i,e,(t,n)=>t.left+t.width-n.width-e.horizontalOffset)}function q_(i,e){return $h(i,e,t=>t.left+e.horizontalOffset)}function $h(i,e,t){return(n,s)=>{const o=n.getVisible();if(!o||n.width<D_||n.height<L_)return es;let r;e.position==="inside"?r=n.bottom-s.height:r=n.bottom-s.height/2,r-=e.verticalOffset;const a=t(n,s);if(e.position==="inside"){const l=s.clone().moveTo(a,r);if(l.getIntersectionArea(o)<l.getArea())return es}else{const l=Ko(i);if(l){const c=new F(l),d=o.bottom+s.height/2>c.bottom,u=e.side==="left"?n.left<c.left:n.right>c.right;if(d||u)return es}}return{top:r,left:a,name:`position_${e.position}-side_${e.side}`,config:{withArrow:!1}}}}function Uh(i){const e=i.config.get("ui.poweredBy"),t=e&&e.position||"border";return{position:t,label:z_,verticalOffset:t==="inside"?5:0,horizontalOffset:5,side:i.locale.contentLanguageDirection==="ltr"?"right":"left",...e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class j_ extends $(){constructor(e){super(),this.isReady=!1,this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[];const t=e.editing.view;this.editor=e,this.componentFactory=new B_(e),this.focusTracker=new ue,this.tooltipManager=new me(e),this.poweredBy=new H_(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this.isReady=!0}),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const n=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?n():this.once("ready",n)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const n=e.config.get("toolbar.viewportTopOffset");return n?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:n}):{top:0}}_initFocusTracking(){const e=this.editor,t=e.editing.view;let n,s;e.keystrokes.set("Alt+F10",(o,r)=>{const a=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(a)&&!Array.from(t.domRoots.values()).includes(a)&&(n=a);const l=this._getCurrentFocusedToolbarDefinition();(!l||!s)&&(s=this._getFocusableCandidateToolbarDefinitions());for(let c=0;c<s.length;c++){const d=s.shift();if(s.push(d),d!==l&&this._focusFocusableCandidateToolbar(d)){l&&l.options.afterBlur&&l.options.afterBlur();break}}r()}),e.keystrokes.set("Esc",(o,r)=>{const a=this._getCurrentFocusedToolbarDefinition();a&&(n?(n.focus(),n=null):e.editing.view.focus(),a.options.afterBlur&&a.options.afterBlur(),r())})}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:n,options:s}=t;(sn(n.element)||s.beforeFocus)&&e.push(t)}return e.sort((t,n)=>Gl(t)-Gl(n)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:n}}=e;return n&&n(),sn(t.element)?(t.focus(),!0):!1}_handleScrollToTheSelection(e,t){const n={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=n.top,t.viewportOffset.bottom+=n.bottom,t.viewportOffset.left+=n.left,t.viewportOffset.right+=n.right}}function Gl(i){const{toolbarView:e,options:t}=i;let n=10;return sn(e.element)&&n--,t.isContextual&&n--,n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class G_ extends E{constructor(e){super(e),this.body=new yp(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K_ extends G_{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new ze;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class J_ extends E{constructor(e,t,n){super(e),this.name=null,this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?n(this):t(this);function t(s){e.change(o=>{const r=e.document.getRoot(s.name);o.addClass(s.isFocused?"ck-focused":"ck-blurred",r),o.removeClass(s.isFocused?"ck-blurred":"ck-focused",r)})}function n(s){e.once("change:isRenderingInProgress",(o,r,a)=>{a?n(s):t(s)})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Q_ extends J_{constructor(e,t,n,s={}){super(e,t,n);const o=e.t;this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}}),this._generateLabel=s.label||(()=>o("Editor editing area: %0",this.name))}render(){super.render();const e=this._editingView;e.change(t=>{const n=e.document.getRoot(this.name);t.setAttribute("aria-label",this._generateLabel(this),n)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qh extends E{constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",n.to("class")]},children:this.children});const s=new E(e);s.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"]},children:[{text:n.to("label")}]}),this.children.add(s)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kl extends qs{static get pluginName(){return"Notification"}init(){this.on("show:warning",(e,t)=>{window.alert(t.message)},{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=e.namespace?`show:${e.type}:${e.namespace}`:`show:${e.type}`;this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wt extends $(){constructor(e,t){super(),t&&Yd(this,t),e&&this.set(e)}}const Y_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',X_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ts=Nr("px");class Nt extends b{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this._viewToStack=new Map,this._idToStack=new Map,this._view=null,this._rotatorView=null,this._fakePanelsView=null,this.positionLimiter=()=>{const t=this.editor.editing.view,s=t.document.selection.editableElement;return s?t.domConverter.mapViewToDom(s.root):null},this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new g("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t)){this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(t);return}const n=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),n.set(e.view,e),this._viewToStack.set(e.view,n),n===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new g("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(t.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),t.size===1?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new g("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}_createPanelView(){this._view=new we(this.editor.locale),this.editor.ui.view.body.add(this._view),this.editor.ui.focusTracker.add(this._view.element),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(n=>n[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new Z_(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(n,s)=>!s&&n>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(n,s)=>{if(s<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[o,s])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new ev(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,n)=>!n&&t>=2?Math.min(t-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:n=!0,singleViewMode:s=!1}){this.view.class=t,this.view.withArrow=n,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),s&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class Z_ extends E{constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new ue,this.buttonPrevView=this._createButtonView(t("Previous"),Y_),this.buttonNextView=this._createButtonView(t("Next"),X_),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",s=>s?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const n=new I(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n}}class ev extends E{constructor(e,t){super(e);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",s=>s?"":"ck-hidden")],style:{top:n.to("top",ts),left:n.to("left",ts),width:n.to("width",ts),height:n.to("height",ts)}},children:this.content}),this.on("change:numberOfPanels",(s,o,r,a)=>{r>a?this._addPanels(r-a):this._removePanels(a-r),this.updatePosition()})}_addPanels(e){for(;e--;){const t=new E;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(e){for(;e--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:n,height:s}=new F(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:n,height:s})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const _n=Nr("px");class tv extends E{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new ke({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",n=>n?"block":"none"),height:t.to("isSticky",n=>n?_n(this._contentPanelRect.height):null)}}}).render(),this._contentPanel=new ke({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",n=>n?_n(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_stickyTopOffset",n=>n&&_n(n)),bottom:t.to("_stickyBottomOffset",n=>n&&_n(n)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(x.document,"scroll",(e,t)=>{this.checkIfShouldBeSticky(t.target)},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(e){if(!this.limiterElement||!this.isActive){this._unstick();return}const t=Rg(this.limiterElement);if(e&&!t.includes(e))return;const n=Ig(t,this.viewportTopOffset),s=new F(this.limiterElement);if(n&&s.top<n.top){const o=s.getIntersection(n);if(o){const r=n.top;if(r+this._contentPanelRect.height+this.limiterBottomOffset>o.bottom){const a=Math.max(s.bottom-n.bottom,0)+this.limiterBottomOffset;s.bottom-a>s.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(a):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<s.height?this._stickToTopOfAncestors(r):this._unstick()}else this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=_n(-x.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=_n(-x.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new F(this._contentPanel)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nv extends j_{constructor(e,t){super(e),this.view=t,this._toolbarConfig=Fu(e.config.get("toolbar")),this._elementReplacer=new du,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,n=this.view,s=t.editing.view,o=n.editable,r=s.document.getRoot();o.name=r.rootName,n.render();const a=o.element;this.setEditableElement(o.name,a),n.editable.bind("isFocused").to(this.focusTracker),s.attachDomRoot(a),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:t})=>t||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,n=t.document.getRoot(),s=e.sourceElement;let o;const r=e.config.get("placeholder");r&&(o=typeof r=="string"?r:r[this.view.editable.name]),!o&&s&&s.tagName.toLowerCase()==="textarea"&&(o=s.getAttribute("placeholder")),o&&(n.placeholder=o),qr({view:t,element:n,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(e,t,n){const s=this.view.stickyPanel;if(s.isSticky){const o=new F(s.element).height;t.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(n)};this.listenTo(s,"change:isSticky",o),setTimeout(()=>{this.stopListening(s,"change:isSticky",o)},20)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iv extends K_{constructor(e,t,n={}){super(e),this.stickyPanel=new tv(e),this.toolbar=new Fn(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),this.editable=new Q_(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jh{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit=typeof e.crashNumberLimit=="number"?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof e.minimumNonErrorTimePeriod=="number"?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const n="error"in t?t.error:t.reason;n instanceof Error&&this._handleError(n,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(n=>n!==t)}_fire(e,...t){const n=this._listeners[e]||[];for(const s of n)s.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&e.context!==void 0&&e.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const e=this.crashes[this.crashes.length-1].date,t=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(e-t)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function cr(i,e=new Set){const t=[i],n=new Set;let s=0;for(;t.length>s;){const o=t[s++];if(!(n.has(o)||!sv(o)||e.has(o)))if(n.add(o),Symbol.iterator in o)try{for(const r of o)t.push(r)}catch{}else for(const r in o)r!=="defaultValue"&&t.push(o[r])}return n}function sv(i){const e=Object.prototype.toString.call(i),t=typeof i;return!(t==="number"||t==="boolean"||t==="string"||t==="symbol"||t==="function"||e==="[object Date]"||e==="[object RegExp]"||e==="[object Module]"||i===void 0||i===null||i._watchdogExcluded||i instanceof EventTarget||i instanceof Event)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Gh(i,e,t=new Set){if(i===e&&ov(i))return!0;const n=cr(i,t),s=cr(e,t);for(const o of n)if(s.has(o))return!0;return!1}function ov(i){return typeof i=="object"&&i!==null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kh extends jh{constructor(e,t={}){super(t),this._editor=null,this._initUsingData=!0,this._editables={},this._throttledSave=zn(this._save.bind(this),typeof t.saveInterval=="number"?t.saveInterval:5e3),e&&(this._creator=(n,s)=>e.create(n,s)),this._destructor=n=>n.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},t=[],n=this._config.rootsAttributes||{},s={};for(const[r,a]of Object.entries(this._data.roots))a.isLoaded?(e[r]="",s[r]=n[r]||{}):t.push(r);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:s,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(rv),this._initUsingData?this.create(e,o,o.context):Rt(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,n){return Promise.resolve().then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(t)||{},this._config.context=n,this._creator(e,this._config))).then(s=>{this._editor=s,s.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=s.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")})}destroy(){return Promise.resolve().then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter(a=>a.isAttached()&&a.rootName!="$graveyard"),{plugins:n}=e,s=n.has("CommentsRepository")&&n.get("CommentsRepository"),o=n.has("TrackChanges")&&n.get("TrackChanges"),r={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(a=>{r.roots[a.rootName]={content:JSON.stringify(Array.from(a.getChildren())),attributes:JSON.stringify(Array.from(a.getAttributes())),isLoaded:a._isLoaded}});for(const a of e.model.markers)a._affectsData&&(r.markers[a.name]={rangeJSON:a.getRange().toJSON(),usingOperation:a._managedUsingOperations,affectsData:a._affectsData});return s&&(r.commentThreads=JSON.stringify(s.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(r.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),r}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(t);n&&(e[t]=n)}return e}_isErrorComingFromThisItem(e){return Gh(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return Or(e,(t,n)=>{if(Rt(t)||n==="context")return t})}}class rv{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},t=>{this._restoreCollaborationData(),this._restoreEditorData(t)}),this.editor.data.fire("ready")},{priority:1e3-1})}_createNode(e,t){if("name"in t){const n=e.createElement(t.name,t.attributes);if(t.children)for(const s of t.children)n._appendChild(this._createNode(e,s));return n}else return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach(([n,{content:s,attributes:o}])=>{const r=JSON.parse(s),a=JSON.parse(o),l=t.model.document.getRoot(n);for(const[c,d]of a)e.setAttribute(c,d,l);for(const c of r){const d=this._createNode(e,c);e.insert(d,l,"end")}}),Object.entries(this._data.markers).forEach(([n,s])=>{const{document:o}=t.model,{rangeJSON:{start:r,end:a},...l}=s,c=o.getRoot(r.root),d=e.createPositionFromPath(c,r.path,r.stickiness),u=e.createPositionFromPath(c,a.path,a.stickiness),h=e.createRange(d,u);e.addMarker(n,{range:h,...l})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);e.forEach(n=>{const s=this.editor.config.get("collaboration.channelId"),o=this.editor.plugins.get("CommentsRepository");o.hasCommentThread(n.threadId)&&o.getCommentThread(n.threadId).remove(),o.addCommentThread({channelId:s,...n})}),t.forEach(n=>{const s=this.editor.plugins.get("TrackChangesEditing");if(s.hasSuggestion(n.id)){const o=s.getSuggestion(n.id);o.attributes=n.attributes}else s.addSuggestionData(n)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hi=Symbol("MainQueueId");class av extends jh{constructor(e,t={}){super(t),this._watchdogs=new Map,this._context=null,this._contextProps=new Set,this._actionQueues=new lv,this._watchdogConfig=t,this._creator=n=>e.create(n),this._destructor=n=>n.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(hi,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=Jl(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let s;if(this._watchdogs.has(n.id))throw new Error(`Item with the given id is already added: '${n.id}'.`);if(n.type==="editor")return s=new Kh(null,this._watchdogConfig),s.setCreator(n.creator),s._setExcludedProperties(this._contextProps),n.destructor&&s.setDestructor(n.destructor),this._watchdogs.set(n.id,s),s.on("error",(o,{error:r,causesRestart:a})=>{this._fire("itemError",{itemId:n.id,error:r}),a&&this._actionQueues.enqueue(n.id,()=>new Promise(l=>{const c=()=>{s.off("restart",c),this._fire("itemRestart",{itemId:n.id}),l()};s.on("restart",c)}))}),s.create(n.sourceElementOrData,n.config,this._context);throw new Error(`Not supported item type: '${n.type}'.`)})))}remove(e){const t=Jl(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n,()=>{const s=this._getWatchdog(n);return this._watchdogs.delete(n),s.destroy()})))}destroy(){return this._actionQueues.enqueue(hi,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(hi,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=cr(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return Gh(this._context,e.context)}}class lv{constructor(){this._onEmptyCallbacks=[],this._queues=new Map,this._activeActions=0}onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const n=e===hi;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const o=(n?Promise.all(this._queues.values()):Promise.all([this._queues.get(hi),this._queues.get(e)])).then(t),r=o.catch(()=>{});return this._queues.set(e,r),o.finally(()=>{this._activeActions--,this._queues.get(e)===r&&this._activeActions===0&&this._onEmptyCallbacks.forEach(a=>a())})}}function Jl(i){return Array.isArray(i)?i:[i]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ra extends ms(ar(R0)){constructor(e,t={}){if(!fs(e)&&t.initialData!==void 0)throw new g("editor-create-initial-data",null);super(t),this.config.get("initialData")===void 0&&this.config.set("initialData",cv(e)),fs(e)&&(this.sourceElement=e),this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),s=new iv(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n});this.ui=new nv(this,s),V0(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(n=>{const s=new this(e,t);n(s.initPlugins().then(()=>s.ui.init(fs(e)?e:null)).then(()=>s.data.init(s.config.get("initialData"))).then(()=>s.fire("ready")).then(()=>s))})}}ra.Context=Du;ra.EditorWatchdog=Kh;ra.ContextWatchdog=av;function cv(i){return fs(i)?Vg(i):i}function fs(i){return Rt(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const aa=["left","right","center","justify"];function Jh(i){return aa.includes(i)}function Qh(i,e){return e.contentLanguageDirection=="rtl"?i==="right":i==="left"}function Yh(i){const e=i.map(n=>{let s;return typeof n=="string"?s={name:n}:s=n,s}).filter(n=>{const s=aa.includes(n.name);return s||K("alignment-config-name-not-recognized",{option:n}),s}),t=e.filter(n=>!!n.className).length;if(t&&t<e.length)throw new g("alignment-config-classnames-are-missing",{configuredOptions:i});return e.forEach((n,s,o)=>{const r=o.slice(s+1);if(r.some(l=>l.name==n.name))throw new g("alignment-config-name-already-defined",{option:n,configuredOptions:i});if(n.className&&r.some(c=>c.className==n.className))throw new g("alignment-config-classname-already-defined",{option:n,configuredOptions:i})}),e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const la="alignment";class dv extends T{refresh(){const t=this.editor.locale,n=Q(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!n&&this._canBeAligned(n),this.isEnabled&&n.hasAttribute("alignment")?this.value=n.getAttribute("alignment"):this.value=t.contentLanguageDirection==="rtl"?"right":"left"}execute(e={}){const t=this.editor,n=t.locale,s=t.model,o=s.document,r=e.value;s.change(a=>{const l=Array.from(o.selection.getSelectedBlocks()).filter(u=>this._canBeAligned(u)),c=l[0].getAttribute("alignment");Qh(r,n)||c===r||!r?uv(l,a):hv(l,a,r)})}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,la)}}function uv(i,e){for(const t of i)e.removeAttribute(la,t)}function hv(i,e,t){for(const n of i)e.setAttribute(la,t,n)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mv extends b{static get pluginName(){return"AlignmentEditing"}constructor(e){super(e),e.config.define("alignment",{options:aa.map(t=>({name:t}))})}init(){const e=this.editor,t=e.locale,n=e.model.schema,o=Yh(e.config.get("alignment.options")).filter(c=>Jh(c.name)&&!Qh(c.name,t)),r=o.some(c=>!!c.className);n.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),r?e.conversion.attributeToAttribute(bv(o)):e.conversion.for("downcast").attributeToAttribute(fv(o));const a=gv(o);for(const c of a)e.conversion.for("upcast").attributeToAttribute(c);const l=pv(o);for(const c of l)e.conversion.for("upcast").attributeToAttribute(c);e.commands.add("alignment",new dv(e))}}function fv(i){const e={};for(const{name:n}of i)e[n]={key:"style",value:{"text-align":n}};return{model:{key:"alignment",values:i.map(n=>n.name)},view:e}}function gv(i){const e=[];for(const{name:t}of i)e.push({view:{key:"style",value:{"text-align":t}},model:{key:"alignment",value:t}});return e}function pv(i){const e=[];for(const{name:t}of i)e.push({view:{key:"align",value:t},model:{key:"alignment",value:t}});return e}function bv(i){const e={};for(const n of i)e[n.name]={key:"class",value:n.className};return{model:{key:"alignment",values:i.map(n=>n.name)},view:e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ns=new Map([["left",R.alignLeft],["right",R.alignRight],["center",R.alignCenter],["justify",R.alignJustify]]);class wv extends b{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const e=this.editor,t=e.ui.componentFactory,n=e.t,s=Yh(e.config.get("alignment.options"));s.map(o=>o.name).filter(Jh).forEach(o=>this._addButton(o)),t.add("alignment",o=>{const r=de(o);Vi(r,()=>s.map(c=>t.create(`alignment:${c.name}`)),{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:n("Text alignment toolbar")}),r.buttonView.set({label:n("Text alignment"),tooltip:!0}),r.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const a=o.contentLanguageDirection==="rtl"?ns.get("right"):ns.get("left"),l=e.commands.get("alignment");return r.buttonView.bind("icon").to(l,"value",c=>ns.get(c)||a),r.bind("isEnabled").to(l,"isEnabled"),this.listenTo(r,"execute",()=>{e.editing.view.focus()}),r})}_addButton(e){const t=this.editor;t.ui.componentFactory.add(`alignment:${e}`,n=>{const s=t.commands.get("alignment"),o=new I(n);return o.set({label:this.localizedOptionTitles[e],icon:ns.get(e),tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(s),o.bind("isOn").to(s,"value",r=>r===e),this.listenTo(o,"execute",()=>{t.execute("alignment",{value:e}),t.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class F5 extends b{static get requires(){return[mv,wv]}static get pluginName(){return"Alignment"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _v extends $(){constructor(){super();const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=t=>{this.loaded=t.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise((n,s)=>{t.onload=()=>{const o=t.result;this._data=o,n(o)},t.onerror=()=>{s("error")},t.onabort=()=>{s("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tn extends b{constructor(){super(...arguments),this.loaders=new ge,this._loadersMap=new Map,this._pendingAction=null}static get pluginName(){return"FileRepository"}static get requires(){return[Ps]}init(){this.loaders.on("change",()=>this._updatePendingAction()),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,t)=>t?e/t*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return K("filerepository-no-upload-adapter"),null;const t=new Ql(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then(n=>{this._loadersMap.set(n,t)}).catch(()=>{}),t.on("change:uploaded",()=>{let n=0;for(const s of this.loaders)n+=s.uploaded;this.uploaded=n}),t.on("change:uploadTotal",()=>{let n=0;for(const s of this.loaders)s.uploadTotal&&(n+=s.uploadTotal);this.uploadTotal=n}),t}destroyLoader(e){const t=e instanceof Ql?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach((n,s)=>{n===t&&this._loadersMap.delete(s)})}_updatePendingAction(){const e=this.editor.plugins.get(Ps);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,n=s=>`${t("Upload in progress")} ${parseInt(s)}%.`;this._pendingAction=e.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else e.remove(this._pendingAction),this._pendingAction=null}}class Ql extends $(){constructor(e,t){super(),this.id=Se(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new _v,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(n,s)=>s?n/s*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new g("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>{if(this.status!=="reading")throw this.status;return this.status="idle",e}).catch(e=>{throw e==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:e)})}upload(){if(this.status!="idle")throw new g("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{throw this.status==="aborted"?"aborted":(this.status="error",e)})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?e=="reading"?this._reader.abort():e=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise((n,s)=>{t.rejecter=s,t.isFulfilled=!1,e.then(o=>{t.isFulfilled=!0,n(o)}).catch(o=>{t.isFulfilled=!0,s(o)})}),t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vv extends E{constructor(e){super(e),this.buttonView=new I(e),this._fileInputView=new yv(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class yv extends E{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class L5 extends b{static get requires(){return[tn]}static get pluginName(){return"Base64UploadAdapter"}init(){this.editor.plugins.get(tn).createUploadAdapter=e=>new Cv(e)}}class Cv{constructor(e){this.loader=e}upload(){return new Promise((e,t)=>{const n=this.reader=new window.FileReader;n.addEventListener("load",()=>{e({default:n.result})}),n.addEventListener("error",s=>{t(s)}),n.addEventListener("abort",()=>{t()}),this.loader.file.then(s=>{n.readAsDataURL(s)})})}abort(){this.reader.abort()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xh{constructor(e,t=20){this._batch=null,this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(n,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kv extends T{constructor(e,t){super(e),this._buffer=new Xh(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,n=t.document,s=e.text||"",o=s.length;let r=n.selection;if(e.selection?r=e.selection:e.range&&(r=t.createSelection(e.range)),!t.canEditAt(r))return;const a=e.resultRange;t.enqueueChange(this._buffer.batch,l=>{this._buffer.lock(),t.deleteContent(r),s&&t.insertContent(l.createText(s,n.selection.getAttributes()),r),a?l.setSelection(a):r.is("documentSelection")||l.setSelection(r),this._buffer.unlock(),this._buffer.input(o)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Yl=["insertText","insertReplacementText"];class Av extends lt{constructor(e){super(e),this.focusObserver=e.getObserver(Ss),V.isAndroid&&Yl.push("insertCompositionText");const t=e.document;t.on("beforeinput",(n,s)=>{if(!this.isEnabled)return;const{data:o,targetRanges:r,inputType:a,domEvent:l}=s;if(!Yl.includes(a))return;this.focusObserver.flush();const c=new bt(t,"insertText");t.fire(c,new Nn(e,l,{text:o,selection:e.createSelection(r)})),c.stop.called&&n.stop()}),t.on("compositionend",(n,{data:s,domEvent:o})=>{!this.isEnabled||V.isAndroid||s&&t.fire("insertText",new Nn(e,o,{text:s,selection:t.selection}))},{priority:"lowest"})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ev extends b{static get pluginName(){return"Input"}init(){const e=this.editor,t=e.model,n=e.editing.view,s=t.document.selection;n.addObserver(Av);const o=new kv(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",o),e.commands.add("input",o),this.listenTo(n.document,"insertText",(r,a)=>{n.document.isComposing||a.preventDefault();const{text:l,selection:c,resultRange:d}=a,u=Array.from(c.getRanges()).map(f=>e.editing.mapper.toModelRange(f));let h=l;if(V.isAndroid){const f=Array.from(u[0].getItems()).reduce((p,w)=>p+(w.is("$textProxy")?w.data:""),"");f&&(f.length<=h.length?h.startsWith(f)&&(h=h.substring(f.length),u[0].start=u[0].start.getShiftedBy(f.length)):f.startsWith(h)&&(u[0].start=u[0].start.getShiftedBy(h.length),h=""))}const m={text:h,selection:t.createSelection(u)};d&&(m.resultRange=e.editing.mapper.toModelRange(d)),e.execute("insertText",m),n.scrollToTheSelection()}),V.isAndroid?this.listenTo(n.document,"keydown",(r,a)=>{s.isCollapsed||a.keyCode!=229||!n.document.isComposing||Xl(t,o)}):this.listenTo(n.document,"compositionstart",()=>{s.isCollapsed||Xl(t,o)})}}function Xl(i,e){if(!e.isEnabled)return;const t=e.buffer;t.lock(),i.enqueueChange(t.batch,()=>{i.deleteContent(i.document.selection)}),t.unlock()}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zl extends T{constructor(e,t){super(e),this.direction=t,this._buffer=new Xh(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,n=t.document;t.enqueueChange(this._buffer.batch,s=>{this._buffer.lock();const o=s.createSelection(e.selection||n.selection);if(!t.canEditAt(o))return;const r=e.sequence||1,a=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(r)){this._replaceEntireContentWithParagraph(s);return}if(this._shouldReplaceFirstBlockWithParagraph(o,r)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let l=0;o.getFirstRange().getMinimalFlatRanges().forEach(c=>{l+=jo(c.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:a,direction:this.direction}),this._buffer.input(l),s.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s);if(!(s.isCollapsed&&s.containsEntireContent(o))||!t.schema.checkChild(o,"paragraph"))return!1;const a=o.getChild(0);return!(a&&a.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s),r=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(r,o),e.setSelection(r,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const n=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const s=e.getFirstPosition(),o=n.schema.getLimitElement(s),r=o.getChild(0);return!(s.parent!=r||!e.containsEntireContent(r)||!n.schema.checkChild(o,"paragraph")||r.name=="paragraph")}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tv="character",ec="word",Sv="codePoint",Pt="selection",Pn="backward",si="forward",Zh={deleteContent:{unit:Pt,direction:Pn},deleteContentBackward:{unit:Sv,direction:Pn},deleteWordBackward:{unit:ec,direction:Pn},deleteHardLineBackward:{unit:Pt,direction:Pn},deleteSoftLineBackward:{unit:Pt,direction:Pn},deleteContentForward:{unit:Tv,direction:si},deleteWordForward:{unit:ec,direction:si},deleteHardLineForward:{unit:Pt,direction:si},deleteSoftLineForward:{unit:Pt,direction:si}};class xv extends lt{constructor(e){super(e);const t=e.document;let n=0;t.on("keydown",()=>{n++}),t.on("keyup",()=>{n=0}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{targetRanges:r,domEvent:a,inputType:l}=o,c=Zh[l];if(!c)return;const d={direction:c.direction,unit:c.unit,sequence:n};d.unit==Pt&&(d.selectionToRemove=e.createSelection(r[0])),l==="deleteContentBackward"&&(V.isAndroid&&(d.sequence=1),Iv(r)&&(d.unit=Pt,d.selectionToRemove=e.createSelection(r)));const u=new Hn(t,"delete",r[0]);t.fire(u,new Nn(e,a,d)),u.stop.called&&s.stop()}),V.isBlink&&Pv(this)}observe(){}stopObserving(){}}function Pv(i){const e=i.view,t=e.document;let n=null,s=!1;t.on("keydown",(a,{keyCode:l})=>{n=l,s=!1}),t.on("keyup",(a,{keyCode:l,domEvent:c})=>{const d=t.selection,u=i.isEnabled&&l==n&&o(l)&&!d.isCollapsed&&!s;if(n=null,u){const h=d.getFirstRange(),m=new Hn(t,"delete",h),f={unit:Pt,direction:r(l),selectionToRemove:d};t.fire(m,new Nn(e,c,f))}}),t.on("beforeinput",(a,{inputType:l})=>{const c=Zh[l];o(n)&&c&&c.direction==r(n)&&(s=!0)},{priority:"high"}),t.on("beforeinput",(a,{inputType:l,data:c})=>{n==O.delete&&l=="insertText"&&c==""&&a.stop()},{priority:"high"});function o(a){return a==O.backspace||a==O.delete}function r(a){return a==O.backspace?Pn:si}}function Iv(i){if(i.length!=1||i[0].isCollapsed)return!1;const e=i[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let t=0;for(const{nextPosition:n}of e){if(!n.parent.is("$text"))t++;else{const s=n.parent.data,o=n.offset;if(Dr(s,o)||zr(s,o)||Eu(s,o))continue;t++}if(t>1)return!0}return!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _t extends b{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.model.document;t.addObserver(xv),this._undoOnBackspace=!1;const o=new Zl(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new Zl(e,"backward")),this.listenTo(n,"delete",(r,a)=>{n.isComposing||a.preventDefault();const{direction:l,sequence:c,selectionToRemove:d,unit:u}=a,h=l==="forward"?"deleteForward":"delete",m={sequence:c};if(u=="selection"){const f=Array.from(d.getRanges()).map(p=>e.editing.mapper.toModelRange(p));m.selection=e.model.createSelection(f)}else m.unit=u;e.execute(h,m),t.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(n,"delete",(r,a)=>{this._undoOnBackspace&&a.direction=="backward"&&a.sequence==1&&a.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),a.preventDefault(),r.stop())},{context:"$capture"}),this.listenTo(s,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rv extends b{static get requires(){return[Ev,_t]}static get pluginName(){return"Typing"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vv(i,e){let t=i.start;return{text:Array.from(i.getWalker({ignoreElementEnd:!1})).reduce((s,{item:o})=>o.is("$text")||o.is("$textProxy")?s+o.data:(t=e.createPositionAfter(o),""),""),range:e.createRange(t,i.end)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class em extends $(){constructor(e,t){super(),this.model=e,this.testCallback=t,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(n,{directChange:s})=>{if(s){if(!t.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(t,"change:data",(n,s)=>{s.isUndo||!s.isLocal||this._evaluateTextBeforeSelection("data",{batch:s})})}_evaluateTextBeforeSelection(e,t={}){const n=this.model,o=n.document.selection,r=n.createRange(n.createPositionAt(o.focus.parent,0),o.focus),{text:a,range:l}=Vv(r,n),c=this.testCallback(a);if(!c&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!c,c){const d=Object.assign(t,{text:a,range:l});typeof c=="object"&&Object.assign(d,c),this.fire(`matched:${e}`,d)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tc extends b{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.locale,o=t.document.selection;this.listenTo(n.document,"arrowKey",(r,a)=>{if(!o.isCollapsed||a.shiftKey||a.altKey||a.ctrlKey)return;const l=a.keyCode==O.arrowright,c=a.keyCode==O.arrowleft;if(!l&&!c)return;const d=s.contentLanguageDirection;let u=!1;d==="ltr"&&l||d==="rtl"&&c?u=this._handleForwardMovement(a):u=this._handleBackwardMovement(a),u===!0&&r.stop()},{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(o,"change:range",(r,a)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!a.directChange&&gs(o.getFirstPosition(),this.attributes)||this._restoreGravity())})}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,s=this.editor.model.document.selection,o=s.getFirstPosition();return this._isGravityOverridden||o.isAtStart&&Eo(s,t)?!1:gs(o,t)?(is(e),this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,o=s.getFirstPosition();return this._isGravityOverridden?(is(e),this._restoreGravity(),To(n,t,o),!0):o.isAtStart?Eo(s,t)?(is(e),To(n,t,o),!0):!1:Bv(o,t)?o.isAtEnd&&!Eo(s,t)&&gs(o,t)?(is(e),To(n,t,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Eo(i,e){for(const t of e)if(i.hasAttribute(t))return!0;return!1}function To(i,e,t){const n=t.nodeBefore;i.change(s=>{if(n){const o=[],r=i.schema.isObject(n)&&i.schema.isInline(n);for(const[a,l]of n.getAttributes())i.schema.checkAttribute("$text",a)&&(!r||i.schema.getAttributeProperties(a).copyFromObject!==!1)&&o.push([a,l]);s.setSelectionAttribute(o)}else s.removeSelectionAttribute(e)})}function is(i){i.preventDefault()}function Bv(i,e){const t=i.getShiftedBy(-1);return gs(t,e)}function gs(i,e){const{nodeBefore:t,nodeAfter:n}=i;for(const s of e){const o=t?t.getAttribute(s):void 0;if((n?n.getAttribute(s):void 0)!==o)return!0}return!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const nc={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:vn('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:vn("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:vn("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:vn('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:vn('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:vn("'"),to:[null,"‚",null,"’"]}},ic={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},Mv=["symbols","mathematical","typography","quotes"];class D5 extends b{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(e){super(e),e.config.define("typing",{transformations:{include:Mv}})}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,n=e.plugins.get("Delete"),s=Lv(e.config.get("typing.transformations")),o=a=>{for(const l of s)if(l.from.test(a))return{normalizedTransformation:l}},r=new em(e.model,o);r.on("matched:data",(a,l)=>{if(!l.batch.isTyping)return;const{from:c,to:d}=l.normalizedTransformation,u=c.exec(l.text),h=d(u.slice(1)),m=l.range;let f=u.index;t.enqueueChange(p=>{for(let w=1;w<u.length;w++){const v=u[w],C=h[w-1];if(C==null){f+=v.length;continue}const B=m.start.getShiftedBy(f),D=t.createRange(B,B.getShiftedBy(v.length)),Z=Fv(B);t.insertContent(p.createText(C,Z),D),f+=C.length}t.enqueueChange(()=>{n.requestUndoOnBackspace()})})}),r.bind("isEnabled").to(this)}}function Ov(i){return typeof i=="string"?new RegExp(`(${jf(i)})$`):i}function Nv(i){return typeof i=="string"?()=>[i]:i instanceof Array?()=>i:i}function Fv(i){return(i.textNode?i.textNode:i.nodeAfter).getAttributes()}function vn(i){return new RegExp(`(^|\\s)(${i})([^${i}]*)(${i})$`)}function Lv(i){const e=i.extra||[],t=i.remove||[],n=o=>!t.includes(o),s=i.include.concat(e).filter(n);return Dv(s).filter(n).map(o=>typeof o=="string"&&nc[o]?nc[o]:o).filter(o=>typeof o=="object").map(o=>({from:Ov(o.from),to:Nv(o.to)}))}function Dv(i){const e=new Set;for(const t of i)if(typeof t=="string"&&ic[t])for(const n of ic[t])e.add(n);else e.add(t);return Array.from(e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tm(i,e,t,n){return n.createRange(dr(i,e,t,!0,n),dr(i,e,t,!1,n))}function dr(i,e,t,n,s){let o=i.textNode||(n?i.nodeBefore:i.nodeAfter),r=null;for(;o&&o.getAttribute(e)==t;)r=o,o=n?o.previousSibling:o.nextSibling;return r?s.createPositionAt(r,n?"before":"after"):i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zv(i,e,t,n){const s=i.editing.view,o=new Set;s.document.registerPostFixer(r=>{const a=i.model.document.selection;let l=!1;if(a.hasAttribute(e)){const c=tm(a.getFirstPosition(),e,a.getAttribute(e),i.model),d=i.editing.mapper.toViewRange(c);for(const u of d.getItems())u.is("element",t)&&!u.hasClass(n)&&(r.addClass(n,u),o.add(u),l=!0)}return l}),i.conversion.for("editingDowncast").add(r=>{r.on("insert",a,{priority:"highest"}),r.on("remove",a,{priority:"highest"}),r.on("attribute",a,{priority:"highest"}),r.on("selection",a,{priority:"highest"});function a(){s.change(l=>{for(const c of o.values())l.removeClass(n,c),o.delete(c)})}})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Et(i,e,t,n){let s,o=null;typeof n=="function"?s=n:(o=i.commands.get(n),s=()=>{i.execute(n)}),i.model.document.on("change:data",(r,a)=>{if(o&&!o.isEnabled||!e.isEnabled)return;const l=Q(i.model.document.selection.getRanges());if(!l.isCollapsed||a.isUndo||!a.isLocal)return;const c=Array.from(i.model.document.differ.getChanges()),d=c[0];if(c.length!=1||d.type!=="insert"||d.name!="$text"||d.length!=1)return;const u=d.position.parent;if(u.is("element","codeBlock")||u.is("element","listItem")&&typeof n!="function"&&!["numberedList","bulletedList","todoList"].includes(n)||o&&o.value===!0)return;const h=u.getChild(0),m=i.model.createRangeOn(h);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;const f=t.exec(h.data.substr(0,l.end.offset));f&&i.model.enqueueChange(p=>{const w=p.createPositionAt(u,0),v=p.createPositionAt(u,f[0].length),C=new $e(w,v);if(s({match:f})!==!1){p.remove(C);const D=i.model.document.selection.getFirstRange(),Z=p.createRangeIn(u);u.isEmpty&&!Z.isEqual(D)&&!Z.containsRange(D,!0)&&p.remove(u)}C.detach(),i.model.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})})})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function yn(i,e,t,n){let s,o;t instanceof RegExp?s=t:o=t,o=o||(r=>{let a;const l=[],c=[];for(;(a=s.exec(r))!==null&&!(a&&a.length<4);){let{index:d,"1":u,"2":h,"3":m}=a;const f=u+h+m;d+=a[0].length-f.length;const p=[d,d+u.length],w=[d+u.length+h.length,d+u.length+h.length+m.length];l.push(p),l.push(w),c.push([d+u.length,d+u.length+h.length])}return{remove:l,format:c}}),i.model.document.on("change:data",(r,a)=>{if(a.isUndo||!a.isLocal||!e.isEnabled)return;const l=i.model,c=l.document.selection;if(!c.isCollapsed)return;const d=Array.from(l.document.differ.getChanges()),u=d[0];if(d.length!=1||u.type!=="insert"||u.name!="$text"||u.length!=1)return;const h=c.focus,m=h.parent,{text:f,range:p}=Hv(l.createRange(l.createPositionAt(m,0),h),l),w=o(f),v=sc(p.start,w.format,l),C=sc(p.start,w.remove,l);v.length&&C.length&&l.enqueueChange(B=>{if(n(B,v)!==!1){for(const Z of C.reverse())B.remove(Z);l.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})}})})}function sc(i,e,t){return e.filter(n=>n[0]!==void 0&&n[1]!==void 0).map(n=>t.createRange(i.getShiftedBy(n[0]),i.getShiftedBy(n[1])))}function Hv(i,e){let t=i.start;return{text:Array.from(i.getItems()).reduce((s,o)=>!(o.is("$text")||o.is("$textProxy"))||o.getAttribute("code")?(t=e.createPositionAfter(o),""):s+o.data,""),range:e.createRange(t,i.end)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class z5 extends b{static get requires(){return[_t]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&Et(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&Et(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&Et(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&Et(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const t=ss(this.editor,"bold");yn(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,t),yn(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,t)}if(e.get("italic")){const t=ss(this.editor,"italic");yn(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,t),yn(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,t)}if(e.get("code")){const t=ss(this.editor,"code");yn(this.editor,this,/(`)([^`]+)(`)$/g,t)}if(e.get("strikethrough")){const t=ss(this.editor,"strikethrough");yn(this.editor,this,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(t=>{const n=t[7],s=new RegExp(`^(#{${n}})\\s$`);Et(this.editor,this,s,()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&Et(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&Et(e,this,/^```$/,()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&Et(this.editor,this,/^---$/,"horizontalLine")}}function ss(i,e){return(t,n)=>{if(!i.commands.get(e).isEnabled)return!1;const o=i.model.schema.getValidRanges(n,e);for(const r of o)t.setAttribute(e,!0,r);t.removeSelectionAttribute(e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bi extends T{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;t.change(r=>{if(s.isCollapsed)o?r.setSelectionAttribute(this.attributeKey,!0):r.removeSelectionAttribute(this.attributeKey);else{const a=t.schema.getValidRanges(s.getRanges(),this.attributeKey);for(const l of a)o?r.setAttribute(this.attributeKey,o,l):r.removeAttribute(this.attributeKey,l)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,n=e.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const s of n.getRanges())for(const o of s.getItems())if(t.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Cn="bold";class Wv extends b{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Cn}),e.model.schema.setAttributeProperties(Cn,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Cn,view:"strong",upcastAlso:["b",t=>{const n=t.getStyle("font-weight");return n&&(n=="bold"||Number(n)>=600)?{name:!0,styles:["font-weight"]}:null}]}),e.commands.add(Cn,new Bi(e,Cn)),e.keystrokes.set("CTRL+B",Cn)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const So="bold";class $v extends b{static get pluginName(){return"BoldUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(So,n=>{const s=e.commands.get(So),o=new I(n);return o.set({label:t("Bold"),icon:R.bold,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(So),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class H5 extends b{static get requires(){return[Wv,$v]}static get pluginName(){return"Bold"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const jt="code",Uv="ck-code_selected";class qv extends b{static get pluginName(){return"CodeEditing"}static get requires(){return[tc]}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:jt}),e.model.schema.setAttributeProperties(jt,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:jt,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(jt,new Bi(e,jt)),e.plugins.get(tc).registerAttribute(jt),zv(e,jt,"code",Uv)}}const jv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const xo="code";class Gv extends b{static get pluginName(){return"CodeUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(xo,n=>{const s=e.commands.get(xo),o=new I(n);return o.set({label:t("Code"),icon:jv,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(xo),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class W5 extends b{static get requires(){return[qv,Gv]}static get pluginName(){return"Code"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const kn="italic";class Kv extends b{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:kn}),e.model.schema.setAttributeProperties(kn,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:kn,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(kn,new Bi(e,kn)),e.keystrokes.set("CTRL+I",kn)}}const Jv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Po="italic";class Qv extends b{static get pluginName(){return"ItalicUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Po,n=>{const s=e.commands.get(Po),o=new I(n);return o.set({label:t("Italic"),icon:Jv,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Po),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $5 extends b{static get requires(){return[Kv,Qv]}static get pluginName(){return"Italic"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Xn="strikethrough";class Yv extends b{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Xn}),e.model.schema.setAttributeProperties(Xn,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Xn,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Xn,new Bi(e,Xn)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}const Xv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Io="strikethrough";class Zv extends b{static get pluginName(){return"StrikethroughUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Io,n=>{const s=e.commands.get(Io),o=new I(n);return o.set({label:t("Strikethrough"),icon:Xv,keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Io),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class U5 extends b{static get requires(){return[Yv,Zv]}static get pluginName(){return"Strikethrough"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Zn="underline";class ey extends b{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Zn}),e.model.schema.setAttributeProperties(Zn,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Zn,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Zn,new Bi(e,Zn)),e.keystrokes.set("CTRL+U","underline")}}const ty='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ro="underline";class ny extends b{static get pluginName(){return"UnderlineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Ro,n=>{const s=e.commands.get(Ro),o=new I(n);return o.set({label:t("Underline"),icon:ty,keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute(Ro),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q5 extends b{static get requires(){return[ey,ny]}static get pluginName(){return"Underline"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*nm(i,e){for(const t of e)t&&i.getAttributeProperties(t[0]).copyOnEnter&&(yield t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iy extends T{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,n=t.document.selection,s=t.schema,o=n.isCollapsed,r=n.getFirstRange(),a=r.start.parent,l=r.end.parent;if(s.isLimit(a)||s.isLimit(l))return!o&&a==l&&t.deleteContent(n),!1;if(o){const c=nm(e.model.schema,n.getAttributes());return oc(e,r.start),e.setSelectionAttribute(c),!0}else{const c=!(r.start.isAtStart&&r.end.isAtEnd),d=a==l;if(t.deleteContent(n,{leaveUnmerged:c}),c){if(d)return oc(e,n.focus),!0;e.setSelection(l,0)}}return!1}}function oc(i,e){i.split(e),i.setSelection(e.parent.nextSibling,0)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const sy={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class im extends lt{constructor(e){super(e);const t=this.document;let n=!1;t.on("keydown",(s,o)=>{n=o.shiftKey}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;let r=o.inputType;V.isSafari&&n&&r=="insertParagraph"&&(r="insertLineBreak");const a=o.domEvent,l=sy[r];if(!l)return;const c=new Hn(t,"enter",o.targetRanges[0]);t.fire(c,new Nn(e,a,{isSoft:l.isSoft})),c.stop.called&&s.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mi extends b{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,n=t.document;t.addObserver(im),e.commands.add("enter",new iy(e)),this.listenTo(n,"enter",(s,o)=>{n.isComposing||o.preventDefault(),!o.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oy extends T{execute(){const e=this.editor.model,t=e.document;e.change(n=>{ay(e,n,t.selection),this.fire("afterExecute",{writer:n})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=ry(e.schema,t.selection)}}function ry(i,e){if(e.rangeCount>1)return!1;const t=e.anchor;if(!t||!i.checkChild(t,"softBreak"))return!1;const n=e.getFirstRange(),s=n.start.parent,o=n.end.parent;return!((ur(s,i)||ur(o,i))&&s!==o)}function ay(i,e,t){const n=t.isCollapsed,s=t.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(n){const l=nm(i.schema,t.getAttributes());rc(i,e,s.end),e.removeSelectionAttribute(t.getAttributeKeys()),e.setSelectionAttribute(l)}else{const l=!(s.start.isAtStart&&s.end.isAtEnd);i.deleteContent(t,{leaveUnmerged:l}),a?rc(i,e,t.focus):l&&e.setSelection(r,0)}}function rc(i,e,t){const n=e.createElement("softBreak");i.insertContent(n,t),e.setSelection(n,"after")}function ur(i,e){return i.is("rootElement")?!1:e.isLimit(i)||ur(i.parent,e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sm extends b{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,n=e.conversion,s=e.editing.view,o=s.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(r,{writer:a})=>a.createEmptyElement("br")}),s.addObserver(im),e.commands.add("shiftEnter",new oy(e)),this.listenTo(o,"enter",(r,a)=>{o.isComposing||a.preventDefault(),a.isSoft&&(e.execute("shiftEnter"),s.scrollToTheSelection())},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ly extends T{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.schema,s=t.document.selection,o=Array.from(s.getSelectedBlocks()),r=e.forceValue===void 0?!this.value:e.forceValue;t.change(a=>{if(!r)this._removeQuote(a,o.filter(os));else{const l=o.filter(c=>os(c)||lc(n,c));this._applyQuote(a,l)}})}_getValue(){const e=this.editor.model.document.selection,t=Q(e.getSelectedBlocks());return!!(t&&os(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Q(e.getSelectedBlocks());return n?lc(t,n):!1}_removeQuote(e,t){ac(e,t).reverse().forEach(n=>{if(n.start.isAtStart&&n.end.isAtEnd){e.unwrap(n.start.parent);return}if(n.start.isAtStart){const o=e.createPositionBefore(n.start.parent);e.move(n,o);return}n.end.isAtEnd||e.split(n.end);const s=e.createPositionAfter(n.end.parent);e.move(n,s)})}_applyQuote(e,t){const n=[];ac(e,t).reverse().forEach(s=>{let o=os(s.start);o||(o=e.createElement("blockQuote"),e.wrap(s,o)),n.push(o)}),n.reverse().reduce((s,o)=>s.nextSibling==o?(e.merge(e.createPositionAfter(s)),s):o)}}function os(i){return i.parent.name=="blockQuote"?i.parent:null}function ac(i,e){let t,n=0;const s=[];for(;n<e.length;){const o=e[n],r=e[n+1];t||(t=i.createPositionBefore(o)),(!r||o.nextSibling!=r)&&(s.push(i.createRange(t,i.createPositionAfter(o))),t=null),n++}return s}function lc(i,e){const t=i.checkChild(e.parent,"blockQuote"),n=i.checkChild(["$root","blockQuote"],e);return t&&n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cy extends b{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[Mi,_t]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new ly(e)),t.register("blockQuote",{inheritAllFrom:"$container"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(r=>{const a=e.model.document.differ.getChanges();for(const l of a)if(l.type=="insert"){const c=l.position.nodeAfter;if(!c)continue;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0;if(c.is("element","blockQuote")&&!t.checkChild(l.position,c))return r.unwrap(c),!0;if(c.is("element")){const d=r.createRangeIn(c);for(const u of d.getItems())if(u.is("element","blockQuote")&&!t.checkChild(r.createPositionBefore(u),u))return r.unwrap(u),!0}}else if(l.type=="remove"){const c=l.position.parent;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0}return!1});const n=this.editor.editing.view.document,s=e.model.document.selection,o=e.commands.get("blockQuote");this.listenTo(n,"enter",(r,a)=>{if(!s.isCollapsed||!o.value)return;s.getLastPosition().parent.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"}),this.listenTo(n,"delete",(r,a)=>{if(a.direction!="backward"||!s.isCollapsed||!o.value)return;const l=s.getLastPosition().parent;l.isEmpty&&!l.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dy extends b{static get pluginName(){return"BlockQuoteUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",n=>{const s=e.commands.get("blockQuote"),o=new I(n);return o.set({label:t("Block quote"),icon:R.quote,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(o,"execute",()=>{e.execute("blockQuote"),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class j5 extends b{static get requires(){return[cy,dy]}static get pluginName(){return"BlockQuote"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uy={autoRefresh:!0},cc=36e5;class ca extends $(){constructor(e,t={}){if(super(),!e)throw new g("token-missing-token-url",this);t.initValue&&this._validateTokenValue(t.initValue),this.set("value",t.initValue),typeof e=="function"?this._refresh=e:this._refresh=()=>hy(e),this._options={...uy,...t}}init(){return new Promise((e,t)=>{if(!this.value){this.refreshToken().then(e).catch(t);return}this._options.autoRefresh&&this._registerRefreshTokenTimeout(),e(this)})}refreshToken(){return this._refresh().then(e=>(this._validateTokenValue(e),this.set("value",e),this._options.autoRefresh&&this._registerRefreshTokenTimeout(),this))}destroy(){clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(e){const t=typeof e=="string",n=!/^".*"$/.test(e),s=t&&e.split(".").length===3;if(!(n&&s))throw new g("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(){const e=this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},e)}_getTokenRefreshTimeoutTime(){try{const[,e]=this.value.split("."),{exp:t}=JSON.parse(atob(e));return t?Math.floor((t*1e3-Date.now())/2):cc}catch{return cc}}static create(e,t={}){return new ca(e,t).init()}}function hy(i){return new Promise((e,t)=>{const n=new XMLHttpRequest;n.open("GET",i),n.addEventListener("load",()=>{const s=n.status,o=n.response;return s<200||s>299?t(new g("token-cannot-download-new-token",null)):e(o)}),n.addEventListener("error",()=>t(new Error("Network Error"))),n.addEventListener("abort",()=>t(new Error("Abort"))),n.send()})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hr=/^data:(\S*?);base64,/;class my extends J(){constructor(e,t,n){if(super(),!e)throw new g("fileuploader-missing-file",null);if(!t)throw new g("fileuploader-missing-token",null);if(!n)throw new g("fileuploader-missing-api-address",null);this.file=gy(e)?fy(e):e,this._token=t,this._apiAddress=n}onProgress(e){return this.on("progress",(t,n)=>e(n)),this}onError(e){return this.once("error",(t,n)=>e(n)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const e=new XMLHttpRequest;e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e}_attachXHRListeners(){const e=this.xhr,t=n=>()=>this.fire("error",n);e.addEventListener("error",t("Network Error")),e.addEventListener("abort",t("Abort"));/* istanbul ignore else -- @preserve */e.upload&&e.upload.addEventListener("progress",n=>{n.lengthComputable&&this.fire("progress",{total:n.total,uploaded:n.loaded})}),e.addEventListener("load",()=>{const n=e.status,s=e.response;if(n<200||n>299)return this.fire("error",s.message||s.error)})}_sendRequest(){const e=new FormData,t=this.xhr;return e.append("file",this.file),new Promise((n,s)=>{t.addEventListener("load",()=>{const o=t.status,r=t.response;return o<200||o>299?r.message?s(new g("fileuploader-uploading-data-failed",this,{message:r.message})):s(r.error):n(r)}),t.addEventListener("error",()=>s(new Error("Network Error"))),t.addEventListener("abort",()=>s(new Error("Abort"))),t.send(e)})}}function fy(i,e=512){try{const t=i.match(hr)[1],n=atob(i.replace(hr,"")),s=[];for(let o=0;o<n.length;o+=e){const r=n.slice(o,o+e),a=new Array(r.length);for(let l=0;l<r.length;l++)a[l]=r.charCodeAt(l);s.push(new Uint8Array(a))}return new Blob(s,{type:t})}catch{throw new g("fileuploader-decoding-image-data-error",null)}}function gy(i){if(typeof i!="string")return!1;const e=i.match(hr);return!!(e&&e.length)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class py{constructor(e,t){if(!e)throw new g("uploadgateway-missing-token",null);if(!t)throw new g("uploadgateway-missing-api-address",null);this._token=e,this._apiAddress=t}upload(e){return new my(e,this._token,this._apiAddress)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class by extends qs{static get pluginName(){return"CloudServicesCore"}createToken(e,t){return new ca(e,t)}createUploadGateway(e,t){return new py(e,t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class G5 extends qs{constructor(){super(...arguments),this.token=null,this._tokens=new Map}static get pluginName(){return"CloudServices"}static get requires(){return[by]}async init(){const t=this.context.config.get("cloudServices")||{};for(const[s,o]of Object.entries(t))this[s]=o;if(!this.tokenUrl){this.token=null;return}const n=this.context.plugins.get("CloudServicesCore");this.token=await n.createToken(this.tokenUrl).init(),this._tokens.set(this.tokenUrl,this.token)}async registerTokenUrl(e){if(this._tokens.has(e))return this.getTokenFor(e);const n=await this.context.plugins.get("CloudServicesCore").createToken(e).init();return this._tokens.set(e,n),n}getTokenFor(e){const t=this._tokens.get(e);if(!t)throw new g("cloudservices-token-not-registered",this);return t}destroy(){super.destroy();for(const e of this._tokens.values())e.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function da(i){const e=i.t,t=i.config.get("codeBlock.languages");for(const n of t)n.label==="Plain text"&&(n.label=e("Plain text")),n.class===void 0&&(n.class=`language-${n.language}`);return t}function mr(i,e,t){const n={};for(const s of i)if(e==="class"){const o=s[e].split(" ").shift();n[o]=s[t]}else n[s[e]]=s[t];return n}function ua(i){return i.data.match(/^(\s*)/)[0]}function wy(i,e){const t=i.createDocumentFragment(),n=e.split(`
`),s=n.reduce((o,r,a)=>(o.push(r),a<n.length-1&&o.push(i.createElement("br")),o),[]);return i.appendChild(s,t),t}function fr(i){const e=i.document.selection,t=[];if(e.isCollapsed)return[e.anchor];const n=e.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:s}of n){if(!s.is("$textProxy"))continue;const{parent:o,startOffset:r}=s.textNode;if(!o.is("element","codeBlock"))continue;const a=ua(s.textNode),l=i.createPositionAt(o,r+a.length);t.push(l)}return t}function om(i){const e=Q(i.getSelectedBlocks());return!!e&&e.is("element","codeBlock")}function dc(i,e){return e.is("rootElement")||i.isLimit(e)?!1:i.checkChild(e.parent,"codeBlock")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _y extends T{constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,n=t.model,s=n.document.selection,r=da(t)[0],a=Array.from(s.getSelectedBlocks()),l=e.forceValue==null?!this.value:e.forceValue,c=vy(e,this._lastLanguage,r.language);n.change(d=>{l?this._applyCodeBlock(d,a,c):this._removeCodeBlock(d,a)})}_getValue(){const e=this.editor.model.document.selection,t=Q(e.getSelectedBlocks());return!!(t&&t.is("element","codeBlock"))?t.getAttribute("language"):!1}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Q(e.getSelectedBlocks());return n?dc(t,n):!1}_applyCodeBlock(e,t,n){this._lastLanguage=n;const s=this.editor.model.schema,o=t.filter(r=>dc(s,r));for(const r of o)e.rename(r,"codeBlock"),e.setAttribute("language",n,r),s.removeDisallowedAttributes([r],e),Array.from(r.getChildren()).filter(a=>!s.checkChild(r,a)).forEach(a=>e.remove(a));o.reverse().forEach((r,a)=>{const l=o[a+1];r.previousSibling===l&&(e.appendElement("softBreak",l),e.merge(e.createPositionBefore(r)))})}_removeCodeBlock(e,t){const n=t.filter(s=>s.is("element","codeBlock"));for(const s of n){const o=e.createRangeOn(s);for(const r of Array.from(o.getItems()).reverse())if(r.is("element","softBreak")&&r.parent.is("element","codeBlock")){const{position:a}=e.split(e.createPositionBefore(r)),l=a.nodeAfter;e.rename(l,"paragraph"),e.removeAttribute("language",l),e.remove(r)}e.rename(s,"paragraph"),e.removeAttribute("language",s)}}}function vy(i,e,t){return i.language?i.language:i.usePreviousLanguageChoice&&e?e:t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yy extends T{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(n=>{const s=fr(t);for(const o of s){const r=n.createText(this._indentSequence);t.insertContent(r,o)}})}_checkEnabled(){return this._indentSequence?om(this.editor.model.document.selection):!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Cy extends T{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(()=>{const n=fr(t);for(const s of n){const o=uc(t,s,this._indentSequence);o&&t.deleteContent(t.createSelection(o))}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return om(e.document.selection)?fr(e).some(t=>uc(e,t,this._indentSequence)):!1}}function uc(i,e,t){const n=ky(e);if(!n)return null;const s=ua(n),o=s.lastIndexOf(t);if(o+t.length!==s.length||o===-1)return null;const{parent:r,startOffset:a}=n;return i.createRange(i.createPositionAt(r,a+o),i.createPositionAt(r,a+o+t.length))}function ky(i){let e=i.parent.getChild(i.index);return(!e||e.is("element","softBreak"))&&(e=i.nodeBefore),!e||e.is("element","softBreak")?null:e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hc(i,e,t=!1){const n=mr(e,"language","class"),s=mr(e,"language","label");return(o,r,a)=>{const{writer:l,mapper:c,consumable:d}=a;if(!d.consume(r.item,"insert"))return;const u=r.item.getAttribute("language"),h=c.toViewPosition(i.createPositionBefore(r.item)),m={};t&&(m["data-language"]=s[u],m.spellcheck="false");const f=n[u]?{class:n[u]}:void 0,p=l.createContainerElement("code",f),w=l.createContainerElement("pre",m,p);l.insert(h,w),c.bindElements(r.item,p)}}function Ay(i){return(e,t,n)=>{if(t.item.parent.name!=="codeBlock")return;const{writer:s,mapper:o,consumable:r}=n;if(!r.consume(t.item,"insert"))return;const a=o.toViewPosition(i.createPositionBefore(t.item));s.insert(a,s.createText(`
`))}}function Ey(i,e){const t=mr(e,"class","language"),n=e[0].language;return(s,o,r)=>{const a=o.viewItem,l=a.parent;if(!l||!l.is("element","pre")||o.modelCursor.findAncestor("codeBlock"))return;const{consumable:c,writer:d}=r;if(!c.test(a,{name:!0}))return;const u=d.createElement("codeBlock"),h=[...a.getClassNames()];h.length||h.push("");for(const m of h){const f=t[m];if(f){d.setAttribute("language",f,u);break}}u.hasAttribute("language")||d.setAttribute("language",n,u),r.convertChildren(a,u),r.safeInsert(u,o.modelCursor)&&(c.consume(a,{name:!0}),r.updateConversionResult(u,o))}}function Ty(){return(i,e,{consumable:t,writer:n})=>{let s=e.modelCursor;if(!t.test(e.viewItem)||!s.findAncestor("codeBlock"))return;t.consume(e.viewItem);const r=e.viewItem.data.split(`
`).map(l=>n.createText(l)),a=r[r.length-1];for(const l of r)if(n.insert(l,s),s=s.getShiftedBy(l.offsetSize),l!==a){const c=n.createElement("softBreak");n.insert(c,s),s=n.createPositionAfter(c)}e.modelRange=n.createRange(e.modelCursor,s),e.modelCursor=s}}function Sy(){return(i,e,{consumable:t})=>{const n=e.viewItem;if(n.findAncestor("pre"))return;const s=Array.from(n.getChildren()),o=s.find(r=>r.is("element","code"));if(o)for(const r of s)r===o||!r.is("$text")||t.consume(r,{name:!0})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const rm="paragraph";class xy extends b{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[sm]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"	"})}init(){const e=this.editor,t=e.model.schema,n=e.model,s=e.editing.view,o=e.plugins.has("DocumentListEditing"),r=da(e);e.commands.add("codeBlock",new _y(e)),e.commands.add("indentCodeBlock",new yy(e)),e.commands.add("outdentCodeBlock",new Cy(e)),this.listenTo(s.document,"tab",(a,l)=>{const c=l.shiftKey?"outdentCodeBlock":"indentCodeBlock";e.commands.get(c).isEnabled&&(e.execute(c),l.stopPropagation(),l.preventDefault(),a.stop())},{context:"pre"}),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",isBlock:!0,allowAttributes:["language"]}),t.addAttributeCheck((a,l)=>{const c=a.endsWith("codeBlock")&&l.startsWith("list")&&l!=="list";if(o&&c)return!0;if(a.endsWith("codeBlock $text"))return!1}),e.model.schema.addChildCheck((a,l)=>{if(a.endsWith("codeBlock")&&l.isObject)return!1}),e.editing.downcastDispatcher.on("insert:codeBlock",hc(n,r,!0)),e.data.downcastDispatcher.on("insert:codeBlock",hc(n,r)),e.data.downcastDispatcher.on("insert:softBreak",Ay(n),{priority:"high"}),e.data.upcastDispatcher.on("element:code",Ey(s,r)),e.data.upcastDispatcher.on("text",Ty()),e.data.upcastDispatcher.on("element:pre",Sy(),{priority:"high"}),this.listenTo(e.editing.view.document,"clipboardInput",(a,l)=>{let c=n.createRange(n.document.selection.anchor);if(l.targetRanges&&(c=e.editing.mapper.toModelRange(l.targetRanges[0])),!c.start.parent.is("element","codeBlock"))return;const d=l.dataTransfer.getData("text/plain"),u=new Ze(e.editing.view.document);l.content=wy(u,d)}),this.listenTo(n,"getSelectedContent",(a,[l])=>{const c=l.anchor;l.isCollapsed||!c.parent.is("element","codeBlock")||!c.hasSameParentAs(l.focus)||n.change(d=>{const u=a.return;if(c.parent.is("element")&&(u.childCount>1||l.containsEntireContent(c.parent))){const m=d.createElement("codeBlock",c.parent.getAttributes());d.append(u,m);const f=d.createDocumentFragment();d.append(m,f),a.return=f;return}const h=u.getChild(0);t.checkAttribute(h,"code")&&d.setAttribute("code",!0,h)})})}afterInit(){const e=this.editor,t=e.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentCodeBlock"),{priority:"highest"}),s&&s.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",(o,r)=>{e.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(!Iy(e,r.isSoft)&&!Ry(e,r.isSoft)&&Py(e),r.preventDefault(),o.stop())},{context:"pre"})}}function Py(i){const t=i.model.document,n=t.selection.getLastPosition(),s=n.nodeBefore||n.textNode;let o;s&&s.is("$text")&&(o=ua(s)),i.model.change(r=>{i.execute("shiftEnter"),o&&r.insertText(o,t.selection.anchor)})}function Iy(i,e){const n=i.model.document,s=i.editing.view,o=n.selection.getLastPosition(),r=o.nodeAfter;return e||!n.selection.isCollapsed||!o.isAtStart||!Qt(r)?!1:(i.model.change(a=>{i.execute("enter");const l=n.selection.anchor.parent.previousSibling;a.rename(l,rm),a.setSelection(l,"in"),i.model.schema.removeDisallowedAttributes([l],a),a.remove(r)}),s.scrollToTheSelection(),!0)}function Ry(i,e){const t=i.model,n=t.document,s=i.editing.view,o=n.selection.getLastPosition(),r=o.nodeBefore;let a;if(e||!n.selection.isCollapsed||!o.isAtEnd||!r||!r.previousSibling)return!1;if(Qt(r)&&Qt(r.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling),t.createPositionAfter(r));else if(Vo(r)&&Qt(r.previousSibling)&&Qt(r.previousSibling.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling.previousSibling),t.createPositionAfter(r));else if(Vo(r)&&Qt(r.previousSibling)&&Vo(r.previousSibling.previousSibling)&&r.previousSibling.previousSibling&&Qt(r.previousSibling.previousSibling.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling.previousSibling.previousSibling),t.createPositionAfter(r));else return!1;return i.model.change(l=>{l.remove(a),i.execute("enter");const c=n.selection.anchor.parent;l.rename(c,rm),i.model.schema.removeDisallowedAttributes([c],l)}),s.scrollToTheSelection(),!0}function Vo(i){return i&&i.is("$text")&&!i.data.match(/\S/)}function Qt(i){return i&&i.is("element","softBreak")}const Vy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class By extends b{static get pluginName(){return"CodeBlockUI"}init(){const e=this.editor,t=e.t,n=e.ui.componentFactory,s=da(e);n.add("codeBlock",o=>{const r=e.commands.get("codeBlock"),a=de(o,Wn),l=a.buttonView,c=t("Insert code block");return l.set({label:c,tooltip:!0,icon:Vy,isToggleable:!0}),l.bind("isOn").to(r,"value",d=>!!d),l.on("execute",()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()}),a.on("execute",d=>{e.execute("codeBlock",{language:d.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()}),a.class="ck-code-block-dropdown",a.bind("isEnabled").to(r),kt(a,()=>this._getLanguageListItemDefinitions(s),{role:"menu",ariaLabel:c}),a})}_getLanguageListItemDefinitions(e){const n=this.editor.commands.get("codeBlock"),s=new ge;for(const o of e){const r={type:"button",model:new wt({_codeBlockLanguage:o.language,label:o.label,role:"menuitemradio",withText:!0})};r.model.bind("isOn").to(n,"value",a=>a===r.model._codeBlockLanguage),s.add(r)}return s}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K5 extends b{static get requires(){return[xy,By]}static get pluginName(){return"CodeBlock"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ha extends ln{constructor(e){super(e),this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"];const t=this.document;this.listenTo(t,"paste",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",n("dragging"),{priority:"low"});function n(s){return(o,r)=>{r.preventDefault();const a=r.dropRange?[r.dropRange]:null,l=new bt(t,s);t.fire(l,{dataTransfer:r.dataTransfer,method:o.name,targetRanges:a,target:r.target,domEvent:r.domEvent}),l.stop.called&&r.stopPropagation()}}}onDomEvent(e){const t="clipboardData"in e?e.clipboardData:e.dataTransfer,n=e.type=="drop"||e.type=="paste",s={dataTransfer:new Zu(t,{cacheFiles:n})};(e.type=="drop"||e.type=="dragover")&&(s.dropRange=My(this.view,e)),this.fire(e.type,e,s)}}function My(i,e){const t=e.target.ownerDocument,n=e.clientX,s=e.clientY;let o;return t.caretRangeFromPoint&&t.caretRangeFromPoint(n,s)?o=t.caretRangeFromPoint(n,s):e.rangeParent&&(o=t.createRange(),o.setStart(e.rangeParent,e.rangeOffset),o.collapse(!0)),o?i.domConverter.domRangeToView(o):null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Oy(i){return i=i.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(i.includes("</p><p>")||i.includes("<br>"))&&(i=`<p>${i}</p>`),i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ny(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>t.length==1?" ":t).replace(/<!--[\s\S]*?-->/g,"")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mc=["figcaption","li"];function am(i){let e="";if(i.is("$text")||i.is("$textProxy"))e=i.data;else if(i.is("element","img")&&i.hasAttribute("alt"))e=i.getAttribute("alt");else if(i.is("element","br"))e=`
`;else{let t=null;for(const n of i.getChildren()){const s=am(n);t&&(t.is("containerElement")||n.is("containerElement"))&&(mc.includes(t.name)||mc.includes(n.name)?e+=`
`:e+=`

`),e+=s,t=n}}return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vt extends b{static get pluginName(){return"ClipboardPipeline"}init(){this.editor.editing.view.addObserver(ha),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document;this.listenTo(s,"clipboardInput",(o,r)=>{r.method=="paste"&&!e.model.canEditAt(e.model.document.selection)&&o.stop()},{priority:"highest"}),this.listenTo(s,"clipboardInput",(o,r)=>{const a=r.dataTransfer;let l;if(r.content)l=r.content;else{let d="";a.getData("text/html")?d=Ny(a.getData("text/html")):a.getData("text/plain")&&(d=Oy(a.getData("text/plain"))),l=this.editor.data.htmlProcessor.toView(d)}const c=new bt(this,"inputTransformation");this.fire(c,{content:l,dataTransfer:a,targetRanges:r.targetRanges,method:r.method}),c.stop.called&&o.stop(),n.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(o,r)=>{if(r.content.isEmpty)return;const l=this.editor.data.toModel(r.content,"$clipboardHolder");l.childCount!=0&&(o.stop(),t.change(()=>{this.fire("contentInsertion",{content:l,method:r.method,dataTransfer:r.dataTransfer,targetRanges:r.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(o,r)=>{r.resultRange=t.insertContent(r.content)},{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,s=e.editing.view.document,o=(r,a)=>{const l=a.dataTransfer;a.preventDefault();const c=e.data.toView(e.model.getSelectedContent(t.selection));s.fire("clipboardOutput",{dataTransfer:l,content:c,method:r.name})};this.listenTo(s,"copy",o,{priority:"low"}),this.listenTo(s,"cut",(r,a)=>{e.model.canEditAt(e.model.document.selection)?o(r,a):a.preventDefault()},{priority:"low"}),this.listenTo(s,"clipboardOutput",(r,a)=>{a.content.isEmpty||(a.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(a.content)),a.dataTransfer.setData("text/plain",am(a.content))),a.method=="cut"&&e.model.deleteContent(t.selection)},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fy extends J(){constructor(){super(...arguments),this._stack=[]}add(e,t){const n=this._stack,s=n[0];this._insertDescriptor(e);const o=n[0];s!==o&&!Bo(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}remove(e,t){const n=this._stack,s=n[0];this._removeDescriptor(e);const o=n[0];s!==o&&!Bo(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}_insertDescriptor(e){const t=this._stack,n=t.findIndex(o=>o.id===e.id);if(Bo(e,t[n]))return;n>-1&&t.splice(n,1);let s=0;for(;t[s]&&Ly(t[s],e);)s++;t.splice(s,0,e)}_removeDescriptor(e){const t=this._stack,n=t.findIndex(s=>s.id===e);n>-1&&t.splice(n,1)}}function Bo(i,e){return i&&e&&i.priority==e.priority&&Is(i.classes)==Is(e.classes)}function Ly(i,e){return i.priority>e.priority?!0:i.priority<e.priority?!1:Is(i.classes)>Is(e.classes)}function Is(i){return Array.isArray(i)?i.sort().join(","):i}const Dy='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const zy="ck-widget",fc="ck-widget_selected";function se(i){return i.is("element")?!!i.getCustomProperty("widget"):!1}function dn(i,e,t={}){if(!i.is("containerElement"))throw new g("widget-to-widget-wrong-element-type",null,{element:i});return e.setAttribute("contenteditable","false",i),e.addClass(zy,i),e.setCustomProperty("widget",!0,i),i.getFillerOffset=qy,e.setCustomProperty("widgetLabel",[],i),t.label&&$y(i,t.label),t.hasSelectionHandle&&jy(i,e),lm(i,e),i}function Hy(i,e,t){if(e.classes&&t.addClass(q(e.classes),i),e.attributes)for(const n in e.attributes)t.setAttribute(n,e.attributes[n],i)}function Wy(i,e,t){if(e.classes&&t.removeClass(q(e.classes),i),e.attributes)for(const n in e.attributes)t.removeAttribute(n,i)}function lm(i,e,t=Hy,n=Wy){const s=new Fy;s.on("change:top",(a,l)=>{l.oldDescriptor&&n(i,l.oldDescriptor,l.writer),l.newDescriptor&&t(i,l.newDescriptor,l.writer)});const o=(a,l,c)=>s.add(l,c),r=(a,l,c)=>s.remove(l,c);e.setCustomProperty("addHighlight",o,i),e.setCustomProperty("removeHighlight",r,i)}function $y(i,e){i.getCustomProperty("widgetLabel").push(e)}function Uy(i){return i.getCustomProperty("widgetLabel").reduce((t,n)=>typeof n=="function"?t?t+". "+n():n():t?t+". "+n:n,"")}function cm(i,e,t={}){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],i),e.setAttribute("role","textbox",i),t.label&&e.setAttribute("aria-label",t.label,i),e.setAttribute("contenteditable",i.isReadOnly?"false":"true",i),i.on("change:isReadOnly",(n,s,o)=>{e.setAttribute("contenteditable",o?"false":"true",i)}),i.on("change:isFocused",(n,s,o)=>{o?e.addClass("ck-editor__nested-editable_focused",i):e.removeClass("ck-editor__nested-editable_focused",i)}),lm(i,e),i}function Xs(i,e){const t=i.getSelectedElement();if(t){const n=St(i);if(n)return e.createRange(e.createPositionAt(t,n))}return Ph(i,e)}function qy(){return null}function jy(i,e){const t=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(n){const s=this.toDomElement(n),o=new Lt;return o.set("content",Dy),o.render(),s.appendChild(o.element),s});e.insert(e.createPositionAt(i,0),t),e.addClass(["ck-widget_with-selection-handle"],i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mt="widget-type-around";function Gt(i,e,t){return!!i&&se(i)&&!t.isInline(e)}function Gy(i){return i.closest(".ck-widget__type-around__button")}function Ky(i){return i.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function Jy(i,e){const t=i.closest(".ck-widget");return e.mapDomToView(t)}function St(i){return i.getAttribute(mt)}const Qy='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const dm=["before","after"],Yy=new DOMParser().parseFromString(Qy,"image/svg+xml").firstChild,gc="ck-widget__type-around_disabled";class Xy extends b{constructor(){super(...arguments),this._currentFakeCaretModelElement=null}static get pluginName(){return"WidgetTypeAround"}static get requires(){return[Mi,_t]}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(n,s,o)=>{t.change(r=>{for(const a of t.document.roots)o?r.removeClass(gc,a):r.addClass(gc,a)}),o||e.model.change(r=>{r.removeSelectionAttribute(mt)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const n=this.editor,s=n.editing.view,o=n.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);n.execute("insertParagraph",{position:n.model.createPositionAt(e,t),attributes:o}),s.focus(),s.scrollToTheSelection()}_listenToIfEnabled(e,t,n,s){this.listenTo(e,t,(...o)=>{this.isEnabled&&n(...o)},s)}_insertParagraphAccordingToFakeCaretPosition(){const n=this.editor.model.document.selection,s=St(n);if(!s)return!1;const o=n.getSelectedElement();return this._insertParagraph(o,s),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,n=e.locale.t,s={before:n("Insert paragraph before block"),after:n("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,r,a)=>{const l=a.mapper.toViewElement(r.item);l&&Gt(l,r.item,t)&&(Zy(a.writer,s,l),l.getCustomProperty("widgetLabel").push(()=>this.isEnabled?n("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,n=t.document.selection,s=t.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(a,l)=>{this._handleArrowKeyPress(a,l)},{context:[se,"$text"],priority:"high"}),this._listenToIfEnabled(n,"change:range",(a,l)=>{l.directChange&&e.model.change(c=>{c.removeSelectionAttribute(mt)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const a=n.getSelectedElement();if(a){const l=e.editing.mapper.toViewElement(a);if(Gt(l,a,s))return}e.model.change(l=>{l.removeSelectionAttribute(mt)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(a,l,c)=>{const d=c.writer;if(this._currentFakeCaretModelElement){const f=c.mapper.toViewElement(this._currentFakeCaretModelElement);f&&(d.removeClass(dm.map(r),f),this._currentFakeCaretModelElement=null)}const u=l.selection.getSelectedElement();if(!u)return;const h=c.mapper.toViewElement(u);if(!Gt(h,u,s))return;const m=St(l.selection);m&&(d.addClass(r(m),h),this._currentFakeCaretModelElement=u)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(a,l,c)=>{c||e.model.change(d=>{d.removeSelectionAttribute(mt)})});function r(a){return`ck-widget_type-around_show-fake-caret_${a}`}}_handleArrowKeyPress(e,t){const n=this.editor,s=n.model,o=s.document.selection,r=s.schema,a=n.editing.view,l=t.keyCode,c=jg(l,n.locale.contentLanguageDirection),d=a.document.selection.getSelectedElement(),u=n.editing.mapper.toModelElement(d);let h;Gt(d,u,r)?h=this._handleArrowKeyPressOnSelectedWidget(c):o.isCollapsed?h=this._handleArrowKeyPressWhenSelectionNextToAWidget(c):t.shiftKey||(h=this._handleArrowKeyPressWhenNonCollapsedSelection(c)),h&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const n=this.editor.model,s=n.document.selection,o=St(s);return n.change(r=>{if(o){if(!(o===(e?"after":"before")))return r.removeSelectionAttribute(mt),!0}else return r.setSelectionAttribute(mt,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,n=t.model,s=n.schema,o=t.plugins.get("Widget"),r=o._getObjectElementNextToSelection(e),a=t.editing.mapper.toViewElement(r);return Gt(a,r,s)?(n.change(l=>{o._setSelectionOverElement(r),l.setSelectionAttribute(mt,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,n=t.model,s=n.schema,o=t.editing.mapper,r=n.document.selection,a=e?r.getLastPosition().nodeBefore:r.getFirstPosition().nodeAfter,l=o.toViewElement(a);return Gt(l,a,s)?(n.change(c=>{c.setSelection(a,"on"),c.setSelectionAttribute(mt,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(n,s)=>{const o=Gy(s.domTarget);if(!o)return;const r=Ky(o),a=Jy(o,t.domConverter),l=e.editing.mapper.toModelElement(a);this._insertParagraph(l,r),s.preventDefault(),n.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,n=e.editing.view;this._listenToIfEnabled(n.document,"enter",(s,o)=>{if(s.eventPhase!="atTarget")return;const r=t.getSelectedElement(),a=e.editing.mapper.toViewElement(r),l=e.model.schema;let c;this._insertParagraphAccordingToFakeCaretPosition()?c=!0:Gt(a,r,l)&&(this._insertParagraph(r,o.isSoft?"before":"after"),c=!0),c&&(o.preventDefault(),s.stop())},{context:se})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view.document;this._listenToIfEnabled(t,"insertText",(n,s)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(s.selection=t.selection)},{priority:"high"}),V.isAndroid?this._listenToIfEnabled(t,"keydown",(n,s)=>{s.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(t,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,n=e.model,s=n.schema;this._listenToIfEnabled(t.document,"delete",(o,r)=>{if(o.eventPhase!="atTarget")return;const a=St(n.document.selection);if(!a)return;const l=r.direction,c=n.document.selection.getSelectedElement(),d=a==="before",u=l=="forward";if(d===u)e.execute("delete",{selection:n.createSelection(c,"on")});else{const m=s.getNearestSelectionRange(n.createPositionAt(c,a),l);if(m)if(!m.isCollapsed)n.change(f=>{f.setSelection(m),e.execute(u?"deleteForward":"delete")});else{const f=n.createSelection(m.start);if(n.modifySelection(f,{direction:l}),!f.focus.isEqual(m.start))n.change(p=>{p.setSelection(m),e.execute(u?"deleteForward":"delete")});else{const p=nC(s,m.start.parent);n.deleteContent(n.createSelection(p,"on"),{doNotAutoparagraph:!0})}}}r.preventDefault(),o.stop()},{context:se})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,n=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(s,[o,r])=>{if(r&&!r.is("documentSelection"))return;const a=St(n);if(a)return s.stop(),t.change(l=>{const c=n.getSelectedElement(),d=t.createPositionAt(c,a),u=l.createSelection(d),h=t.insertContent(o,u);return l.setSelection(u),h})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(s,o)=>{const[,r,a={}]=o;if(r&&!r.is("documentSelection"))return;const l=St(n);l&&(a.findOptimalPosition=l,o[3]=a)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(s,[o])=>{if(o&&!o.is("documentSelection"))return;St(n)&&s.stop()},{priority:"high"})}}function Zy(i,e,t){const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(s){const o=this.toDomElement(s);return eC(o,e),tC(o),o});i.insert(i.createPositionAt(t,"end"),n)}function eC(i,e){for(const t of dm){const n=new ke({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${t}`],title:e[t],"aria-hidden":"true"},children:[i.ownerDocument.importNode(Yy,!0)]});i.appendChild(n.render())}}function tC(i){const e=new ke({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});i.appendChild(e.render())}function nC(i,e){let t=e;for(const n of e.getAncestors({parentFirst:!0})){if(n.childCount>1||i.isLimit(n))break;t=n}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function iC(i){const e=i.model;return(t,n)=>{const s=n.keyCode==O.arrowup,o=n.keyCode==O.arrowdown,r=n.shiftKey,a=e.document.selection;if(!s&&!o)return;const l=o;if(r&&rC(a,l))return;const c=sC(i,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||oC(i,c,l))&&(e.change(d=>{const u=l?c.end:c.start;if(r){const h=e.createSelection(a.anchor);h.setFocus(u),d.setSelection(h)}else d.setSelection(u)}),t.stop(),n.preventDefault(),n.stopPropagation())}}}function sC(i,e,t){const n=i.model;if(t){const s=e.isCollapsed?e.focus:e.getLastPosition(),o=pc(n,s,"forward");if(!o)return null;const r=n.createRange(s,o),a=bc(n.schema,r,"backward");return a?n.createRange(s,a):null}else{const s=e.isCollapsed?e.focus:e.getFirstPosition(),o=pc(n,s,"backward");if(!o)return null;const r=n.createRange(o,s),a=bc(n.schema,r,"forward");return a?n.createRange(a,s):null}}function pc(i,e,t){const n=i.schema,s=i.createRangeIn(e.root),o=t=="forward"?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of s.getWalker({startPosition:e,direction:t})){if(n.isLimit(a)&&!n.isInline(a))return r;if(l==o&&n.isBlock(a))return null}return null}function bc(i,e,t){const n=t=="backward"?e.end:e.start;if(i.checkChild(n,"$text"))return n;for(const{nextPosition:s}of e.getWalker({direction:t}))if(i.checkChild(s,"$text"))return s;return null}function oC(i,e,t){const n=i.model,s=i.view.domConverter;if(t){const c=n.createSelection(e.start);n.modifySelection(c),!c.focus.isAtEnd&&!e.start.isEqual(c.focus)&&(e=n.createRange(c.focus,e.end))}const o=i.mapper.toViewRange(e),r=s.viewRangeToDom(o),a=F.getDomRangeRects(r);let l;for(const c of a){if(l===void 0){l=Math.round(c.bottom);continue}if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}return!0}function rC(i,e){return!i.isCollapsed&&i.isBackward==e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zt extends b{constructor(){super(...arguments),this._previouslySelected=new Set}static get pluginName(){return"Widget"}static get requires(){return[Xy,_t]}init(){const e=this.editor,t=e.editing.view,n=t.document;this.editor.editing.downcastDispatcher.on("selection",(s,o,r)=>{const a=r.writer,l=o.selection;if(l.isCollapsed)return;const c=l.getSelectedElement();if(!c)return;const d=e.editing.mapper.toViewElement(c);se(d)&&r.consumable.consume(l,"selection")&&a.setSelection(a.createRangeOn(d),{fake:!0,label:Uy(d)})}),this.editor.editing.downcastDispatcher.on("selection",(s,o,r)=>{this._clearPreviouslySelectedWidgets(r.writer);const a=r.writer,l=a.document.selection;let c=null;for(const d of l.getRanges())for(const u of d){const h=u.item;se(h)&&!lC(h,c)&&(a.addClass(fc,h),this._previouslySelected.add(h),c=h)}},{priority:"low"}),t.addObserver(na),this.listenTo(n,"mousedown",(...s)=>this._onMousedown(...s)),this.listenTo(n,"arrowKey",(...s)=>{this._handleSelectionChangeOnArrowKeyPress(...s)},{context:[se,"$text"]}),this.listenTo(n,"arrowKey",(...s)=>{this._preventDefaultOnArrowKeyPress(...s)},{context:"$root"}),this.listenTo(n,"arrowKey",iC(this.editor.editing),{context:"$text"}),this.listenTo(n,"delete",(s,o)=>{this._handleDelete(o.direction=="forward")&&(o.preventDefault(),s.stop())},{context:"$root"})}_onMousedown(e,t){const n=this.editor,s=n.editing.view,o=s.document;let r=t.target;if(aC(r)){if((V.isSafari||V.isGecko)&&t.domEvent.detail>=3){const l=n.editing.mapper,c=r.is("attributeElement")?r.findAncestor(u=>!u.is("attributeElement")):r,d=l.toModelElement(c);t.preventDefault(),this.editor.model.change(u=>{u.setSelection(d,"in")})}return}if(!se(r)&&(r=r.findAncestor(se),!r))return;V.isAndroid&&t.preventDefault(),o.isFocused||s.focus();const a=n.editing.mapper.toModelElement(r);this._setSelectionOverElement(a)}_handleSelectionChangeOnArrowKeyPress(e,t){const n=t.keyCode,s=this.editor.model,o=s.schema,r=s.document.selection,a=r.getSelectedElement(),l=Lr(n,this.editor.locale.contentLanguageDirection),c=l=="down"||l=="right",d=l=="up"||l=="down";if(a&&o.isObject(a)){const h=c?r.getLastPosition():r.getFirstPosition(),m=o.getNearestSelectionRange(h,c?"forward":"backward");m&&(s.change(f=>{f.setSelection(m)}),t.preventDefault(),e.stop());return}if(!r.isCollapsed&&!t.shiftKey){const h=r.getFirstPosition(),m=r.getLastPosition(),f=h.nodeAfter,p=m.nodeBefore;(f&&o.isObject(f)||p&&o.isObject(p))&&(s.change(w=>{w.setSelection(c?m:h)}),t.preventDefault(),e.stop());return}if(!r.isCollapsed)return;const u=this._getObjectElementNextToSelection(c);if(u&&o.isObject(u)){if(o.isInline(u)&&d)return;this._setSelectionOverElement(u),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const n=this.editor.model,s=n.schema,o=n.document.selection.getSelectedElement();o&&s.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){const n=this.editor.model.document.selection;if(!this.editor.model.canEditAt(n)||!n.isCollapsed)return;const s=this._getObjectElementNextToSelection(e);if(s)return this.editor.model.change(o=>{let r=n.anchor.parent;for(;r.isEmpty;){const a=r;r=a.parent,o.remove(a)}this._setSelectionOverElement(s)}),!0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,n=t.schema,s=t.document.selection,o=t.createSelection(s);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(s))return null;const r=e?o.focus.nodeBefore:o.focus.nodeAfter;return r&&n.isObject(r)?r:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(fc,t);this._previouslySelected.clear()}}function aC(i){let e=i;for(;e;){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(se(e))return!1;e=e.parent}return!1}function lC(i,e){return e?Array.from(i.getAncestors()).includes(e):!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rs extends b{constructor(){super(...arguments),this._toolbarDefinitions=new Map}static get requires(){return[Nt]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",n=>{cC(e.editing.view.document.selection)&&n.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:n,getRelatedElement:s,balloonClassName:o="ck-toolbar-container"}){if(!n.length){K("widget-toolbar-no-items",{toolbarId:e});return}const r=this.editor,a=r.t,l=new Fn(r.locale);if(l.ariaLabel=t||a("Widget toolbar"),this._toolbarDefinitions.has(e))throw new g("widget-toolbar-duplicated",this,{toolbarId:e});const c={view:l,getRelatedElement:s,balloonClassName:o,itemsConfig:n,initialized:!1};r.ui.addToolbar(l,{isContextual:!0,beforeFocus:()=>{const d=s(r.editing.view.document.selection);d&&this._showToolbar(c,d)},afterBlur:()=>{this._hideToolbar(c)}}),this._toolbarDefinitions.set(e,c)}_updateToolbarsVisibility(){let e=0,t=null,n=null;for(const s of this._toolbarDefinitions.values()){const o=s.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!o)this._isToolbarInBalloon(s)&&this._hideToolbar(s);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(s)&&this._hideToolbar(s);else{const r=o.getAncestors().length;r>e&&(e=r,t=o,n=s)}}n&&this._showToolbar(n,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?wc(this.editor,t):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:um(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const n of this._toolbarDefinitions.values())if(this._isToolbarVisible(n)){const s=n.getRelatedElement(this.editor.editing.view.document.selection);wc(this.editor,s)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function wc(i,e){const t=i.plugins.get("ContextualBalloon"),n=um(i,e);t.updatePosition(n)}function um(i,e){const t=i.editing.view,n=we.defaultPositions;return{target:t.domConverter.mapViewToDom(e),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function cC(i){const e=i.getSelectedElement();return!!(e&&se(e))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dC extends $(){constructor(e){super(),this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}get originalWidth(){return this._originalWidth}get originalHeight(){return this._originalHeight}get originalWidthPercents(){return this._originalWidthPercents}get aspectRatio(){return this._aspectRatio}begin(e,t,n){const s=new F(t);this.activeHandlePosition=fC(e),this._referenceCoordinates=hC(t,gC(this.activeHandlePosition)),this._originalWidth=s.width,this._originalHeight=s.height,this._aspectRatio=s.width/s.height;const o=n.style.width;o&&o.match(/^\d+(\.\d*)?%$/)?this._originalWidthPercents=parseFloat(o):this._originalWidthPercents=uC(n,s)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function uC(i,e){const t=i.parentElement;let n=parseFloat(t.ownerDocument.defaultView.getComputedStyle(t).width);const s=5;let o=0,r=t;for(;isNaN(n);){if(r=r.parentElement,++o>s)return 0;n=parseFloat(t.ownerDocument.defaultView.getComputedStyle(r).width)}return e.width/n*100}function hC(i,e){const t=new F(i),n=e.split("-"),s={x:n[1]=="right"?t.right:t.left,y:n[0]=="bottom"?t.bottom:t.top};return s.x+=i.ownerDocument.defaultView.scrollX,s.y+=i.ownerDocument.defaultView.scrollY,s}function mC(i){return`ck-widget__resizer__handle-${i}`}function fC(i){const e=["top-left","top-right","bottom-right","bottom-left"];for(const t of e)if(i.classList.contains(mC(t)))return t}function gC(i){const e=i.split("-"),t={top:"bottom",bottom:"top",left:"right",right:"left"};return`${t[e[0]]}-${t[e[1]]}`}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pC extends E{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("_viewPosition",t=>t?`ck-orientation-${t}`:"")],style:{display:e.if("_isVisible","none",t=>!t)}},children:[{text:e.to("_label")}]})}_bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",(n,s)=>n!==null&&s!==null),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",(n,s,o)=>e.unit==="px"?`${n}×${s}`:`${o}%`),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",(n,s,o)=>s<50||o<50?"above-center":n)}_dismiss(){this.unbind(),this._isVisible=!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _c extends $(){constructor(e){super(),this._viewResizerWrapper=null,this._options=e,this.set("isEnabled",!0),this.set("isSelected",!1),this.bind("isVisible").to(this,"isEnabled",this,"isSelected",(t,n)=>t&&n),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",t=>{!this.state.proposedWidth&&!this.state.proposedWidthPercents&&(this._cleanup(),t.stop())},{priority:"high"})}get state(){return this._state}show(){this._options.editor.editing.view.change(t=>{t.removeClass("ck-hidden",this._viewResizerWrapper)})}hide(){this._options.editor.editing.view.change(t=>{t.addClass("ck-hidden",this._viewResizerWrapper)})}attach(){const e=this,t=this._options.viewElement;this._options.editor.editing.view.change(s=>{const o=s.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(r){const a=this.toDomElement(r);return e._appendHandles(a),e._appendSizeUI(a),a});s.insert(s.createPositionAt(t,"end"),o),s.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=o,this.isVisible||this.hide()}),this.on("change:isVisible",()=>{this.isVisible?(this.show(),this.redraw()):this.hide()})}begin(e){this._state=new dC(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e);this._options.editor.editing.view.change(c=>{const d=this._options.unit||"%",u=(d==="%"?t.widthPercents:t.width)+d;c.setStyle("width",u,this._options.viewElement)});const s=this._getHandleHost(),o=new F(s),r=Math.round(o.width),a=Math.round(o.height),l=new F(s);t.width=Math.round(l.width),t.height=Math.round(l.height),this.redraw(o),this.state.update({...t,handleHostWidth:r,handleHostHeight:a})}commit(){const e=this._options.unit||"%",t=(e==="%"?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(t)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!_C(t))return;const n=t.parentElement,s=this._getHandleHost(),o=this._viewResizerWrapper,r=[o.getStyle("width"),o.getStyle("height"),o.getStyle("left"),o.getStyle("top")];let a;if(n.isSameNode(s)){const l=e||new F(s);a=[l.width+"px",l.height+"px",void 0,void 0]}else a=[s.offsetWidth+"px",s.offsetHeight+"px",s.offsetLeft+"px",s.offsetTop+"px"];Ce(r,a)!=="same"&&this._options.editor.editing.view.change(l=>{l.setStyle({width:a[0],height:a[1],left:a[2],top:a[3]},o)})}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(t=>{t.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(e){const t=this.state,n=wC(e),s=this._options.isCentered?this._options.isCentered(this):!0,o={x:t._referenceCoordinates.x-(n.x+t.originalWidth),y:n.y-t.originalHeight-t._referenceCoordinates.y};s&&t.activeHandlePosition.endsWith("-right")&&(o.x=n.x-(t._referenceCoordinates.x+t.originalWidth)),s&&(o.x*=2);let r=Math.abs(t.originalWidth+o.x),a=Math.abs(t.originalHeight+o.y);return(r/t.aspectRatio>a?"width":"height")=="width"?a=r/t.aspectRatio:r=a*t.aspectRatio,{width:Math.round(r),height:Math.round(a),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*r*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const n of t)e.appendChild(new ke({tag:"div",attributes:{class:`ck-widget__resizer__handle ${bC(n)}`}}).render())}_appendSizeUI(e){this._sizeView=new pC,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function bC(i){return`ck-widget__resizer__handle-${i}`}function wC(i){return{x:i.pageX,y:i.pageY}}function _C(i){return i&&i.ownerDocument&&i.ownerDocument.contains(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mo extends b{constructor(){super(...arguments),this._resizers=new Map}static get pluginName(){return"WidgetResize"}init(){const e=this.editor.editing,t=x.window.document;this.set("selectedResizer",null),this.set("_activeResizer",null),e.view.addObserver(na),this._observer=new(rt()),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this)),this._redrawSelectedResizerThrottled=zn(()=>this.redrawSelectedResizer(),200),this.editor.ui.on("update",this._redrawSelectedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[s,o]of this._resizers)s.isAttached()||(this._resizers.delete(s),o.destroy())},{priority:"lowest"}),this._observer.listenTo(x.window,"resize",this._redrawSelectedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",()=>{const s=n.getSelectedElement(),o=this.getResizerByViewElement(s)||null;o?this.select(o):this.deselect()})}redrawSelectedResizer(){this.selectedResizer&&this.selectedResizer.isVisible&&this.selectedResizer.redraw()}destroy(){super.destroy(),this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawSelectedResizerThrottled.cancel()}select(e){this.deselect(),this.selectedResizer=e,this.selectedResizer.isSelected=!0}deselect(){this.selectedResizer&&(this.selectedResizer.isSelected=!1),this.selectedResizer=null}attachTo(e){const t=new _c(e),n=this.editor.plugins;if(t.attach(),n.has("WidgetToolbarRepository")){const r=n.get("WidgetToolbarRepository");t.on("begin",()=>{r.forceDisabled("resize")},{priority:"lowest"}),t.on("cancel",()=>{r.clearForceDisabled("resize")},{priority:"highest"}),t.on("commit",()=>{r.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(e.viewElement,t);const o=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(o)==t&&this.select(t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const n=t.domTarget;_c.isResizeHandle(n)&&(this._activeResizer=this._getResizerByHandle(n)||null,this._activeResizer&&(this._activeResizer.begin(n),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vC extends b{static get pluginName(){return"DragDrop"}static get requires(){return[vt,zt]}init(){const e=this.editor,t=e.editing.view;if(this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=zn(n=>this._updateDropMarker(n),40),this._removeDropMarkerDelayed=Yo(()=>this._removeDropMarker(),40),this._clearDraggableAttributesDelayed=Yo(()=>this._clearDraggableAttributes(),40),e.plugins.has("DragDropExperimental")){this.forceDisabled("DragDropExperimental");return}t.addObserver(ha),t.addObserver(na),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(n,s,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(n,s,o)=>{o||this._finalizeDragging(!1)}),V.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,n=t.document,s=e.editing.view,o=s.document;this.listenTo(o,"dragstart",(r,a)=>{const l=n.selection;if(a.target&&a.target.is("editableElement")){a.preventDefault();return}const c=a.target?Cc(a.target):null;if(c){const m=e.editing.mapper.toModelElement(c);this._draggedRange=$e.fromRange(t.createRangeOn(m)),e.plugins.has("WidgetToolbarRepository")&&e.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!o.selection.isCollapsed){const m=o.selection.getSelectedElement();(!m||!se(m))&&(this._draggedRange=$e.fromRange(l.getFirstRange()))}if(!this._draggedRange){a.preventDefault();return}this._draggingUid=Se();const d=this.isEnabled&&e.model.canEditAt(this._draggedRange);a.dataTransfer.effectAllowed=d?"copyMove":"copy",a.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const u=t.createSelection(this._draggedRange.toRange()),h=e.data.toView(t.getSelectedContent(u));o.fire("clipboardOutput",{dataTransfer:a.dataTransfer,content:h,method:"dragstart"}),d||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(o,"dragend",(r,a)=>{this._finalizeDragging(!a.dataTransfer.isCanceled&&a.dataTransfer.dropEffect=="move")},{priority:"low"}),this.listenTo(o,"dragenter",()=>{this.isEnabled&&s.focus()}),this.listenTo(o,"dragleave",()=>{this._removeDropMarkerDelayed()}),this.listenTo(o,"dragging",(r,a)=>{if(!this.isEnabled){a.dataTransfer.dropEffect="none";return}this._removeDropMarkerDelayed.cancel();const l=vc(e,a.targetRanges,a.target);if(!e.model.canEditAt(l)){a.dataTransfer.dropEffect="none";return}this._draggedRange||(a.dataTransfer.dropEffect="copy"),V.isGecko||(a.dataTransfer.effectAllowed=="copy"?a.dataTransfer.dropEffect="copy":["all","copyMove"].includes(a.dataTransfer.effectAllowed)&&(a.dataTransfer.dropEffect="move"));/* istanbul ignore else -- @preserve */l&&this._updateDropMarkerThrottled(l)},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,n=e.editing.view.document;this.listenTo(n,"clipboardInput",(s,o)=>{if(o.method!="drop")return;const r=vc(e,o.targetRanges,o.target);this._removeDropMarker();/* istanbul ignore if -- @preserve */if(!r||!e.model.canEditAt(r)){this._finalizeDragging(!1),s.stop();return}if(this._draggedRange&&this._draggingUid!=o.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),yc(o.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(r,!0)){this._finalizeDragging(!1),s.stop();return}o.targetRanges=[e.editing.mapper.toViewRange(r)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(vt);e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=n.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(s))},{priority:"high"}),e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=yc(n.dataTransfer)=="move",o=!n.resultRange||!n.resultRange.isCollapsed;this._finalizeDragging(o&&s)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,n=t.document;this.listenTo(n,"mousedown",(s,o)=>{if(V.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let r=Cc(o.target);if(V.isBlink&&!r&&!n.selection.isCollapsed){const a=n.selection.getSelectedElement();if(!a||!se(a)){const l=n.selection.editableElement;l&&!l.isReadOnly&&(r=l)}}r&&(t.change(a=>{a.setAttribute("draggable","true",r)}),this._draggableElement=e.editing.mapper.toModelElement(r))}),this.listenTo(n,"mouseup",()=>{V.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(t=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_setupDropMarker(){const e=this.editor;e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:n})=>{if(e.model.schema.checkChild(t.markerRange.start,"$text"))return n.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(o){const r=this.toDomElement(o);return r.append("⁠",o.createElement("span"),"⁠"),r})}})}_updateDropMarker(e){const t=this.editor,n=t.model.markers;t.model.change(s=>{n.has("drop-target")?n.get("drop-target").getRange().isEqual(e)||s.updateMarker("drop-target",{range:e}):s.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_removeDropMarker(){const e=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),e.markers.has("drop-target")&&e.change(t=>{t.removeMarker("drop-target")})}_finalizeDragging(e){const t=this.editor,n=t.model;this._removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(e&&this.isEnabled&&n.deleteContent(n.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function vc(i,e,t){const n=i.model,s=i.editing.mapper;let o=null;const r=e?e[0].start:null;if(t.is("uiElement")&&(t=t.parent),o=yC(i,t),o)return o;const a=EC(i,t),l=r?s.toModelPosition(r):null;return l?(o=kC(i,l,a),o||(o=n.schema.getNearestSelectionRange(l,V.isGecko?"forward":"backward"),o)?o:AC(i,l.parent)):CC(i,a)}function yC(i,e){const t=i.model,n=i.editing.mapper;if(se(e))return t.createRangeOn(n.toModelElement(e));if(!e.is("editableElement")){const s=e.findAncestor(o=>se(o)||o.is("editableElement"));if(se(s))return t.createRangeOn(n.toModelElement(s))}return null}function CC(i,e){const t=i.model,n=t.schema,s=t.createPositionAt(e,0);return n.getNearestSelectionRange(s,"forward")}function kC(i,e,t){const n=i.model;if(!n.schema.checkChild(t,"$block"))return null;const s=n.createPositionAt(t,0),o=e.path.slice(0,s.path.length),a=n.createPositionFromPath(e.root,o).nodeAfter;return a&&n.schema.isObject(a)?n.createRangeOn(a):null}function AC(i,e){const t=i.model;let n=e;for(;n;){if(t.schema.isObject(n))return t.createRangeOn(n);n=n.parent}/* istanbul ignore next -- @preserve */return null}function EC(i,e){const t=i.editing.mapper,n=i.editing.view,s=t.toModelElement(e);if(s)return s;const o=n.createPositionBefore(e),r=t.findMappedViewAncestor(o);return t.toModelElement(r)}function yc(i){return V.isGecko?i.dropEffect:["all","copyMove"].includes(i.effectAllowed)?"move":"copy"}function Cc(i){if(i.is("editableElement"))return null;if(i.hasClass("ck-widget__selection-handle"))return i.findAncestor(se);if(se(i))return i;const e=i.findAncestor(t=>se(t)||t.is("editableElement"));return se(e)?e:null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class TC extends b{static get pluginName(){return"PastePlainText"}static get requires(){return[vt]}init(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=t.document.selection;let r=!1;n.addObserver(ha),this.listenTo(s,"keydown",(a,l)=>{r=l.shiftKey}),e.plugins.get(vt).on("contentInsertion",(a,l)=>{!r&&!SC(l.content,t.schema)||t.change(c=>{const d=Array.from(o.getAttributes()).filter(([h])=>t.schema.getAttributeProperties(h).isFormatting);o.isCollapsed||t.deleteContent(o,{doNotAutoparagraph:!0}),d.push(...o.getAttributes());const u=c.createRangeIn(l.content);for(const h of u.getItems())h.is("$textProxy")&&c.setAttributes(d,h)})})}}function SC(i,e){if(i.childCount>1)return!1;const t=i.getChild(0);return e.isObject(t)?!1:Array.from(t.getAttributeKeys()).length==0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ma extends b{static get pluginName(){return"Clipboard"}static get requires(){return[vt,vC,TC]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xC extends T{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let n=e.schema.getLimitElement(t);if(t.containsEntireContent(n)||!kc(e.schema,n))do if(n=n.parent,!n)return;while(!kc(e.schema,n));e.change(s=>{s.setSelection(n,"in")})}}function kc(i,e){return i.isLimit(e)&&(i.checkChild(e,"$text")||i.checkChild(e,"paragraph"))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const PC=$s("Ctrl+A");class IC extends b{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,n=e.editing.view.document;e.commands.add("selectAll",new xC(e)),this.listenTo(n,"keydown",(s,o)=>{Bn(o)===PC&&(e.execute("selectAll"),o.preventDefault())})}}const RC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class VC extends b{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",t=>{const n=e.commands.get("selectAll"),s=new I(t),o=t.t;return s.set({label:o("Select all"),icon:RC,keystroke:"Ctrl+A",tooltip:!0}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",()=>{e.execute("selectAll"),e.editing.view.focus()}),s})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class BC extends b{static get requires(){return[IC,VC]}static get pluginName(){return"SelectAll"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hm extends T{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(t,n)=>{n[1]={...n[1]};const s=n[1];s.batchType||(s.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(t,n)=>{n[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const t=this.editor.model.document.selection,n={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,n){const s=this.editor.model,o=s.document,r=[],a=e.map(c=>c.getTransformedByOperations(n)),l=a.flat();for(const c of a){const d=c.filter(u=>u.root!=o.graveyard).filter(u=>!OC(u,l));d.length&&(MC(d),r.push(d[0]))}r.length&&s.change(c=>{c.setSelection(r,{backward:t})})}_undo(e,t){const n=this.editor.model,s=n.document;this._createdBatches.add(t);const o=e.operations.slice().filter(r=>r.isDocumentOperation);o.reverse();for(const r of o){const a=r.baseVersion+1,l=Array.from(s.history.getOperations(a)),d=p1([r.getReversed()],l,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(let u of d){const h=u.affectedSelectable;h&&!n.canEditAt(h)&&(u=new ce(u.baseVersion)),t.addOperation(u),n.applyOperation(u),s.history.setOperationAsUndone(r,u)}}}}function MC(i){i.sort((e,t)=>e.start.isBefore(t.start)?-1:1);for(let e=1;e<i.length;e++){const n=i[e-1].getJoined(i[e],!0);n&&(e--,i.splice(e,2,n))}}function OC(i,e){return e.some(t=>t!==i&&t.containsRange(i,!0))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class NC extends hm{execute(e=null){const t=e?this._stack.findIndex(o=>o.batch==e):this._stack.length-1,n=this._stack.splice(t,1)[0],s=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(s,()=>{this._undo(n.batch,s);const o=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,o)}),this.fire("revert",n.batch,s),this.refresh()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FC extends hm{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,()=>{const s=e.batch.operations[e.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(s);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)}),this.refresh()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class LC extends b{constructor(){super(...arguments),this._batchRegistry=new WeakSet}static get pluginName(){return"UndoEditing"}init(){const e=this.editor;this._undoCommand=new NC(e),this._redoCommand=new FC(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(t,n)=>{const s=n[0];if(!s.isDocumentOperation)return;const o=s.batch,r=this._redoCommand.createdBatches.has(o),a=this._undoCommand.createdBatches.has(o);this._batchRegistry.has(o)||(this._batchRegistry.add(o),o.isUndoable&&(r?this._undoCommand.addBatch(o):a||(this._undoCommand.addBatch(o),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(t,n,s)=>{this._redoCommand.addBatch(s)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}const Ac='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',Ec='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class DC extends b{static get pluginName(){return"UndoUI"}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?Ac:Ec,o=t.uiLanguageDirection=="ltr"?Ec:Ac;this._addButton("undo",n("Undo"),"CTRL+Z",s),this._addButton("redo",n("Redo"),"CTRL+Y",o)}_addButton(e,t,n,s){const o=this.editor;o.ui.componentFactory.add(e,r=>{const a=o.commands.get(e),l=new I(r);return l.set({label:t,icon:s,keystroke:n,tooltip:!0}),l.bind("isEnabled").to(a,"isEnabled"),this.listenTo(l,"execute",()=>{o.execute(e),o.editing.view.focus()}),l})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fa extends b{static get requires(){return[LC,DC]}static get pluginName(){return"Undo"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class J5 extends b{static get requires(){return[ma,Mi,BC,sm,Rv,fa]}static get pluginName(){return"Essentials"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zs extends T{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.value,r=e.batch,a=l=>{if(s.isCollapsed)o?l.setSelectionAttribute(this.attributeKey,o):l.removeSelectionAttribute(this.attributeKey);else{const c=t.schema.getValidRanges(s.getRanges(),this.attributeKey);for(const d of c)o?l.setAttribute(this.attributeKey,o,d):l.removeAttribute(this.attributeKey,d)}};r?t.enqueueChange(r,l=>{a(l)}):t.change(l=>{a(l)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const xe="fontSize",Pe="fontFamily",tt="fontColor",gt="fontBackgroundColor";function mm(i,e){const t={model:{key:i,values:[]},view:{},upcastAlso:{}};for(const n of e)t.model.values.push(n.model),t.view[n.model]=n.view,n.upcastAlso&&(t.upcastAlso[n.model]=n.upcastAlso);return t}function fm(i){return e=>HC(e.getStyle(i))}function gm(i){return(e,{writer:t})=>t.createAttributeElement("span",{style:`${i}:${e}`},{priority:7})}function zC({dropdownView:i,colors:e,columns:t,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerViewConfig:a}){const l=i.locale,c=new Hh(l,{colors:e,columns:t,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerViewConfig:a});return i.colorSelectorView=c,i.panelView.children.add(c),c}function HC(i){return i.replace(/\s/g,"")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WC extends Zs{constructor(e){super(e,Pe)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pm(i){return i.map($C).filter(e=>e!==void 0)}function $C(i){if(typeof i=="object")return i;if(i==="default")return{title:"Default",model:void 0};if(typeof i=="string")return UC(i)}function UC(i){const e=i.replace(/"|'/g,"").split(","),t=e[0],n=e.map(qC).join(", ");return{title:t,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}function qC(i){return i=i.trim(),i.indexOf(" ")>0&&(i=`'${i}'`),i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jC extends b{static get pluginName(){return"FontFamilyEditing"}constructor(e){super(e),e.config.define(Pe,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Pe}),e.model.schema.setAttributeProperties(Pe,{isFormatting:!0,copyOnEnter:!0});const t=pm(e.config.get("fontFamily.options")).filter(s=>s.model),n=mm(Pe,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(n),e.commands.add(Pe,new WC(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:Pe,view:(t,{writer:n})=>n.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:Pe,value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:Pe,value:t=>t.getAttribute("face")}})}}const GC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class KC extends b{static get pluginName(){return"FontFamilyUI"}init(){const e=this.editor,t=e.t,n=this._getLocalizedOptions(),s=e.commands.get(Pe),o=t("Font Family");e.ui.componentFactory.add(Pe,r=>{const a=de(r);return kt(a,()=>JC(n,s),{role:"menu",ariaLabel:o}),a.buttonView.set({label:o,icon:GC,tooltip:!0}),a.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),a.bind("isEnabled").to(s),this.listenTo(a,"execute",l=>{e.execute(l.source.commandName,{value:l.source.commandParam}),e.editing.view.focus()}),a})}_getLocalizedOptions(){const e=this.editor,t=e.t;return pm(e.config.get(Pe).options).map(s=>(s.title==="Default"&&(s.title=t("Default")),s))}}function JC(i,e){const t=new ge;for(const n of i){const s={type:"button",model:new wt({commandName:Pe,commandParam:n.model,label:n.title,role:"menuitemradio",withText:!0})};s.model.bind("isOn").to(e,"value",o=>o===n.model?!0:!o||!n.model?!1:o.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase()),n.view&&typeof n.view!="string"&&n.view.styles&&s.model.set("labelStyle",`font-family: ${n.view.styles["font-family"]}`),t.add(s)}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Q5 extends b{static get requires(){return[jC,KC]}static get pluginName(){return"FontFamily"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class QC extends Zs{constructor(e){super(e,xe)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ga(i){return i.map(e=>YC(e)).filter(e=>e!==void 0)}const Tc={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function YC(i){if(typeof i=="number"&&(i=String(i)),typeof i=="object"&&ek(i))return gr(i);const e=ZC(i);if(e)return gr(e);if(i==="default")return{model:void 0,title:"Default"};if(!tk(i))return XC(i)}function XC(i){return typeof i=="string"&&(i={title:i,model:`${parseFloat(i)}px`}),i.view={name:"span",styles:{"font-size":i.model}},gr(i)}function gr(i){return i.view&&typeof i.view!="string"&&!i.view.priority&&(i.view.priority=7),i}function ZC(i){return typeof i=="string"?Tc[i]:Tc[i.model]}function ek(i){return i.title&&i.model&&i.view}function tk(i){let e;if(typeof i=="object")if(i.model)e=parseFloat(i.model);else throw new g("font-size-invalid-definition",null,i);else e=parseFloat(i);return isNaN(e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Sc=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class nk extends b{static get pluginName(){return"FontSizeEditing"}constructor(e){super(e),e.config.define(xe,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:xe}),e.model.schema.setAttributeProperties(xe,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),n=ga(this.editor.config.get("fontSize.options")).filter(o=>o.model),s=mm(xe,n);t?(this._prepareAnyValueConverters(s),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(s),e.commands.add(xe,new QC(e))}_prepareAnyValueConverters(e){const t=this.editor,n=e.model.values.filter(s=>!Qs(String(s))&&!Rh(String(s)));if(n.length)throw new g("font-size-invalid-use-of-named-presets",null,{presets:n});t.conversion.for("downcast").attributeToElement({model:xe,view:(s,{writer:o})=>{if(s)return o.createAttributeElement("span",{style:"font-size:"+s},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:xe,value:s=>s.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:xe,value:t=>{const n=t.getAttribute("size"),s=n[0]==="-"||n[0]==="+";let o=parseInt(n,10);s&&(o=3+o);const r=Sc.length-1,a=Math.min(Math.max(o,0),r);return Sc[a]}}})}}const ik='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sk extends b{static get pluginName(){return"FontSizeUI"}init(){const e=this.editor,t=e.t,n=this._getLocalizedOptions(),s=e.commands.get(xe),o=t("Font Size");e.ui.componentFactory.add(xe,r=>{const a=de(r);return kt(a,()=>ok(n,s),{role:"menu",ariaLabel:o}),a.buttonView.set({label:o,icon:ik,tooltip:!0}),a.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),a.bind("isEnabled").to(s),this.listenTo(a,"execute",l=>{e.execute(l.source.commandName,{value:l.source.commandParam}),e.editing.view.focus()}),a})}_getLocalizedOptions(){const e=this.editor,t=e.t,n={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return ga(e.config.get(xe).options).map(o=>{const r=n[o.title];return r&&r!=o.title&&(o=Object.assign({},o,{title:r})),o})}}function ok(i,e){const t=new ge;for(const n of i){const s={type:"button",model:new wt({commandName:xe,commandParam:n.model,label:n.title,class:"ck-fontsize-option",role:"menuitemradio",withText:!0})};n.view&&typeof n.view!="string"&&(n.view.styles&&s.model.set("labelStyle",`font-size:${n.view.styles["font-size"]}`),n.view.classes&&s.model.set("class",`${s.model.class} ${n.view.classes}`)),s.model.bind("isOn").to(e,"value",o=>o===n.model),t.add(s)}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y5 extends b{static get requires(){return[nk,sk]}static get pluginName(){return"FontSize"}normalizeSizeOptions(e){return ga(e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rk extends Zs{constructor(e){super(e,tt)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ak extends b{static get pluginName(){return"FontColorEditing"}constructor(e){super(e),e.config.define(tt,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:tt,value:fm("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:tt,value:t=>t.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:tt,view:gm("color")}),e.commands.add(tt,new rk(e)),e.model.schema.extend("$text",{allowAttributes:tt}),e.model.schema.setAttributeProperties(tt,{isFormatting:!0,copyOnEnter:!0})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bm extends b{constructor(e,{commandName:t,componentName:n,icon:s,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=n,this.icon=s,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`),this.colorSelectorView=void 0}init(){const e=this.editor,t=e.locale,n=t.t,s=e.commands.get(this.commandName),o=e.config.get(this.componentName),r=pi(o.colors),a=gi(t,r),l=o.documentColors,c=o.colorPicker!==!1;e.ui.componentFactory.add(this.componentName,d=>{const u=de(d);let h=!1;return this.colorSelectorView=zC({dropdownView:u,colors:a.map(m=>({label:m.label,color:m.model,options:{hasBorder:m.hasBorder}})),columns:this.columns,removeButtonLabel:n("Remove color"),colorPickerLabel:n("Color picker"),documentColorsLabel:l!==0?n("Document colors"):"",documentColorsCount:l===void 0?this.columns:l,colorPickerViewConfig:c?o.colorPicker||{}:!1}),this.colorSelectorView.bind("selectedColor").to(s,"value"),u.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),u.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),u.bind("isEnabled").to(s),this.colorSelectorView.on("execute",(m,f)=>{u.isOpen&&e.execute(this.commandName,{value:f.value,batch:this._undoStepBatch}),f.source!=="colorPicker"&&e.editing.view.focus(),f.source==="colorPickerSaveButton"&&(u.isOpen=!1)}),this.colorSelectorView.on("colorPicker:show",()=>{this._undoStepBatch=e.model.createBatch()}),this.colorSelectorView.on("colorPicker:cancel",()=>{this._undoStepBatch.operations.length&&(u.isOpen=!1,e.execute("undo",this._undoStepBatch)),e.editing.view.focus()}),u.on("change:isOpen",(m,f,p)=>{h||(h=!0,u.colorSelectorView.appendUI()),p&&(l!==0&&this.colorSelectorView.updateDocumentColors(e.model,this.componentName),this.colorSelectorView.updateSelectedColors(),this.colorSelectorView.showColorGridsFragment())}),Ys(u,()=>u.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(m=>m.isOn)),u})}}const lk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ck extends bm{constructor(e){const t=e.locale.t;super(e,{commandName:tt,componentName:tt,icon:lk,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class X5 extends b{static get requires(){return[ak,ck]}static get pluginName(){return"FontColor"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dk extends Zs{constructor(e){super(e,gt)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uk extends b{static get pluginName(){return"FontBackgroundColorEditing"}constructor(e){super(e),e.config.define(gt,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(sa),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:gt,value:fm("background-color")}}),e.conversion.for("downcast").attributeToElement({model:gt,view:gm("background-color")}),e.commands.add(gt,new dk(e)),e.model.schema.extend("$text",{allowAttributes:gt}),e.model.schema.setAttributeProperties(gt,{isFormatting:!0,copyOnEnter:!0})}}const hk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mk extends bm{constructor(e){const t=e.locale.t;super(e,{commandName:gt,componentName:gt,icon:hk,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Z5 extends b{static get requires(){return[uk,mk]}static get pluginName(){return"FontBackgroundColor"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fk extends T{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document,n=Q(t.selection.getSelectedBlocks());this.value=!!n&&n.is("element","paragraph"),this.isEnabled=!!n&&xc(n,e.schema)}execute(e={}){const t=this.editor.model,n=t.document,s=e.selection||n.selection;t.canEditAt(s)&&t.change(o=>{const r=s.getSelectedBlocks();for(const a of r)!a.is("element","paragraph")&&xc(a,t.schema)&&o.rename(a,"paragraph")})}}function xc(i,e){return e.checkChild(i.parent,"paragraph")&&!e.isObject(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gk extends T{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}execute(e){const t=this.editor.model,n=e.attributes;let s=e.position;t.canEditAt(s)&&t.change(o=>{const r=o.createElement("paragraph"),a=t.schema.findAllowedParent(s,r);if(!a)return;if(n&&t.schema.setAllowedAttributes(r,n,o),s.path.length<2){t.insertContent(r,s),o.setSelection(r,"in");return}const l=s.parent,c=l.isEmpty,d=s.isAtEnd&&!l.isEmpty,u=s.isAtStart&&!l.isEmpty,h=t.schema.checkChild(l,r);c||d?s=o.createPositionAfter(l):u?s=o.createPositionBefore(l):h||(s=o.split(s,a).position),t.insertContent(r,s),o.setSelection(r,"in")})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class eo extends b{static get pluginName(){return"Paragraph"}init(){const e=this.editor,t=e.model;e.commands.add("paragraph",new fk(e)),e.commands.add("insertParagraph",new gk(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(n,{writer:s})=>!eo.paragraphLikeElements.has(n.name)||n.isEmpty?null:s.createElement("paragraph"),view:/.+/,converterPriority:"low"})}}eo.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pk extends T{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=Q(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(t=>Pc(e,t,this.editor.model.schema))}execute(e){const t=this.editor.model,n=t.document,s=e.value;t.change(o=>{const r=Array.from(n.selection.getSelectedBlocks()).filter(a=>Pc(a,s,t.schema));for(const a of r)a.is("element",s)||o.rename(a,s)})}}function Pc(i,e,t){return t.checkChild(i.parent,e)&&!t.isObject(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ic="paragraph";class bk extends b{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[eo]}init(){const e=this.editor,t=e.config.get("heading.options"),n=[];for(const s of t)s.model!=="paragraph"&&(e.model.schema.register(s.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(s),n.push(s.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new pk(e,n))}afterInit(){const e=this.editor,t=e.commands.get("enter"),n=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",(s,o)=>{const r=e.model.document.selection.getFirstPosition().parent;n.some(l=>r.is("element",l.model))&&!r.is("element",Ic)&&r.childCount===0&&o.writer.rename(r,Ic)})}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Be.low+1})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wk(i){const e=i.t,t={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3"),"Heading 4":e("Heading 4"),"Heading 5":e("Heading 5"),"Heading 6":e("Heading 6")};return i.config.get("heading.options").map(n=>{const s=t[n.title];return s&&s!=n.title&&(n.title=s),n})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _k extends b{static get pluginName(){return"HeadingUI"}init(){const e=this.editor,t=e.t,n=wk(e),s=t("Choose heading"),o=t("Heading");e.ui.componentFactory.add("heading",r=>{const a={},l=new ge,c=e.commands.get("heading"),d=e.commands.get("paragraph"),u=[c];for(const m of n){const f={type:"button",model:new wt({label:m.title,class:m.class,role:"menuitemradio",withText:!0})};m.model==="paragraph"?(f.model.bind("isOn").to(d,"value"),f.model.set("commandName","paragraph"),u.push(d)):(f.model.bind("isOn").to(c,"value",p=>p===m.model),f.model.set({commandName:"heading",commandValue:m.model})),l.add(f),a[m.model]=m.title}const h=de(r);return kt(h,l,{ariaLabel:o,role:"menu"}),h.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),h.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),h.bind("isEnabled").toMany(u,"isEnabled",(...m)=>m.some(f=>f)),h.buttonView.bind("label").to(c,"value",d,"value",(m,f)=>{const p=m||f&&"paragraph";return typeof p=="boolean"||!a[p]?s:a[p]}),this.listenTo(h,"execute",m=>{const{commandName:f,commandValue:p}=m.source;e.execute(f,p?{value:p}:void 0),e.editing.view.focus()}),h})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class eP extends b{static get requires(){return[bk,_k]}static get pluginName(){return"Heading"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Rc=new Set(["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"]);class tP extends b{constructor(){super(...arguments),this._bodyPlaceholder=new Map}static get pluginName(){return"Title"}static get requires(){return["Paragraph"]}init(){const e=this.editor,t=e.model;t.schema.register("title",{isBlock:!0,allowIn:"$root"}),t.schema.register("title-content",{isBlock:!0,allowIn:"title",allowAttributes:["alignment"]}),t.schema.extend("$text",{allowIn:"title-content"}),t.schema.addAttributeCheck(n=>{if(n.endsWith("title-content $text"))return!1}),e.editing.mapper.on("modelToViewPosition",Vc(e.editing.view)),e.data.mapper.on("modelToViewPosition",Vc(e.editing.view)),e.conversion.for("downcast").elementToElement({model:"title-content",view:"h1"}),e.conversion.for("downcast").add(n=>n.on("insert:title",(s,o,r)=>{r.consumable.consume(o.item,s.name)})),e.data.upcastDispatcher.on("element:h1",Oo,{priority:"high"}),e.data.upcastDispatcher.on("element:h2",Oo,{priority:"high"}),e.data.upcastDispatcher.on("element:h3",Oo,{priority:"high"}),t.document.registerPostFixer(n=>this._fixTitleContent(n)),t.document.registerPostFixer(n=>this._fixTitleElement(n)),t.document.registerPostFixer(n=>this._fixBodyElement(n)),t.document.registerPostFixer(n=>this._fixExtraParagraph(n)),this._attachPlaceholders(),this._attachTabPressHandling()}getTitle(e={}){const t=e.rootName?e.rootName:void 0,s=this._getTitleElement(t).getChild(0);return this.editor.data.stringify(s,e)}getBody(e={}){const t=this.editor,n=t.data,s=t.model,o=e.rootName?e.rootName:void 0,r=t.model.document.getRoot(o),a=t.editing.view,l=new Qr(a.document),c=s.createRangeIn(r),d=l.createDocumentFragment(),u=s.createPositionAfter(r.getChild(0)),h=s.createRange(u,s.createPositionAt(r,"end")),m=new Map;for(const f of s.markers){const p=h.getIntersection(f.getRange());p&&m.set(f.name,p)}return n.mapper.clearBindings(),n.mapper.bindElements(r,d),n.downcastDispatcher.convert(c,m,l,e),l.remove(l.createRangeOn(d.getChild(0))),t.data.processor.toData(d)}_getTitleElement(e){const t=this.editor.model.document.getRoot(e);for(const n of t.getChildren())if(Bc(n))return n}_fixTitleContent(e){let t=!1;for(const n of this.editor.model.document.getRootNames()){const s=this._getTitleElement(n);if(!s||s.maxOffset===1)continue;const o=Array.from(s.getChildren());o.shift();for(const r of o)e.move(e.createRangeOn(r),s,"after"),e.rename(r,"paragraph");t=!0}return t}_fixTitleElement(e){let t=!1;const n=this.editor.model;for(const s of this.editor.model.document.getRoots()){const o=Array.from(s.getChildren()).filter(Bc),r=o[0],a=s.getChild(0);if(a.is("element","title")){o.length>1&&(Mc(o,e,n),t=!0);continue}if(!r&&!Rc.has(a.name)){const l=e.createElement("title");e.insert(l,s),e.insertElement("title-content",l),t=!0;continue}Rc.has(a.name)?vk(a,e,n):e.move(e.createRangeOn(r),s,0),Mc(o,e,n),t=!0}return t}_fixBodyElement(e){let t=!1;for(const n of this.editor.model.document.getRootNames()){const s=this.editor.model.document.getRoot(n);if(s.childCount<2){const o=e.createElement("paragraph");e.insert(o,s,1),this._bodyPlaceholder.set(n,o),t=!0}}return t}_fixExtraParagraph(e){let t=!1;for(const n of this.editor.model.document.getRootNames()){const s=this.editor.model.document.getRoot(n),o=this._bodyPlaceholder.get(n);Ck(o,s)&&(this._bodyPlaceholder.delete(n),e.remove(o),t=!0)}return t}_attachPlaceholders(){const e=this.editor,t=e.t,n=e.editing.view,s=e.sourceElement,o=e.config.get("title.placeholder")||t("Type your title"),r=e.config.get("placeholder")||s&&s.tagName.toLowerCase()==="textarea"&&s.getAttribute("placeholder")||t("Type or paste your content here.");e.editing.downcastDispatcher.on("insert:title-content",(l,c,d)=>{const u=d.mapper.toViewElement(c.item);u.placeholder=o,qr({view:n,element:u,keepOnFocus:!0})});const a=new Map;n.document.registerPostFixer(l=>{let c=!1;for(const d of n.document.roots){if(d.isEmpty)continue;const u=d.getChild(1),h=a.get(d.rootName);u!==h&&(h&&(Xo(l,h),l.removeAttribute("data-placeholder",h)),l.setAttribute("data-placeholder",r,u),a.set(d.rootName,u),c=!0),Hu(u,!0)&&d.childCount===2&&u.name==="p"?c=zu(l,u)?!0:c:c=Xo(l,u)?!0:c}return c})}_attachTabPressHandling(){const e=this.editor,t=e.model;e.keystrokes.set("TAB",(n,s)=>{t.change(o=>{const r=t.document.selection,a=Array.from(r.getSelectedBlocks());if(a.length===1&&a[0].is("element","title-content")){const c=r.getFirstPosition().root.getChild(1);o.setSelection(c,0),s()}})}),e.keystrokes.set("SHIFT + TAB",(n,s)=>{t.change(o=>{const r=t.document.selection;if(!r.isCollapsed)return;const a=Q(r.getSelectedBlocks()),l=r.getFirstPosition(),c=e.model.document.getRoot(l.root.rootName),d=c.getChild(0),u=c.getChild(1);a===u&&l.isAtStart&&(o.setSelection(d.getChild(0),0),s())})})}}function Oo(i,e,t){const n=e.modelCursor,s=e.viewItem;if(!n.isAtStart||!n.parent.is("element","$root")||!t.consumable.consume(s,{name:!0}))return;const o=t.writer,r=o.createElement("title"),a=o.createElement("title-content");o.append(a,r),o.insert(r,n),t.convertChildren(s,a),t.updateConversionResult(r,e)}function Vc(i){return(e,t)=>{const n=t.modelPosition.parent;if(!n.is("element","title"))return;const s=n.parent,o=t.mapper.toViewElement(s);t.viewPosition=i.createPositionAt(o,0),e.stop()}}function Bc(i){return i.is("element","title")}function vk(i,e,t){const n=e.createElement("title");e.insert(n,i,"before"),e.insert(i,n,0),e.rename(i,"title-content"),t.schema.removeDisallowedAttributes([i],e)}function Mc(i,e,t){let n=!1;for(const s of i)s.index!==0&&(yk(s,e,t),n=!0);return n}function yk(i,e,t){const n=i.getChild(0);if(n.isEmpty){e.remove(i);return}e.move(e.createRangeOn(n),i,"before"),e.rename(n,"paragraph"),e.remove(i),t.schema.removeDisallowedAttributes([n],e)}function Ck(i,e){return!(!i||!i.is("element","paragraph")||i.childCount||e.childCount<=2||e.getChild(e.childCount-1)!==i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kk extends T{refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("highlight"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"highlight")}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.value;t.change(r=>{if(s.isCollapsed){const a=s.getFirstPosition();if(s.hasAttribute("highlight")){const l=h=>h.item.hasAttribute("highlight")&&h.item.getAttribute("highlight")===this.value,c=a.getLastMatchingPosition(l,{direction:"backward"}),d=a.getLastMatchingPosition(l),u=r.createRange(c,d);!o||this.value===o?(a.isEqual(d)||r.removeAttribute("highlight",u),r.removeSelectionAttribute("highlight")):(a.isEqual(d)||r.setAttribute("highlight",o,u),r.setSelectionAttribute("highlight",o))}else o&&r.setSelectionAttribute("highlight",o)}else{const a=t.schema.getValidRanges(s.getRanges(),"highlight");for(const l of a)o?r.setAttribute("highlight",o,l):r.removeAttribute("highlight",l)}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ak extends b{static get pluginName(){return"HighlightEditing"}constructor(e){super(e),e.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"highlight"});const t=e.config.get("highlight.options");e.conversion.attributeToElement(Ek(t)),e.commands.add("highlight",new kk(e))}}function Ek(i){const e={model:{key:"highlight",values:[]},view:{}};for(const t of i)e.model.values.push(t.model),e.view[t.model]={name:"mark",classes:t.class};return e}const Tk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.798 1.59 3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="m2.556 16.727.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415 1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5 9.59 17h9.406v1.5H8.245z"/></svg>',Sk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268 2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="m4.5 18.088-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5 9.59 17h9.406v1.5H8.245z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xk extends b{get localizedOptionTitles(){const e=this.editor.t;return{"Yellow marker":e("Yellow marker"),"Green marker":e("Green marker"),"Pink marker":e("Pink marker"),"Blue marker":e("Blue marker"),"Red pen":e("Red pen"),"Green pen":e("Green pen")}}static get pluginName(){return"HighlightUI"}init(){const e=this.editor.config.get("highlight.options");for(const t of e)this._addHighlighterButton(t);this._addRemoveHighlightButton(),this._addDropdown(e)}_addRemoveHighlightButton(){const e=this.editor.t,t=this.editor.commands.get("highlight");this._addButton("removeHighlight",e("Remove highlight"),R.eraser,null,n=>{n.bind("isEnabled").to(t,"isEnabled")})}_addHighlighterButton(e){const t=this.editor.commands.get("highlight");this._addButton("highlight:"+e.model,e.title,Oc(e.type),e.model,n);function n(s){s.bind("isEnabled").to(t,"isEnabled"),s.bind("isOn").to(t,"value",o=>o===e.model),s.iconView.fillColor=e.color,s.isToggleable=!0}}_addButton(e,t,n,s,o){const r=this.editor;r.ui.componentFactory.add(e,a=>{const l=new I(a),c=this.localizedOptionTitles[t]?this.localizedOptionTitles[t]:t;return l.set({label:c,icon:n,tooltip:!0}),l.on("execute",()=>{r.execute("highlight",{value:s}),r.editing.view.focus()}),o(l),l})}_addDropdown(e){const t=this.editor,n=t.t,s=t.ui.componentFactory,o=e[0],r=e.reduce((a,l)=>(a[l.model]=l,a),{});s.add("highlight",a=>{const l=t.commands.get("highlight"),c=de(a,Wn),d=c.buttonView;d.set({label:n("Highlight"),tooltip:!0,lastExecuted:o.model,commandValue:o.model,isToggleable:!0}),d.bind("icon").to(l,"value",m=>Oc(h(m,"type"))),d.bind("color").to(l,"value",m=>h(m,"color")),d.bind("commandValue").to(l,"value",m=>h(m,"model")),d.bind("isOn").to(l,"value",m=>!!m),d.delegate("execute").to(c);const u=()=>{const m=e.map(f=>{const p=s.create("highlight:"+f.model);return this.listenTo(p,"execute",()=>{c.buttonView.set({lastExecuted:f.model})}),p});return m.push(new Ur),m.push(s.create("removeHighlight")),m};c.bind("isEnabled").to(l,"isEnabled"),Vi(c,u,{enableActiveItemFocusOnDropdownOpen:!0,ariaLabel:n("Text highlight toolbar")}),Pk(c),d.on("execute",()=>{t.execute("highlight",{value:d.commandValue})}),this.listenTo(c,"execute",()=>{t.editing.view.focus()});function h(m,f){const p=!m||m===d.lastExecuted?d.lastExecuted:m;return r[p][f]}return c})}}function Pk(i){i.buttonView.actionView.iconView.bind("fillColor").to(i.buttonView,"color")}function Oc(i){return i==="marker"?Tk:Sk}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nP extends b{static get requires(){return[Ak,xk]}static get pluginName(){return"Highlight"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ik extends T{refresh(){const e=this.editor.model,t=e.schema,n=e.document.selection,s=Nc(n);this.isEnabled=Rk(n,t,e),this.value=s?s.getAttribute("value")||"":null}execute(e){const t=this.editor.model,n=t.document.selection;t.change(s=>{let o;this.value!==null?o=Nc(n):(o=s.createElement("rawHtml"),t.insertObject(o,null,null,{setSelection:"on"})),s.setAttribute("value",e,o)})}}function Rk(i,e,t){const n=Vk(i,t);return e.checkChild(n,"rawHtml")}function Vk(i,e){const n=Xs(i,e).start.parent;return n.isEmpty&&!n.is("rootElement")?n.parent:n}function Nc(i){const e=i.getSelectedElement();return e&&e.is("element","rawHtml")?e:null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bk extends b{static get pluginName(){return"HtmlEmbedEditing"}constructor(e){super(e),this._widgetButtonViewReferences=new Set,e.config.define("htmlEmbed",{showPreviews:!1,sanitizeHtml:t=>(K("html-embed-provide-sanitize-function"),{html:t,hasChanged:!1})})}init(){const e=this.editor;e.model.schema.register("rawHtml",{inheritAllFrom:"$blockObject",allowAttributes:["value"]}),e.commands.add("htmlEmbed",new Ik(e)),this._setupConversion()}_setupConversion(){const e=this.editor,t=e.t,n=e.editing.view,s=this._widgetButtonViewReferences,o=e.config.get("htmlEmbed");this.editor.editing.view.on("render",()=>{for(const d of s){if(d.element&&d.element.isConnected)return;d.destroy(),s.delete(d)}},{priority:"lowest"}),e.data.registerRawContentMatcher({name:"div",classes:"raw-html-embed"}),e.conversion.for("upcast").elementToElement({view:{name:"div",classes:"raw-html-embed"},model:(d,{writer:u})=>u.createElement("rawHtml",{value:d.getCustomProperty("$rawContent")})}),e.conversion.for("dataDowncast").elementToElement({model:"rawHtml",view:(d,{writer:u})=>u.createRawElement("div",{class:"raw-html-embed"},function(h){h.innerHTML=d.getAttribute("value")||""})}),e.conversion.for("editingDowncast").elementToStructure({model:{name:"rawHtml",attributes:["value"]},view:(d,{writer:u})=>{let h,m,f;const p=u.createRawElement("div",{class:"raw-html-embed__content-wrapper"},function(C){h=C,r({editor:e,domElement:C,state:m,props:f}),h.addEventListener("mousedown",()=>{if(m.isEditable){const B=e.model;B.document.selection.getSelectedElement()!==d&&B.change(Z=>Z.setSelection(d,"on"))}},!0)}),w={makeEditable(){m=Object.assign({},m,{isEditable:!0}),r({domElement:h,editor:e,state:m,props:f}),n.change(C=>{C.setAttribute("data-cke-ignore-events","true",p)}),h.querySelector("textarea").focus()},save(C){C!==m.getRawHtmlValue()?(e.execute("htmlEmbed",C),e.editing.view.focus()):this.cancel()},cancel(){m=Object.assign({},m,{isEditable:!1}),r({domElement:h,editor:e,state:m,props:f}),e.editing.view.focus(),n.change(C=>{C.removeAttribute("data-cke-ignore-events",p)})}};m={showPreviews:o.showPreviews,isEditable:!1,getRawHtmlValue:()=>d.getAttribute("value")||""},f={sanitizeHtml:o.sanitizeHtml,textareaPlaceholder:t("Paste raw HTML here..."),onEditClick(){w.makeEditable()},onSaveClick(C){w.save(C)},onCancelClick(){w.cancel()}};const v=u.createContainerElement("div",{class:"raw-html-embed","data-html-embed-label":t("HTML snippet"),dir:e.locale.uiLanguageDirection},p);return u.setCustomProperty("rawHtmlApi",w,v),u.setCustomProperty("rawHtml",!0,v),dn(v,u,{label:t("HTML snippet"),hasSelectionHandle:!0})}});function r({editor:d,domElement:u,state:h,props:m}){u.textContent="";const f=u.ownerDocument;let p;if(h.isEditable){const v={isDisabled:!1,placeholder:m.textareaPlaceholder};p=l({domDocument:f,state:h,props:v}),u.append(p)}else if(h.showPreviews){const v={sanitizeHtml:m.sanitizeHtml};u.append(c({domDocument:f,state:h,props:v,editor:d}))}else{const v={isDisabled:!0,placeholder:m.textareaPlaceholder};u.append(l({domDocument:f,state:h,props:v}))}const w={onEditClick:m.onEditClick,onSaveClick:()=>{m.onSaveClick(p.value)},onCancelClick:m.onCancelClick};u.prepend(a({editor:d,domDocument:f,state:h,props:w}))}function a({editor:d,domDocument:u,state:h,props:m}){const f=xt(u,"div",{class:"raw-html-embed__buttons-wrapper"});if(h.isEditable){const p=No(d,"save",m.onSaveClick),w=No(d,"cancel",m.onCancelClick);f.append(p.element,w.element),s.add(p).add(w)}else{const p=No(d,"edit",m.onEditClick);f.append(p.element),s.add(p)}return f}function l({domDocument:d,state:u,props:h}){const m=xt(d,"textarea",{placeholder:h.placeholder,class:"ck ck-reset ck-input ck-input-text raw-html-embed__source"});return m.disabled=h.isDisabled,m.value=u.getRawHtmlValue(),m}function c({editor:d,domDocument:u,state:h,props:m}){const f=m.sanitizeHtml(h.getRawHtmlValue()),p=h.getRawHtmlValue().length>0?t("No preview available"):t("Empty snippet content"),w=xt(u,"div",{class:"ck ck-reset_all raw-html-embed__preview-placeholder"},p),v=xt(u,"div",{class:"raw-html-embed__preview-content",dir:d.locale.contentLanguageDirection}),B=u.createRange().createContextualFragment(f.html);return v.appendChild(B),xt(u,"div",{class:"raw-html-embed__preview"},[w,v])}}}function No(i,e,t){const{t:n}=i.locale,s=new I(i.locale),o=i.commands.get("htmlEmbed");return s.set({class:`raw-html-embed__${e}-button`,icon:R.pencil,tooltip:!0,tooltipPosition:i.locale.uiLanguageDirection==="rtl"?"e":"w"}),s.render(),e==="edit"?(s.set({icon:R.pencil,label:n("Edit source")}),s.bind("isEnabled").to(o)):e==="save"?(s.set({icon:R.check,label:n("Save changes")}),s.bind("isEnabled").to(o)):s.set({icon:R.cancel,label:n("Cancel")}),s.on("execute",t),s}const Mk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ok extends b{static get pluginName(){return"HtmlEmbedUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("htmlEmbed",n=>{const s=e.commands.get("htmlEmbed"),o=new I(n);return o.set({label:t("Insert HTML"),icon:Mk,tooltip:!0}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("htmlEmbed"),e.editing.view.focus(),e.editing.view.document.selection.getSelectedElement().getCustomProperty("rawHtmlApi").makeEditable()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iP extends b{static get requires(){return[Bk,Ok,zt]}static get pluginName(){return"HtmlEmbed"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function on(i,e,t,n){e&&Nk(i,e,n),t&&st(i,t,n)}function st(i,e,t){if(e.attributes)for(const[n,s]of Object.entries(e.attributes))i.setAttribute(n,s,t);e.styles&&i.setStyle(e.styles,t),e.classes&&i.addClass(e.classes,t)}function Nk(i,e,t){if(e.attributes)for(const[n]of Object.entries(e.attributes))i.removeAttribute(n,t);if(e.styles)for(const n of Object.keys(e.styles))i.removeStyle(n,t);e.classes&&i.removeClass(e.classes,t)}function Fk(i,e){const t=Ct(i);let n="attributes";for(n in e)n=="classes"?t[n]=Array.from(new Set([...i[n]||[],...e[n]])):t[n]={...i[n],...e[n]};return t}function An(i,e,t,n,s){const o=e.getAttribute(t),r={};for(const a of["attributes","styles","classes"]){if(a!=n){o&&o[a]&&(r[a]=o[a]);continue}if(n=="classes"){const c=new Set(o&&o.classes||[]);s(c),c.size&&(r[a]=Array.from(c));continue}const l=new Map(Object.entries(o&&o[a]||{}));s(l),l.size&&(r[a]=Object.fromEntries(l))}Object.keys(r).length?e.is("documentSelection")?i.setSelectionAttribute(t,r):i.setAttribute(t,r,e):o&&(e.is("documentSelection")?i.removeSelectionAttribute(t):i.removeAttribute(t,e))}function Lk(i){return Gf(i).replace(/ /g,"")}function He(i){return`html${Lk(i)}Attributes`}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pa({model:i}){return(e,t)=>t.writer.createElement(i,{htmlContent:e.getCustomProperty("$rawContent")})}function Dk(i,{view:e,isInline:t}){const n=i.t;return(s,{writer:o})=>{const r=n("HTML object"),a=to(e,s,o),l=s.getAttribute(He(e));o.addClass("html-object-embed__content",a),l&&st(o,l,a);const c=o.createContainerElement(t?"span":"div",{class:"html-object-embed","data-html-object-embed-label":r},a);return dn(c,o,{label:r})}}function to(i,e,t){return t.createRawElement(i,null,(n,s)=>{s.setContentOf(n,e.getAttribute("htmlContent"))})}function zk({view:i,model:e,allowEmpty:t},n){return o=>{o.on(`element:${i}`,(r,a,l)=>{let c=n.processViewAttributes(a.viewItem,l);if(!(!c&&!l.consumable.test(a.viewItem,{name:!0}))){if(c=c||{},l.consumable.consume(a.viewItem,{name:!0}),a.modelRange||(a=Object.assign(a,l.convertChildren(a.viewItem,a.modelCursor))),t&&a.modelRange.isCollapsed&&Object.keys(c).length){const d=l.writer.createElement("htmlEmptyElement");if(!l.safeInsert(d,a.modelCursor))return;const u=l.getSplitParts(d);a.modelRange=l.writer.createRange(a.modelRange.start,l.writer.createPositionAfter(u[u.length-1])),l.updateConversionResult(d,a),s(d,c,l);return}for(const d of a.modelRange.getItems())s(d,c,l)}},{priority:"low"})};function s(o,r,a){if(a.schema.checkAttribute(o,e)){const l=o.getAttribute(e),c=Fk(r,l||{});a.writer.setAttribute(e,c,o)}}}function Fc({model:i,view:e},t){return(n,{writer:s,consumable:o})=>{if(!n.hasAttribute(i))return null;const r=s.createContainerElement(e),a=n.getAttribute(i);return o.consume(n,`attribute:${i}`),st(s,a,r),r.getFillerOffset=()=>null,t?dn(r,s):r}}function Hk({priority:i,view:e}){return(t,n)=>{if(!t)return;const{writer:s}=n,o=s.createAttributeElement(e,null,{priority:i});return st(s,t,o),o}}function Ai({view:i},e){return t=>{t.on(`element:${i}`,(n,s,o)=>{if(!s.modelRange||s.modelRange.isCollapsed)return;const r=e.processViewAttributes(s.viewItem,o);r&&o.writer.setAttribute(He(s.viewItem.name),r,s.modelRange)},{priority:"low"})}}function Ei({view:i,model:e}){return t=>{t.on(`attribute:${He(i)}:${e}`,(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const{attributeOldValue:r,attributeNewValue:a}=s,l=o.writer,c=o.mapper.toViewElement(s.item);on(l,r,a,c)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Lc={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:"$text",allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref",attributeProperties:{copyOnEnter:!0}},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ln extends b{constructor(){super(...arguments),this._definitions=[]}static get pluginName(){return"DataSchema"}init(){for(const e of Lc.block)this.registerBlockElement(e);for(const e of Lc.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,t=!1){const n=new Set;for(const s of this._getMatchingViewDefinitions(e)){if(t)for(const o of this._getReferences(s.model))n.add(o);n.add(s)}return n}getDefinitionsForModel(e){return this._definitions.filter(t=>t.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(t=>t.view&&Wk(e,t.view))}*_getReferences(e){const t=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],n=this._definitions.filter(s=>s.model==e);for(const{modelSchema:s}of n)if(s)for(const o of t)for(const r of q(s[o]||[])){const a=this._definitions.filter(l=>l.model==r);for(const l of a)r!==e&&(yield*this._getReferences(l.model),yield l)}}_extendDefinition(e){const t=Array.from(this._definitions.entries()).filter(([,n])=>n.model==e.model);if(t.length==0){this._definitions.push(e);return}for(const[n,s]of t)this._definitions[n]=Kf({},s,e,(o,r)=>Array.isArray(o)?o.concat(r):void 0)}}function Wk(i,e){return typeof i=="string"?i===e:i instanceof RegExp?i.test(e):!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class re extends b{constructor(e){super(e),this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new Oe,this._disallowedAttributes=new Oe,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get requires(){return[Ln,zt]}loadAllowedConfig(e){for(const t of e){const n=t.name||/[\s\S]+/,s=Hc(t);this.allowElement(n),s.forEach(o=>this.allowAttributes(o))}}loadDisallowedConfig(e){for(const t of e){const n=t.name||/[\s\S]+/,s=Hc(t);s.length==0?this.disallowElement(n):s.forEach(o=>this.disallowAttributes(o))}}loadAllowedEmptyElementsConfig(e){for(const t of e)this.allowEmptyElement(t)}allowElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(t),this._coupledAttributes=null}disallowElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(t.view)}allowEmptyElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!0))t.isInline&&this._dataSchema.extendInlineElement({...t,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,t){return Dc(e,t,this._disallowedAttributes),Dc(e,t,this._allowedAttributes)}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const t of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))t.isBlock&&this._addAllowedElement(t);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:Be.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:Be.highest+1})}_registerElementHandlers(){this.on("register",(e,t)=>{const n=this.editor.model.schema;if(t.isObject&&!n.isRegistered(t.model))this._registerObjectElement(t);else if(t.isBlock)this._registerBlockElement(t);else if(t.isInline)this._registerInlineElement(t);else throw new g("data-filter-invalid-definition",null,t);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(t=>{const n=e.document.differ.getChanges();let s=!1;const o=this._getCoupledAttributesMap();for(const r of n){if(r.type!="attribute"||r.attributeNewValue!==null)continue;const a=o.get(r.attributeKey);if(a)for(const{item:l}of r.range.getWalker({shallow:!0}))for(const c of a)l.hasAttribute(c)&&(t.removeAttribute(c,l),s=!0)}return s})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(t=>{const n=e.document.differ.getChanges();let s=!1;for(const o of n)if(!(o.type!=="insert"||o.name==="$text"))for(const r of o.attributes.keys())!r.startsWith("html")||!r.endsWith("Attributes")||e.schema.checkAttribute(o.name,r)||(t.removeAttribute(r,o.position.nodeAfter),s=!0);return s})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const t=this._coupledAttributes.get(e.coupledAttribute);t?t.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,{view:o,model:r}=e;n.register(r,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */o&&(n.extend(e.model,{allowAttributes:[He(o),"htmlContent"]}),t.data.registerRawContentMatcher({name:o}),s.for("upcast").elementToElement({view:o,model:pa(e),converterPriority:Be.low+2}),s.for("upcast").add(Ai(e,this)),s.for("editingDowncast").elementToStructure({model:{name:r,attributes:[He(o)]},view:Dk(t,e)}),s.for("dataDowncast").elementToElement({model:r,view:(a,{writer:l})=>to(o,a,l)}),s.for("dataDowncast").add(Ei(e)))}_registerBlockElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,{view:o,model:r}=e;if(!n.isRegistered(e.model)){if(n.register(e.model,e.modelSchema),!o)return;s.for("upcast").elementToElement({model:r,view:o,converterPriority:Be.low+2}),s.for("downcast").elementToElement({model:r,view:o})}o&&(n.extend(e.model,{allowAttributes:He(o)}),s.for("upcast").add(Ai(e,this)),s.for("downcast").add(Ei(e)))}_registerInlineElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,o=e.model;e.appliesToBlock||(n.extend("$text",{allowAttributes:o}),e.attributeProperties&&n.setAttributeProperties(o,e.attributeProperties),s.for("upcast").add(zk(e,this)),s.for("downcast").attributeToElement({model:o,view:Hk(e)}),e.allowEmpty&&(n.setAttributeProperties(o,{copyFromObject:!1}),n.isRegistered("htmlEmptyElement")||n.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),t.data.htmlProcessor.domConverter.registerInlineObjectMatcher(r=>r.name==e.view&&r.isEmpty&&Array.from(r.getAttributeKeys()).length?{name:!0}:null),s.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:Fc(e,!0)}),s.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:Fc(e)})))}}function Dc(i,e,t){const n=$k(i,e,t),{attributes:s,styles:o,classes:r}=qk(n),a={};if(s.size)for(const l of s)wu(l)||s.delete(l);return s.size&&(a.attributes=zc(s,l=>i.getAttribute(l))),o.size&&(a.styles=zc(o,l=>i.getStyle(l))),r.size&&(a.classes=Array.from(r)),Object.keys(a).length?a:null}function $k(i,{consumable:e},t){const n=t.matchAll(i)||[],s=[];for(const o of n)Uk(e,i,o),delete o.match.name,e.consume(i,o.match),s.push(o);return s}function Uk(i,e,t){for(const n of["attributes","classes","styles"]){const s=t.match[n];if(s)for(const o of Array.from(s))i.test(e,{[n]:[o]})||Jf(s,o)}}function qk(i){const e={attributes:new Set,classes:new Set,styles:new Set};for(const t of i)for(const n in e)(t.match[n]||[]).forEach(o=>e[n].add(o));return e}function zc(i,e){const t={};for(const n of i)e(n)!==void 0&&(t[n]=e(n));return t}function Fo(i,e){const{name:t}=i,n=i[e];return De(n)?Object.entries(n).map(([s,o])=>({name:t,[e]:{[s]:o}})):Array.isArray(n)?n.map(s=>({name:t,[e]:[s]})):[i]}function Hc(i){const{name:e,attributes:t,classes:n,styles:s}=i,o=[];return t&&o.push(...Fo({name:e,attributes:t},"attributes")),n&&o.push(...Fo({name:e,classes:n},"classes")),s&&o.push(...Fo({name:e,styles:s},"styles")),o}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jk extends b{static get requires(){return[re]}static get pluginName(){return"CodeBlockElementSupport"}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const e=this.editor.plugins.get(re);e.on("register:pre",(t,n)=>{if(n.model!=="codeBlock")return;const s=this.editor,o=s.model.schema,r=s.conversion;o.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),r.for("upcast").add(Gk(e)),r.for("downcast").add(Kk()),t.stop()})}}function Gk(i){return e=>{e.on("element:code",(t,n,s)=>{const o=n.viewItem,r=o.parent;if(!r||!r.is("element","pre"))return;a(r,"htmlPreAttributes"),a(o,"htmlContentAttributes");function a(l,c){const d=i.processViewAttributes(l,s);d&&s.writer.setAttribute(c,d,n.modelRange)}},{priority:"low"})}}function Kk(){return i=>{i.on("attribute:htmlPreAttributes:codeBlock",(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const{attributeOldValue:s,attributeNewValue:o}=t,a=n.mapper.toViewElement(t.item).parent;on(n.writer,s,o,a)}),i.on("attribute:htmlContentAttributes:codeBlock",(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const{attributeOldValue:s,attributeNewValue:o}=t,r=n.mapper.toViewElement(t.item);on(n.writer,s,o,r)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Jk extends b{static get requires(){return[re]}static get pluginName(){return"DualContentModelElementSupport"}init(){this.editor.plugins.get(re).on("register",(t,n)=>{const s=n,o=this.editor,r=o.model.schema,a=o.conversion;if(!s.paragraphLikeModel||r.isRegistered(s.model)||r.isRegistered(s.paragraphLikeModel))return;const l={model:s.paragraphLikeModel,view:s.view};r.register(s.model,s.modelSchema),r.register(l.model,{inheritAllFrom:"$block"}),a.for("upcast").elementToElement({view:s.view,model:(c,{writer:d})=>this._hasBlockContent(c)?d.createElement(s.model):d.createElement(l.model),converterPriority:Be.low+.5}),a.for("downcast").elementToElement({view:s.view,model:s.model}),this._addAttributeConversion(s),a.for("downcast").elementToElement({view:l.view,model:l.model}),this._addAttributeConversion(l),t.stop()})}_hasBlockContent(e){const t=this.editor.editing.view,n=t.domConverter.blockElements;for(const s of t.createRangeIn(e).getItems())if(s.is("element")&&n.includes(s.name))return!0;return!1}_addAttributeConversion(e){const t=this.editor,n=t.conversion,s=t.plugins.get(re);t.model.schema.extend(e.model,{allowAttributes:He(e.view)}),n.for("upcast").add(Ai(e,s)),n.for("downcast").add(Ei(e))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qk extends b{static get requires(){return[Ln,Mi]}static get pluginName(){return"HeadingElementSupport"}init(){const e=this.editor;if(!e.plugins.has("HeadingEditing"))return;const t=e.config.get("heading.options");this.registerHeadingElements(e,t)}registerHeadingElements(e,t){const n=e.plugins.get(Ln),s=[];for(const o of t)"model"in o&&"view"in o&&(n.registerBlockElement({view:o.view,model:o.model}),s.push(o.model));n.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:s}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vs(i,e,t){const n=i.createRangeOn(e);for(const{item:s}of n.getWalker())if(s.is("element",t))return s}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Yk extends b{static get requires(){return[re]}static get pluginName(){return"ImageElementSupport"}init(){const e=this.editor;if(!e.plugins.has("ImageInlineEditing")&&!e.plugins.has("ImageBlockEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(re);s.on("register:figure",()=>{n.for("upcast").add(Zk(s))}),s.on("register:img",(o,r)=>{r.model!=="imageBlock"&&r.model!=="imageInline"||(t.isRegistered("imageBlock")&&t.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),t.isRegistered("imageInline")&&t.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),n.for("upcast").add(Xk(s)),n.for("downcast").add(eA()),o.stop())})}}function Xk(i){return e=>{e.on("element:img",(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem,r=o.parent;a(o,"htmlImgAttributes"),r.is("element","a")&&l(r);function a(c,d){const u=i.processViewAttributes(c,s);u&&s.writer.setAttribute(d,u,n.modelRange)}function l(c){n.modelRange&&n.modelRange.getContainedElement().is("element","imageBlock")&&a(c,"htmlLinkAttributes")}},{priority:"low"})}}function Zk(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("image"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function eA(){return i=>{e("htmlImgAttributes"),t("img","htmlImgAttributes"),t("figure","htmlFigureAttributes"),t("a","htmlLinkAttributes");function e(n){i.on(`attribute:${n}:imageInline`,(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const{attributeOldValue:a,attributeNewValue:l}=o,c=r.mapper.toViewElement(o.item);on(r.writer,a,l,c)},{priority:"low"})}function t(n,s){i.on(`attribute:${s}:imageBlock`,(o,r,a)=>{if(!a.consumable.test(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,d=a.mapper.toViewElement(r.item),u=Vs(a.writer,d,n);u&&(on(a.writer,l,c,u),a.consumable.consume(r.item,o.name))},{priority:"low"}),n==="a"&&i.on("attribute:linkHref:imageBlock",(o,r,a)=>{if(!a.consumable.consume(r.item,"attribute:htmlLinkAttributes:imageBlock"))return;const l=a.mapper.toViewElement(r.item),c=Vs(a.writer,l,"a");st(a.writer,r.item.getAttribute("htmlLinkAttributes"),c)},{priority:"low"})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tA extends b{static get requires(){return[re]}static get pluginName(){return"MediaEmbedElementSupport"}init(){const e=this.editor;if(!e.plugins.has("MediaEmbed")||e.config.get("mediaEmbed.previewsInData"))return;const t=e.model.schema,n=e.conversion,s=this.editor.plugins.get(re),o=this.editor.plugins.get(Ln),r=e.config.get("mediaEmbed.elementName");o.registerBlockElement({model:"media",view:r}),s.on("register:figure",()=>{n.for("upcast").add(iA(s))}),s.on(`register:${r}`,(a,l)=>{l.model==="media"&&(t.extend("media",{allowAttributes:[He(r),"htmlFigureAttributes"]}),n.for("upcast").add(nA(s,r)),n.for("dataDowncast").add(sA(r)),a.stop())})}}function nA(i,e){const t=(n,s,o)=>{const r=s.viewItem;a(r,He(e));function a(l,c){const d=i.processViewAttributes(l,o);d&&o.writer.setAttribute(c,d,s.modelRange)}};return n=>{n.on(`element:${e}`,t,{priority:"low"})}}function iA(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("media"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function sA(i){return e=>{t(i,He(i)),t("figure","htmlFigureAttributes");function t(n,s){e.on(`attribute:${s}:media`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,d=a.mapper.toViewElement(r.item),u=Vs(a.writer,d,n);on(a.writer,l,c,u)})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oA extends b{static get requires(){return[re]}static get pluginName(){return"ScriptElementSupport"}init(){const e=this.editor.plugins.get(re);e.on("register:script",(t,n)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlScript",n.modelSchema),o.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"script"}),r.for("upcast").elementToElement({view:"script",model:pa(n)}),r.for("upcast").add(Ai(n,e)),r.for("downcast").elementToElement({model:"htmlScript",view:(a,{writer:l})=>to("script",a,l)}),r.for("downcast").add(Ei(n)),t.stop()})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rA extends b{static get requires(){return[re]}static get pluginName(){return"TableElementSupport"}init(){const e=this.editor;if(!e.plugins.has("TableEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(re),o=e.plugins.get("TableUtils");s.on("register:figure",()=>{n.for("upcast").add(cA(s))}),s.on("register:table",(r,a)=>{a.model==="table"&&(t.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),n.for("upcast").add(lA(s)),n.for("downcast").add(dA()),e.model.document.registerPostFixer(aA(e.model,o)),r.stop())})}}function aA(i,e){return t=>{const n=i.document.differ.getChanges();let s=!1;for(const o of n){if(o.type!="attribute"||o.attributeKey!="headingRows")continue;const r=o.range.start.nodeAfter,a=r.getAttribute("htmlTheadAttributes"),l=r.getAttribute("htmlTbodyAttributes");a&&!o.attributeNewValue?(t.removeAttribute("htmlTheadAttributes",r),s=!0):l&&o.attributeNewValue==e.getRows(r)&&(t.removeAttribute("htmlTbodyAttributes",r),s=!0)}return s}}function lA(i){return e=>{e.on("element:table",(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem;r(o,"htmlTableAttributes");for(const a of o.getChildren())a.is("element","thead")&&r(a,"htmlTheadAttributes"),a.is("element","tbody")&&r(a,"htmlTbodyAttributes");function r(a,l){const c=i.processViewAttributes(a,s);c&&s.writer.setAttribute(l,c,n.modelRange)}},{priority:"low"})}}function cA(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("table"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function dA(){return i=>{e("table","htmlTableAttributes"),e("figure","htmlFigureAttributes"),e("thead","htmlTheadAttributes"),e("tbody","htmlTbodyAttributes");function e(t,n){i.on(`attribute:${n}:table`,(s,o,r)=>{if(!r.consumable.test(o.item,s.name))return;const a=r.mapper.toViewElement(o.item),l=Vs(r.writer,a,t);l&&(r.consumable.consume(o.item,s.name),on(r.writer,o.attributeOldValue,o.attributeNewValue,l))})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uA extends b{static get requires(){return[re]}static get pluginName(){return"StyleElementSupport"}init(){const e=this.editor.plugins.get(re);e.on("register:style",(t,n)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlStyle",n.modelSchema),o.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"style"}),r.for("upcast").elementToElement({view:"style",model:pa(n)}),r.for("upcast").add(Ai(n,e)),r.for("downcast").elementToElement({model:"htmlStyle",view:(a,{writer:l})=>to("style",a,l)}),r.for("downcast").add(Ei(n)),t.stop()})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hA extends b{static get requires(){return[re]}static get pluginName(){return"DocumentListElementSupport"}init(){const e=this.editor;if(!e.plugins.has("DocumentListEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(re),o=e.plugins.get("DocumentListEditing"),r=["ul","ol","li"];o.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:st}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:st}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:st}),s.on("register",(a,l)=>{if(!r.includes(l.view)||(a.stop(),t.checkAttribute("$block","htmlLiAttributes")))return;const c=r.map(d=>He(d));t.extend("$block",{allowAttributes:c}),t.extend("$blockObject",{allowAttributes:c}),t.extend("$container",{allowAttributes:c}),n.for("upcast").add(d=>{d.on("element:ul",Lo("htmlUlAttributes",s),{priority:"low"}),d.on("element:ol",Lo("htmlOlAttributes",s),{priority:"low"}),d.on("element:li",Lo("htmlLiAttributes",s),{priority:"low"})})}),o.on("postFixer",(a,{listNodes:l,writer:c})=>{const d=[];for(const{node:u,previous:h}of l){if(!h)continue;const m=u.getAttribute("listIndent"),f=h.getAttribute("listIndent");let p=null;if(m>f?d[f]=h:m<f?(p=d[m],d.length=m):p=h,!!p){if(p.getAttribute("listType")==u.getAttribute("listType")){const w=Wc(p.getAttribute("listType")),v=p.getAttribute(w);!Vn(u.getAttribute(w),v)&&c.model.schema.checkAttribute(u,w)&&(c.setAttribute(w,v,u),a.return=!0)}if(p.getAttribute("listItemId")==u.getAttribute("listItemId")){const w=p.getAttribute("htmlLiAttributes");!Vn(u.getAttribute("htmlLiAttributes"),w)&&c.model.schema.checkAttribute(u,"htmlLiAttributes")&&(c.setAttribute("htmlLiAttributes",w,u),a.return=!0)}}}}),o.on("postFixer",(a,{listNodes:l,writer:c})=>{for(const{node:d}of l){const u=d.getAttribute("listType");u==="bulleted"&&d.getAttribute("htmlOlAttributes")&&(c.removeAttribute("htmlOlAttributes",d),a.return=!0),u==="numbered"&&d.getAttribute("htmlUlAttributes")&&(c.removeAttribute("htmlUlAttributes",d),a.return=!0)}})}afterInit(){const e=this.editor;if(!e.commands.get("indentList"))return;const t=e.commands.get("indentList");this.listenTo(t,"afterExecute",(n,s)=>{e.model.change(o=>{for(const r of s){const a=Wc(r.getAttribute("listType"));e.model.schema.checkAttribute(r,a)&&o.setAttribute(a,{},r)}})})}}function Lo(i,e){return(t,n,s)=>{const o=n.viewItem;n.modelRange||Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor));const r=e.processViewAttributes(o,s);for(const a of n.modelRange.getItems({shallow:!0}))a.hasAttribute("listItemId")&&(a.hasAttribute(i)||s.writer.model.schema.checkAttribute(a,i)&&s.writer.setAttribute(i,r||{},a))}}function Wc(i){return i==="bulleted"?"htmlUlAttributes":"htmlOlAttributes"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mA extends b{static get requires(){return[re,Ln]}static get pluginName(){return"CustomElementSupport"}init(){const e=this.editor.plugins.get(re),t=this.editor.plugins.get(Ln);e.on("register:$customElement",(n,s)=>{n.stop();const o=this.editor,r=o.model.schema,a=o.conversion,l=o.editing.view.domConverter.unsafeElements,c=o.data.htmlProcessor.domConverter.preElements;r.register(s.model,s.modelSchema),r.extend(s.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),a.for("upcast").elementToElement({view:/.*/,model:(d,u)=>{if(d.name=="$comment"||!fA(d.name)||t.getDefinitionsForView(d.name).size)return null;l.includes(d.name)||l.push(d.name),c.includes(d.name)||c.push(d.name);const h=u.writer.createElement(s.model,{htmlElementName:d.name}),m=e.processViewAttributes(d,u);m&&u.writer.setAttribute("htmlCustomElementAttributes",m,h);const p=new Ze(d.document).createDocumentFragment(d),w=o.data.processor.toData(p);u.writer.setAttribute("htmlContent",w,h);for(const{item:v}of o.editing.view.createRangeIn(d))u.consumable.consume(v,{name:!0});return h},converterPriority:"low"}),a.for("editingDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(d,{writer:u})=>{const h=d.getAttribute("htmlElementName"),m=u.createRawElement(h);return d.hasAttribute("htmlCustomElementAttributes")&&st(u,d.getAttribute("htmlCustomElementAttributes"),m),m}}),a.for("dataDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(d,{writer:u})=>{const h=d.getAttribute("htmlElementName"),m=d.getAttribute("htmlContent"),f=u.createRawElement(h,null,(p,w)=>{w.setContentOf(p,m);const v=p.firstChild;for(v.remove();v.firstChild;)p.appendChild(v.firstChild)});return d.hasAttribute("htmlCustomElementAttributes")&&st(u,d.getAttribute("htmlCustomElementAttributes"),f),f}})})}}function fA(i){try{document.createElement(i)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sP extends b{static get pluginName(){return"GeneralHtmlSupport"}static get requires(){return[re,jk,Jk,Qk,Yk,tA,oA,rA,uA,hA,mA]}init(){const e=this.editor,t=e.plugins.get(re);t.loadAllowedEmptyElementsConfig(e.config.get("htmlSupport.allowEmpty")||[]),t.loadAllowedConfig(e.config.get("htmlSupport.allow")||[]),t.loadDisallowedConfig(e.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(e){const t=this.editor.plugins.get("DataSchema"),n=Array.from(t.getDefinitionsForView(e,!1)),s=n.find(o=>o.isInline&&!n[0].isObject);return s?s.model:He(e)}addModelHtmlClass(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"classes",l=>{for(const c of q(t))l.add(c)})})}removeModelHtmlClass(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"classes",l=>{for(const c of q(t))l.delete(c)})})}setModelHtmlAttributes(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"attributes",l=>{for(const[c,d]of Object.entries(t))l.set(c,d)})})}removeModelHtmlAttributes(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"attributes",l=>{for(const c of q(t))l.delete(c)})})}setModelHtmlStyles(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"styles",l=>{for(const[c,d]of Object.entries(t))l.set(c,d)})})}removeModelHtmlStyles(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of En(s,n,o))An(r,a,o,"styles",l=>{for(const c of q(t))l.delete(c)})})}}function*En(i,e,t){if(e)if(!(Symbol.iterator in e)&&e.is("documentSelection")&&e.isCollapsed)i.schema.checkAttributeInSelection(e,t)&&(yield e);else for(const n of gA(i,e,t))yield*n.getItems({shallow:!0})}function gA(i,e,t){return!(Symbol.iterator in e)&&(e.is("node")||e.is("$text")||e.is("$textProxy"))?i.schema.checkAttribute(e,t)?[i.createRangeOn(e)]:[]:i.schema.getValidRanges(i.createSelection(e).getRanges(),t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oP extends b{static get pluginName(){return"HtmlComment"}init(){const e=this.editor,t=new Map;e.data.processor.skipComments=!1,e.model.schema.addAttributeCheck((n,s)=>{if(n.endsWith("$root")&&s.startsWith("$comment"))return!0}),e.conversion.for("upcast").elementToMarker({view:"$comment",model:n=>{const o=`$comment:${Se()}`,r=n.getCustomProperty("$rawContent");return t.set(o,r),o}}),e.conversion.for("dataDowncast").markerToElement({model:"$comment",view:(n,{writer:s})=>{let o;for(const c of this.editor.model.document.getRootNames())if(o=this.editor.model.document.getRoot(c),o.hasAttribute(n.markerName))break;const r=n.markerName,a=o.getAttribute(r),l=s.createUIElement("$comment");return s.setCustomProperty("$rawContent",a,l),l}}),e.model.document.registerPostFixer(n=>{let s=!1;const o=e.model.document.differ.getChangedMarkers().filter(r=>r.name.startsWith("$comment:"));for(const r of o){const{oldRange:a,newRange:l}=r.data;if(!(a&&l&&a.root==l.root)){if(a){const c=a.root;c.hasAttribute(r.name)&&(n.removeAttribute(r.name,c),s=!0)}if(l){const c=l.root;c.rootName=="$graveyard"?(n.removeMarker(r.name),s=!0):c.hasAttribute(r.name)||(n.setAttribute(r.name,t.get(r.name)||"",c),s=!0)}}}return s}),e.data.on("set",()=>{for(const n of e.model.markers.getMarkersGroup("$comment"))this.removeHtmlComment(n.name)},{priority:"high"}),e.model.on("deleteContent",(n,[s])=>{for(const o of s.getRanges()){const r=e.model.schema.getLimitElement(o),a=e.model.createPositionAt(r,0),l=e.model.createPositionAt(r,"end");let c;a.isTouching(o.start)&&l.isTouching(o.end)?c=this.getHtmlCommentsInRange(e.model.createRange(a,l)):c=this.getHtmlCommentsInRange(o,{skipBoundaries:!0});for(const d of c)this.removeHtmlComment(d)}},{priority:"high"})}createHtmlComment(e,t){const n=Se(),o=this.editor.model,r=o.document.getRoot(e.root.rootName),a=`$comment:${n}`;return o.change(l=>{const c=l.createRange(e);return l.addMarker(a,{usingOperation:!0,affectsData:!0,range:c}),l.setAttribute(a,t,r),a})}removeHtmlComment(e){const t=this.editor,n=t.model.markers.get(e);return n?(t.model.change(s=>{s.removeMarker(n)}),!0):!1}getHtmlCommentData(e){const n=this.editor.model.markers.get(e);if(!n)return null;let s="";for(const o of this.editor.model.document.getRoots())if(o.hasAttribute(e)){s=o.getAttribute(e);break}return{content:s,position:n.getStart()}}getHtmlCommentsInRange(e,{skipBoundaries:t=!1}={}){const n=!t;return Array.from(this.editor.model.markers.getMarkersGroup("$comment")).filter(o=>s(o,e)).map(o=>o.name);function s(o,r){const a=o.getRange().start;return(a.isAfter(r.start)||n&&a.isEqual(r.start))&&(a.isBefore(r.end)||n&&a.isEqual(r.end))}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pA(i){return i.createContainerElement("span",{class:"image-inline"},i.createEmptyElement("img"))}function $c(i){return i.createContainerElement("figure",{class:"image"},[i.createEmptyElement("img"),i.createSlot("children")])}function wm(i,e){const t=i.plugins.get("ImageUtils"),n=i.plugins.has("ImageInlineEditing")&&i.plugins.has("ImageBlockEditing");return o=>t.isInlineImageView(o)?n&&(o.getStyle("display")=="block"||o.findAncestor(t.isBlockImageView)?"imageBlock":"imageInline")!==e?null:s(o):null;function s(o){const r={name:!0};return o.hasAttribute("src")&&(r.attributes=["src"]),r}}function ba(i,e){const t=Q(e.getSelectedBlocks());return!t||i.isObject(t)||t.isEmpty&&t.name!="listItem"?"imageBlock":"imageInline"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ot extends b{static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,n=null){const s=this.editor,o=s.model,r=o.document.selection;n=_m(s,t||r,n),e={...Object.fromEntries(r.getAttributes()),...e};for(const a in e)o.schema.checkAttribute(n,a)||delete e[a];return o.change(a=>{const l=a.createElement(n,e);return o.insertObject(l,t,null,{setSelection:"on",findOptimalPosition:!t&&n!="imageInline"?"auto":void 0}),l.parent?l:null})}getClosestSelectedImageWidget(e){const t=e.getFirstPosition();if(!t)return null;const n=e.getSelectedElement();if(n&&this.isImageWidget(n))return n;let s=t.parent;for(;s;){if(s.is("element")&&this.isImageWidget(s))return s;s=s.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const t=this.editor.model.document.selection;return bA(this.editor,t)&&wA(t)}toImageWidget(e,t,n){return t.setCustomProperty("image",!0,e),dn(e,t,{label:()=>{const r=this.findViewImgElement(e).getAttribute("alt");return r?`${r} ${n}`:n}})}isImageWidget(e){return!!e.getCustomProperty("image")&&se(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:n}of t.createRangeIn(e))if(this.isInlineImageView(n))return n}}function bA(i,e){if(_m(i,e,null)=="imageBlock"){const n=_A(e,i.model);if(i.model.schema.checkChild(n,"imageBlock"))return!0}else if(i.model.schema.checkChild(e.focus,"imageInline"))return!0;return!1}function wA(i){return[...i.focus.getAncestors()].every(e=>!e.is("element","imageBlock"))}function _A(i,e){const n=Xs(i,e).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}function _m(i,e,t){const n=i.model.schema,s=i.config.get("image.insert.type");return i.plugins.has("ImageBlockEditing")?i.plugins.has("ImageInlineEditing")?t||(s==="inline"?"imageInline":s==="block"?"imageBlock":e.is("selection")?ba(n,e):n.checkChild(e,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const vA=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source));class rP extends b{static get requires(){return[ma,ot,fa,_t]}static get pluginName(){return"AutoImage"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",()=>{const s=t.selection.getFirstRange(),o=ae.fromPosition(s.start);o.stickiness="toPrevious";const r=ae.fromPosition(s.end);r.stickiness="toNext",t.once("change:data",()=>{this._embedImageBetweenPositions(o,r),o.detach(),r.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(x.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedImageBetweenPositions(e,t){const n=this.editor,s=new $e(e,t),o=s.getWalker({ignoreElementEnd:!0}),r=Object.fromEntries(n.model.document.selection.getAttributes()),a=this.editor.plugins.get("ImageUtils");let l="";for(const c of o)c.item.is("$textProxy")&&(l+=c.item.data);if(l=l.trim(),!l.match(vA)){s.detach();return}this._positionToInsert=ae.fromPosition(e),this._timeoutId=setTimeout(()=>{if(!n.commands.get("insertImage").isEnabled){s.detach();return}n.model.change(u=>{this._timeoutId=null,u.remove(s),s.detach();let h;this._positionToInsert.root.rootName!=="$graveyard"&&(h=this._positionToInsert.toPosition()),a.insertImage({...r,src:l},h),this._positionToInsert.detach(),this._positionToInsert=null}),n.plugins.get("Delete").requestUndoOnBackspace()},100)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yA extends T{refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled&&n.hasAttribute("alt")?this.value=n.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor,n=t.plugins.get("ImageUtils"),s=t.model,o=n.getClosestSelectedImageElement(s.document.selection);s.change(r=>{r.setAttribute("alt",e.newValue,o)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CA extends b{static get requires(){return[ot]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new yA(this.editor))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kA extends E{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new ue,this.keystrokes=new _e,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("Save"),R.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("Cancel"),R.cancel,"ck-button-cancel","cancel"),this._focusables=new qe,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),Ds({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,t,n,s){const o=new I(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:n}}),s&&o.delegate("execute").to(this,s),o}_createLabeledInputView(){const e=this.locale.t,t=new pe(this.locale,nt);return t.label=e("Text alternative"),t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function AA(i){const e=i.plugins.get("ContextualBalloon");if(i.plugins.get("ImageUtils").getClosestSelectedImageWidget(i.editing.view.document.selection)){const n=vm(i);e.updatePosition(n)}}function vm(i){const e=i.editing.view,t=we.defaultPositions,n=i.plugins.get("ImageUtils");return{target:e.domConverter.mapViewToDom(n.getClosestSelectedImageWidget(e.document.selection)),positions:[t.northArrowSouth,t.northArrowSouthWest,t.northArrowSouthEast,t.southArrowNorth,t.southArrowNorthWest,t.southArrowNorthEast,t.viewportStickyNorth]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class EA extends b{static get requires(){return[Nt]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton()}destroy(){super.destroy(),this._form&&this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",n=>{const s=e.commands.get("imageTextAlternative"),o=new I(n);return o.set({label:t("Change image text alternative"),icon:R.lowVision,tooltip:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",r=>!!r),this.listenTo(o,"execute",()=>{this._showForm()}),o})}_createForm(){const e=this.editor,n=e.editing.view.document,s=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(Zd(kA))(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(o,r)=>{this._hideForm(!0),r()}),this.listenTo(e.ui,"update",()=>{s.getClosestSelectedImageWidget(n.selection)?this._isVisible&&AA(e):this._hideForm(!0)}),Ii({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;this._form||this._createForm();const e=this.editor,t=e.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:vm(e)}),n.fieldView.value=n.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ym extends b{static get requires(){return[CA,EA]}static get pluginName(){return"ImageTextAlternative"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function TA(i){const e=(t,n,s)=>{if(!s.consumable.test(n.viewItem,{name:!0,classes:"image"}))return;const o=i.findViewImgElement(n.viewItem);if(!o||!s.consumable.test(o,{name:!0}))return;s.consumable.consume(n.viewItem,{name:!0,classes:"image"});const r=s.convertItem(o,n.modelCursor),a=Q(r.modelRange.getItems());if(!a){s.consumable.revert(n.viewItem,{name:!0,classes:"image"});return}s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n)};return t=>{t.on("element:figure",e)}}function Cm(i,e){const t=(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const r=o.writer,a=o.mapper.toViewElement(s.item),l=i.findViewImgElement(a);if(s.attributeNewValue===null){const c=s.attributeOldValue;c&&c.data&&(r.removeAttribute("srcset",l),r.removeAttribute("sizes",l),c.width&&r.removeAttribute("width",l))}else{const c=s.attributeNewValue;c&&c.data&&(r.setAttribute("srcset",c.data,l),r.setAttribute("sizes","100vw",l),c.width&&r.setAttribute("width",c.width,l))}};return n=>{n.on(`attribute:srcset:${e}`,t)}}function Bs(i,e,t){const n=(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const a=r.writer,l=r.mapper.toViewElement(o.item),c=i.findViewImgElement(l);a.setAttribute(o.attributeKey,o.attributeNewValue||"",c)};return s=>{s.on(`attribute:${t}:${e}`,n)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class km extends lt{observe(e){this.listenTo(e,"load",(t,n)=>{const s=n.target;this.checkShouldIgnoreEventFromTarget(s)||s.tagName=="IMG"&&this._fireEvents(n)},{useCapture:!0})}stopObserving(e){this.stopListening(e)}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SA extends T{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||t==="block"&&K("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||t==="inline"&&K("image-inline-plugin-required")}refresh(){const e=this.editor.plugins.get("ImageUtils");this.isEnabled=e.isImageAllowed()}execute(e){const t=q(e.source),n=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(n.getAttributes());t.forEach((r,a)=>{const l=n.getSelectedElement();if(typeof r=="string"&&(r={src:r}),a&&l&&s.isImage(l)){const c=this.editor.model.createPositionAfter(l);s.insertImage({...r,...o},c)}else s.insertImage({...r,...o})})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xA extends T{refresh(){const t=this.editor.plugins.get("ImageUtils"),n=this.editor.model.document.selection.getSelectedElement();this.isEnabled=t.isImage(n),this.value=this.isEnabled?n.getAttribute("src"):null}execute(e){const t=this.editor.model.document.selection.getSelectedElement();this.editor.model.change(n=>{n.setAttribute("src",e.source,t),n.removeAttribute("srcset",t),n.removeAttribute("sizes",t)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Am extends b{static get requires(){return[ot]}static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(km),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:o=>{const r={data:o.getAttribute("srcset")};return o.hasAttribute("width")&&(r.width=o.getAttribute("width")),r}}});const n=new SA(e),s=new xA(e);e.commands.add("insertImage",n),e.commands.add("replaceImageSource",s),e.commands.add("imageInsert",n)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Em extends T{constructor(e,t){super(e),this._modelElementName=t}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=t.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=t.isInlineImage(n):this.isEnabled=t.isBlockImage(n)}execute(){const e=this.editor,t=this.editor.model,n=e.plugins.get("ImageUtils"),s=n.getClosestSelectedImageElement(t.document.selection),o=Object.fromEntries(s.getAttributes());return!o.src&&!o.uploadId?null:t.change(r=>{const a=Array.from(t.markers).filter(d=>d.getRange().containsItem(s)),l=n.insertImage(o,t.createSelection(s,"on"),this._modelElementName);if(!l)return null;const c=r.createRangeOn(l);for(const d of a){const u=d.getRange(),h=u.root.rootName!="$graveyard"?u.getJoined(c,!0):c;r.updateMarker(d,{range:h})}return{oldElement:s,newElement:l}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PA extends b{static get requires(){return[Am,ot,vt]}static get pluginName(){return"ImageBlockEditing"}init(){const e=this.editor;e.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new Em(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,n=e.conversion,s=e.plugins.get("ImageUtils");n.for("dataDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>$c(r)}),n.for("editingDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>s.toImageWidget($c(r),r,t("image widget"))}),n.for("downcast").add(Bs(s,"imageBlock","src")).add(Bs(s,"imageBlock","alt")).add(Cm(s,"imageBlock")),n.for("upcast").elementToElement({view:wm(e,"imageBlock"),model:(o,{writer:r})=>r.createElement("imageBlock",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)}).add(TA(s))}_setupClipboardIntegration(){const e=this.editor,t=e.model,n=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(r,a)=>{const l=Array.from(a.content.getChildren());let c;if(!l.every(s.isInlineImageView))return;a.targetRanges?c=e.editing.mapper.toModelRange(a.targetRanges[0]):c=t.document.selection.getFirstRange();const d=t.createSelection(c);if(ba(t.schema,d)==="imageBlock"){const u=new Ze(n.document),h=l.map(m=>u.createElement("figure",{class:"image"},m));a.content=u.createDocumentFragment(h)}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IA extends b{static get requires(){return[PA,zt,ym]}static get pluginName(){return"ImageBlock"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class RA extends b{static get requires(){return[Am,ot,vt]}static get pluginName(){return"ImageInlineEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageInline",{inheritAllFrom:"$inlineObject",allowAttributes:["alt","src","srcset"]}),t.addChildCheck((n,s)=>{if(n.endsWith("caption")&&s.name==="imageInline")return!1}),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new Em(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,n=e.conversion,s=e.plugins.get("ImageUtils");n.for("dataDowncast").elementToElement({model:"imageInline",view:(o,{writer:r})=>r.createEmptyElement("img")}),n.for("editingDowncast").elementToStructure({model:"imageInline",view:(o,{writer:r})=>s.toImageWidget(pA(r),r,t("image widget"))}),n.for("downcast").add(Bs(s,"imageInline","src")).add(Bs(s,"imageInline","alt")).add(Cm(s,"imageInline")),n.for("upcast").elementToElement({view:wm(e,"imageInline"),model:(o,{writer:r})=>r.createElement("imageInline",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)})}_setupClipboardIntegration(){const e=this.editor,t=e.model,n=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(r,a)=>{const l=Array.from(a.content.getChildren());let c;if(!l.every(s.isBlockImageView))return;a.targetRanges?c=e.editing.mapper.toModelRange(a.targetRanges[0]):c=t.document.selection.getFirstRange();const d=t.createSelection(c);if(ba(t.schema,d)==="imageInline"){const u=new Ze(n.document),h=l.map(m=>m.childCount===1?(Array.from(m.getAttributes()).forEach(f=>u.setAttribute(...f,s.findViewImgElement(m))),m.getChild(0)):m);a.content=u.createDocumentFragment(h)}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class VA extends b{static get requires(){return[RA,zt,ym]}static get pluginName(){return"ImageInline"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class aP extends b{static get requires(){return[IA,VA]}static get pluginName(){return"Image"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Tm(i){const e=i.map(t=>t.replace("+","\\+"));return new RegExp(`^image\\/(${e.join("|")})$`)}function BA(i){return new Promise((e,t)=>{const n=i.getAttribute("src");fetch(n).then(s=>s.blob()).then(s=>{const o=Sm(s,n),a=`image.${o.replace("image/","")}`,l=new File([s],a,{type:o});e(l)}).catch(s=>s&&s.name==="TypeError"?OA(n).then(e).catch(t):t(s))})}function MA(i,e){return!i.isInlineImageView(e)||!e.getAttribute("src")?!1:!!e.getAttribute("src").match(/^data:image\/\w+;base64,/g)||!!e.getAttribute("src").match(/^blob:/g)}function Sm(i,e){return i.type?i.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function OA(i){return NA(i).then(e=>{const t=Sm(e,i),s=`image.${t.replace("image/","")}`;return new File([e],s,{type:t})})}function NA(i){return new Promise((e,t)=>{const n=x.document.createElement("img");n.addEventListener("load",()=>{const s=x.document.createElement("canvas");s.width=n.width,s.height=n.height,s.getContext("2d").drawImage(n,0,0),s.toBlob(r=>r?e(r):t())}),n.addEventListener("error",()=>t()),n.src=i})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FA extends b{static get pluginName(){return"ImageUploadUI"}init(){const e=this.editor,t=e.t,n=s=>{const o=new vv(s),r=e.commands.get("uploadImage"),a=e.config.get("image.upload.types"),l=Tm(a);return o.set({acceptedType:a.map(c=>`image/${c}`).join(","),allowMultipleFiles:!0}),o.buttonView.set({label:t("Insert image"),icon:R.image,tooltip:!0}),o.buttonView.bind("isEnabled").to(r),o.on("done",(c,d)=>{const u=Array.from(d).filter(h=>l.test(h.type));u.length&&(e.execute("uploadImage",{file:u}),e.editing.view.focus())}),o};e.ui.componentFactory.add("uploadImage",n),e.ui.componentFactory.add("imageUpload",n)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class LA extends b{static get pluginName(){return"ImageUploadProgress"}constructor(e){super(e),this.uploadStatusChange=(t,n,s)=>{const o=this.editor,r=n.item,a=r.getAttribute("uploadId");if(!s.consumable.consume(n.item,t.name))return;const l=o.plugins.get("ImageUtils"),c=o.plugins.get(tn),d=a?n.attributeNewValue:null,u=this.placeholder,h=o.editing.mapper.toViewElement(r),m=s.writer;if(d=="reading"){Uc(h,m),qc(l,u,h,m);return}if(d=="uploading"){const f=c.loaders.get(a);Uc(h,m),f?(jc(h,m),zA(h,m,f,o.editing.view),qA(l,h,m,f)):qc(l,u,h,m);return}d=="complete"&&c.loaders.get(a)&&WA(h,m,o.editing.view),HA(h,m),jc(h,m),DA(h,m)},this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",this.uploadStatusChange),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",this.uploadStatusChange)}}function Uc(i,e){i.hasClass("ck-appear")||e.addClass("ck-appear",i)}function DA(i,e){e.removeClass("ck-appear",i)}function qc(i,e,t,n){t.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",t);const s=i.findViewImgElement(t);s.getAttribute("src")!==e&&n.setAttribute("src",e,s),xm(t,"placeholder")||n.insert(n.createPositionAfter(s),UA(n))}function jc(i,e){i.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",i),Pm(i,e,"placeholder")}function zA(i,e,t,n){const s=$A(e);e.insert(e.createPositionAt(i,"end"),s),t.on("change:uploadedPercent",(o,r,a)=>{n.change(l=>{l.setStyle("width",a+"%",s)})})}function HA(i,e){Pm(i,e,"progressBar")}function WA(i,e,t){const n=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(i,"end"),n),setTimeout(()=>{t.change(s=>s.remove(s.createRangeOn(n)))},3e3)}function $A(i){const e=i.createUIElement("div",{class:"ck-progress-bar"});return i.setCustomProperty("progressBar",!0,e),e}function UA(i){const e=i.createUIElement("div",{class:"ck-upload-placeholder-loader"});return i.setCustomProperty("placeholder",!0,e),e}function xm(i,e){for(const t of i.getChildren())if(t.getCustomProperty(e))return t}function Pm(i,e,t){const n=xm(i,t);n&&e.remove(e.createRangeOn(n))}function qA(i,e,t,n){if(n.data){const s=i.findViewImgElement(e);t.setAttribute("src",n.data,s)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jA extends T{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),n=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(n)}execute(e){const t=q(e.file),n=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(n.getAttributes());t.forEach((r,a)=>{const l=n.getSelectedElement();if(a&&l&&s.isImage(l)){const c=this.editor.model.createPositionAfter(l);this._uploadImage(r,o,c)}else this._uploadImage(r,o)})}_uploadImage(e,t,n){const s=this.editor,r=s.plugins.get(tn).createLoader(e),a=s.plugins.get("ImageUtils");r&&a.insertImage({...t,uploadId:r.id},n)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class GA extends b{static get requires(){return[tn,Kl,vt,ot]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const e=this.editor,t=e.model.document,n=e.conversion,s=e.plugins.get(tn),o=e.plugins.get("ImageUtils"),r=e.plugins.get("ClipboardPipeline"),a=Tm(e.config.get("image.upload.types")),l=new jA(e);e.commands.add("uploadImage",l),e.commands.add("imageUpload",l),n.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",(c,d)=>{if(KA(d.dataTransfer))return;const u=Array.from(d.dataTransfer.files).filter(h=>h?a.test(h.type):!1);u.length&&(c.stop(),e.model.change(h=>{d.targetRanges&&h.setSelection(d.targetRanges.map(m=>e.editing.mapper.toModelRange(m))),e.model.enqueueChange(()=>{e.execute("uploadImage",{file:u})})}))}),this.listenTo(r,"inputTransformation",(c,d)=>{const u=Array.from(e.editing.view.createRangeIn(d.content)).map(m=>m.item).filter(m=>MA(o,m)&&!m.getAttribute("uploadProcessed")).map(m=>({promise:BA(m),imageElement:m}));if(!u.length)return;const h=new Ze(e.editing.view.document);for(const m of u){h.setAttribute("uploadProcessed",!0,m.imageElement);const f=s.createLoader(m.promise);f&&(h.setAttribute("src","",m.imageElement),h.setAttribute("uploadId",f.id,m.imageElement))}}),e.editing.view.document.on("dragover",(c,d)=>{d.preventDefault()}),t.on("change",()=>{const c=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),d=new Set;for(const u of c)if(u.type=="insert"&&u.name!="$text"){const h=u.position.nodeAfter,m=u.position.root.rootName=="$graveyard";for(const f of JA(e,h)){const p=f.getAttribute("uploadId");if(!p)continue;const w=s.loaders.get(p);w&&(m?d.has(p)||w.abort():(d.add(p),this._uploadImageElements.set(p,f),w.status=="idle"&&this._readAndUpload(w)))}}}),this.on("uploadComplete",(c,{imageElement:d,data:u})=>{const h=u.urls?u.urls:u;this.editor.model.change(m=>{m.setAttribute("src",h.default,d),this._parseAndSetSrcsetAttributeOnImage(h,d,m)})},{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(e){const t=this.editor,n=t.model,s=t.locale.t,o=t.plugins.get(tn),r=t.plugins.get(Kl),a=t.plugins.get("ImageUtils"),l=this._uploadImageElements;return n.enqueueChange({isUndoable:!1},d=>{d.setAttribute("uploadStatus","reading",l.get(e.id))}),e.read().then(()=>{const d=e.upload(),u=l.get(e.id);/* istanbul ignore next -- @preserve */if(V.isSafari){const h=t.editing.mapper.toViewElement(u),m=a.findViewImgElement(h);t.editing.view.once("render",()=>{if(!m.parent)return;const f=t.editing.view.domConverter.mapViewToDom(m.parent);if(!f)return;const p=f.style.display;f.style.display="none",f._ckHack=f.offsetHeight,f.style.display=p})}return n.enqueueChange({isUndoable:!1},h=>{h.setAttribute("uploadStatus","uploading",u)}),d}).then(d=>{n.enqueueChange({isUndoable:!1},u=>{const h=l.get(e.id);u.setAttribute("uploadStatus","complete",h),this.fire("uploadComplete",{data:d,imageElement:h})}),c()}).catch(d=>{if(e.status!=="error"&&e.status!=="aborted")throw d;e.status=="error"&&d&&r.showWarning(d,{title:s("Upload failed"),namespace:"upload"}),n.enqueueChange({isUndoable:!1},u=>{u.remove(l.get(e.id))}),c()});function c(){n.enqueueChange({isUndoable:!1},d=>{const u=l.get(e.id);d.removeAttribute("uploadId",u),d.removeAttribute("uploadStatus",u),l.delete(e.id)}),o.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,n){let s=0;const o=Object.keys(e).filter(r=>{const a=parseInt(r,10);if(!isNaN(a))return s=Math.max(s,a),!0}).map(r=>`${e[r]} ${r}w`).join(", ");o!=""&&n.setAttribute("srcset",{data:o,width:s},t)}}function KA(i){return Array.from(i.types).includes("text/html")&&i.getData("text/html")!==""}function JA(i,e){const t=i.plugins.get("ImageUtils");return Array.from(i.model.createRangeOn(e)).filter(n=>t.isImage(n.item)).map(n=>n.item)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lP extends b{static get pluginName(){return"ImageUpload"}static get requires(){return[GA,FA,LA]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class QA extends T{refresh(){const e=this.editor,n=e.plugins.get("ImageUtils").getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!n,!n||!n.hasAttribute("width")?this.value=null:this.value={width:n.getAttribute("width"),height:null}}execute(e){const t=this.editor,n=t.model,o=t.plugins.get("ImageUtils").getClosestSelectedImageElement(n.document.selection);this.value={width:e.width,height:null},o&&n.change(r=>{r.setAttribute("width",e.width,o)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Im extends b{static get requires(){return[ot]}static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new QA(e);this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:"width"}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:"width"})}_registerConverters(e){const t=this.editor;t.conversion.for("downcast").add(n=>n.on(`attribute:width:${e}`,(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const a=r.writer,l=r.mapper.toViewElement(o.item);o.attributeNewValue!==null?(a.setStyle("width",o.attributeNewValue,l),a.addClass("image_resized",l)):(a.removeStyle("width",l),a.removeClass("image_resized",l))})),t.conversion.for("upcast").attributeToAttribute({view:{name:e==="imageBlock"?"figure":"img",styles:{width:/.+/}},model:{key:"width",value:n=>n.getStyle("width")}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Do={small:R.objectSizeSmall,medium:R.objectSizeMedium,large:R.objectSizeLarge,original:R.objectSizeFull};class YA extends b{static get requires(){return[Im]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),n=e.commands.get("resizeImage");this.bind("isEnabled").to(n);for(const s of t)this._registerImageResizeButton(s);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:n,value:s,icon:o}=e,r=s?s+this._resizeUnit:null;t.ui.componentFactory.add(n,a=>{const l=new I(a),c=t.commands.get("resizeImage"),d=this._getOptionLabelValue(e,!0);if(!Do[o])throw new g("imageresizebuttons-missing-icon",t,e);return l.set({label:d,icon:Do[o],tooltip:d,isToggleable:!0}),l.bind("isEnabled").to(this),l.bind("isOn").to(c,"value",Gc(r)),this.listenTo(l,"execute",()=>{t.execute("resizeImage",{width:r})}),l})}_registerImageResizeDropdown(e){const t=this.editor,n=t.t,s=e.find(r=>!r.value),o=r=>{const a=t.commands.get("resizeImage"),l=de(r,Nu),c=l.buttonView,d=n("Resize image");return c.set({tooltip:d,commandValue:s.value,icon:Do.medium,isToggleable:!0,label:this._getOptionLabelValue(s),withText:!0,class:"ck-resize-image-button",ariaLabel:d,ariaLabelledBy:void 0}),c.bind("label").to(a,"value",u=>u&&u.width?u.width:this._getOptionLabelValue(s)),l.bind("isEnabled").to(this),kt(l,()=>this._getResizeDropdownListItemDefinitions(e,a),{ariaLabel:n("Image resize list"),role:"menu"}),this.listenTo(l,"execute",u=>{t.execute(u.source.commandName,{width:u.source.commandValue}),t.editing.view.focus()}),l};t.ui.componentFactory.add("resizeImage",o),t.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(e,t=!1){const n=this.editor.t;return e.label?e.label:t?e.value?n("Resize image to %0",e.value+this._resizeUnit):n("Resize image to the original size"):e.value?e.value+this._resizeUnit:n("Original")}_getResizeDropdownListItemDefinitions(e,t){const n=new ge;return e.map(s=>{const o=s.value?s.value+this._resizeUnit:null,r={type:"button",model:new wt({commandName:"resizeImage",commandValue:o,label:this._getOptionLabelValue(s),role:"menuitemradio",withText:!0,icon:null})};r.model.bind("isOn").to(t,"value",Gc(o)),n.add(r)}),n}}function Gc(i){return e=>{const t=e;return i===null&&t===i?!0:t!==null&&t.width===i}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const XA="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",ZA=/(image|image-inline)/,zo="image_resized";class eE extends b{static get requires(){return[Mo]}static get pluginName(){return"ImageResizeHandles"}init(){const e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view;t.addObserver(km),this.listenTo(t.document,"imageLoaded",(n,s)=>{if(!s.target.matches(XA))return;const o=e.editing.view.domConverter,a=o.domToView(s.target).findAncestor({classes:ZA});let l=this.editor.plugins.get(Mo).getResizerByViewElement(a);if(l){l.redraw();return}const c=e.editing.mapper,d=c.toModelElement(a);l=e.plugins.get(Mo).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:d,viewElement:a,editor:e,getHandleHost(u){return u.querySelector("img")},getResizeHost(){return o.mapViewToDom(c.toViewElement(d.parent))},isCentered(){const u=d.getAttribute("imageStyle");return!u||u=="block"||u=="alignCenter"},onCommit(u){t.change(h=>{h.removeClass(zo,a)}),e.execute("resizeImage",{width:u})}}),l.on("updateSize",()=>{a.hasClass(zo)||t.change(u=>{u.addClass(zo,a)})}),l.bind("isEnabled").to(this)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cP extends b{static get requires(){return[Im,eE,YA]}static get pluginName(){return"ImageResize"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tE extends T{constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map(n=>{if(n.isDefault)for(const s of n.modelElements)this._defaultStyles[s]=n.name;return[n.name,n]}))}refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled?n.hasAttribute("imageStyle")?this.value=n.getAttribute("imageStyle"):this.value=this._defaultStyles[n.name]:this.value=!1}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("ImageUtils");n.change(o=>{const r=e.value;let a=s.getClosestSelectedImageElement(n.document.selection);r&&this.shouldConvertImageType(r,a)&&(this.editor.execute(s.isBlockImage(a)?"imageTypeInline":"imageTypeBlock"),a=s.getClosestSelectedImageElement(n.document.selection)),!r||this._styles.get(r).isDefault?o.removeAttribute("imageStyle",a):o.setAttribute("imageStyle",r,a)})}shouldConvertImageType(e,t){return!this._styles.get(e).modelElements.includes(t.name)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const{objectFullWidth:nE,objectInline:Rm,objectLeft:Vm,objectRight:pr,objectCenter:br,objectBlockLeft:Bm,objectBlockRight:Mm}=R,ps={get inline(){return{name:"inline",title:"In line",icon:Rm,modelElements:["imageInline"],isDefault:!0}},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:Vm,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"}},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:Bm,modelElements:["imageBlock"],className:"image-style-block-align-left"}},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:br,modelElements:["imageBlock"],className:"image-style-align-center"}},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:pr,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"}},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:Mm,modelElements:["imageBlock"],className:"image-style-block-align-right"}},get block(){return{name:"block",title:"Centered image",icon:br,modelElements:["imageBlock"],isDefault:!0}},get side(){return{name:"side",title:"Side image",icon:pr,modelElements:["imageBlock"],className:"image-style-side"}}},Om={full:nE,left:Bm,right:Mm,center:br,inlineLeft:Vm,inlineRight:pr,inline:Rm},Nm=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function iE(i){return(i.configuredStyles.options||[]).map(n=>rE(n)).filter(n=>aE(n,i))}function sE(i,e){return i&&e?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:i?{options:["block","side"]}:e?{options:["inline","alignLeft","alignRight"]}:{}}function oE(i){return i.has("ImageBlockEditing")&&i.has("ImageInlineEditing")?[...Nm]:[]}function rE(i){return typeof i=="string"?ps[i]?i={...ps[i]}:i={name:i}:i=lE(ps[i.name],i),typeof i.icon=="string"&&(i.icon=Om[i.icon]||i.icon),i}function aE(i,{isBlockPluginLoaded:e,isInlinePluginLoaded:t}){const{modelElements:n,name:s}=i;if(!n||!n.length||!s)return Fm({style:i}),!1;{const o=[e?"imageBlock":null,t?"imageInline":null];if(!n.some(r=>o.includes(r)))return K("image-style-missing-dependency",{style:i,missingPlugins:n.map(r=>r==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}function lE(i,e){const t={...e};for(const n in i)Object.prototype.hasOwnProperty.call(e,n)||(t[n]=i[n]);return t}function Fm(i){K("image-style-configuration-definition-invalid",i)}const wr={normalizeStyles:iE,getDefaultStylesConfiguration:sE,getDefaultDropdownDefinitions:oE,warnInvalidStyle:Fm,DEFAULT_OPTIONS:ps,DEFAULT_ICONS:Om,DEFAULT_DROPDOWN_DEFINITIONS:Nm};/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function cE(i){return(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const s=Kc(t.attributeNewValue,i),o=Kc(t.attributeOldValue,i),r=n.mapper.toViewElement(t.item),a=n.writer;o&&a.removeClass(o.className,r),s&&a.addClass(s.className,r)}}function dE(i){const e={imageInline:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageInline")),imageBlock:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageBlock"))};return(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem,r=Q(n.modelRange.getItems());if(r&&s.schema.checkAttribute(r,"imageStyle"))for(const a of e[r.name])s.consumable.consume(o,{classes:a.className})&&s.writer.setAttribute("imageStyle",a.name,r)}}function Kc(i,e){for(const t of e)if(t.name===i)return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lm extends b{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[ot]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:t}=wr,n=this.editor,s=n.plugins.has("ImageBlockEditing"),o=n.plugins.has("ImageInlineEditing");n.config.define("image.styles",t(s,o)),this.normalizedStyles=e({configuredStyles:n.config.get("image.styles"),isBlockPluginLoaded:s,isInlinePluginLoaded:o}),this._setupConversion(s,o),this._setupPostFixer(),n.commands.add("imageStyle",new tE(n,this.normalizedStyles))}_setupConversion(e,t){const n=this.editor,s=n.model.schema,o=cE(this.normalizedStyles),r=dE(this.normalizedStyles);n.editing.downcastDispatcher.on("attribute:imageStyle",o),n.data.downcastDispatcher.on("attribute:imageStyle",o),e&&(s.extend("imageBlock",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:figure",r,{priority:"low"})),t&&(s.extend("imageInline",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:img",r,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,n=e.plugins.get(ot),s=new Map(this.normalizedStyles.map(o=>[o.name,o]));t.registerPostFixer(o=>{let r=!1;for(const a of t.differ.getChanges())if(a.type=="insert"||a.type=="attribute"&&a.attributeKey=="imageStyle"){let l=a.type=="insert"?a.position.nodeAfter:a.range.start.nodeAfter;if(l&&l.is("element","paragraph")&&l.childCount>0&&(l=l.getChild(0)),!n.isImage(l))continue;const c=l.getAttribute("imageStyle");if(!c)continue;const d=s.get(c);(!d||!d.modelElements.includes(l.name))&&(o.removeAttribute("imageStyle",l),r=!0)}return r})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uE extends b{static get requires(){return[Lm]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],n=e.get("ImageStyleEditing"),s=Jc(n.normalizedStyles,this.localizedDefaultStylesTitles);for(const r of s)this._createButton(r);const o=Jc([...t.filter(We),...wr.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const r of o)this._createDropdown(r,s)}_createDropdown(e,t){const n=this.editor.ui.componentFactory;n.add(e.name,s=>{let o;const{defaultItem:r,items:a,title:l}=e,c=a.filter(m=>t.find(({name:f})=>Qc(f)===m)).map(m=>{const f=n.create(m);return m===r&&(o=f),f});a.length!==c.length&&wr.warnInvalidStyle({dropdown:e});const d=de(s,Wn),u=d.buttonView,h=u.arrowView;return Vi(d,c,{enableActiveItemFocusOnDropdownOpen:!0}),u.set({label:Yc(l,o.label),class:null,tooltip:!0}),h.unbind("label"),h.set({label:l}),u.bind("icon").toMany(c,"isOn",(...m)=>{const f=m.findIndex(Gn);return f<0?o.icon:c[f].icon}),u.bind("label").toMany(c,"isOn",(...m)=>{const f=m.findIndex(Gn);return Yc(l,f<0?o.label:c[f].label)}),u.bind("isOn").toMany(c,"isOn",(...m)=>m.some(Gn)),u.bind("class").toMany(c,"isOn",(...m)=>m.some(Gn)?"ck-splitbutton_flatten":void 0),u.on("execute",()=>{c.some(({isOn:m})=>m)?d.isOpen=!d.isOpen:o.fire("execute")}),d.bind("isEnabled").toMany(c,"isEnabled",(...m)=>m.some(Gn)),this.listenTo(d,"execute",()=>{this.editor.editing.view.focus()}),d})}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Qc(t),n=>{const s=this.editor.commands.get("imageStyle"),o=new I(n);return o.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",r=>r===t),o.on("execute",this._executeCommand.bind(this,t)),o})}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Jc(i,e){for(const t of i)e[t.title]&&(t.title=e[t.title]);return i}function Qc(i){return`imageStyle:${i}`}function Yc(i,e){return(i?i+": ":"")+e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dP extends b{static get requires(){return[Lm,uE]}static get pluginName(){return"ImageStyle"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uP extends b{static get requires(){return[Rs,ot]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(Rs),s=e.plugins.get("ImageUtils");n.register("image",{ariaLabel:t("Image toolbar"),items:hE(e.config.get("image.toolbar")||[]),getRelatedElement:o=>s.getClosestSelectedImageWidget(o)})}}function hE(i){return i.map(e=>We(e)?e.name:e)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mE extends b{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new ol(e)),e.commands.add("outdent",new ol(e))}}const Xc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',Zc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fE extends b{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?Xc:Zc,o=t.uiLanguageDirection=="ltr"?Zc:Xc;this._defineButton("indent",n("Increase indent"),s),this._defineButton("outdent",n("Decrease indent"),o)}_defineButton(e,t,n){const s=this.editor;s.ui.componentFactory.add(e,o=>{const r=s.commands.get(e),a=new I(o);return a.set({label:t,icon:n,tooltip:!0}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",()=>{s.execute(e),s.editing.view.focus()}),a})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hP extends b{static get pluginName(){return"Indent"}static get requires(){return[mE,fE]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rs extends T{constructor(e,t){super(e),this._indentBehavior=t}refresh(){const t=this.editor.model,n=Q(t.document.selection.getSelectedBlocks());if(!n||!t.schema.checkAttribute(n,"blockIndent")){this.isEnabled=!1;return}this.isEnabled=this._indentBehavior.checkEnabled(n.getAttribute("blockIndent"))}execute(){const e=this.editor.model,t=gE(e);e.change(n=>{for(const s of t){const o=s.getAttribute("blockIndent"),r=this._indentBehavior.getNextIndent(o);r?n.setAttribute("blockIndent",r,s):n.removeAttribute("blockIndent",s)}})}}function gE(i){const e=i.document.selection,t=i.schema;return Array.from(e.getSelectedBlocks()).filter(s=>t.checkAttribute(s,"blockIndent"))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ed{constructor(e){this.isForward=e.direction==="forward",this.offset=e.offset,this.unit=e.unit}checkEnabled(e){const t=parseFloat(e||"0");return this.isForward||t>0}getNextIndent(e){const t=parseFloat(e||"0");if(!(!e||e.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;const s=this.isForward?this.offset:-this.offset,o=t+s;return o>0?o+this.unit:void 0}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class td{constructor(e){this.isForward=e.direction==="forward",this.classes=e.classes}checkEnabled(e){const t=this.classes.indexOf(e);return this.isForward?t<this.classes.length-1:t>=0}getNextIndent(e){const t=this.classes.indexOf(e),n=this.isForward?1:-1;return this.classes[t+n]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const pE=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class mP extends b{constructor(e){super(e),e.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}init(){const e=this.editor,t=e.config.get("indentBlock");t.classes&&t.classes.length?(this._setupConversionUsingClasses(t.classes),e.commands.add("indentBlock",new rs(e,new td({direction:"forward",classes:t.classes}))),e.commands.add("outdentBlock",new rs(e,new td({direction:"backward",classes:t.classes})))):(e.data.addStyleProcessorRules(S0),this._setupConversionUsingOffset(),e.commands.add("indentBlock",new rs(e,new ed({direction:"forward",offset:t.offset,unit:t.unit}))),e.commands.add("outdentBlock",new rs(e,new ed({direction:"backward",offset:t.offset,unit:t.unit}))))}afterInit(){const e=this.editor,t=e.model.schema,n=e.commands.get("indent"),s=e.commands.get("outdent"),o=e.config.get("heading.options");(o&&o.map(l=>l.model)||pE).forEach(l=>{t.isRegistered(l)&&t.extend(l,{allowAttributes:"blockIndent"})}),t.setAttributeProperties("blockIndent",{isFormatting:!0}),n.registerChildCommand(e.commands.get("indentBlock")),s.registerChildCommand(e.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const e=this.editor.conversion,n=this.editor.locale.contentLanguageDirection==="rtl"?"margin-right":"margin-left";e.for("upcast").attributeToAttribute({view:{styles:{[n]:/[\s\S]+/}},model:{key:"blockIndent",value:s=>s.getStyle(n)}}),e.for("downcast").attributeToAttribute({model:"blockIndent",view:s=>({key:"style",value:{[n]:s}})})}_setupConversionUsingClasses(e){const t={model:{key:"blockIndent",values:[]},view:{}};for(const n of e)t.model.values.push(n),t.view[n]={key:"class",value:[n]};this.editor.conversion.attributeToAttribute(t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wa(i,e){return e=e||Qo(i),`${i}:${e}`}function bE(i){const[e,t]=i.split(":");return{languageCode:e,textDirection:t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wE extends T{refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"language")}execute({languageCode:e,textDirection:t}={}){const n=this.editor.model,o=n.document.selection,r=e?wa(e,t):!1;n.change(a=>{if(o.isCollapsed)r?a.setSelectionAttribute("language",r):a.removeSelectionAttribute("language");else{const l=n.schema.getValidRanges(o.getRanges(),"language");for(const c of l)r?a.setAttribute("language",r,c):a.removeAttribute("language",c)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,n=e.document.selection;if(n.isCollapsed)return n.getAttribute("language")||!1;for(const s of n.getRanges())for(const o of s.getItems())if(t.checkAttribute(o,"language"))return o.getAttribute("language")||!1;return!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _E extends b{static get pluginName(){return"TextPartLanguageEditing"}constructor(e){super(e),e.config.define("language",{textPartLanguage:[{title:"Arabic",languageCode:"ar"},{title:"French",languageCode:"fr"},{title:"Spanish",languageCode:"es"}]})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"language"}),e.model.schema.setAttributeProperties("language",{copyOnEnter:!0}),this._defineConverters(),e.commands.add("textPartLanguage",new wE(e))}_defineConverters(){const e=this.editor.conversion;e.for("upcast").elementToAttribute({model:{key:"language",value:t=>{const n=t.getAttribute("lang"),s=t.getAttribute("dir");return wa(n,s)}},view:{name:"span",attributes:{lang:/[\s\S]+/}}}),e.for("downcast").attributeToElement({model:"language",view:(t,{writer:n},s)=>{if(!t||!s.item.is("$textProxy")&&!s.item.is("documentSelection"))return;const{languageCode:o,textDirection:r}=bE(t);return n.createAttributeElement("span",{lang:o,dir:r})}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vE extends b{static get pluginName(){return"TextPartLanguageUI"}init(){const e=this.editor,t=e.t,n=e.config.get("language.textPartLanguage"),s=t("Choose language"),o=t("Remove language"),r=t("Language");e.ui.componentFactory.add("textPartLanguage",a=>{const l=new ge,c={},d=e.commands.get("textPartLanguage");l.add({type:"button",model:new wt({label:o,languageCode:!1,withText:!0})}),l.add({type:"separator"});for(const h of n){const m={type:"button",model:new wt({label:h.title,languageCode:h.languageCode,role:"menuitemradio",textDirection:h.textDirection,withText:!0})},f=wa(h.languageCode,h.textDirection);m.model.bind("isOn").to(d,"value",p=>p===f),l.add(m),c[f]=h.title}const u=de(a);return kt(u,l,{ariaLabel:r,role:"menu"}),u.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),u.extendTemplate({attributes:{class:["ck-text-fragment-language-dropdown"]}}),u.bind("isEnabled").to(d,"isEnabled"),u.buttonView.bind("label").to(d,"value",h=>h&&c[h]||s),this.listenTo(u,"execute",h=>{d.execute({languageCode:h.source.languageCode,textDirection:h.source.textDirection}),e.editing.view.focus()}),u})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fP extends b{static get requires(){return[_E,vE]}static get pluginName(){return"TextPartLanguage"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ue{constructor(e,t){this._startElement=e,this._referenceIndent=e.getAttribute("listIndent"),this._isForward=t.direction=="forward",this._includeSelf=!!t.includeSelf,this._sameAttributes=q(t.sameAttributes||[]),this._sameIndent=!!t.sameIndent,this._lowerIndent=!!t.lowerIndent,this._higherIndent=!!t.higherIndent}static first(e,t){const s=new this(e,t)[Symbol.iterator]();return Q(s)}*[Symbol.iterator](){const e=[];for(const{node:t}of $n(this._getStartNode(),this._isForward?"forward":"backward")){const n=t.getAttribute("listIndent");if(n<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=n}else if(n>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){e.push(t);continue}}else{if(!this._sameIndent){if(this._higherIndent){e.length&&(yield*e,e.length=0);break}continue}if(this._sameAttributes.some(s=>t.getAttribute(s)!==this._startElement.getAttribute(s)))break}e.length&&(yield*e,e.length=0),yield t}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}function*$n(i,e="forward"){const t=e=="forward";let n=null;for(;te(i);)yield{node:i,previous:n},n=i,i=t?i.nextSibling:i.previousSibling}class yE{constructor(e){this._listHead=e}[Symbol.iterator](){return $n(this._listHead,"forward")}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ti{static next(){return Se()}}function te(i){return!!i&&i.is("element")&&i.hasAttribute("listItemId")}function _a(i,e={}){return[...Ft(i,{...e,direction:"backward"}),...Ft(i,{...e,direction:"forward"})]}function Ft(i,e={}){const t=e.direction=="forward",n=Array.from(new Ue(i,{...e,includeSelf:t,sameIndent:!0,sameAttributes:"listItemId"}));return t?n:n.reverse()}function CE(i){return Array.from(new Ue(i,{direction:"forward",higherIndent:!0}))}function Dm(i){const e=new Ue(i,{sameIndent:!0,sameAttributes:"listType"}),t=new Ue(i,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward"});return[...Array.from(e).reverse(),...t]}function Dn(i){return!Ue.first(i,{sameIndent:!0,sameAttributes:"listItemId"})}function nd(i){return!Ue.first(i,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function Oi(i,e={}){i=q(i);const t=e.withNested!==!1,n=new Set;for(const s of i)for(const o of _a(s,{higherIndent:t}))n.add(o);return un(n)}function no(i){i=q(i);const e=new Set;for(const t of i)for(const n of Dm(t))e.add(n);return un(e)}function va(i,e){const t=Ft(i,{direction:"forward"}),n=Ti.next();for(const s of t)e.setAttribute("listItemId",n,s);return t}function _r(i,e,t){const n={};for(const[o,r]of e.getAttributes())o.startsWith("list")&&(n[o]=r);const s=Ft(i,{direction:"forward"});for(const o of s)t.setAttributes(n,o);return s}function vr(i,e,{expand:t,indentBy:n=1}={}){i=q(i);const s=t?Oi(i):i;for(const o of s){const r=o.getAttribute("listIndent")+n;r<0?io(o,e):e.setAttribute("listIndent",r,o)}return s}function kE(i,e){i=q(i);const t=Oi(i),n=new Set,s=Math.min(...t.map(r=>r.getAttribute("listIndent"))),o=new Map;for(const r of t)o.set(r,Ue.first(r,{lowerIndent:!0}));for(const r of t){if(n.has(r))continue;n.add(r);const a=r.getAttribute("listIndent")-1;if(a<0){io(r,e);continue}if(r.getAttribute("listIndent")==s){const l=EE(r,o.get(r),e);for(const c of l)n.add(c);if(l.length)continue}e.setAttribute("listIndent",a,r)}return un(n)}function io(i,e){i=q(i);for(const t of i)for(const n of t.getAttributeKeys())n.startsWith("list")&&e.removeAttribute(n,t);return i}function Si(i){if(!i.length)return!1;const e=i[0].getAttribute("listItemId");return e?!i.some(t=>t.getAttribute("listItemId")!=e):!1}function AE(i,e){const t=[];let n=Number.POSITIVE_INFINITY;for(const{node:s}of $n(i.nextSibling,"forward")){const o=s.getAttribute("listIndent");if(o==0)break;o<n&&(n=o);const r=o-n;e.setAttribute("listIndent",r,s),t.push(s)}return t}function un(i){return Array.from(i).filter(e=>e.root.rootName!=="$graveyard").sort((e,t)=>e.index-t.index)}function xi(i){const e=i.document.selection.getSelectedElement();return e&&i.schema.isObject(e)&&i.schema.isBlock(e)?e:null}function EE(i,e,t){return Ft(e,{direction:"forward"}).pop().index>i.index?_r(i,e,t):[]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class id extends T{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=sd(e.document.selection);e.change(n=>{const s=[];Si(t)&&!Dn(t[0])?(this._direction=="forward"&&s.push(...vr(t,n)),s.push(...va(t[0],n))):this._direction=="forward"?s.push(...vr(t,n,{expand:!0})):s.push(...kE(t,n));for(const o of s){if(!o.hasAttribute("listType"))continue;const r=Ue.first(o,{sameIndent:!0});r&&n.setAttribute("listType",r.getAttribute("listType"),o)}this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",un(new Set(e)))}_checkEnabled(){let e=sd(this.editor.model.document.selection),t=e[0];if(!t)return!1;if(this._direction=="backward"||Si(e)&&!Dn(e[0]))return!0;e=Oi(e),t=e[0];const n=Ue.first(t,{sameIndent:!0});return n?n.getAttribute("listType")==t.getAttribute("listType"):!1}}function sd(i){const e=Array.from(i.getSelectedBlocks()),t=e.findIndex(n=>!te(n));return t!=-1&&(e.length=t),e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class od extends T{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.document,s=xi(t),o=Array.from(n.selection.getSelectedBlocks()).filter(a=>t.schema.checkAttribute(a,"listType")),r=e.forceValue!==void 0?!e.forceValue:this.value;t.change(a=>{if(r){const l=o[o.length-1],c=Ft(l,{direction:"forward"}),d=[];c.length>1&&d.push(...va(c[1],a)),d.push(...io(o,a)),d.push(...AE(l,a)),this._fireAfterExecute(d)}else if((s||n.selection.isCollapsed)&&te(o[0])){const l=Dm(s||o[0]);for(const c of l)a.setAttribute("listType",this.type,c);this._fireAfterExecute(l)}else{const l=[];for(const c of o)if(!c.hasAttribute("listType"))a.setAttributes({listIndent:0,listItemId:Ti.next(),listType:this.type},c),l.push(c);else for(const d of Oi(c,{withNested:!1}))d.getAttribute("listType")!=this.type&&(a.setAttribute("listType",this.type,d),l.push(d));this._fireAfterExecute(l)}})}_fireAfterExecute(e){this.fire("afterExecute",un(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,t=Array.from(e.getSelectedBlocks());if(!t.length)return!1;for(const n of t)if(n.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Array.from(e.getSelectedBlocks());if(!n.length)return!1;if(this.value)return!0;for(const s of n)if(t.checkAttribute(s,"listType"))return!0;return!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rd extends T{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const t=this.editor.model,n=t.document.selection,s=[];t.change(o=>{const{firstElement:r,lastElement:a}=this._getMergeSubjectElements(n,e),l=r.getAttribute("listIndent")||0,c=a.getAttribute("listIndent"),d=a.getAttribute("listItemId");if(l!=c){const u=CE(a);s.push(...vr([a,...u],o,{indentBy:l-c,expand:l<c}))}if(e){let u=n;n.isCollapsed&&(u=o.createSelection(o.createRange(o.createPositionAt(r,"end"),o.createPositionAt(a,0)))),t.deleteContent(u,{doNotResetEntireContent:n.isCollapsed});const h=u.getLastPosition().parent,m=h.nextSibling;s.push(h),m&&m!==a&&m.getAttribute("listItemId")==d&&s.push(..._r(m,h,o))}else s.push(..._r(a,r,o));this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",un(new Set(e)))}_checkEnabled(){const e=this.editor.model,t=e.document.selection,n=xi(e);if(t.isCollapsed||n){const s=n||t.getFirstPosition().parent;if(!te(s))return!1;const o=this._direction=="backward"?s.previousSibling:s.nextSibling;if(!o||Si([s,o]))return!1}else{const s=t.getLastPosition(),o=t.getFirstPosition();if(s.parent===o.parent||!te(s.parent))return!1}return!0}_getMergeSubjectElements(e,t){const n=this.editor.model,s=xi(n);let o,r;if(e.isCollapsed||s){const a=s||e.getFirstPosition().parent,l=Dn(a);this._direction=="backward"?(r=a,l&&!t?o=Ue.first(a,{sameIndent:!0,lowerIndent:!0}):o=a.previousSibling):(o=a,r=a.nextSibling)}else o=e.getFirstPosition().parent,r=e.getLastPosition().parent;return{firstElement:o,lastElement:r}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ad extends T{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(t=>{const n=va(this._getStartBlock(),t);this._fireAfterExecute(n)})}_fireAfterExecute(e){this.fire("afterExecute",un(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,t=this._getStartBlock();return e.isCollapsed&&te(t)&&!Dn(t)}_getStartBlock(){const t=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?t:t.nextSibling}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class TE extends b{static get pluginName(){return"DocumentListUtils"}expandListBlocksToCompleteList(e){return no(e)}isFirstBlockOfListItem(e){return Dn(e)}isListItemBlock(e){return te(e)}expandListBlocksToCompleteItems(e,t={}){return Oi(e,t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zm(i){return i.is("element","ol")||i.is("element","ul")}function Ms(i){return i.is("element","li")}function SE(i){let e=0,t=i.parent;for(;t;){if(Ms(t))e++;else{const n=t.previousSibling;n&&Ms(n)&&e++}t=t.parent}return e}function xE(i,e,t,n=Wm(t,e)){return i.createAttributeElement(Hm(t),null,{priority:2*e/100-100,id:n})}function PE(i,e,t){return i.createAttributeElement("li",null,{priority:(2*e+1)/100-100,id:t})}function Hm(i){return i=="numbered"?"ol":"ul"}function Wm(i,e){return`list-${i}-${e}`}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ke(i,e){const t=i.nodeBefore;if(te(t)){let n=t;for(const{node:s}of $n(n,"backward"))if(n=s,e.has(n))return;e.set(t,n)}else{const n=i.nodeAfter;te(n)&&e.set(n,n)}}function IE(i,e){let t=0,n=-1,s=null,o=!1;for(const{node:r}of i){const a=r.getAttribute("listIndent");if(a>t){let l;s===null?(s=a-t,l=t):(s>a&&(s=a),l=a-s),l>n+1&&(l=n+1),e.setAttribute("listIndent",l,r),o=!0,n=l}else s=null,t=a+1,n=a}return o}function RE(i,e,t){const n=new Set;let s=!1;for(const{node:o}of i){if(n.has(o))continue;let r=o.getAttribute("listType"),a=o.getAttribute("listItemId");e.has(a)&&(a=Ti.next()),e.add(a);for(const l of Ft(o,{direction:"forward"}))n.add(l),l.getAttribute("listType")!=r&&(a=Ti.next(),r=l.getAttribute("listType")),l.getAttribute("listItemId")!=a&&(t.setAttribute("listItemId",a,l),s=!0)}return s}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function VE(){return(i,e,t)=>{const{writer:n,schema:s}=t;if(!e.modelRange)return;const o=Array.from(e.modelRange.getItems({shallow:!0})).filter(a=>s.checkAttribute(a,"listItemId"));if(!o.length)return;const r={listItemId:Ti.next(),listIndent:SE(e.viewItem),listType:e.viewItem.parent&&e.viewItem.parent.is("element","ol")?"numbered":"bulleted"};for(const a of o)te(a)||n.setAttributes(r,a);o.length>1&&o[1].getAttribute("listItemId")!=r.listItemId&&t.keepEmptyElement(o[0])}}function ld(){return(i,e,t)=>{if(!t.consumable.test(e.viewItem,{name:!0}))return;const n=new Ze(e.viewItem.document);for(const s of Array.from(e.viewItem.getChildren()))!Ms(s)&&!zm(s)&&n.remove(s)}}function BE(i,e,t,n){return()=>{const a=i.document.differ.getChanges(),l=[],c=new Map,d=new Set;for(const u of a)if(u.type=="insert"&&u.name!="$text")Ke(u.position,c),u.attributes.has("listItemId")?d.add(u.position.nodeAfter):Ke(u.position.getShiftedBy(u.length),c);else if(u.type=="remove"&&u.attributes.has("listItemId"))Ke(u.position,c);else if(u.type=="attribute"){const h=u.range.start.nodeAfter;t.includes(u.attributeKey)?(Ke(u.range.start,c),u.attributeNewValue===null?(Ke(u.range.start.getShiftedBy(1),c),o(h)&&l.push(h)):d.add(h)):te(h)&&o(h)&&l.push(h)}for(const u of c.values())l.push(...s(u,d));for(const u of new Set(l))e.reconvertItem(u)};function s(a,l){const c=[],d=new Set,u=[];for(const{node:h,previous:m}of $n(a,"forward")){if(d.has(h))continue;const f=h.getAttribute("listIndent");m&&f<m.getAttribute("listIndent")&&(u.length=f+1),u[f]=Object.fromEntries(Array.from(h.getAttributes()).filter(([w])=>t.includes(w)));const p=Ft(h,{direction:"forward"});for(const w of p)d.add(w),(o(w,p)||r(w,u,l))&&c.push(w)}return c}function o(a,l){if(!a.is("element","paragraph"))return!1;const c=e.mapper.toViewElement(a);if(!c)return!1;const d=$m(a,t,l);return d&&c.is("element","p")?!0:!!(!d&&c.is("element","span"))}function r(a,l,c){if(c.has(a))return!1;const d=e.mapper.toViewElement(a);let u=l.length-1;for(let h=d.parent;!h.is("editableElement");h=h.parent){const m=Ms(h),f=zm(h);if(!f&&!m)continue;const p=`checkAttributes:${m?"item":"list"}`;if(n.fire(p,{viewElement:h,modelAttributes:l[u]}))break;if(f&&(u--,u<0))return!1}return!0}}function ME(i,e,t){const n=LE(i);return(s,o,r)=>{const{writer:a,mapper:l,consumable:c}=r,d=o.item;if(!i.includes(o.attributeKey)||!n(d,c))return;const u=OE(d,l,t);NE(u,a),FE(d,a.createRangeOn(u),e,a)}}function cd(i,{dataPipeline:e}={}){return(t,{writer:n})=>{if(!$m(t,i))return null;if(!e)return n.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const s=n.createContainerElement("p");return n.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function OE(i,e,t){const n=t.createRangeOn(i);return e.toViewRange(n).getTrimmed().getContainedElement()}function NE(i,e){let t=i.parent;for(;t.is("attributeElement")&&["ul","ol","li"].includes(t.name);){const n=t.parent;e.unwrap(e.createRangeOn(i),t),t=n}}function FE(i,e,t,n){if(!i.hasAttribute("listIndent"))return;const s=i.getAttribute("listIndent");let o=i;for(let r=s;r>=0;r--){const a=PE(n,r,o.getAttribute("listItemId")),l=xE(n,r,o.getAttribute("listType"));for(const c of t)o.hasAttribute(c.attributeName)&&c.setAttributeOnDowncast(n,o.getAttribute(c.attributeName),c.scope=="list"?l:a);if(e=n.wrap(e,a),e=n.wrap(e,l),r==0||(o=Ue.first(o,{lowerIndent:!0}),!o))break}}function LE(i){return(e,t)=>{const n=[];for(const s of i)e.hasAttribute(s)&&n.push(`attribute:${s}`);return n.every(s=>t.test(e,s)!==!1)?(n.forEach(s=>t.consume(e,s)),!0):!1}}function $m(i,e,t=_a(i)){if(!te(i))return!1;for(const n of i.getAttributeKeys())if(!n.startsWith("selection:")&&!e.includes(n))return!1;return t.length<2}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ei=["listType","listIndent","listItemId"];class yr extends b{constructor(){super(...arguments),this._downcastStrategies=[]}static get pluginName(){return"DocumentListEditing"}static get requires(){return[Mi,_t,TE]}init(){const e=this.editor,t=e.model;if(e.plugins.has("ListEditing"))throw new g("document-list-feature-conflict",this,{conflictPlugin:"ListEditing"});t.schema.extend("$container",{allowAttributes:ei}),t.schema.extend("$block",{allowAttributes:ei}),t.schema.extend("$blockObject",{allowAttributes:ei});for(const n of ei)t.schema.setAttributeProperties(n,{copyOnReplace:!0});e.commands.add("numberedList",new od(e,"numbered")),e.commands.add("bulletedList",new od(e,"bulleted")),e.commands.add("indentList",new id(e,"forward")),e.commands.add("outdentList",new id(e,"backward")),e.commands.add("mergeListItemBackward",new rd(e,"backward")),e.commands.add("mergeListItemForward",new rd(e,"forward")),e.commands.add("splitListItemBefore",new ad(e,"before")),e.commands.add("splitListItemAfter",new ad(e,"after")),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration()}afterInit(){const t=this.editor.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentList"),{priority:"high"}),s&&s.registerChildCommand(t.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}_getListAttributeNames(){return[...ei,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,t=e.commands.get("mergeListItemBackward"),n=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(s,o)=>{const r=e.model.document.selection;xi(e.model)||e.model.change(()=>{const a=r.getFirstPosition();if(r.isCollapsed&&o.direction=="backward"){if(!a.isAtStart)return;const l=a.parent;if(!te(l))return;if(!Ue.first(l,{sameAttributes:"listType",sameIndent:!0})&&l.getAttribute("listIndent")===0)nd(l)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!t.isEnabled)return;t.execute({shouldMergeOnBlocksContentLevel:dd(e.model,"backward")})}o.preventDefault(),s.stop()}else{if(r.isCollapsed&&!r.getLastPosition().isAtEnd||!n.isEnabled)return;n.execute({shouldMergeOnBlocksContentLevel:dd(e.model,"forward")}),o.preventDefault(),s.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,t=e.model,n=e.commands,s=n.get("enter");this.listenTo(e.editing.view.document,"enter",(o,r)=>{const a=t.document,l=a.selection.getFirstPosition().parent;if(a.selection.isCollapsed&&te(l)&&l.isEmpty&&!r.isSoft){const c=Dn(l),d=nd(l);c&&d?(e.execute("outdentList"),r.preventDefault(),o.stop()):c&&!d?(e.execute("splitListItemAfter"),r.preventDefault(),o.stop()):d&&(e.execute("splitListItemBefore"),r.preventDefault(),o.stop())}},{context:"li"}),this.listenTo(s,"afterExecute",()=>{const o=n.get("splitListItemBefore");if(o.refresh(),!o.isEnabled)return;const a=e.model.document.selection.getLastPosition().parent;_a(a).length===2&&o.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(t,n)=>{const s=n.shiftKey?"outdentList":"indentList";this.editor.commands.get(s).isEnabled&&(e.execute(s),n.stopPropagation(),n.preventDefault(),t.stop())},{context:"li"})}_setupConversion(){const e=this.editor,t=e.model,n=this._getListAttributeNames();e.conversion.for("upcast").elementToElement({view:"li",model:"paragraph"}).add(s=>{s.on("element:li",VE()),s.on("element:ul",ld(),{priority:"high"}),s.on("element:ol",ld(),{priority:"high"})}),e.conversion.for("editingDowncast").elementToElement({model:"paragraph",view:cd(n),converterPriority:"high"}),e.conversion.for("dataDowncast").elementToElement({model:"paragraph",view:cd(n,{dataPipeline:!0}),converterPriority:"high"}),e.conversion.for("downcast").add(s=>{s.on("attribute",ME(n,this._downcastStrategies,t))}),this.listenTo(t.document,"change:data",BE(t,e.editing,n,this),{priority:"high"}),this.on("checkAttributes:item",(s,{viewElement:o,modelAttributes:r})=>{o.id!=r.listItemId&&(s.return=!0,s.stop())}),this.on("checkAttributes:list",(s,{viewElement:o,modelAttributes:r})=>{(o.name!=Hm(r.listType)||o.id!=Wm(r.listType,r.listIndent))&&(s.return=!0,s.stop())})}_setupModelPostFixing(){const e=this.editor.model,t=this._getListAttributeNames();e.document.registerPostFixer(n=>DE(e,n,t,this)),this.on("postFixer",(n,{listNodes:s,writer:o})=>{n.return=IE(s,o)||n.return},{priority:"high"}),this.on("postFixer",(n,{listNodes:s,writer:o,seenIds:r})=>{n.return=RE(s,r,o)||n.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model;this.listenTo(e,"insertContent",zE(e),{priority:"high"}),this.listenTo(e,"getSelectedContent",(t,[n])=>{Si(Array.from(n.getSelectedBlocks()))&&e.change(o=>io(Array.from(t.return.getChildren()),o))})}}function DE(i,e,t,n){const s=i.document.differ.getChanges(),o=new Map;let r=!1;for(const l of s)if(l.type=="insert"&&l.name!="$text"){const c=l.position.nodeAfter;if(!i.schema.checkAttribute(c,"listItemId"))for(const d of Array.from(c.getAttributeKeys()))t.includes(d)&&(e.removeAttribute(d,c),r=!0);Ke(l.position,o),l.attributes.has("listItemId")||Ke(l.position.getShiftedBy(l.length),o);for(const{item:d,previousPosition:u}of i.createRangeIn(c))te(d)&&Ke(u,o)}else l.type=="remove"?Ke(l.position,o):l.type=="attribute"&&t.includes(l.attributeKey)&&(Ke(l.range.start,o),l.attributeNewValue===null&&Ke(l.range.start.getShiftedBy(1),o));const a=new Set;for(const l of o.values())r=n.fire("postFixer",{listNodes:new yE(l),listHead:l,writer:e,seenIds:a})||r;return r}function zE(i){return(e,[t,n])=>{const s=t.is("documentFragment")?t.getChild(0):t;if(!te(s))return;let o;n?o=i.createSelection(n):o=i.document.selection;const r=o.getFirstPosition();let a=null;if(te(r.parent)?a=r.parent:te(r.nodeBefore)&&(a=r.nodeBefore),!a)return;const l=a.getAttribute("listIndent")-s.getAttribute("listIndent");l<=0||i.change(c=>{for(const{node:d}of $n(s,"forward"))c.setAttribute("listIndent",d.getAttribute("listIndent")+l,d)})}}function dd(i,e){const t=i.document.selection;if(!t.isCollapsed)return!xi(i);if(e==="forward")return!0;const s=t.getFirstPosition().parent,o=s.previousSibling;return i.schema.isObject(o)?!1:o.isEmpty?!0:Si([s,o])}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ud(i,e,t,n){i.ui.componentFactory.add(e,s=>{const o=i.commands.get(e),r=new I(s);return r.set({label:t,icon:n,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",()=>{i.execute(e),i.editing.view.focus()}),r})}const Um='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',qm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class HE extends b{static get pluginName(){return"ListUI"}init(){const e=this.editor.t;ud(this.editor,"numberedList",e("Numbered List"),Um),ud(this.editor,"bulletedList",e("Bulleted List"),qm)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gP extends b{static get requires(){return[yr,HE]}static get pluginName(){return"DocumentList"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WE extends T{refresh(){const e=this._getValue();this.value=e,this.isEnabled=e!=null}execute({startIndex:e=1}={}){const t=this.editor.model,n=t.document;let s=Array.from(n.selection.getSelectedBlocks()).filter(o=>te(o)&&o.getAttribute("listType")=="numbered");s=no(s),t.change(o=>{for(const r of s)o.setAttribute("listStart",e>=0?e:1,r)})}_getValue(){const t=this.editor.model.document,n=Q(t.selection.getSelectedBlocks());return n&&te(n)&&n.getAttribute("listType")=="numbered"?n.getAttribute("listStart"):null}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const jm={},Gm={},Km={},Jm=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:i,typeAttribute:e,listType:t}of Jm)jm[i]=t,Gm[i]=e,e&&(Km[e]=i);function Qm(){return Jm.map(i=>i.listStyle)}function ya(i){return jm[i]||null}function Ym(i){return Km[i]||null}function Cr(i){return Gm[i]||null}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $E extends T{constructor(e,t,n){super(e),this.defaultType=t,this._supportedTypes=n}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.document;t.change(s=>{this._tryToConvertItemsToList(e);let o=Array.from(n.selection.getSelectedBlocks()).filter(r=>r.hasAttribute("listType"));if(o.length){o=no(o);for(const r of o)s.setAttribute("listStyle",e.type||this.defaultType,r)}})}isStyleTypeSupported(e){return this._supportedTypes?this._supportedTypes.includes(e):!0}_getValue(){const e=Q(this.editor.model.document.selection.getSelectedBlocks());return te(e)?e.getAttribute("listStyle"):null}_checkEnabled(){const e=this.editor,t=e.commands.get("numberedList"),n=e.commands.get("bulletedList");return t.isEnabled||n.isEnabled}_tryToConvertItemsToList(e){if(!e.type)return;const t=ya(e.type);if(!t)return;const n=this.editor,s=`${t}List`;n.commands.get(s).value||n.execute(s)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class UE extends T{refresh(){const e=this._getValue();this.value=e,this.isEnabled=e!=null}execute(e={}){const t=this.editor.model,n=t.document;let s=Array.from(n.selection.getSelectedBlocks()).filter(o=>te(o)&&o.getAttribute("listType")=="numbered");s=no(s),t.change(o=>{for(const r of s)o.setAttribute("listReversed",!!e.reversed,r)})}_getValue(){const t=this.editor.model.document,n=Q(t.selection.getSelectedBlocks());return te(n)&&n.getAttribute("listType")=="numbered"?n.getAttribute("listReversed"):null}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hd(i){return(e,t,n)=>{const{writer:s,schema:o,consumable:r}=n;if(r.test(t.viewItem,i.viewConsumables)===!1)return;t.modelRange||Object.assign(t,n.convertChildren(t.viewItem,t.modelCursor));let a=!1;for(const l of t.modelRange.getItems({shallow:!0}))o.checkAttribute(l,i.attributeName)&&i.appliesToListItem(l)&&(l.hasAttribute(i.attributeName)||(s.setAttribute(i.attributeName,i.getAttributeOnUpcast(t.viewItem),l),a=!0));a&&r.consume(t.viewItem,i.viewConsumables)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qE extends b{static get pluginName(){return"DocumentListPropertiesUtils"}getAllSupportedStyleTypes(){return Qm()}getListTypeFromListStyleType(e){return ya(e)}getListStyleTypeFromTypeAttribute(e){return Ym(e)}getTypeAttributeFromListStyleType(e){return Cr(e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ti="default";class jE extends b{static get requires(){return[yr,qE]}static get pluginName(){return"DocumentListPropertiesEditing"}constructor(e){super(e),e.config.define("list",{properties:{styles:!0,startIndex:!1,reversed:!1}})}init(){const e=this.editor,t=e.model,n=e.plugins.get(yr),s=e.config.get("list.properties"),o=GE(s);for(const r of o)r.addCommand(e),t.schema.extend("$container",{allowAttributes:r.attributeName}),t.schema.extend("$block",{allowAttributes:r.attributeName}),t.schema.extend("$blockObject",{allowAttributes:r.attributeName}),n.registerDowncastStrategy({scope:"list",attributeName:r.attributeName,setAttributeOnDowncast(a,l,c){r.setAttributeOnDowncast(a,l,c)}});e.conversion.for("upcast").add(r=>{for(const a of o)r.on("element:ol",hd(a)),r.on("element:ul",hd(a))}),n.on("checkAttributes:list",(r,{viewElement:a,modelAttributes:l})=>{for(const c of o)c.getAttributeOnUpcast(a)!=l[c.attributeName]&&(r.return=!0,r.stop())}),this.listenTo(e.commands.get("indentList"),"afterExecute",(r,a)=>{t.change(l=>{for(const c of a)for(const d of o)d.appliesToListItem(c)&&l.setAttribute(d.attributeName,d.defaultValue,c)})}),n.on("postFixer",(r,{listNodes:a,writer:l})=>{for(const{node:c}of a)for(const d of o)d.hasValidAttribute(c)||(d.appliesToListItem(c)?l.setAttribute(d.attributeName,d.defaultValue,c):l.removeAttribute(d.attributeName,c),r.return=!0)}),n.on("postFixer",(r,{listNodes:a,writer:l})=>{const c=[];for(const{node:d,previous:u}of a){if(!u)continue;const h=d.getAttribute("listIndent"),m=u.getAttribute("listIndent");let f=null;if(h>m?c[m]=u:h<m?(f=c[h],c.length=h):f=u,!!f&&f.getAttribute("listType")==d.getAttribute("listType"))for(const p of o){const{attributeName:w}=p;if(!p.appliesToListItem(d))continue;const v=f.getAttribute(w);d.getAttribute(w)!=v&&(l.setAttribute(w,v,d),r.return=!0)}}})}}function GE(i){const e=[];if(i.styles){const t=typeof i.styles=="object"&&i.styles.useAttribute;e.push({attributeName:"listStyle",defaultValue:ti,viewConsumables:{styles:"list-style-type"},addCommand(n){let s=Qm();t&&(s=s.filter(o=>!!Cr(o))),n.commands.add("listStyle",new $E(n,ti,s))},appliesToListItem(){return!0},hasValidAttribute(n){if(!n.hasAttribute("listStyle"))return!1;const s=n.getAttribute("listStyle");return s==ti?!0:ya(s)==n.getAttribute("listType")},setAttributeOnDowncast(n,s,o){if(s&&s!==ti)if(t){const r=Cr(s);if(r){n.setAttribute("type",r,o);return}}else{n.setStyle("list-style-type",s,o);return}n.removeStyle("list-style-type",o),n.removeAttribute("type",o)},getAttributeOnUpcast(n){const s=n.getStyle("list-style-type");if(s)return s;const o=n.getAttribute("type");return o?Ym(o):ti}})}return i.reversed&&e.push({attributeName:"listReversed",defaultValue:!1,viewConsumables:{attributes:"reversed"},addCommand(t){t.commands.add("listReversed",new UE(t))},appliesToListItem(t){return t.getAttribute("listType")=="numbered"},hasValidAttribute(t){return this.appliesToListItem(t)==t.hasAttribute("listReversed")},setAttributeOnDowncast(t,n,s){n?t.setAttribute("reversed","reversed",s):t.removeAttribute("reversed",s)},getAttributeOnUpcast(t){return t.hasAttribute("reversed")}}),i.startIndex&&e.push({attributeName:"listStart",defaultValue:1,viewConsumables:{attributes:"start"},addCommand(t){t.commands.add("listStart",new WE(t))},appliesToListItem(t){return t.getAttribute("listType")=="numbered"},hasValidAttribute(t){return this.appliesToListItem(t)==t.hasAttribute("listStart")},setAttributeOnDowncast(t,n,s){n==0||n>1?t.setAttribute("start",n,s):t.removeAttribute("start",s)},getAttributeOnUpcast(t){const n=t.getAttribute("start");return n>=0?n:1}}),e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class KE extends E{constructor(e,t){super(e);const n=this.bindTemplate;this.set("isCollapsed",!1),this.set("label",""),this.buttonView=this._createButtonView(),this.children=this.createCollection(),this.set("_collapsibleAriaLabelUid",void 0),t&&this.children.addMany(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-collapsible",n.if("isCollapsed","ck-collapsible_collapsed")]},children:[this.buttonView,{tag:"div",attributes:{class:["ck","ck-collapsible__children"],role:"region",hidden:n.if("isCollapsed","hidden"),"aria-labelledby":n.to("_collapsibleAriaLabelUid")},children:this.children}]})}render(){super.render(),this._collapsibleAriaLabelUid=this.buttonView.labelView.element.id}_createButtonView(){const e=new I(this.locale),t=e.bindTemplate;return e.set({withText:!0,icon:$r}),e.extendTemplate({attributes:{"aria-expanded":t.to("isOn",n=>String(n))}}),e.bind("label").to(this),e.bind("isOn").to(this,"isCollapsed",n=>!n),e.on("execute",()=>{this.isCollapsed=!this.isCollapsed}),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class JE extends E{constructor(e,{enabledProperties:t,styleButtonViews:n,styleGridAriaLabel:s}){super(e),this.stylesView=null,this.additionalPropertiesCollapsibleView=null,this.startIndexFieldView=null,this.reversedSwitchButtonView=null,this.focusTracker=new ue,this.keystrokes=new _e,this.focusables=new qe;const o=["ck","ck-list-properties"];this.children=this.createCollection(),this.focusCycler=new at({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),t.styles?(this.stylesView=this._createStylesView(n,s),this.children.add(this.stylesView)):o.push("ck-list-properties_without-styles"),(t.startIndex||t.reversed)&&(this._addNumberedListPropertyViews(t),o.push("ck-list-properties_with-numbered-properties")),this.setTemplate({tag:"div",attributes:{class:o},children:this.children})}render(){if(super.render(),this.stylesView){this.focusables.add(this.stylesView),this.focusTracker.add(this.stylesView.element),(this.startIndexFieldView||this.reversedSwitchButtonView)&&(this.focusables.add(this.children.last.buttonView),this.focusTracker.add(this.children.last.buttonView.element));for(const e of this.stylesView.children)this.stylesView.focusTracker.add(e.element);zs({keystrokeHandler:this.stylesView.keystrokes,focusTracker:this.stylesView.focusTracker,gridItems:this.stylesView.children,numberOfColumns:()=>x.window.getComputedStyle(this.stylesView.element).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}if(this.startIndexFieldView){this.focusables.add(this.startIndexFieldView),this.focusTracker.add(this.startIndexFieldView.element);const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}this.reversedSwitchButtonView&&(this.focusables.add(this.reversedSwitchButtonView),this.focusTracker.add(this.reversedSwitchButtonView.element)),this.keystrokes.listenTo(this.element)}focus(){this.focusCycler.focusFirst()}focusLast(){this.focusCycler.focusLast()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createStylesView(e,t){const n=new E(this.locale);return n.children=n.createCollection(),n.children.addMany(e),n.setTemplate({tag:"div",attributes:{"aria-label":t,class:["ck","ck-list-styles-list"]},children:n.children}),n.children.delegate("execute").to(this),n.focus=function(){this.children.first.focus()},n.focusTracker=new ue,n.keystrokes=new _e,n.render(),n.keystrokes.listenTo(n.element),n}_addNumberedListPropertyViews(e){const t=this.locale.t,n=[];e.startIndex&&(this.startIndexFieldView=this._createStartIndexField(),n.push(this.startIndexFieldView)),e.reversed&&(this.reversedSwitchButtonView=this._createReversedSwitchButton(),n.push(this.reversedSwitchButtonView)),e.styles?(this.additionalPropertiesCollapsibleView=new KE(this.locale,n),this.additionalPropertiesCollapsibleView.set({label:t("List properties"),isCollapsed:!0}),this.additionalPropertiesCollapsibleView.buttonView.bind("isEnabled").toMany(n,"isEnabled",(...s)=>s.some(o=>o)),this.additionalPropertiesCollapsibleView.buttonView.on("change:isEnabled",(s,o,r)=>{r||(this.additionalPropertiesCollapsibleView.isCollapsed=!0)}),this.children.add(this.additionalPropertiesCollapsibleView)):this.children.addMany(n)}_createStartIndexField(){const e=this.locale.t,t=new pe(this.locale,k_);return t.set({label:e("Start at"),class:"ck-numbered-list-properties__start-index"}),t.fieldView.set({min:0,step:1,value:1,inputMode:"numeric"}),t.fieldView.on("input",()=>{const n=t.fieldView.element,s=n.valueAsNumber;Number.isNaN(s)||(n.checkValidity()?this.fire("listStart",{startIndex:s}):t.errorText=e("Start index must be greater than 0."))}),t}_createReversedSwitchButton(){const e=this.locale.t,t=new Us(this.locale);return t.set({withText:!0,label:e("Reversed order"),class:"ck-numbered-list-properties__reversed-order"}),t.delegate("execute").to(this,"listReversed"),t}}const QE='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>',YE='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>',XE='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>',ZE='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>',eT='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>',tT='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>',nT='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>',iT='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>',sT='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oT extends b{static get pluginName(){return"ListPropertiesUI"}init(){const e=this.editor,t=e.locale.t,n=e.config.get("list.properties");n.styles&&e.ui.componentFactory.add("bulletedList",md({editor:e,parentCommandName:"bulletedList",buttonLabel:t("Bulleted List"),buttonIcon:qm,styleGridAriaLabel:t("Bulleted list styles toolbar"),styleDefinitions:[{label:t("Toggle the disc list style"),tooltip:t("Disc"),type:"disc",icon:QE},{label:t("Toggle the circle list style"),tooltip:t("Circle"),type:"circle",icon:YE},{label:t("Toggle the square list style"),tooltip:t("Square"),type:"square",icon:XE}]})),(n.styles||n.startIndex||n.reversed)&&e.ui.componentFactory.add("numberedList",md({editor:e,parentCommandName:"numberedList",buttonLabel:t("Numbered List"),buttonIcon:Um,styleGridAriaLabel:t("Numbered list styles toolbar"),styleDefinitions:[{label:t("Toggle the decimal list style"),tooltip:t("Decimal"),type:"decimal",icon:ZE},{label:t("Toggle the decimal with leading zero list style"),tooltip:t("Decimal with leading zero"),type:"decimal-leading-zero",icon:eT},{label:t("Toggle the lower–roman list style"),tooltip:t("Lower–roman"),type:"lower-roman",icon:tT},{label:t("Toggle the upper–roman list style"),tooltip:t("Upper-roman"),type:"upper-roman",icon:nT},{label:t("Toggle the lower–latin list style"),tooltip:t("Lower-latin"),type:"lower-latin",icon:iT},{label:t("Toggle the upper–latin list style"),tooltip:t("Upper-latin"),type:"upper-latin",icon:sT}]}))}}function md({editor:i,parentCommandName:e,buttonLabel:t,buttonIcon:n,styleGridAriaLabel:s,styleDefinitions:o}){const r=i.commands.get(e);return a=>{const l=de(a,Wn),c=l.buttonView;return l.bind("isEnabled").to(r),l.class="ck-list-styles-dropdown",c.on("execute",()=>{i.execute(e),i.editing.view.focus()}),c.set({label:t,icon:n,tooltip:!0,isToggleable:!0}),c.bind("isOn").to(r,"value",d=>!!d),l.once("change:isOpen",()=>{const d=aT({editor:i,dropdownView:l,parentCommandName:e,styleGridAriaLabel:s,styleDefinitions:o});l.panelView.children.add(d)}),l.on("execute",()=>{i.editing.view.focus()}),l}}function rT({editor:i,listStyleCommand:e,parentCommandName:t}){const n=i.locale,s=i.commands.get(t);return({label:o,type:r,icon:a,tooltip:l})=>{const c=new I(n);return c.set({label:o,icon:a,tooltip:l}),e.on("change:value",()=>{c.isOn=e.value===r}),c.on("execute",()=>{s.value?e.value!==r?i.execute("listStyle",{type:r}):i.execute("listStyle",{type:e.defaultType}):i.model.change(()=>{i.execute("listStyle",{type:r})})}),c}}function aT({editor:i,dropdownView:e,parentCommandName:t,styleDefinitions:n,styleGridAriaLabel:s}){const o=i.locale,r=i.config.get("list.properties");let a=null;if(t!="numberedList"&&(r.startIndex=!1,r.reversed=!1),r.styles){const c=i.commands.get("listStyle"),d=rT({editor:i,parentCommandName:t,listStyleCommand:c}),u=typeof c.isStyleTypeSupported=="function"?h=>c.isStyleTypeSupported(h.type):()=>!0;a=n.filter(u).map(d)}const l=new JE(o,{styleGridAriaLabel:s,enabledProperties:r,styleButtonViews:a});if(r.styles&&Ys(e,()=>l.stylesView.children.find(c=>c.isOn)),r.startIndex){const c=i.commands.get("listStart");l.startIndexFieldView.bind("isEnabled").to(c),l.startIndexFieldView.fieldView.bind("value").to(c),l.on("listStart",(d,u)=>i.execute("listStart",u))}if(r.reversed){const c=i.commands.get("listReversed");l.reversedSwitchButtonView.bind("isEnabled").to(c),l.reversedSwitchButtonView.bind("isOn").to(c,"value",d=>!!d),l.on("listReversed",()=>{const d=c.value;i.execute("listReversed",{reversed:!d})})}return l.delegate("execute").to(e),l}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pP extends b{static get requires(){return[jE,oT]}static get pluginName(){return"DocumentListProperties"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */$s("Ctrl+Enter");/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fd(i,e){const t=(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const r=s.attributeNewValue,a=o.writer,l=o.mapper.toViewElement(s.item),c=[...l.getChildren()].find(u=>u.getCustomProperty("media-content"));a.remove(c);const d=i.getMediaViewElement(a,r,e);a.insert(a.createPositionAt(l,0),d)};return n=>{n.on("attribute:url:media",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function lT(i,e,t){return e.setCustomProperty("media",!0,i),dn(i,e,{label:t})}function gd(i,e,t,n){return i.createContainerElement("figure",{class:"media"},[e.getMediaViewElement(i,t,n),i.createSlot()])}function pd(i){const e=i.getSelectedElement();return e&&e.is("element","media")?e:null}function Xm(i,e,t,n){i.change(s=>{const o=s.createElement("media",{url:e});i.insertObject(o,t,null,{setSelection:"on",findOptimalPosition:n?"auto":void 0})})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cT extends T{refresh(){const e=this.editor.model,t=e.document.selection,n=pd(t);this.value=n?n.getAttribute("url"):void 0,this.isEnabled=uT(t)||dT(t,e)}execute(e){const t=this.editor.model,n=t.document.selection,s=pd(n);s?t.change(o=>{o.setAttribute("url",e,s)}):Xm(t,e,n,!0)}}function dT(i,e){let n=Xs(i,e).start.parent;return n.isEmpty&&!e.schema.isLimit(n)&&(n=n.parent),e.schema.checkChild(n,"media")}function uT(i){const e=i.getSelectedElement();return!!e&&e.name==="media"}const hT='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mT="0 0 64 42";class fT{constructor(e,t){const n=t.providers,s=t.extraProviders||[],o=new Set(t.removeProviders),r=n.concat(s).filter(a=>{const l=a.name;return l?!o.has(l):(K("media-embed-no-provider-name",{provider:a}),!1)});this.locale=e,this.providerDefinitions=r}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,n){return this._getMedia(t).getViewElement(e,n)}_getMedia(e){if(!e)return new bd(this.locale);e=e.trim();for(const t of this.providerDefinitions){const n=t.html,s=q(t.url);for(const o of s){const r=this._getUrlMatches(e,o);if(r)return new bd(this.locale,e,r,n)}}return null}_getUrlMatches(e,t){let n=e.match(t);if(n)return n;let s=e.replace(/^https?:\/\//,"");return n=s.match(t),n||(s=s.replace(/^www\./,""),n=s.match(t),n)?n:null}}class bd{constructor(e,t,n,s){this.url=this._getValidUrl(t),this._locale=e,this._match=n,this._previewRenderer=s}getViewElement(e,t){const n={};let s;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(n["data-oembed-url"]=this.url),t.renderForEditingView&&(n.class="ck-media__wrapper");const o=this._getPreviewHtml(t);s=e.createRawElement("div",n,(r,a)=>{a.setContentOf(r,o)})}else this.url&&(n.url=this.url),s=e.createEmptyElement(t.elementName,n);return e.setCustomProperty("media-content",!0,s),s}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new Lt,t=this._locale.t;return e.content=hT,e.viewBox=mT,new ke({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[e]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url,"data-cke-tooltip-text":t("Open media in new tab")},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]}]}]}).render().outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Os extends b{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)(?:&t=(\d+))?/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)(?:\?t=(\d+))?/,/^youtube\.com\/embed\/([\w-]+)(?:\?start=(\d+))?/,/^youtu\.be\/([\w-]+)(?:\?t=(\d+))?/],html:t=>{const n=t[1],s=t[2];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${n}${s?`?start=${s}`:""}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new fT(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,n=e.t,s=e.conversion,o=e.config.get("mediaEmbed.previewsInData"),r=e.config.get("mediaEmbed.elementName"),a=this.registry;e.commands.add("mediaEmbed",new cT(e)),t.register("media",{inheritAllFrom:"$blockObject",allowAttributes:["url"]}),s.for("dataDowncast").elementToStructure({model:"media",view:(l,{writer:c})=>{const d=l.getAttribute("url");return gd(c,a,d,{elementName:r,renderMediaPreview:!!d&&o})}}),s.for("dataDowncast").add(fd(a,{elementName:r,renderMediaPreview:o})),s.for("editingDowncast").elementToStructure({model:"media",view:(l,{writer:c})=>{const d=l.getAttribute("url"),u=gd(c,a,d,{elementName:r,renderForEditingView:!0});return lT(u,c,n("media widget"))}}),s.for("editingDowncast").add(fd(a,{elementName:r,renderForEditingView:!0})),s.for("upcast").elementToElement({view:l=>["oembed",r].includes(l.name)&&l.getAttribute("url")?{name:!0}:null,model:(l,{writer:c})=>{const d=l.getAttribute("url");return a.hasMedia(d)?c.createElement("media",{url:d}):null}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(l,{writer:c})=>{const d=l.getAttribute("data-oembed-url");return a.hasMedia(d)?c.createElement("media",{url:d}):null}}).add(l=>{const c=(d,u,h)=>{if(!h.consumable.consume(u.viewItem,{name:!0,classes:"media"}))return;const{modelRange:m,modelCursor:f}=h.convertChildren(u.viewItem,u.modelCursor);u.modelRange=m,u.modelCursor=f,Q(m.getItems())||h.consumable.revert(u.viewItem,{name:!0,classes:"media"})};l.on("element:figure",c)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const gT=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class pT extends b{static get requires(){return[ma,_t,fa]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",()=>{const o=t.selection.getFirstRange(),r=ae.fromPosition(o.start);r.stickiness="toPrevious";const a=ae.fromPosition(o.end);a.stickiness="toNext",t.once("change:data",()=>{this._embedMediaBetweenPositions(r,a),r.detach(),a.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(x.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(e,t){const n=this.editor,s=n.plugins.get(Os).registry,o=new $e(e,t),r=o.getWalker({ignoreElementEnd:!0});let a="";for(const c of r)c.item.is("$textProxy")&&(a+=c.item.data);if(a=a.trim(),!a.match(gT)){o.detach();return}if(!s.hasMedia(a)){o.detach();return}if(!n.commands.get("mediaEmbed").isEnabled){o.detach();return}this._positionToInsert=ae.fromPosition(e),this._timeoutId=x.window.setTimeout(()=>{n.model.change(c=>{this._timeoutId=null,c.remove(o),o.detach();let d=null;this._positionToInsert.root.rootName!=="$graveyard"&&(d=this._positionToInsert),Xm(n.model,a,d,!1),this._positionToInsert.detach(),this._positionToInsert=null}),n.plugins.get(_t).requestUndoOnBackspace()},100)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bT extends E{constructor(e,t){super(t);const n=t.t;this.focusTracker=new ue,this.keystrokes=new _e,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(n("Save"),R.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",s=>!!s),this.cancelButtonView=this._createButton(n("Cancel"),R.cancel,"ck-button-cancel","cancel"),this._focusables=new qe,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),Ds({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach(n=>{this._focusables.add(n),this.focusTracker.add(n.element)}),this.keystrokes.listenTo(this.element);const t=n=>n.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new pe(this.locale,nt),n=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,n.on("input",()=>{t.infoText=n.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=n.element.value.trim()}),t}_createButton(e,t,n,s){const o=new I(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:n}}),s&&o.delegate("execute").to(this,s),o}}const wT='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _T extends b{static get requires(){return[Os]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed");e.ui.componentFactory.add("mediaEmbed",n=>{const s=de(n);return this._setUpDropdown(s,t),s})}_setUpDropdown(e,t){const n=this.editor,s=n.t,o=e.buttonView,r=n.plugins.get(Os).registry;e.once("change:isOpen",()=>{const a=new(Zd(bT))(vT(n.t,r),n.locale);e.panelView.children.add(a),o.on("open",()=>{a.disableCssTransitions(),a.url=t.value||"",a.urlInputView.fieldView.select(),a.enableCssTransitions()},{priority:"low"}),e.on("submit",()=>{a.isValid()&&(n.execute("mediaEmbed",a.url),n.editing.view.focus())}),e.on("change:isOpen",()=>a.resetFormStatus()),e.on("cancel",()=>{n.editing.view.focus()}),a.delegate("submit","cancel").to(e),a.urlInputView.fieldView.bind("value").to(t,"value"),a.urlInputView.bind("isEnabled").to(t,"isEnabled")}),e.bind("isEnabled").to(t),o.set({label:s("Insert media"),icon:wT,tooltip:!0})}}function vT(i,e){return[t=>{if(!t.url.length)return i("The URL must not be empty.")},t=>{if(!e.hasMedia(t.url))return i("This media URL is not supported.")}]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bP extends b{static get requires(){return[Os,_T,pT,zt]}static get pluginName(){return"MediaEmbed"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yT extends T{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"mention")}execute(e){const t=this.editor.model,s=t.document.selection,o=typeof e.mention=="string"?{id:e.mention}:e.mention,r=o.id,a=e.range||s.getFirstRange();if(!t.canEditAt(a))return;const l=e.text||r,c=Zm({_text:l,id:r},o);if(e.marker.length!=1)throw new g("mentioncommand-incorrect-marker",this);if(r.charAt(0)!=e.marker)throw new g("mentioncommand-incorrect-id",this);t.change(d=>{const u=Mt(s.getAttributes()),h=new Map(u.entries());h.set("mention",c),t.insertContent(d.createText(l,h),a),t.insertContent(d.createText(" ",u),a.start.getShiftedBy(l.length))})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CT extends b{static get pluginName(){return"MentionEditing"}init(){const e=this.editor,t=e.model,n=t.document;t.schema.extend("$text",{allowAttributes:"mention"}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",key:"data-mention",classes:"mention"},model:{key:"mention",value:s=>ef(s)}}),e.conversion.for("downcast").attributeToElement({model:"mention",view:AT}),e.conversion.for("downcast").add(kT),n.registerPostFixer(s=>ST(s,n,t.schema)),n.registerPostFixer(s=>xT(s,n)),n.registerPostFixer(s=>ET(s,n)),e.commands.add("mention",new yT(e))}}function Zm(i,e){return Object.assign({uid:Se()},i,e||{})}function ef(i,e){const t=i.getAttribute("data-mention"),n=i.getChild(0);if(!n)return;const s={id:t,_text:n.data};return Zm(s,e)}function kT(i){i.on("attribute:mention",(e,t,n)=>{const s=t.attributeNewValue;if(!t.item.is("$textProxy")||!s)return;const o=t.range.start;(o.textNode||o.nodeAfter).data!=s._text&&n.consumable.consume(t.item,e.name)},{priority:"highest"})}function AT(i,{writer:e}){if(!i)return;const t={class:"mention","data-mention":i.id},n={id:i.uid,priority:20};return e.createAttributeElement("span",t,n)}function ET(i,e){const t=e.selection,n=t.focus;return t.isCollapsed&&t.hasAttribute("mention")&&TT(n)?(i.removeSelectionAttribute("mention"),!0):!1}function TT(i){const e=i.isAtStart;return i.nodeBefore&&i.nodeBefore.is("$text")||e}function ST(i,e,t){const n=e.differ.getChanges();let s=!1;for(const o of n){if(o.type=="attribute")continue;const r=o.position;if(o.name=="$text"){const a=r.textNode&&r.textNode.nextSibling;s=Kt(r.textNode,i)||s,s=Kt(a,i)||s,s=Kt(r.nodeBefore,i)||s,s=Kt(r.nodeAfter,i)||s}if(o.name!="$text"&&o.type=="insert"){const a=r.nodeAfter;for(const l of i.createRangeIn(a).getItems())s=Kt(l,i)||s}if(o.type=="insert"&&t.isInline(o.name)){const a=r.nodeAfter&&r.nodeAfter.nextSibling;s=Kt(r.nodeBefore,i)||s,s=Kt(a,i)||s}}return s}function xT(i,e){const t=e.differ.getChanges();let n=!1;for(const s of t)if(s.type==="attribute"&&s.attributeKey!="mention"){const o=s.range.start.nodeBefore,r=s.range.end.nodeAfter;for(const a of[o,r])tf(a)&&a.getAttribute(s.attributeKey)!=s.attributeNewValue&&(i.setAttribute(s.attributeKey,s.attributeNewValue,a),n=!0)}return n}function tf(i){if(!i||!(i.is("$text")||i.is("$textProxy"))||!i.hasAttribute("mention"))return!1;const e=i.data,n=i.getAttribute("mention")._text;return e!=n}function Kt(i,e){return tf(i)?(e.removeAttribute("mention",i),!0):!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PT extends Dh{constructor(e){super(e),this.extendTemplate({attributes:{class:["ck-mentions"],tabindex:"-1"}})}selectFirst(){this.select(0)}selectNext(){const e=this.selected,t=this.items.getIndex(e);this.select(t+1)}selectPrevious(){const e=this.selected,t=this.items.getIndex(e);this.select(t-1)}select(e){let t=0;e>0&&e<this.items.length?t=e:e<0&&(t=this.items.length-1);const n=this.items.get(t);this.selected!==n&&(this.selected&&this.selected.removeHighlight(),n.highlight(),this.selected=n,this._isItemVisibleInScrolledArea(n)||(this.element.scrollTop=n.element.offsetTop))}executeSelected(){this.selected.fire("execute")}_isItemVisibleInScrolledArea(e){return new F(this.element).contains(new F(e.element))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IT extends E{constructor(e,t){super(e),this.template=void 0,this.domElement=t,this.domElement.classList.add("ck-button"),this.set("isOn",!1),this.on("change:isOn",(n,s,o)=>{o?(this.domElement.classList.add("ck-on"),this.domElement.classList.remove("ck-off")):(this.domElement.classList.add("ck-off"),this.domElement.classList.remove("ck-on"))}),this.listenTo(this.domElement,"click",()=>{this.fire("execute")})}render(){super.render(),this.element=this.domElement}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class RT extends oa{highlight(){const e=this.children.first;e.isOn=!0}removeHighlight(){const e=this.children.first;e.isOn=!1}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const as=3,VT=[O.arrowup,O.arrowdown,O.esc],BT=[O.enter,O.tab];class MT extends b{static get pluginName(){return"MentionUI"}static get requires(){return[Nt]}constructor(e){super(e),this._items=new ge,this._mentionsView=this._createMentionView(),this._mentionsConfigurations=new Map,this._requestFeedDebounced=Vt(this._requestFeed,100),e.config.define("mention",{feeds:[]})}init(){const e=this.editor,t=e.config.get("mention.commitKeys")||BT,n=VT.concat(t);this._balloon=e.plugins.get(Nt),e.editing.view.document.on("keydown",(r,a)=>{o(a.keyCode)&&this._isUIVisible&&(a.preventDefault(),r.stop(),a.keyCode==O.arrowdown&&this._mentionsView.selectNext(),a.keyCode==O.arrowup&&this._mentionsView.selectPrevious(),t.includes(a.keyCode)&&this._mentionsView.executeSelected(),a.keyCode==O.esc&&this._hideUIAndRemoveMarker())},{priority:"highest"}),Ii({emitter:this._mentionsView,activator:()=>this._isUIVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUIAndRemoveMarker()});const s=e.config.get("mention.feeds");for(const r of s){const{feed:a,marker:l,dropdownLimit:c}=r;if(!HT(l))throw new g("mentionconfig-incorrect-marker",null,{marker:l});const d=typeof a=="function"?a.bind(this.editor):LT(a),u=r.itemRenderer,h={marker:l,feedCallback:d,itemRenderer:u,dropdownLimit:c};this._mentionsConfigurations.set(l,h)}this._setupTextWatcher(s),this.listenTo(e,"change:isReadOnly",()=>{this._hideUIAndRemoveMarker()}),this.on("requestFeed:response",(r,a)=>this._handleFeedResponse(a)),this.on("requestFeed:error",()=>this._hideUIAndRemoveMarker());function o(r){return n.includes(r)}}destroy(){super.destroy(),this._mentionsView.destroy()}get _isUIVisible(){return this._balloon.visibleView===this._mentionsView}_createMentionView(){const e=this.editor.locale,t=new PT(e);return t.items.bindTo(this._items).using(n=>{const{item:s,marker:o}=n,{dropdownLimit:r}=this._mentionsConfigurations.get(o),a=r||this.editor.config.get("mention.dropdownLimit")||10;if(t.items.length>=a)return null;const l=new RT(e),c=this._renderItem(s,o);return c.delegate("execute").to(l),l.children.add(c),l.item=s,l.marker=o,l.on("execute",()=>{t.fire("execute",{item:s,marker:o})}),l}),t.on("execute",(n,s)=>{const o=this.editor,r=o.model,a=s.item,l=s.marker,c=o.model.markers.get("mention"),d=r.createPositionAt(r.document.selection.focus),u=r.createPositionAt(c.getStart()),h=r.createRange(u,d);this._hideUIAndRemoveMarker(),o.execute("mention",{mention:a,text:a.text,marker:l,range:h}),o.editing.view.focus()}),t}_getItemRenderer(e){const{itemRenderer:t}=this._mentionsConfigurations.get(e);return t}_requestFeed(e,t){this._lastRequested=t;const{feedCallback:n}=this._mentionsConfigurations.get(e),s=n(t);if(!(s instanceof Promise)){this.fire("requestFeed:response",{feed:s,marker:e,feedText:t});return}s.then(r=>{this._lastRequested==t?this.fire("requestFeed:response",{feed:r,marker:e,feedText:t}):this.fire("requestFeed:discarded",{feed:r,marker:e,feedText:t})}).catch(r=>{this.fire("requestFeed:error",{error:r}),K("mention-feed-callback-error",{marker:e})})}_setupTextWatcher(e){const t=this.editor,n=e.map(r=>({...r,pattern:sf(r.marker,r.minimumCharacters||0)})),s=new em(t.model,NT(n));s.on("matched",(r,a)=>{const l=nf(n,a.text),d=t.model.document.selection.focus,u=t.model.createPositionAt(d.parent,l.position);if(DT(d)||zT(u)){this._hideUIAndRemoveMarker();return}const h=FT(l,a.text),m=l.marker.length+h.length,f=d.getShiftedBy(-m),p=d.getShiftedBy(-h.length),w=t.model.createRange(f,p);if(Ho(t)){const v=t.model.markers.get("mention");t.model.change(C=>{C.updateMarker(v,{range:w})})}else t.model.change(v=>{v.addMarker("mention",{range:w,usingOperation:!1,affectsData:!1})});this._requestFeedDebounced(l.marker,h)}),s.on("unmatched",()=>{this._hideUIAndRemoveMarker()});const o=t.commands.get("mention");return s.bind("isEnabled").to(o),s}_handleFeedResponse(e){const{feed:t,marker:n}=e;if(!Ho(this.editor))return;this._items.clear();for(const o of t){const r=typeof o!="object"?{id:o,text:o}:o;this._items.add({item:r,marker:n})}const s=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(s):this._hideUIAndRemoveMarker()}_showOrUpdateUI(e){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(e,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(e,this._mentionsView.position),singleViewMode:!0}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst()}_hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),Ho(this.editor)&&this.editor.model.change(e=>e.removeMarker("mention")),this._mentionsView.position=void 0}_renderItem(e,t){const n=this.editor;let s,o=e.id;const r=this._getItemRenderer(t);if(r){const a=r(e);typeof a!="string"?s=new IT(n.locale,a):o=a}if(!s){const a=new I(n.locale);a.label=o,a.withText=!0,s=a}return s}_getBalloonPanelPositionData(e,t){const n=this.editor,s=n.editing,o=s.view.domConverter,r=s.mapper,a=n.locale.uiLanguageDirection;return{target:()=>{let l=e.getRange();l.start.root.rootName=="$graveyard"&&(l=n.model.document.selection.getFirstRange());const c=r.toViewRange(l);return F.getDomRangeRects(o.viewRangeToDom(c)).pop()},limiter:()=>{const l=this.editor.editing.view,d=l.document.selection.editableElement;return d?l.domConverter.mapViewToDom(d.root):null},positions:OT(t,a)}}}function OT(i,e){const t={caret_se:n=>({top:n.bottom+as,left:n.right,name:"caret_se",config:{withArrow:!1}}),caret_ne:(n,s)=>({top:n.top-s.height-as,left:n.right,name:"caret_ne",config:{withArrow:!1}}),caret_sw:(n,s)=>({top:n.bottom+as,left:n.right-s.width,name:"caret_sw",config:{withArrow:!1}}),caret_nw:(n,s)=>({top:n.top-s.height-as,left:n.right-s.width,name:"caret_nw",config:{withArrow:!1}})};return Object.prototype.hasOwnProperty.call(t,i)?[t[i]]:e!=="rtl"?[t.caret_se,t.caret_sw,t.caret_ne,t.caret_nw]:[t.caret_sw,t.caret_se,t.caret_nw,t.caret_ne]}function nf(i,e){let t;for(const n of i){const s=e.lastIndexOf(n.marker);s>0&&!e.substring(s-1).match(n.pattern)||(!t||s>=t.position)&&(t={marker:n.marker,position:s,minimumCharacters:n.minimumCharacters,pattern:n.pattern})}return t}function sf(i,e){const t=e==0?"*":`{${e},}`,o=`(?:^|[ ${V.features.isRegExpUnicodePropertySupported?`\\p{Ps}\\p{Pi}"'`:`\\(\\[{"'`}])([${i}])(.${t})$`;return new RegExp(o,"u")}function NT(i){return t=>{const n=nf(i,t);if(!n)return!1;let s=0;n.position!==0&&(s=n.position-1);const o=t.substring(s);return n.pattern.test(o)}}function FT(i,e){let t=0;i.position!==0&&(t=i.position-1);const n=sf(i.marker,0);return e.substring(t).match(n)[2]}function LT(i){return e=>i.filter(n=>(typeof n=="string"?n:String(n.id)).toLowerCase().includes(e.toLowerCase()))}function DT(i){const e=i.textNode&&i.textNode.hasAttribute("mention"),t=i.nodeBefore;return e||t&&t.is("$text")&&t.hasAttribute("mention")}function zT(i){const e=i.nodeAfter;return e&&e.is("$text")&&e.hasAttribute("mention")}function HT(i){return i&&i.length==1}function Ho(i){return i.model.markers.has("mention")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wP extends b{toMentionAttribute(e,t){return ef(e,t)}static get pluginName(){return"Mention"}static get requires(){return[CT,MT]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WT extends T{refresh(){const e=this.editor.model,t=e.schema,n=e.document.selection;this.isEnabled=$T(n,t,e)}execute(){const e=this.editor.model;e.change(t=>{const n=t.createElement("pageBreak");e.insertObject(n,null,null,{setSelection:"after"})})}}function $T(i,e,t){const n=UT(i,t);return e.checkChild(n,"pageBreak")}function UT(i,e){const n=Xs(i,e).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qT extends b{static get pluginName(){return"PageBreakEditing"}init(){const e=this.editor,t=e.model.schema,n=e.t,s=e.conversion;t.register("pageBreak",{inheritAllFrom:"$blockObject"}),s.for("dataDowncast").elementToStructure({model:"pageBreak",view:(o,{writer:r})=>r.createContainerElement("div",{class:"page-break",style:"page-break-after: always"},r.createContainerElement("span",{style:"display: none"}))}),s.for("editingDowncast").elementToStructure({model:"pageBreak",view:(o,{writer:r})=>{const a=n("Page break"),l=r.createContainerElement("div"),c=r.createRawElement("span",{class:"page-break__label"},function(d){d.innerText=n("Page break")});return r.addClass("page-break",l),r.insert(r.createPositionAt(l,0),c),jT(l,r,a)}}),s.for("upcast").elementToElement({view:o=>{const r=o.getStyle("page-break-before")=="always",a=o.getStyle("page-break-after")=="always";if(!r&&!a)return null;if(o.childCount==1){const l=o.getChild(0);if(!l.is("element","span")||l.getStyle("display")!="none")return null}else if(o.childCount>1)return null;return{name:!0}},model:"pageBreak",converterPriority:"high"}),e.commands.add("pageBreak",new WT(e))}}function jT(i,e,t){return e.setCustomProperty("pageBreak",!0,i),dn(i,e,{label:t})}const GT='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.598.687h1.5v5h-1.5zm14.5 0h1.5v5h-1.5z"/><path d="M19.598 4.187v1.5h-16v-1.5zm-16 14.569h1.5v-5h-1.5zm14.5 0h1.5v-5h-1.5z"/><path d="M19.598 15.256v-1.5h-16v1.5zM5.081 9h6v2h-6zm8 0h6v2h-6zm-9.483 1L0 12.5v-5z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class KT extends b{static get pluginName(){return"PageBreakUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("pageBreak",n=>{const s=e.commands.get("pageBreak"),o=new I(n);return o.set({label:t("Page break"),icon:GT,tooltip:!0}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("pageBreak"),e.editing.view.focus()}),o})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _P extends b{static get requires(){return[qT,KT,zt]}static get pluginName(){return"PageBreak"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function JT(i,e){if(!i.childCount)return;const t=new Ze(i.document),n=YT(i,t);if(!n.length)return;let s=null,o=1;n.forEach((r,a)=>{const l=o2(n[a-1],r),c=l?null:n[a-1],d=a2(c,r);if(l&&(s=null,o=1),!s||d!==0){const h=XT(r,e);if(!s)s=wd(h,r.element,t);else if(r.indent>o){const m=s.getChild(s.childCount-1),f=m.getChild(m.childCount-1);s=wd(h,f,t),o+=1}else if(r.indent<o){const m=o-r.indent;s=l2(s,m),o=r.indent}r.indent<=o&&(s.is("element",h.type)||(s=t.rename(h.type,s)))}const u=n2(r.element,t);t.appendChild(u,s)})}function QT(i,e){for(const t of e.createRangeIn(i)){const n=t.item;if(n.is("element","li")){const s=n.getChild(0);s&&s.is("element","p")&&e.unwrapElement(s)}}}function YT(i,e){const t=e.createRangeIn(i),n=new Oe({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),s=[];for(const o of t)if(o.type==="elementStart"&&n.match(o.item)){const r=i2(o.item);s.push({element:o.item,id:r.id,order:r.order,indent:r.indent})}return s}function XT(i,e){const t=new RegExp(`@list l${i.id}:level${i.indent}\\s*({[^}]*)`,"gi"),n=/mso-level-number-format:([^;]{0,100});/gi,s=/mso-level-start-at:\s{0,100}([0-9]{0,10})\s{0,100};/gi,o=t.exec(e);let r="decimal",a="ol",l=null;if(o&&o[1]){const c=n.exec(o[1]);if(c&&c[1]&&(r=c[1].trim(),a=r!=="bullet"&&r!=="image"?"ol":"ul"),r==="bullet"){const d=ZT(i.element);d&&(r=d)}else{const d=s.exec(o[1]);d&&d[1]&&(l=parseInt(d[1]))}}return{type:a,startIndex:l,style:t2(r)}}function ZT(i){const e=e2(i);if(!e)return null;const t=e._data;return t==="o"?"circle":t==="·"?"disc":t==="§"?"square":null}function e2(i){if(i.getChild(0).is("$text"))return null;for(const e of i.getChildren()){if(!e.is("element","span"))continue;const t=e.getChild(0);if(t)return t.is("$text")?t:t.getChild(0)}/* istanbul ignore next -- @preserve */return null}function t2(i){if(i.startsWith("arabic-leading-zero"))return"decimal-leading-zero";switch(i){case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return i;default:return null}}function wd(i,e,t){const n=e.parent,s=t.createElement(i.type),o=n.getChildIndex(e)+1;return t.insertChild(o,s,n),i.style&&t.setStyle("list-style-type",i.style,s),i.startIndex&&i.startIndex>1&&t.setAttribute("start",i.startIndex,s),s}function n2(i,e){return s2(i,e),e.removeStyle("text-indent",i),e.rename("li",i)}function i2(i){const e={},t=i.getStyle("mso-list");if(t){const n=t.match(/(^|\s{1,100})l(\d+)/i),s=t.match(/\s{0,100}lfo(\d+)/i),o=t.match(/\s{0,100}level(\d+)/i);n&&s&&o&&(e.id=n[2],e.order=s[1],e.indent=parseInt(o[1]))}return e}function s2(i,e){const t=new Oe({name:"span",styles:{"mso-list":"Ignore"}}),n=e.createRangeIn(i);for(const s of n)s.type==="elementStart"&&t.match(s.item)&&e.remove(s.item)}function o2(i,e){if(!i)return!0;if(i.id!==e.id)return e.indent-i.indent!==1;const t=e.element.previousSibling;return t?!r2(t):!0}function r2(i){return i.is("element","ol")||i.is("element","ul")}function a2(i,e){return i?e.indent-i.indent:e.indent-1}function l2(i,e){const t=i.getAncestors({parentFirst:!0});let n=null,s=0;for(const o of t)if((o.is("element","ul")||o.is("element","ol"))&&s++,s===e){n=o;break}return n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function c2(i,e){if(!i.childCount)return;const t=new Ze(i.document),n=u2(i,t);h2(n,i,t),f2(n,i,t),m2(i,t);const s=g2(i,t);s.length&&b2(s,p2(e),t)}function d2(i){return btoa(i.match(/\w{2}/g).map(e=>String.fromCharCode(parseInt(e,16))).join(""))}function u2(i,e){const t=e.createRangeIn(i),n=new Oe({name:/v:(.+)/}),s=[];for(const o of t){if(o.type!="elementStart")continue;const r=o.item,a=r.previousSibling,l=a&&a.is("element")?a.name:null;n.match(r)&&r.getAttribute("o:gfxdata")&&l!=="v:shapetype"&&s.push(o.item.getAttribute("id"))}return s}function h2(i,e,t){const n=t.createRangeIn(e),s=new Oe({name:"img"}),o=[];for(const r of n)if(r.item.is("element")&&s.match(r.item)){const a=r.item,l=a.getAttribute("v:shapes")?a.getAttribute("v:shapes").split(" "):[];l.length&&l.every(c=>i.indexOf(c)>-1)?o.push(a):a.getAttribute("src")||o.push(a)}for(const r of o)t.remove(r)}function m2(i,e){const t=e.createRangeIn(i),n=new Oe({name:/v:(.+)/}),s=[];for(const o of t)o.type=="elementStart"&&n.match(o.item)&&s.push(o.item);for(const o of s)e.remove(o)}function f2(i,e,t){const n=t.createRangeIn(e),s=[];for(const a of n)if(a.type=="elementStart"&&a.item.is("element","v:shape")){const l=a.item.getAttribute("id");if(i.includes(l))continue;o(a.item.parent.getChildren(),l)||s.push(a.item)}for(const a of s){const l={src:r(a)};a.hasAttribute("alt")&&(l.alt=a.getAttribute("alt"));const c=t.createElement("img",l);t.insertChild(a.index+1,c,a.parent)}function o(a,l){for(const c of a){/* istanbul ignore else -- @preserve */if(c.is("element")&&(c.name=="img"&&c.getAttribute("v:shapes")==l||o(c.getChildren(),l)))return!0}return!1}function r(a){for(const l of a.getChildren()){/* istanbul ignore else -- @preserve */if(l.is("element")&&l.getAttribute("src"))return l.getAttribute("src")}}}function g2(i,e){const t=e.createRangeIn(i),n=new Oe({name:"img"}),s=[];for(const o of t)o.item.is("element")&&n.match(o.item)&&o.item.getAttribute("src").startsWith("file://")&&s.push(o.item);return s}function p2(i){if(!i)return[];const e=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,t=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),n=i.match(t),s=[];if(n)for(const o of n){let r=!1;o.includes("\\pngblip")?r="image/png":o.includes("\\jpegblip")&&(r="image/jpeg"),r&&s.push({hex:o.replace(e,"").replace(/[^\da-fA-F]/g,""),type:r})}return s}function b2(i,e,t){if(i.length===e.length)for(let n=0;n<i.length;n++){const s=`data:${e[n].type};base64,${d2(e[n].hex)}`;t.setAttribute("src",s,i[n])}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function w2(i){const e=new Ze(i.document);for(const t of i.getChildren()){if(!t.is("element"))continue;if(t.is("element","table")){e.setAttribute("align","left",t);continue}const n=t.getAttribute("align"),s=t.getChild(0);t.name!=="div"||!n||!s||s.is("element","table")&&e.setAttribute("align",n==="center"?"none":n,s)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const _2=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,v2=/xmlns:o="urn:schemas-microsoft-com/i;class y2{constructor(e){this.document=e}isActive(e){return _2.test(e)||v2.test(e)}execute(e){const{body:t,stylesString:n}=e._parsedData;JT(t,n),c2(t,e.dataTransfer.getData("text/rtf")),w2(t),e.content=t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function C2(i,e){for(const t of i.getChildren())if(t.is("element","b")&&t.getStyle("font-weight")==="normal"){const n=i.getChildIndex(t);e.remove(t),e.insertChild(n,t.getChildren(),i)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function k2(i,e){const t=new Gs(e.document.stylesProcessor),n=new Js(t,{renderingMode:"data"}),s=n.blockElements,o=n.inlineObjectElements,r=[];for(const a of e.createRangeIn(i)){const l=a.item;if(l.is("element","br")){const c=_d(l,"forward",e,{blockElements:s,inlineObjectElements:o}),d=_d(l,"backward",e,{blockElements:s,inlineObjectElements:o}),u=vd(c,s);(vd(d,s)||u)&&r.push(l)}}for(const a of r)a.hasClass("Apple-interchange-newline")?e.remove(a):e.replace(a,e.createElement("p"))}function _d(i,e,t,{blockElements:n,inlineObjectElements:s}){let o=t.createPositionAt(i,e=="forward"?"after":"before");return o=o.getLastMatchingPosition(({item:r})=>r.is("element")&&!n.includes(r.name)&&!s.includes(r.name),{direction:e}),e=="forward"?o.nodeAfter:o.nodeBefore}function vd(i,e){return!!i&&i.is("element")&&e.includes(i.name)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const A2=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class E2{constructor(e){this.document=e}isActive(e){return A2.test(e)}execute(e){const t=new Ze(this.document),{body:n}=e._parsedData;C2(n,t),QT(n,t),k2(n,t),e.content=n}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function T2(i,e){for(const t of i.getChildren())t.is("element","table")&&t.hasAttribute("xmlns")&&e.removeAttribute("xmlns",t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function S2(i,e){for(const t of i.getChildren())if(t.is("element","google-sheets-html-origin")){const n=i.getChildIndex(t);e.remove(t),e.insertChild(n,t.getChildren(),i)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function x2(i,e){for(const t of i.getChildren())t.is("element","table")&&t.getStyle("width")==="0px"&&e.removeStyle("width",t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function P2(i,e){for(const t of Array.from(i.getChildren()))t.is("element","style")&&e.remove(t)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const I2=/<google-sheets-html-origin/i;class R2{constructor(e){this.document=e}isActive(e){return I2.test(e)}execute(e){const t=new Ze(this.document),{body:n}=e._parsedData;S2(n,t),T2(n,t),x2(n,t),P2(n,t),e.content=n}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function V2(i){return yd(yd(i)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/(<span\s+style=['"]letter-spacing:[^'"]+?['"]>)[\r\n]+(<\/span>)/g,"$1 $2").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}function B2(i){i.querySelectorAll("span[style*=spacerun]").forEach(e=>{const t=e,n=t.innerText.length||0;t.innerText=Array(n+1).join("  ").substr(0,n)})}function yd(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>t.length===1?" ":Array(t.length+1).join("  ").substr(0,t.length))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function M2(i,e){const t=new DOMParser;i=i.replace(/<!--\[if gte vml 1]>/g,"");const n=V2(F2(i)),s=t.parseFromString(n,"text/html");B2(s);const o=s.body.innerHTML,r=O2(s,e),a=N2(s);return{body:r,bodyString:o,styles:a.styles,stylesString:a.stylesString}}function O2(i,e){const t=new Gs(e),n=new Js(t,{renderingMode:"data"}),s=i.createDocumentFragment(),o=i.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);return n.domToView(s,{skipComments:!0})}function N2(i){const e=[],t=[],n=Array.from(i.getElementsByTagName("style"));for(const s of n)s.sheet&&s.sheet.cssRules&&s.sheet.cssRules.length&&(e.push(s.sheet),t.push(s.innerHTML));return{styles:e,stylesString:t.join(" ")}}function F2(i){const e="</body>",t="</html>",n=i.indexOf(e);if(n<0)return i;const s=i.indexOf(t,n+e.length);return i.substring(0,n+e.length)+(s>=0?i.substring(s):"")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vP extends b{static get pluginName(){return"PasteFromOffice"}static get requires(){return[vt]}init(){const e=this.editor,t=e.plugins.get("ClipboardPipeline"),n=e.editing.view.document,s=[];s.push(new y2(n)),s.push(new E2(n)),s.push(new R2(n)),t.on("inputTransformation",(o,r)=>{if(r._isTransformedWithPasteFromOffice||e.model.document.selection.getFirstPosition().parent.is("element","codeBlock"))return;const l=r.dataTransfer.getData("text/html"),c=s.find(d=>d.isActive(l));c&&(r._parsedData||(r._parsedData=M2(l,n.stylesProcessor)),c.execute(r),r._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function L2(i){const e=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"input",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"textarea",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],t=e.map(o=>o.name).join("|"),n=i.replace(new RegExp(`</?(${t})( .*?)?>`,"g"),`
$&
`).replace(/<br[^>]*>/g,`$&
`).split(`
`);let s=0;return n.filter(o=>o.length).map(o=>D2(o,e)?Wo(o,s++):z2(o,e)?Wo(o,--s):Wo(o,s)).join(`
`)}function D2(i,e){return e.some(t=>!(t.isVoid||!new RegExp(`<${t.name}( .*?)?>`).test(i)))}function z2(i,e){return e.some(t=>new RegExp(`</${t.name}>`).test(i))}function Wo(i,e,t="    "){return`${t.repeat(Math.max(0,e))}${i}`}const H2='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Cd="SourceEditingMode";class yP extends b{static get pluginName(){return"SourceEditing"}static get requires(){return[Ps]}constructor(e){super(e),this.set("isSourceEditingMode",!1),this._elementReplacer=new du,this._replacedRoots=new Map,this._dataFromRoots=new Map}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("sourceEditing",n=>{const s=new I(n);return s.set({label:t("Source"),icon:H2,tooltip:!0,withText:!0,class:"ck-source-editing-button"}),s.bind("isOn").to(this,"isSourceEditingMode"),s.bind("isEnabled").to(this,"isEnabled",e,"isReadOnly",e.plugins.get(Ps),"hasAny",(o,r,a)=>!(!o||r||a)),this.listenTo(s,"execute",()=>{this.isSourceEditingMode=!this.isSourceEditingMode}),s}),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",(n,s,o)=>{o?(this._showSourceEditing(),this._disableCommands()):(this._hideSourceEditing(),this._enableCommands())}),this.on("change:isEnabled",(n,s,o)=>this._handleReadOnlyMode(!o)),this.listenTo(e,"change:isReadOnly",(n,s,o)=>this._handleReadOnlyMode(o))),e.data.on("get",()=>{this.isSourceEditingMode&&this.updateEditorData()},{priority:"high"})}afterInit(){const e=this.editor;["RealTimeCollaborativeEditing","CommentsEditing","TrackChangesEditing","RevisionHistory"].some(n=>e.plugins.has(n))&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}updateEditorData(){const e=this.editor,t={};for(const[n,s]of this._replacedRoots){const o=this._dataFromRoots.get(n),r=s.dataset.value;o!==r&&(t[n]=r,this._dataFromRoots.set(n,r))}Object.keys(t).length&&e.data.set(t,{batchType:{isUndoable:!0}})}_showSourceEditing(){const e=this.editor,t=e.editing.view,n=e.model;n.change(s=>{s.setSelection(null),s.removeSelectionAttribute(n.document.selection.getAttributeKeys())});for(const[s,o]of t.domRoots){const r=W2(e.data.get({rootName:s})),a=xt(o.ownerDocument,"textarea",{rows:"1","aria-label":"Source code editing area"}),l=xt(o.ownerDocument,"div",{class:"ck-source-editing-area","data-value":r},[a]);a.value=r,a.setSelectionRange(0,0),a.addEventListener("input",()=>{l.dataset.value=a.value,e.ui.update()}),t.change(c=>{const d=t.document.getRoot(s);c.addClass("ck-hidden",d)}),e.ui.setEditableElement("sourceEditing:"+s,a),this._replacedRoots.set(s,l),this._elementReplacer.replace(o,l),this._dataFromRoots.set(s,r)}this._focusSourceEditing()}_hideSourceEditing(){const t=this.editor.editing.view;this.updateEditorData(),t.change(n=>{for(const[s]of this._replacedRoots)n.removeClass("ck-hidden",t.document.getRoot(s))}),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),t.focus()}_focusSourceEditing(){const e=this.editor,[t]=this._replacedRoots.values(),n=t.querySelector("textarea");e.editing.view.document.isFocused=!1,n.focus()}_disableCommands(){const e=this.editor;for(const t of e.commands.commands())t.forceDisabled(Cd)}_enableCommands(){const e=this.editor;for(const t of e.commands.commands())t.clearForceDisabled(Cd)}_handleReadOnlyMode(e){if(this.isSourceEditingMode)for(const[,t]of this._replacedRoots)t.querySelector("textarea").readOnly=e}_isAllowedToHandleSourceEditingMode(){const t=this.editor.ui.view.editable;return t&&!t.hasExternalElement}}function W2(i){return $2(i)?L2(i):i}function $2(i){return i.startsWith("<")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class U2 extends I{constructor(e,t){super(e),this.styleDefinition=t,this.previewView=this._createPreview(),this.set({label:t.name,class:"ck-style-grid__button",withText:!0}),this.extendTemplate({attributes:{role:"option"}}),this.children.add(this.previewView,0)}_createPreview(){const e=new E(this.locale);return e.setTemplate({tag:"div",attributes:{class:["ck","ck-reset_all-excluded","ck-style-grid__button__preview","ck-content"],"aria-hidden":"true"},children:[this.styleDefinition.previewTemplate]}),e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q2 extends E{constructor(e,t){super(e),this.focusTracker=new ue,this.keystrokes=new _e,this.set("activeStyles",[]),this.set("enabledStyles",[]),this.children=this.createCollection(),this.children.delegate("execute").to(this);for(const n of t){const s=new U2(e,n);this.children.add(s)}this.on("change:activeStyles",()=>{for(const n of this.children)n.isOn=this.activeStyles.includes(n.styleDefinition.name)}),this.on("change:enabledStyles",()=>{for(const n of this.children)n.isEnabled=this.enabledStyles.includes(n.styleDefinition.name)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-grid"],role:"listbox"},children:this.children})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element);zs({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.children,numberOfColumns:3,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection}),this.keystrokes.listenTo(this.element)}focus(){this.children.first.focus()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kd extends E{constructor(e,t,n){super(e),this.labelView=new ze(e),this.labelView.text=t,this.gridView=new q2(e,n),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel__style-group"],role:"group","aria-labelledby":this.labelView.id},children:[this.labelView,this.gridView]})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class j2 extends E{constructor(e,t){super(e);const n=e.t;this.focusTracker=new ue,this.keystrokes=new _e,this.children=this.createCollection(),this.blockStylesGroupView=new kd(e,n("Block styles"),t.block),this.inlineStylesGroupView=new kd(e,n("Text styles"),t.inline),this.set("activeStyles",[]),this.set("enabledStyles",[]),this._focusables=new qe,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["shift + tab"],focusNext:["tab"]}}),t.block.length&&this.children.add(this.blockStylesGroupView),t.inline.length&&this.children.add(this.inlineStylesGroupView),this.blockStylesGroupView.gridView.delegate("execute").to(this),this.inlineStylesGroupView.gridView.delegate("execute").to(this),this.blockStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.inlineStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel"]},children:this.children})}render(){super.render(),this._focusables.add(this.blockStylesGroupView.gridView),this._focusables.add(this.inlineStylesGroupView.gridView),this.focusTracker.add(this.blockStylesGroupView.gridView.element),this.focusTracker.add(this.inlineStylesGroupView.gridView.element),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const G2=["caption","colgroup","dd","dt","figcaption","legend","li","optgroup","option","rp","rt","summary","tbody","td","tfoot","th","thead","tr"];class yt extends b{static get pluginName(){return"StyleUtils"}constructor(e){super(e),this.decorate("isStyleEnabledForBlock"),this.decorate("isStyleActiveForBlock"),this.decorate("getAffectedBlocks"),this.decorate("isStyleEnabledForInlineSelection"),this.decorate("isStyleActiveForInlineSelection"),this.decorate("getAffectedInlineSelectable"),this.decorate("getStylePreview"),this.decorate("configureGHSDataFilter")}init(){this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport")}normalizeConfig(e,t=[]){const n={block:[],inline:[]};for(const s of t){const o=[],r=[];for(const l of e.getDefinitionsForView(s.element)){const c="appliesToBlock"in l?l.appliesToBlock:!1;if(l.isBlock||c){if(typeof c=="string")o.push(c);else if(l.isBlock){const d=l;o.push(l.model),d.paragraphLikeModel&&o.push(d.paragraphLikeModel)}}else r.push(l.model)}const a=this.getStylePreview(s,[{text:"AaBbCcDdEeFfGgHhIiJj"}]);o.length?n.block.push({...s,previewTemplate:a,modelElements:o,isBlock:!0}):n.inline.push({...s,previewTemplate:a,ghsAttributes:r})}return n}isStyleEnabledForBlock(e,t){const n=this.editor.model,s=this._htmlSupport.getGhsAttributeNameForElement(e.element);return n.schema.checkAttribute(t,s)?e.modelElements.includes(t.name):!1}isStyleActiveForBlock(e,t){const n=this._htmlSupport.getGhsAttributeNameForElement(e.element),s=t.getAttribute(n);return this.hasAllClasses(s,e.classes)}getAffectedBlocks(e,t){return e.modelElements.includes(t.name)?[t]:null}isStyleEnabledForInlineSelection(e,t){const n=this.editor.model;for(const s of e.ghsAttributes)if(n.schema.checkAttributeInSelection(t,s))return!0;return!1}isStyleActiveForInlineSelection(e,t){for(const n of e.ghsAttributes){const s=this._getValueFromFirstAllowedNode(t,n);if(this.hasAllClasses(s,e.classes))return!0}return!1}getAffectedInlineSelectable(e,t){return t}getStylePreview(e,t){const{element:n,classes:s}=e;return{tag:J2(n)?n:"div",attributes:{class:s},children:t}}hasAllClasses(e,t){return We(e)&&K2(e)&&t.every(n=>e.classes.includes(n))}configureGHSDataFilter({block:e,inline:t}){const n=this.editor.plugins.get("DataFilter");n.loadAllowedConfig(e.map(Ad)),n.loadAllowedConfig(t.map(Ad))}_getValueFromFirstAllowedNode(e,t){const s=this.editor.model.schema;if(e.isCollapsed)return e.getAttribute(t);for(const o of e.getRanges())for(const r of o.getItems())if(s.checkAttribute(r,t))return r.getAttribute(t);return null}}function K2(i){return!!i.classes&&Array.isArray(i.classes)}function J2(i){return!G2.includes(i)}function Ad({element:i,classes:e}){return{name:i,classes:e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Q2 extends b{static get pluginName(){return"StyleUI"}static get requires(){return[yt]}init(){const e=this.editor,t=e.plugins.get("DataSchema"),n=e.plugins.get("StyleUtils"),s=e.config.get("style.definitions"),o=n.normalizeConfig(t,s);e.ui.componentFactory.add("style",r=>{const a=r.t,l=de(r),c=e.commands.get("style");return l.once("change:isOpen",()=>{const d=new j2(r,o);l.panelView.children.add(d),d.delegate("execute").to(l),d.bind("activeStyles").to(c,"value"),d.bind("enabledStyles").to(c,"enabledStyles")}),l.bind("isEnabled").to(c),l.buttonView.withText=!0,l.buttonView.bind("label").to(c,"value",d=>d.length>1?a("Multiple styles"):d.length===1?d[0]:a("Styles")),l.bind("class").to(c,"value",d=>{const u=["ck-style-dropdown"];return d.length>1&&u.push("ck-style-dropdown_multiple-active"),u.join(" ")}),l.on("execute",d=>{e.execute("style",{styleName:d.source.styleDefinition.name}),e.editing.view.focus()}),l})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y2 extends T{constructor(e,t){super(e),this.set("value",[]),this.set("enabledStyles",[]),this._styleDefinitions=t,this._styleUtils=this.editor.plugins.get(yt)}refresh(){const e=this.editor.model,t=e.document.selection,n=new Set,s=new Set;for(const r of this._styleDefinitions.inline)this._styleUtils.isStyleEnabledForInlineSelection(r,t)&&s.add(r.name),this._styleUtils.isStyleActiveForInlineSelection(r,t)&&n.add(r.name);const o=Q(t.getSelectedBlocks())||t.getFirstPosition().parent;if(o){const r=o.getAncestors({includeSelf:!0,parentFirst:!0});for(const a of r){if(a.is("rootElement"))break;for(const l of this._styleDefinitions.block)this._styleUtils.isStyleEnabledForBlock(l,a)&&(s.add(l.name),this._styleUtils.isStyleActiveForBlock(l,a)&&n.add(l.name));if(e.schema.isObject(a))break}}this.enabledStyles=Array.from(s).sort(),this.isEnabled=this.enabledStyles.length>0,this.value=this.isEnabled?Array.from(n).sort():[]}execute({styleName:e,forceValue:t}){if(!this.enabledStyles.includes(e)){K("style-command-executed-with-incorrect-style-name");return}const n=this.editor.model,s=n.document.selection,o=this.editor.plugins.get("GeneralHtmlSupport"),r=[...this._styleDefinitions.inline,...this._styleDefinitions.block],a=r.filter(({name:d})=>this.value.includes(d)),l=r.find(({name:d})=>d==e),c=t===void 0?!this.value.includes(l.name):t;n.change(()=>{let d;Z2(l)?d=this._findAffectedBlocks(eS(s),l):d=[this._styleUtils.getAffectedInlineSelectable(l,s)];for(const u of d)c?o.addModelHtmlClass(l.element,l.classes,u):o.removeModelHtmlClass(l.element,X2(a,l),u)})}_findAffectedBlocks(e,t){const n=new Set;for(const s of e){const o=s.getAncestors({includeSelf:!0,parentFirst:!0});for(const r of o){if(r.is("rootElement"))break;const a=this._styleUtils.getAffectedBlocks(t,r);if(a){for(const l of a)n.add(l);break}}}return n}}function X2(i,e){return i.reduce((t,n)=>n.name===e.name?t:t.filter(s=>!n.classes.includes(s)),e.classes)}function Z2(i){return"isBlock"in i}function eS(i){const e=Array.from(i.getSelectedBlocks());return e.length?e:[i.getFirstPosition().parent]}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tS extends b{static get pluginName(){return"DocumentListStyleSupport"}static get requires(){return[yt,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("DocumentListEditing")&&(this._styleUtils=e.plugins.get(yt),this._documentListUtils=this.editor.plugins.get("DocumentListUtils"),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(t,[n,s])=>{this._isStyleEnabledForBlock(n,s)&&(t.return=!0,t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForBlock",(t,[n,s])=>{this._isStyleActiveForBlock(n,s)&&(t.return=!0,t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(t,[n,s])=>{const o=this._getAffectedBlocks(n,s);o&&(t.return=o,t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getStylePreview",(t,[n,s])=>{const o=this._getStylePreview(n,s);o&&(t.return=o,t.stop())},{priority:"high"}))}_isStyleEnabledForBlock(e,t){const n=this.editor.model;if(!["ol","ul","li"].includes(e.element)||!this._documentListUtils.isListItemBlock(t))return!1;const s=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(e.element=="ol"||e.element=="ul"){if(!n.schema.checkAttribute(t,s))return!1;const o=t.getAttribute("listType")=="numbered"?"ol":"ul";return e.element==o}else return n.schema.checkAttribute(t,s)}_isStyleActiveForBlock(e,t){const n=this._htmlSupport.getGhsAttributeNameForElement(e.element),s=t.getAttribute(n);return this._styleUtils.hasAllClasses(s,e.classes)}_getAffectedBlocks(e,t){return this._isStyleEnabledForBlock(e,t)?e.element=="li"?this._documentListUtils.expandListBlocksToCompleteItems(t,{withNested:!1}):this._documentListUtils.expandListBlocksToCompleteList(t):null}_getStylePreview(e,t){const{element:n,classes:s}=e;return n=="ol"||n=="ul"?{tag:n,attributes:{class:s},children:[{tag:"li",children:t}]}:n=="li"?{tag:"ol",children:[{tag:n,attributes:{class:s},children:t}]}:null}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nS extends b{static get pluginName(){return"TableStyleSupport"}static get requires(){return[yt]}init(){const e=this.editor;e.plugins.has("TableEditing")&&(this._styleUtils=e.plugins.get(yt),this._tableUtils=this.editor.plugins.get("TableUtils"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(t,[n,s])=>{this._isApplicable(n,s)&&(t.return=this._isStyleEnabledForBlock(n,s),t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(t,[n,s])=>{this._isApplicable(n,s)&&(t.return=this._getAffectedBlocks(n,s),t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"configureGHSDataFilter",(t,[{block:n}])=>{this.editor.plugins.get("DataFilter").loadAllowedConfig(n.filter(o=>o.element=="figcaption").map(o=>({name:"caption",classes:o.classes})))}))}_isApplicable(e,t){return["td","th"].includes(e.element)?t.name=="tableCell":["thead","tbody"].includes(e.element)?t.name=="table":!1}_isStyleEnabledForBlock(e,t){if(["td","th"].includes(e.element)){const n=this._tableUtils.getCellLocation(t),o=t.parent.parent,r=o.getAttribute("headingRows")||0,a=o.getAttribute("headingColumns")||0,l=n.row<r||n.column<a;return e.element=="th"?l:!l}if(["thead","tbody"].includes(e.element)){const n=t.getAttribute("headingRows")||0;return e.element=="thead"?n>0:n<this._tableUtils.getRows(t)}/* istanbul ignore next -- @preserve */return!1}_getAffectedBlocks(e,t){return this._isStyleEnabledForBlock(e,t)?[t]:null}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iS extends b{static get pluginName(){return"LinkStyleSupport"}static get requires(){return[yt,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("LinkEditing")&&(this._styleUtils=e.plugins.get(yt),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForInlineSelection",(t,[n,s])=>{n.element=="a"&&(t.return=this._isStyleEnabled(n,s),t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForInlineSelection",(t,[n,s])=>{n.element=="a"&&(t.return=this._isStyleActive(n,s),t.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedInlineSelectable",(t,[n,s])=>{if(n.element!="a")return;const o=this._getAffectedSelectable(n,s);o&&(t.return=o,t.stop())},{priority:"high"}))}_isStyleEnabled(e,t){const n=this.editor.model;if(t.isCollapsed)return t.hasAttribute("linkHref");for(const s of t.getRanges())for(const o of s.getItems())if((o.is("$textProxy")||n.schema.isInline(o))&&o.hasAttribute("linkHref"))return!0;return!1}_isStyleActive(e,t){const n=this.editor.model,s=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(t.isCollapsed){if(t.hasAttribute("linkHref")){const o=t.getAttribute(s);if(this._styleUtils.hasAllClasses(o,e.classes))return!0}return!1}for(const o of t.getRanges())for(const r of o.getItems())if((r.is("$textProxy")||n.schema.isInline(r))&&r.hasAttribute("linkHref")){const a=r.getAttribute(s);return this._styleUtils.hasAllClasses(a,e.classes)}return!1}_getAffectedSelectable(e,t){const n=this.editor.model;if(t.isCollapsed){const o=t.getAttribute("linkHref");return tm(t.getFirstPosition(),"linkHref",o,n)}const s=[];for(const o of t.getRanges()){const r=n.createRange(Ed(o.start,"linkHref",!0,n),Ed(o.end,"linkHref",!1,n));for(const a of r.getItems())(a.is("$textProxy")||n.schema.isInline(a))&&a.hasAttribute("linkHref")&&s.push(this.editor.model.createRangeOn(a))}return sS(s)}}function Ed(i,e,t,n){const s=i.textNode||(t?i.nodeAfter:i.nodeBefore);if(!s||!s.hasAttribute(e))return i;const o=s.getAttribute(e);return dr(i,e,o,t,n)}function sS(i){for(let e=1;e<i.length;e++){const t=i[e-1].getJoined(i[e]);t&&i.splice(--e,2,t)}return i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oS extends b{static get pluginName(){return"StyleEditing"}static get requires(){return["GeneralHtmlSupport",yt,tS,nS,iS]}init(){const e=this.editor,t=e.plugins.get("DataSchema"),n=e.plugins.get("StyleUtils"),s=e.config.get("style.definitions"),o=n.normalizeConfig(t,s);e.commands.add("style",new Y2(e,o)),n.configureGHSDataFilter(o)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CP extends b{static get pluginName(){return"Style"}static get requires(){return[oS,Q2]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ca(i,e){const{modelAttribute:t,styleName:n,viewElement:s,defaultValue:o,reduceBoxSides:r=!1,shouldUpcast:a=()=>!0}=e;i.for("upcast").attributeToAttribute({view:{name:s,styles:{[n]:/[\s\S]+/}},model:{key:t,value:l=>{if(!a(l))return;const c=l.getNormalizedStyle(n),d=r?ws(c):c;if(o!==d)return d}}})}function kr(i,e,t,n){i.for("upcast").add(s=>s.on("element:"+e,(o,r,a)=>{if(!r.modelRange)return;const l=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(m=>r.viewItem.hasStyle(m));if(!l.length)return;const c={styles:l};if(!a.consumable.test(r.viewItem,c))return;const d=[...r.modelRange.getItems({shallow:!0})].pop();a.consumable.consume(r.viewItem,c);const u={style:r.viewItem.getNormalizedStyle("border-style"),color:r.viewItem.getNormalizedStyle("border-color"),width:r.viewItem.getNormalizedStyle("border-width")},h={style:ws(u.style),color:ws(u.color),width:ws(u.width)};h.style!==n.style&&a.writer.setAttribute(t.style,h.style,d),h.color!==n.color&&a.writer.setAttribute(t.color,h.color,d),h.width!==n.width&&a.writer.setAttribute(t.width,h.width,d)}))}function mi(i,e){const{modelElement:t,modelAttribute:n,styleName:s}=e;i.for("downcast").attributeToAttribute({model:{name:t,key:n},view:o=>({key:"style",value:{[s]:o}})})}function bs(i,e){const{modelAttribute:t,styleName:n}=e;i.for("downcast").add(s=>s.on(`attribute:${t}:table`,(o,r,a)=>{const{item:l,attributeNewValue:c}=r,{mapper:d,writer:u}=a;if(!a.consumable.consume(r.item,o.name))return;const h=[...d.toViewElement(l).getChildren()].find(m=>m.is("element","table"));c?u.setStyle(n,c,h):u.removeStyle(n,h)}))}function ws(i){if(!i)return;const e=["top","right","bottom","left"];if(!e.every(o=>i[o]))return i;const n=i.top;return e.every(o=>i[o]===n)?n:i}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ne(i,e,t,n,s=1){e!=null&&s!==void 0&&s!==null&&e>s?n.setAttribute(i,e,t):n.removeAttribute(i,t)}function hn(i,e,t={}){const n=i.createElement("tableCell",t);return i.insertElement("paragraph",n),i.insert(n,e),n}function Ar(i,e){const t=e.parent.parent,n=parseInt(t.getAttribute("headingColumns")||"0"),{column:s}=i.getCellLocation(e);return!!n&&s<n}function _s(i,e,t){const{modelAttribute:n}=t;i.extend("tableCell",{allowAttributes:[n]}),Ca(e,{viewElement:/^(td|th)$/,...t}),mi(e,{modelElement:"tableCell",...t})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function rS(){return i=>{i.on("element:figure",(e,t,n)=>{if(!n.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const s=cS(t.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(t.viewItem,{name:!0,classes:"table"});const o=n.convertItem(s,t.modelCursor),r=Q(o.modelRange.getItems());if(!r){n.consumable.revert(t.viewItem,{name:!0,classes:"table"});return}n.convertChildren(t.viewItem,n.writer.createPositionAt(r,"end")),n.updateConversionResult(r,t)})}}function aS(){return i=>{i.on("element:table",(e,t,n)=>{const s=t.viewItem;if(!n.consumable.test(s,{name:!0}))return;const{rows:o,headingRows:r,headingColumns:a}=dS(s),l={};a&&(l.headingColumns=a),r&&(l.headingRows=r);const c=n.writer.createElement("table",l);if(n.safeInsert(c,t.modelCursor)){if(n.consumable.consume(s,{name:!0}),o.forEach(d=>n.convertItem(d,n.writer.createPositionAt(c,"end"))),n.convertChildren(s,n.writer.createPositionAt(c,"end")),c.isEmpty){const d=n.writer.createElement("tableRow");n.writer.insert(d,n.writer.createPositionAt(c,"end")),hn(n.writer,n.writer.createPositionAt(d,"end"))}n.updateConversionResult(c,t)}})}}function lS(){return i=>{i.on("element:tr",(e,t)=>{t.viewItem.isEmpty&&t.modelCursor.index==0&&e.stop()},{priority:"high"})}}function Td(i){return e=>{e.on(`element:${i}`,(t,n,{writer:s})=>{if(!n.modelRange)return;const o=n.modelRange.start.nodeAfter,r=s.createPositionAt(o,0);if(n.viewItem.isEmpty){s.insertElement("paragraph",r);return}const a=Array.from(o.getChildren());if(a.every(l=>l.is("element","$marker"))){const l=s.createElement("paragraph");s.insert(l,s.createPositionAt(o,0));for(const c of a)s.move(s.createRangeOn(c),s.createPositionAt(l,"end"))}},{priority:"low"})}}function cS(i){for(const e of i.getChildren())if(e.is("element","table"))return e}function dS(i){let e=0,t;const n=[],s=[];let o;for(const r of Array.from(i.getChildren())){if(r.name!=="tbody"&&r.name!=="thead"&&r.name!=="tfoot")continue;r.name==="thead"&&!o&&(o=r);const a=Array.from(r.getChildren()).filter(l=>l.is("element","tr"));for(const l of a)if(o&&r===o||r.name==="tbody"&&Array.from(l.getChildren()).length&&Array.from(l.getChildren()).every(c=>c.is("element","th")))e++,n.push(l);else{s.push(l);const c=uS(l);(!t||c<t)&&(t=c)}}return{headingRows:e,headingColumns:t||0,rows:[...n,...s]}}function uS(i){let e=0,t=0;const n=Array.from(i.getChildren()).filter(s=>s.name==="th"||s.name==="td");for(;t<n.length&&n[t].name==="th";){const s=n[t],o=parseInt(s.getAttribute("colspan")||"1");e=e+o,t++}return e}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class W{constructor(e,t={}){this._table=e,this._startRow=t.row!==void 0?t.row:t.startRow||0,this._endRow=t.row!==void 0?t.row:t.endRow,this._startColumn=t.column!==void 0?t.column:t.startColumn||0,this._endColumn=t.column!==void 0?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0,value:void 0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const n=this._getSpanned();if(n)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(n.cell,n.row,n.column));else{const s=e.getChild(this._cellIndex);if(!s)return this._advanceToNextRow();const o=parseInt(s.getAttribute("colspan")||"1"),r=parseInt(s.getAttribute("rowspan")||"1");(o>1||r>1)&&this._recordSpans(s,r,o),this._shouldSkipSlot()||(t=this._formatOutValue(s)),this._nextCellAtColumn=this._column+o}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(e,t=this._row,n=this._column){return{done:!1,value:new hS(this,e,t,n)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,n=this._column<this._startColumn,s=this._endColumn!==void 0&&this._column>this._endColumn;return e||t||n||s}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,n){const s={cell:e,row:this._row,column:this._column};for(let o=this._row;o<this._row+t;o++)for(let r=this._column;r<this._column+n;r++)(o!=this._row||r!=this._column)&&this._markSpannedCell(o,r,s)}_markSpannedCell(e,t,n){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(t,n)}}class hS{constructor(e,t,n,s){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=n,this.cellAnchorColumn=s,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Sd(i,e){return(t,{writer:n})=>{const s=t.getAttribute("headingRows")||0,o=n.createContainerElement("table",null,[]),r=n.createContainerElement("figure",{class:"table"},o);s>0&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("thead",null,n.createSlot(a=>a.is("element","tableRow")&&a.index<s))),s<i.getRows(t)&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("tbody",null,n.createSlot(a=>a.is("element","tableRow")&&a.index>=s)));for(const{positionOffset:a,filter:l}of e.additionalSlots)n.insert(n.createPositionAt(o,a),n.createSlot(l));return n.insert(n.createPositionAt(o,"after"),n.createSlot(a=>a.is("element","tableRow")?!1:!e.additionalSlots.some(({filter:l})=>l(a)))),e.asWidget?fS(r,n):r}}function mS(){return(i,{writer:e})=>i.isEmpty?e.createEmptyElement("tr"):e.createContainerElement("tr")}function xd(i={}){return(e,{writer:t})=>{const n=e.parent,s=n.parent,o=s.getChildIndex(n),r=new W(s,{row:o}),a=s.getAttribute("headingRows")||0,l=s.getAttribute("headingColumns")||0;let c=null;for(const d of r)if(d.cell==e){const h=d.row<a||d.column<l?"th":"td";c=i.asWidget?cm(t.createEditableElement(h),t):t.createContainerElement(h);break}return c}}function Pd(i={}){return(e,{writer:t})=>{if(!e.parent.is("element","tableCell")||!of(e))return null;if(i.asWidget)return t.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const n=t.createContainerElement("p");return t.setCustomProperty("dataPipeline:transparentRendering",!0,n),n}}}function of(i){return i.parent.childCount==1&&!gS(i)}function fS(i,e){return e.setCustomProperty("table",!0,i),dn(i,e,{hasSelectionHandle:!0})}function gS(i){return!i.getAttributeKeys().next().done}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pS extends T{refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema;this.isEnabled=bS(t,n)}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("TableUtils"),o=t.config.get("table.defaultHeadings.rows"),r=t.config.get("table.defaultHeadings.columns");e.headingRows===void 0&&o&&(e.headingRows=o),e.headingColumns===void 0&&r&&(e.headingColumns=r),n.change(a=>{const l=s.createTable(a,e);n.insertObject(l,null,null,{findOptimalPosition:"auto"}),a.setSelection(a.createPositionAt(l.getNodeByPath([0,0,0]),0))})}}function bS(i,e){const t=i.getFirstPosition().parent,n=t===t.root?t:t.parent;return e.checkChild(n,"table")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Id extends T{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="above",o=n.getSelectionAffectedTableCells(t),r=n.getRowIndexes(o),a=s?r.first:r.last,l=o[0].findAncestor("table");n.insertRows(l,{at:s?a:a+1,copyStructureFromAbove:!s})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rd extends T{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="left",o=n.getSelectionAffectedTableCells(t),r=n.getColumnIndexes(o),a=s?r.first:r.last,l=o[0].findAncestor("table");n.insertColumns(l,{columns:1,at:s?a:a+1})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vd extends T{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(t,2):e.splitCellVertically(t,2)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function rf(i,e,t){const{startRow:n,startColumn:s,endRow:o,endColumn:r}=e,a=t.createElement("table"),l=o-n+1;for(let d=0;d<l;d++)t.insertElement("tableRow",a,"end");const c=[...new W(i,{startRow:n,endRow:o,startColumn:s,endColumn:r,includeAllSlots:!0})];for(const{row:d,column:u,cell:h,isAnchor:m,cellAnchorRow:f,cellAnchorColumn:p}of c){const w=d-n,v=a.getChild(w);if(!m)(f<n||p<s)&&hn(t,t.createPositionAt(v,"end"));else{const C=t.cloneElement(h);t.append(C,v),uf(C,d,u,o,r,t)}}return wS(a,i,n,s,t),a}function af(i,e,t=0){const n=[],s=new W(i,{startRow:t,endRow:e-1});for(const o of s){const{row:r,cellHeight:a}=o,l=r+a-1;r<e&&e<=l&&n.push(o)}return n}function lf(i,e,t){const n=i.parent,s=n.parent,o=n.index,r=parseInt(i.getAttribute("rowspan")),a=e-o,l={},c=r-a;c>1&&(l.rowspan=c);const d=parseInt(i.getAttribute("colspan")||"1");d>1&&(l.colspan=d);const u=o,h=u+a,m=[...new W(s,{startRow:u,endRow:h,includeAllSlots:!0})];let f=null,p;for(const w of m){const{row:v,column:C,cell:B}=w;B===i&&p===void 0&&(p=C),p!==void 0&&p===C&&v===h&&(f=hn(t,w.getPositionBefore(),l))}return ne("rowspan",a,i,t),f}function cf(i,e){const t=[],n=new W(i);for(const s of n){const{column:o,cellWidth:r}=s,a=o+r-1;o<e&&e<=a&&t.push(s)}return t}function df(i,e,t,n){const s=parseInt(i.getAttribute("colspan")),o=t-e,r={},a=s-o;a>1&&(r.colspan=a);const l=parseInt(i.getAttribute("rowspan")||"1");l>1&&(r.rowspan=l);const c=hn(n,n.createPositionAfter(i),r);return ne("colspan",o,i,n),c}function uf(i,e,t,n,s,o){const r=parseInt(i.getAttribute("colspan")||"1"),a=parseInt(i.getAttribute("rowspan")||"1");if(t+r-1>s){const d=s-t+1;ne("colspan",d,i,o,1)}if(e+a-1>n){const d=n-e+1;ne("rowspan",d,i,o,1)}}function wS(i,e,t,n,s){const o=parseInt(e.getAttribute("headingRows")||"0");if(o>0){const a=o-t;ne("headingRows",a,i,s,0)}const r=parseInt(e.getAttribute("headingColumns")||"0");if(r>0){const a=r-n;ne("headingColumns",a,i,s,0)}}function Er(i,e){const t=e.getColumns(i),n=new Array(t).fill(0);for(const{column:o}of new W(i))n[o]++;const s=n.reduce((o,r,a)=>r?o:[...o,a],[]);if(s.length>0){const o=s[s.length-1];return e.removeColumns(i,{at:o}),!0}return!1}function Tr(i,e){const t=[],n=e.getRows(i);for(let s=0;s<n;s++)i.getChild(s).isEmpty&&t.push(s);if(t.length>0){const s=t[t.length-1];return e.removeRows(i,{at:s}),!0}return!1}function ka(i,e){Er(i,e)||Tr(i,e)}function hf(i,e){const t=Array.from(new W(i,{startColumn:e.firstColumn,endColumn:e.lastColumn,row:e.lastRow}));if(t.every(({cellHeight:o})=>o===1))return e.lastRow;const s=t[0].cellHeight-1;return e.lastRow+s}function mf(i,e){const t=Array.from(new W(i,{startRow:e.firstRow,endRow:e.lastRow,column:e.lastColumn}));if(t.every(({cellWidth:o})=>o===1))return e.lastColumn;const s=t[0].cellWidth-1;return e.lastColumn+s}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ls extends T{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,s=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(t.selection)[0],o=this.value,r=this.direction;e.change(a=>{const l=r=="right"||r=="down",c=l?s:o,d=l?o:s,u=d.parent;yS(d,c,a);const h=this.isHorizontal?"colspan":"rowspan",m=parseInt(s.getAttribute(h)||"1"),f=parseInt(o.getAttribute(h)||"1");a.setAttribute(h,m+f,c),a.setSelection(a.createRangeIn(c));const p=this.editor.plugins.get("TableUtils"),w=u.findAncestor("table");ka(w,p)})}_getMergeableCell(){const t=this.editor.model.document,n=this.editor.plugins.get("TableUtils"),s=n.getTableCellsContainingSelection(t.selection)[0];if(!s)return;const o=this.isHorizontal?_S(s,this.direction,n):vS(s,this.direction,n);if(!o)return;const r=this.isHorizontal?"rowspan":"colspan",a=parseInt(s.getAttribute(r)||"1");if(parseInt(o.getAttribute(r)||"1")===a)return o}}function _S(i,e,t){const s=i.parent.parent,o=e=="right"?i.nextSibling:i.previousSibling,r=(s.getAttribute("headingColumns")||0)>0;if(!o)return;const a=e=="right"?i:o,l=e=="right"?o:i,{column:c}=t.getCellLocation(a),{column:d}=t.getCellLocation(l),u=parseInt(a.getAttribute("colspan")||"1"),h=Ar(t,a),m=Ar(t,l);return r&&h!=m?void 0:c+u===d?o:void 0}function vS(i,e,t){const n=i.parent,s=n.parent,o=s.getChildIndex(n);if(e=="down"&&o===t.getRows(s)-1||e=="up"&&o===0)return null;const r=parseInt(i.getAttribute("rowspan")||"1"),a=s.getAttribute("headingRows")||0,l=e=="down"&&o+r===a,c=e=="up"&&o===a;if(a&&(l||c))return null;const d=parseInt(i.getAttribute("rowspan")||"1"),u=e=="down"?o+d:o,h=[...new W(s,{endRow:u})],f=h.find(w=>w.cell===i).column,p=h.find(({row:w,cellHeight:v,column:C})=>C!==f?!1:e=="down"?w===u:u===w+v);return p&&p.cell?p.cell:null}function yS(i,e,t){Bd(i)||(Bd(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function Bd(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CS extends T{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),r=e.getRows(s)-1,a=e.getRowIndexes(t),l=a.first===0&&a.last===r;this.isEnabled=!l}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0],r=o.findAncestor("table"),a=t.getCellLocation(o).column;e.change(l=>{const c=s.last-s.first+1;t.removeRows(r,{at:s.first,rows:c});const d=kS(r,s.first,a,t.getRows(r));l.setSelection(l.createPositionAt(d,0))})}}function kS(i,e,t,n){const s=i.getChild(Math.min(e,n-1));let o=s.getChild(0),r=0;for(const a of s.getChildren()){if(r>t)return o;o=a,r+=parseInt(a.getAttribute("colspan")||"1")}return o}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AS extends T{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),o=e.getColumns(s),{first:r,last:a}=e.getColumnIndexes(t);this.isEnabled=a-r<o-1}else this.isEnabled=!1}execute(){const e=this.editor.plugins.get("TableUtils"),[t,n]=TS(this.editor.model.document.selection,e),s=t.parent.parent,o=[...new W(s)],r={first:o.find(l=>l.cell===t).column,last:o.find(l=>l.cell===n).column},a=ES(o,t,n,r);this.editor.model.change(l=>{const c=r.last-r.first+1;e.removeColumns(s,{at:r.first,columns:c}),l.setSelection(l.createPositionAt(a,0))})}}function ES(i,e,t,n){return parseInt(t.getAttribute("colspan")||"1")>1?t:e.previousSibling||t.nextSibling?t.nextSibling||e.previousSibling:n.first?i.reverse().find(({column:o})=>o<n.first).cell:i.reverse().find(({column:o})=>o>n.last).cell}function TS(i,e){const t=e.getSelectionAffectedTableCells(i),n=t[0],s=t.pop(),o=[n,s];return n.isBefore(s)?o:o.reverse()}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SS extends T{refresh(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(o=>this._isInHeading(o,o.parent.parent))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=t.getRowIndexes(s),l=this.value?r:a+1,c=o.getAttribute("headingRows")||0;n.change(d=>{if(l){const u=l>c?c:0,h=af(o,l,u);for(const{cell:m}of h)lf(m,l,d)}ne("headingRows",l,o,d,0)})}_isInHeading(e,t){const n=parseInt(t.getAttribute("headingRows")||"0");return!!n&&e.parent.index<n}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xS extends T{refresh(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(o=>Ar(t,o))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=t.getColumnIndexes(s),l=this.value?r:a+1;n.change(c=>{if(l){const d=cf(o,l);for(const{cell:u,column:h}of d)df(u,h,l,c)}ne("headingColumns",l,o,c,0)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class be extends b{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,n=t.parent,s=n.getChildIndex(t),o=new W(n,{row:s});for(const{cell:r,row:a,column:l}of o)if(r===e)return{row:a,column:l};/* istanbul ignore next -- @preserve */}createTable(e,t){const n=e.createElement("table"),s=t.rows||2,o=t.columns||2;return $o(e,n,0,s,o),t.headingRows&&ne("headingRows",Math.min(t.headingRows,s),n,e,0),t.headingColumns&&ne("headingColumns",Math.min(t.headingColumns,o),n,e,0),n}insertRows(e,t={}){const n=this.editor.model,s=t.at||0,o=t.rows||1,r=t.copyStructureFromAbove!==void 0,a=t.copyStructureFromAbove?s-1:s,l=this.getRows(e),c=this.getColumns(e);if(s>l)throw new g("tableutils-insertrows-insert-out-of-range",this,{options:t});n.change(d=>{const u=e.getAttribute("headingRows")||0;if(u>s&&ne("headingRows",u+o,e,d,0),!r&&(s===0||s===l)){$o(d,e,s,o,c);return}const h=r?Math.max(s,a):s,m=new W(e,{endRow:h}),f=new Array(c).fill(1);for(const{row:p,column:w,cellHeight:v,cellWidth:C,cell:B}of m){const D=p+v-1,Z=p<s&&s<=D,P=p<=a&&a<=D;Z?(d.setAttribute("rowspan",v+o,B),f[w]=-C):r&&P&&(f[w]=C)}for(let p=0;p<o;p++){const w=d.createElement("tableRow");d.insert(w,e,s);for(let v=0;v<f.length;v++){const C=f[v],B=d.createPositionAt(w,"end");C>0&&hn(d,B,C>1?{colspan:C}:void 0),v+=Math.abs(C)-1}}})}insertColumns(e,t={}){const n=this.editor.model,s=t.at||0,o=t.columns||1;n.change(r=>{const a=e.getAttribute("headingColumns");s<a&&r.setAttribute("headingColumns",a+o,e);const l=this.getColumns(e);if(s===0||l===s){for(const d of e.getChildren())d.is("element","tableRow")&&In(o,r,r.createPositionAt(d,s?"end":0));return}const c=new W(e,{column:s,includeAllSlots:!0});for(const d of c){const{row:u,cell:h,cellAnchorColumn:m,cellAnchorRow:f,cellWidth:p,cellHeight:w}=d;if(m<s){r.setAttribute("colspan",p+o,h);const v=f+w-1;for(let C=u;C<=v;C++)c.skipRow(C)}else In(o,r,d.getPositionBefore())}})}removeRows(e,t){const n=this.editor.model,s=t.rows||1,o=this.getRows(e),r=t.at,a=r+s-1;if(a>o-1)throw new g("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});n.change(l=>{const c={first:r,last:a},{cellsToMove:d,cellsToTrim:u}=RS(e,c);if(d.size){const h=a+1;VS(e,h,d,l)}for(let h=a;h>=r;h--)l.remove(e.getChild(h));for(const{rowspan:h,cell:m}of u)ne("rowspan",h,m,l);IS(e,c,l),Er(e,this)||Tr(e,this)})}removeColumns(e,t){const n=this.editor.model,s=t.at,o=t.columns||1,r=t.at+o-1;n.change(a=>{PS(e,{first:s,last:r},a);for(let l=r;l>=s;l--)for(const{cell:c,column:d,cellWidth:u}of[...new W(e)])d<=l&&u>1&&d+u>l?ne("colspan",u-1,c,a):d===l&&a.remove(c);Tr(e,this)||Er(e,this)})}splitCellVertically(e,t=2){const n=this.editor.model,o=e.parent.parent,r=parseInt(e.getAttribute("rowspan")||"1"),a=parseInt(e.getAttribute("colspan")||"1");n.change(l=>{if(a>1){const{newCellsSpan:c,updatedSpan:d}=Md(a,t);ne("colspan",d,e,l);const u={};c>1&&(u.colspan=c),r>1&&(u.rowspan=r);const h=a>t?t-1:a-1;In(h,l,l.createPositionAfter(e),u)}if(a<t){const c=t-a,d=[...new W(o)],{column:u}=d.find(({cell:p})=>p===e),h=d.filter(({cell:p,cellWidth:w,column:v})=>{const C=p!==e&&v===u,B=v<u&&v+w>u;return C||B});for(const{cell:p,cellWidth:w}of h)l.setAttribute("colspan",w+c,p);const m={};r>1&&(m.rowspan=r),In(c,l,l.createPositionAfter(e),m);const f=o.getAttribute("headingColumns")||0;f>u&&ne("headingColumns",f+c,o,l)}})}splitCellHorizontally(e,t=2){const n=this.editor.model,s=e.parent,o=s.parent,r=o.getChildIndex(s),a=parseInt(e.getAttribute("rowspan")||"1"),l=parseInt(e.getAttribute("colspan")||"1");n.change(c=>{if(a>1){const d=[...new W(o,{startRow:r,endRow:r+a-1,includeAllSlots:!0})],{newCellsSpan:u,updatedSpan:h}=Md(a,t);ne("rowspan",h,e,c);const{column:m}=d.find(({cell:p})=>p===e),f={};u>1&&(f.rowspan=u),l>1&&(f.colspan=l);for(const p of d){const{column:w,row:v}=p,C=v>=r+h,B=w===m,D=(v+r+h)%u===0;C&&B&&D&&In(1,c,p.getPositionBefore(),f)}}if(a<t){const d=t-a,u=[...new W(o,{startRow:0,endRow:r})];for(const{cell:f,cellHeight:p,row:w}of u)if(f!==e&&w+p>r){const v=p+d;c.setAttribute("rowspan",v,f)}const h={};l>1&&(h.colspan=l),$o(c,o,r+1,d,1,h);const m=o.getAttribute("headingRows")||0;m>r&&ne("headingRows",m+d,o,c)}})}getColumns(e){return[...e.getChild(0).getChildren()].reduce((n,s)=>{const o=parseInt(s.getAttribute("colspan")||"1");return n+o},0)}getRows(e){return Array.from(e.getChildren()).reduce((t,n)=>n.is("element","tableRow")?t+1:t,0)}createTableWalker(e,t={}){return new W(e,t)}getSelectedTableCells(e){const t=[];for(const n of this.sortRanges(e.getRanges())){const s=n.getContainedElement();s&&s.is("element","tableCell")&&t.push(s)}return t}getTableCellsContainingSelection(e){const t=[];for(const n of e.getRanges()){const s=n.start.findAncestor("tableCell");s&&t.push(s)}return t}getSelectionAffectedTableCells(e){const t=this.getSelectedTableCells(e);return t.length?t:this.getTableCellsContainingSelection(e)}getRowIndexes(e){const t=e.map(n=>n.parent.index);return this._getFirstLastIndexesObject(t)}getColumnIndexes(e){const t=e[0].findAncestor("table"),s=[...new W(t)].filter(o=>e.includes(o.cell)).map(o=>o.column);return this._getFirstLastIndexesObject(s)}isSelectionRectangular(e){if(e.length<2||!this._areCellInTheSameTableSection(e))return!1;const t=new Set,n=new Set;let s=0;for(const r of e){const{row:a,column:l}=this.getCellLocation(r),c=parseInt(r.getAttribute("rowspan"))||1,d=parseInt(r.getAttribute("colspan"))||1;t.add(a),n.add(l),c>1&&t.add(a+c-1),d>1&&n.add(l+d-1),s+=c*d}return MS(t,n)==s}sortRanges(e){return Array.from(e).sort(BS)}_getFirstLastIndexesObject(e){const t=e.sort((o,r)=>o-r),n=t[0],s=t[t.length-1];return{first:n,last:s}}_areCellInTheSameTableSection(e){const t=e[0].findAncestor("table"),n=this.getRowIndexes(e),s=parseInt(t.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(n,s))return!1;const o=this.getColumnIndexes(e),r=parseInt(t.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(o,r)}_areIndexesInSameSection({first:e,last:t},n){const s=e<n,o=t<n;return s===o}}function $o(i,e,t,n,s,o={}){for(let r=0;r<n;r++){const a=i.createElement("tableRow");i.insert(a,e,t),In(s,i,i.createPositionAt(a,"end"),o)}}function In(i,e,t,n={}){for(let s=0;s<i;s++)hn(e,t,n)}function Md(i,e){if(i<e)return{newCellsSpan:1,updatedSpan:1};const t=Math.floor(i/e),n=i-t*e+t;return{newCellsSpan:t,updatedSpan:n}}function PS(i,e,t){const n=i.getAttribute("headingColumns")||0;if(n&&e.first<n){const s=Math.min(n-1,e.last)-e.first+1;t.setAttribute("headingColumns",n-s,i)}}function IS(i,{first:e,last:t},n){const s=i.getAttribute("headingRows")||0;if(e<s){const o=t<s?s-(t-e+1):e;ne("headingRows",o,i,n,0)}}function RS(i,{first:e,last:t}){const n=new Map,s=[];for(const{row:o,column:r,cellHeight:a,cell:l}of new W(i,{endRow:t})){const c=o+a-1;if(o>=e&&o<=t&&c>t){const h=t-o+1,m=a-h;n.set(r,{cell:l,rowspan:m})}if(o<e&&c>=e){let h;c>=t?h=t-e+1:h=c-e+1,s.push({cell:l,rowspan:a-h})}}return{cellsToMove:n,cellsToTrim:s}}function VS(i,e,t,n){const o=[...new W(i,{includeAllSlots:!0,row:e})],r=i.getChild(e);let a;for(const{column:l,cell:c,isAnchor:d}of o)if(t.has(l)){const{cell:u,rowspan:h}=t.get(l),m=a?n.createPositionAfter(a):n.createPositionAt(r,0);n.move(n.createRangeOn(u),m),ne("rowspan",h,u,n),a=u}else d&&(a=c)}function BS(i,e){const t=i.start,n=e.start;return t.isBefore(n)?-1:1}function MS(i,e){const t=Array.from(i.values()),n=Array.from(e.values()),s=Math.max(...t),o=Math.min(...t),r=Math.max(...n),a=Math.min(...n);return(s-o+1)*(r-a+1)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class OS extends T{refresh(){const e=this.editor.plugins.get(be),t=e.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=e.isSelectionRectangular(t)}execute(){const e=this.editor.model,t=this.editor.plugins.get(be);e.change(n=>{const s=t.getSelectedTableCells(e.document.selection),o=s.shift(),{mergeWidth:r,mergeHeight:a}=FS(o,s,t);ne("colspan",r,o,n),ne("rowspan",a,o,n);for(const c of s)NS(c,o,n);const l=o.findAncestor("table");ka(l,t),n.setSelection(o,"in")})}}function NS(i,e,t){Od(i)||(Od(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function Od(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}function FS(i,e,t){let n=0,s=0;for(const c of e){const{row:d,column:u}=t.getCellLocation(c);n=Nd(c,u,n,"colspan"),s=Nd(c,d,s,"rowspan")}const{row:o,column:r}=t.getCellLocation(i),a=n-r,l=s-o;return{mergeWidth:a,mergeHeight:l}}function Nd(i,e,t,n){const s=parseInt(i.getAttribute(n)||"1");return Math.max(t,e+s)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class LS extends T{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0].findAncestor("table"),r=[];for(let a=s.first;a<=s.last;a++)for(const l of o.getChild(a).getChildren())r.push(e.createRangeOn(l));e.change(a=>{a.setSelection(r)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class DS extends T{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection),s=n[0],o=n.pop(),r=s.findAncestor("table"),a=e.getCellLocation(s),l=e.getCellLocation(o),c=Math.min(a.column,l.column),d=Math.max(a.column,l.column),u=[];for(const h of new W(r,{startColumn:c,endColumn:d}))u.push(t.createRangeOn(h.cell));t.change(h=>{h.setSelection(u)})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zS(i){i.document.registerPostFixer(e=>HS(e,i))}function HS(i,e){const t=e.document.differ.getChanges();let n=!1;const s=new Set;for(const o of t){let r=null;o.type=="insert"&&o.name=="table"&&(r=o.position.nodeAfter),(o.type=="insert"||o.type=="remove")&&(o.name=="tableRow"||o.name=="tableCell")&&(r=o.position.findAncestor("table")),jS(o)&&(r=o.range.start.findAncestor("table")),r&&!s.has(r)&&(n=WS(r,i)||n,n=$S(r,i)||n,s.add(r))}return n}function WS(i,e){let t=!1;const n=US(i);if(n.length){t=!0;for(const s of n)ne("rowspan",s.rowspan,s.cell,e,1)}return t}function $S(i,e){let t=!1;const n=qS(i),s=[];for(const[l,c]of n.entries())!c&&i.getChild(l).is("element","tableRow")&&s.push(l);if(s.length){t=!0;for(const l of s.reverse())e.remove(i.getChild(l)),n.splice(l,1)}const o=n.filter((l,c)=>i.getChild(c).is("element","tableRow")),r=o[0];if(!o.every(l=>l===r)){const l=o.reduce((c,d)=>d>c?d:c,0);for(const[c,d]of o.entries()){const u=l-d;if(u){for(let h=0;h<u;h++)hn(e,e.createPositionAt(i.getChild(c),"end"));t=!0}}}return t}function US(i){const e=parseInt(i.getAttribute("headingRows")||"0"),t=Array.from(i.getChildren()).reduce((s,o)=>o.is("element","tableRow")?s+1:s,0),n=[];for(const{row:s,cell:o,cellHeight:r}of new W(i)){if(r<2)continue;const l=s<e?e:t;if(s+r>l){const c=l-s;n.push({cell:o,rowspan:c})}}return n}function qS(i){const e=new Array(i.childCount).fill(0);for(const{rowIndex:t}of new W(i,{includeAllSlots:!0}))e[t]++;return e}function jS(i){if(i.type!=="attribute")return!1;const e=i.attributeKey;return e==="headingRows"||e==="colspan"||e==="rowspan"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function GS(i){i.document.registerPostFixer(e=>KS(e,i))}function KS(i,e){const t=e.document.differ.getChanges();let n=!1;for(const s of t)s.type=="insert"&&s.name=="table"&&(n=JS(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableRow"&&(n=ff(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableCell"&&(n=Sr(s.position.nodeAfter,i)||n),(s.type=="remove"||s.type=="insert")&&QS(s)&&(n=Sr(s.position.parent,i)||n);return n}function JS(i,e){let t=!1;for(const n of i.getChildren())n.is("element","tableRow")&&(t=ff(n,e)||t);return t}function ff(i,e){let t=!1;for(const n of i.getChildren())t=Sr(n,e)||t;return t}function Sr(i,e){if(i.childCount==0)return e.insertElement("paragraph",i),!0;const t=Array.from(i.getChildren()).filter(n=>n.is("$text"));for(const n of t)e.wrap(e.createRangeOn(n),"paragraph");return!!t.length}function QS(i){return i.position.parent.is("element","tableCell")?i.type=="insert"&&i.name=="$text"||i.type=="remove":!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function YS(i,e){const t=i.document.differ;for(const n of t.getChanges()){let s,o=!1;if(n.type=="attribute"){const c=n.range.start.nodeAfter;if(!c||!c.is("element","table")||n.attributeKey!="headingRows"&&n.attributeKey!="headingColumns")continue;s=c,o=n.attributeKey=="headingRows"}else(n.name=="tableRow"||n.name=="tableCell")&&(s=n.position.findAncestor("table"),o=n.name=="tableRow");if(!s)continue;const r=s.getAttribute("headingRows")||0,a=s.getAttribute("headingColumns")||0,l=new W(s);for(const c of l){const u=c.row<r||c.column<a?"th":"td",h=e.mapper.toViewElement(c.cell);h&&h.is("element")&&h.name!=u&&e.reconvertItem(o?c.cell.parent:c.cell)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function XS(i,e){const t=i.document.differ,n=new Set;for(const s of t.getChanges()){const o=s.type=="attribute"?s.range.start.parent:s.position.parent;o.is("element","tableCell")&&n.add(o)}for(const s of n.values()){const o=Array.from(s.getChildren()).filter(r=>ZS(r,e.mapper));for(const r of o)e.reconvertItem(r)}}function ZS(i,e){if(!i.is("element","paragraph"))return!1;const t=e.toViewElement(i);return t?of(i)!==t.is("element","span"):!1}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ni extends b{static get pluginName(){return"TableEditing"}static get requires(){return[be]}constructor(e){super(e),this._additionalSlots=[]}init(){const e=this.editor,t=e.model,n=t.schema,s=e.conversion,o=e.plugins.get(be);n.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),s.for("upcast").add(rS()),s.for("upcast").add(aS()),s.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:Sd(o,{asWidget:!0,additionalSlots:this._additionalSlots})}),s.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:Sd(o,{additionalSlots:this._additionalSlots})}),s.for("upcast").elementToElement({model:"tableRow",view:"tr"}),s.for("upcast").add(lS()),s.for("downcast").elementToElement({model:"tableRow",view:mS()}),s.for("upcast").elementToElement({model:"tableCell",view:"td"}),s.for("upcast").elementToElement({model:"tableCell",view:"th"}),s.for("upcast").add(Td("td")),s.for("upcast").add(Td("th")),s.for("editingDowncast").elementToElement({model:"tableCell",view:xd({asWidget:!0})}),s.for("dataDowncast").elementToElement({model:"tableCell",view:xd()}),s.for("editingDowncast").elementToElement({model:"paragraph",view:Pd({asWidget:!0}),converterPriority:"high"}),s.for("dataDowncast").elementToElement({model:"paragraph",view:Pd(),converterPriority:"high"}),s.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),s.for("upcast").attributeToAttribute({model:{key:"colspan",value:Fd("colspan")},view:"colspan"}),s.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),s.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Fd("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new pS(e)),e.commands.add("insertTableRowAbove",new Id(e,{order:"above"})),e.commands.add("insertTableRowBelow",new Id(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Rd(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Rd(e,{order:"right"})),e.commands.add("removeTableRow",new CS(e)),e.commands.add("removeTableColumn",new AS(e)),e.commands.add("splitTableCellVertically",new Vd(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Vd(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new OS(e)),e.commands.add("mergeTableCellRight",new ls(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new ls(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new ls(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new ls(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new xS(e)),e.commands.add("setTableRowHeader",new SS(e)),e.commands.add("selectTableRow",new LS(e)),e.commands.add("selectTableColumn",new DS(e)),zS(t),GS(t),this.listenTo(t.document,"change:data",()=>{YS(t,e.editing),XS(t,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}}function Fd(i){return e=>{const t=parseInt(e.getAttribute(i));return Number.isNaN(t)||t<=0?null:t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ex extends E{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new _e,this.focusTracker=new ue,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(n,s)=>`${s} × ${n}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:t.to("label")}]}],on:{mousedown:t.to(n=>{n.preventDefault()}),click:t.to(()=>{this.fire("execute")})}}),this.on("boxover",(n,s)=>{const{row:o,column:r}=s.target.dataset;this.items.get((parseInt(o,10)-1)*10+(parseInt(r,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(n,s,o)=>{if(!o)return;const{row:r,column:a}=o.dataset;this.set({rows:parseInt(r),columns:parseInt(a)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),zs({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map((n,s)=>{const o=Math.floor(s/10),r=s%10,a=o<e&&r<t;n.set("isOn",a)})}_createGridButton(e,t,n,s){const o=new I(e);return o.set({label:s,class:"ck-insert-table-dropdown-grid-box"}),o.extendTemplate({attributes:{"data-row":t,"data-column":n}}),o}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const n=Math.floor(t/10),s=t%10,o=`${n+1} × ${s+1}`;e.push(this._createGridButton(this.locale,n+1,s+1,o))}return this.createCollection(e)}}const tx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',nx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',ix='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',sx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ox extends b{static get pluginName(){return"TableUI"}init(){const e=this.editor,t=this.editor.t,s=e.locale.contentLanguageDirection==="ltr";e.ui.componentFactory.add("insertTable",o=>{const r=e.commands.get("insertTable"),a=de(o);a.bind("isEnabled").to(r),a.buttonView.set({icon:tx,label:t("Insert table"),tooltip:!0});let l;return a.on("change:isOpen",()=>{l||(l=new ex(o),a.panelView.children.add(l),l.delegate("execute").to(a),a.on("execute",()=>{e.execute("insertTable",{rows:l.rows,columns:l.columns}),e.editing.view.focus()}))}),a}),e.ui.componentFactory.add("tableColumn",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:s?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:s?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),nx,r,o)}),e.ui.componentFactory.add("tableRow",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),ix,r,o)}),e.ui.componentFactory.add("mergeTableCells",o=>{const r=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:s?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:s?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),sx,r,o)})}_prepareDropdown(e,t,n,s){const o=this.editor,r=de(s),a=this._fillDropdownWithListOptions(r,n);return r.buttonView.set({label:e,icon:t,tooltip:!0}),r.bind("isEnabled").toMany(a,"isEnabled",(...l)=>l.some(c=>c)),this.listenTo(r,"execute",l=>{o.execute(l.source.commandName),l.source instanceof Us||o.editing.view.focus()}),r}_prepareMergeSplitButtonDropdown(e,t,n,s){const o=this.editor,r=de(s,Wn),a="mergeTableCells",l=o.commands.get(a),c=this._fillDropdownWithListOptions(r,n);return r.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),r.bind("isEnabled").toMany([l,...c],"isEnabled",(...d)=>d.some(u=>u)),this.listenTo(r.buttonView,"execute",()=>{o.execute(a),o.editing.view.focus()}),this.listenTo(r,"execute",d=>{o.execute(d.source.commandName),o.editing.view.focus()}),r}_fillDropdownWithListOptions(e,t){const n=this.editor,s=[],o=new ge;for(const r of t)rx(r,n,s,o);return kt(e,o),s}}function rx(i,e,t,n){if(i.type==="button"||i.type==="switchbutton"){const s=i.model=new wt(i.model),{commandName:o,bindIsOn:r}=i.model,a=e.commands.get(o);t.push(a),s.set({commandName:o}),s.bind("isEnabled").to(a),r&&s.bind("isOn").to(a,"value"),s.set({withText:!0})}n.add(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nn extends b{static get pluginName(){return"TableSelection"}static get requires(){return[be,be]}init(){const e=this.editor,t=e.model,n=e.editing.view;this.listenTo(t,"deleteContent",(s,o)=>this._handleDeleteContent(s,o),{priority:"high"}),this.listenTo(n.document,"insertText",(s,o)=>this._handleInsertTextEvent(s,o),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.plugins.get(be),t=this.editor.model.document.selection,n=e.getSelectedTableCells(t);return n.length==0?null:n}getSelectionAsFragment(){const e=this.editor.plugins.get(be),t=this.getSelectedTableCells();return t?this.editor.model.change(n=>{const s=n.createDocumentFragment(),{first:o,last:r}=e.getColumnIndexes(t),{first:a,last:l}=e.getRowIndexes(t),c=t[0].findAncestor("table");let d=l,u=r;if(e.isSelectionRectangular(t)){const f={firstColumn:o,lastColumn:r,firstRow:a,lastRow:l};d=hf(c,f),u=mf(c,f)}const m=rf(c,{startRow:a,startColumn:o,endRow:d,endColumn:u},n);return n.insert(m,s,0),s}):null}setCellSelection(e,t){const n=this._getCellsToSelect(e,t);this.editor.model.change(s=>{s.setSelection(n.cells.map(o=>s.createRangeOn(o)),{backward:n.backward})})}getFocusCell(){const n=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return n&&n.is("element","tableCell")?n:null}getAnchorCell(){const e=this.editor.model.document.selection,n=Q(e.getRanges()).getContainedElement();return n&&n.is("element","tableCell")?n:null}_defineSelectionConverter(){const e=this.editor,t=new Set;e.conversion.for("editingDowncast").add(s=>s.on("selection",(o,r,a)=>{const l=a.writer;n(l);const c=this.getSelectedTableCells();if(!c)return;for(const u of c){const h=a.mapper.toViewElement(u);l.addClass("ck-editor__editable_selected",h),t.add(h)}const d=a.mapper.toViewElement(c[c.length-1]);l.setSelection(d,0)},{priority:"lowest"}));function n(s){for(const o of t)s.removeClass("ck-editor__editable_selected",o);t.clear()}}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change(n=>{const s=n.createPositionAt(t[0],0),o=e.model.schema.getNearestSelectionRange(s);n.setSelection(o)})}})}_handleDeleteContent(e,t){const n=this.editor.plugins.get(be),s=t[0],o=t[1],r=this.editor.model,a=!o||o.direction=="backward",l=n.getSelectedTableCells(s);l.length&&(e.stop(),r.change(c=>{const d=l[a?l.length-1:0];r.change(h=>{for(const m of l)r.deleteContent(h.createSelection(m,"in"))});const u=r.schema.getNearestSelectionRange(c.createPositionAt(d,0));s.is("documentSelection")?c.setSelection(u):s.setTo(u)}))}_handleInsertTextEvent(e,t){const n=this.editor,s=this.getSelectedTableCells();if(!s)return;const o=n.editing.view,r=n.editing.mapper,a=s.map(l=>o.createRangeOn(r.toViewElement(l)));t.selection=o.createSelection(a)}_getCellsToSelect(e,t){const n=this.editor.plugins.get("TableUtils"),s=n.getCellLocation(e),o=n.getCellLocation(t),r=Math.min(s.row,o.row),a=Math.max(s.row,o.row),l=Math.min(s.column,o.column),c=Math.max(s.column,o.column),d=new Array(a-r+1).fill(null).map(()=>[]),u={startRow:r,endRow:a,startColumn:l,endColumn:c};for(const{row:f,cell:p}of new W(e.findAncestor("table"),u))d[f-r].push(p);const h=o.row<s.row,m=o.column<s.column;return h&&d.reverse(),m&&d.forEach(f=>f.reverse()),{cells:d.flat(),backward:h||m}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ax extends b{static get pluginName(){return"TableClipboard"}static get requires(){return[nn,be]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",(n,s)=>this._onCopyCut(n,s)),this.listenTo(t,"cut",(n,s)=>this._onCopyCut(n,s)),this.listenTo(e.model,"insertContent",(n,[s,o])=>this._onInsertContent(n,s,o),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const n=this.editor.plugins.get(nn);if(!n.getSelectedTableCells()||e.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection))return;t.preventDefault(),e.stop();const s=this.editor.data,o=this.editor.editing.view.document,r=s.toView(n.getSelectionAsFragment());o.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:r,method:e.name})}_onInsertContent(e,t,n){if(n&&!n.is("documentSelection"))return;const s=this.editor.model,o=this.editor.plugins.get(be);let r=this.getTableIfOnlyTableInContent(t,s);if(!r)return;const a=o.getSelectionAffectedTableCells(s.document.selection);if(!a.length){ka(r,o);return}e.stop(),s.change(l=>{const c={width:o.getColumns(r),height:o.getRows(r)},d=lx(a,c,l,o),u=d.lastRow-d.firstRow+1,h=d.lastColumn-d.firstColumn+1,m={startRow:0,startColumn:0,endRow:Math.min(u,c.height)-1,endColumn:Math.min(h,c.width)-1};r=rf(r,m,l);const f=a[0].findAncestor("table"),p=this._replaceSelectedCellsWithPasted(r,c,f,d,l);if(this.editor.plugins.get("TableSelection").isEnabled){const w=o.sortRanges(p.map(v=>l.createRangeOn(v)));l.setSelection(w)}else l.setSelection(p[0],0)})}_replaceSelectedCellsWithPasted(e,t,n,s,o){const{width:r,height:a}=t,l=dx(e,r,a),c=[...new W(n,{startRow:s.firstRow,endRow:s.lastRow,startColumn:s.firstColumn,endColumn:s.lastColumn,includeAllSlots:!0})],d=[];let u;for(const w of c){const{row:v,column:C}=w;C===s.firstColumn&&(u=w.getPositionBefore());const B=v-s.firstRow,D=C-s.firstColumn,Z=l[B%a][D%r],P=Z?o.cloneElement(Z):null,N=this._replaceTableSlotCell(w,P,u,o);N&&(uf(N,v,C,s.lastRow,s.lastColumn,o),d.push(N),u=o.createPositionAfter(N))}const h=parseInt(n.getAttribute("headingRows")||"0"),m=parseInt(n.getAttribute("headingColumns")||"0"),f=s.firstRow<h&&h<=s.lastRow,p=s.firstColumn<m&&m<=s.lastColumn;if(f){const w={first:s.firstColumn,last:s.lastColumn},v=xr(n,h,w,o,s.firstRow);d.push(...v)}if(p){const w={first:s.firstRow,last:s.lastRow},v=Pr(n,m,w,o);d.push(...v)}return d}_replaceTableSlotCell(e,t,n,s){const{cell:o,isAnchor:r}=e;return r&&s.remove(o),t?(s.insert(t,n),t):null}getTableIfOnlyTableInContent(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(e.childCount==1&&e.getChild(0).is("element","table"))return e.getChild(0);const n=t.createRangeIn(e);for(const s of n.getItems())if(s.is("element","table")){const o=t.createRange(n.start,t.createPositionBefore(s));if(t.hasContent(o,{ignoreWhitespaces:!0}))return null;const r=t.createRange(t.createPositionAfter(s),n.end);return t.hasContent(r,{ignoreWhitespaces:!0})?null:s}return null}}function lx(i,e,t,n){const s=i[0].findAncestor("table"),o=n.getColumnIndexes(i),r=n.getRowIndexes(i),a={firstColumn:o.first,lastColumn:o.last,firstRow:r.first,lastRow:r.last},l=i.length===1;return l&&(a.lastRow+=e.height-1,a.lastColumn+=e.width-1,cx(s,a.lastRow+1,a.lastColumn+1,n)),l||!n.isSelectionRectangular(i)?ux(s,a,t):(a.lastRow=hf(s,a),a.lastColumn=mf(s,a)),a}function cx(i,e,t,n){const s=n.getColumns(i),o=n.getRows(i);t>s&&n.insertColumns(i,{at:s,columns:t-s}),e>o&&n.insertRows(i,{at:o,rows:e-o})}function dx(i,e,t){const n=new Array(t).fill(null).map(()=>new Array(e).fill(null));for(const{column:s,row:o,cell:r}of new W(i))n[o][s]=r;return n}function ux(i,e,t){const{firstRow:n,lastRow:s,firstColumn:o,lastColumn:r}=e,a={first:n,last:s},l={first:o,last:r};Pr(i,o,a,t),Pr(i,r+1,a,t),xr(i,n,l,t),xr(i,s+1,l,t,n)}function xr(i,e,t,n,s=0){return e<1?void 0:af(i,e,s).filter(({column:a,cellWidth:l})=>gf(a,l,t)).map(({cell:a})=>lf(a,e,n))}function Pr(i,e,t,n){return e<1?void 0:cf(i,e).filter(({row:r,cellHeight:a})=>gf(r,a,t)).map(({cell:r,column:a})=>df(r,a,e,n))}function gf(i,e,t){const n=i+e-1,{first:s,last:o}=t,r=i>=s&&i<=o,a=i<s&&n>=s;return r||a}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hx extends b{static get pluginName(){return"TableKeyboard"}static get requires(){return[nn,be]}init(){const t=this.editor.editing.view.document;this.listenTo(t,"arrowKey",(...n)=>this._onArrowKey(...n),{context:"table"}),this.listenTo(t,"tab",(...n)=>this._handleTabOnSelectedTable(...n),{context:"figure"}),this.listenTo(t,"tab",(...n)=>this._handleTab(...n),{context:["th","td"]})}_handleTabOnSelectedTable(e,t){const n=this.editor,o=n.model.document.selection.getSelectedElement();!o||!o.is("element","table")||(t.preventDefault(),t.stopPropagation(),e.stop(),n.model.change(r=>{r.setSelection(r.createRangeIn(o.getChild(0).getChild(0)))}))}_handleTab(e,t){const n=this.editor,s=this.editor.plugins.get(be),o=this.editor.plugins.get("TableSelection"),r=n.model.document.selection,a=!t.shiftKey;let l=s.getTableCellsContainingSelection(r)[0];if(l||(l=o.getFocusCell()),!l)return;t.preventDefault(),t.stopPropagation(),e.stop();const c=l.parent,d=c.parent,u=d.getChildIndex(c),h=c.getChildIndex(l),m=h===0;if(!a&&m&&u===0){n.model.change(v=>{v.setSelection(v.createRangeOn(d))});return}const f=h===c.childCount-1,p=u===s.getRows(d)-1;if(a&&p&&f&&(n.execute("insertTableRowBelow"),u===s.getRows(d)-1)){n.model.change(v=>{v.setSelection(v.createRangeOn(d))});return}let w;if(a&&f)w=d.getChild(u+1).getChild(0);else if(!a&&m){const v=d.getChild(u-1);w=v.getChild(v.childCount-1)}else w=c.getChild(h+(a?1:-1));n.model.change(v=>{v.setSelection(v.createRangeIn(w))})}_onArrowKey(e,t){const n=this.editor,s=t.keyCode,o=Lr(s,n.locale.contentLanguageDirection);this._handleArrowKeys(o,t.shiftKey)&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const n=this.editor.plugins.get(be),s=this.editor.plugins.get("TableSelection"),o=this.editor.model,r=o.document.selection,a=["right","down"].includes(e),l=n.getSelectedTableCells(r);if(l.length){let d;return t?d=s.getFocusCell():d=a?l[l.length-1]:l[0],this._navigateFromCellInDirection(d,e,t),!0}const c=r.focus.findAncestor("tableCell");/* istanbul ignore if: paranoid check -- @preserve */if(!c)return!1;if(!r.isCollapsed)if(t){if(r.isBackward==a&&!r.containsEntireContent(c))return!1}else{const d=r.getSelectedElement();if(!d||!o.schema.isObject(d))return!1}return this._isSelectionAtCellEdge(r,c,a)?(this._navigateFromCellInDirection(c,e,t),!0):!1}_isSelectionAtCellEdge(e,t,n){const s=this.editor.model,o=this.editor.model.schema,r=n?e.getLastPosition():e.getFirstPosition();if(!o.getLimitElement(r).is("element","tableCell"))return s.createPositionAt(t,n?"end":0).isTouching(r);const a=s.createSelection(r);return s.modifySelection(a,{direction:n?"forward":"backward"}),r.isEqual(a.focus)}_navigateFromCellInDirection(e,t,n=!1){const s=this.editor.model,o=e.findAncestor("table"),r=[...new W(o,{includeAllSlots:!0})],{row:a,column:l}=r[r.length-1],c=r.find(({cell:C})=>C==e);let{row:d,column:u}=c;switch(t){case"left":u--;break;case"up":d--;break;case"right":u+=c.cellWidth;break;case"down":d+=c.cellHeight;break}const h=d<0||d>a,m=u<0&&d<=0,f=u>l&&d>=a;if(h||m||f){s.change(C=>{C.setSelection(C.createRangeOn(o))});return}u<0?(u=n?0:l,d--):u>l&&(u=n?l:0,d++);const p=r.find(C=>C.row==d&&C.column==u).cell,w=["right","down"].includes(t),v=this.editor.plugins.get("TableSelection");if(n&&v.isEnabled){const C=v.getAnchorCell()||e;v.setCellSelection(C,p)}else{const C=s.createPositionAt(p,w?0:"end");s.change(B=>{B.setSelection(C)})}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pf extends ln{constructor(){super(...arguments),this.domEventType=["mousemove","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mx extends b{static get pluginName(){return"TableMouse"}static get requires(){return[nn,be]}init(){this.editor.editing.view.addObserver(pf),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor,t=e.plugins.get(be);let n=!1;const s=e.plugins.get(nn);this.listenTo(e.editing.view.document,"mousedown",(o,r)=>{const a=e.model.document.selection;if(!this.isEnabled||!s.isEnabled||!r.domEvent.shiftKey)return;const l=s.getAnchorCell()||t.getTableCellsContainingSelection(a)[0];if(!l)return;const c=this._getModelTableCellFromDomEvent(r);c&&Ld(l,c)&&(n=!0,s.setCellSelection(l,c),r.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{n=!1}),this.listenTo(e.editing.view.document,"selectionChange",o=>{n&&o.stop()},{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,n,s=!1,o=!1;const r=e.plugins.get(nn);this.listenTo(e.editing.view.document,"mousedown",(a,l)=>{!this.isEnabled||!r.isEnabled||l.domEvent.shiftKey||l.domEvent.ctrlKey||l.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(l))}),this.listenTo(e.editing.view.document,"mousemove",(a,l)=>{if(!l.domEvent.buttons||!t)return;const c=this._getModelTableCellFromDomEvent(l);c&&Ld(t,c)&&(n=c,!s&&n!=t&&(s=!0)),s&&(o=!0,r.setCellSelection(t,n),l.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{s=!1,o=!1,t=null,n=null}),this.listenTo(e.editing.view.document,"selectionChange",a=>{o&&a.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,n=this.editor.editing.view.createPositionAt(t,0);return this.editor.editing.mapper.toModelPosition(n).parent.findAncestor("tableCell",{includeSelf:!0})}}function Ld(i,e){return i.parent.parent==e.parent.parent}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kP extends b{static get requires(){return[Ni,ox,nn,mx,hx,ax,zt]}static get pluginName(){return"Table"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fx(i){const e=i.getSelectedElement();return e&&bf(e)?e:null}function so(i){const e=i.getFirstPosition();if(!e)return null;let t=e.parent;for(;t;){if(t.is("element")&&bf(t))return t;t=t.parent}return null}function bf(i){return!!i.getCustomProperty("table")&&se(i)}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AP extends b{static get requires(){return[Rs]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(Rs),s=e.config.get("table.contentToolbar"),o=e.config.get("table.tableToolbar");s&&n.register("tableContent",{ariaLabel:t("Table toolbar"),items:s,getRelatedElement:so}),o&&n.register("table",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:fx})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gx extends E{constructor(e,t){super(e),this.set("value",""),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.options=t,this.focusTracker=new ue,this._focusables=new qe,this.dropdownView=this._createDropdownView(),this.inputView=this._createInputTextView(),this.keystrokes=new _e,this._stillTyping=!1,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color"]},children:[this.dropdownView,this.inputView]}),this.on("change:value",(n,s,o)=>this._setInputValue(o))}render(){super.render(),this.keystrokes.listenTo(this.dropdownView.panelView.element)}focus(){this.inputView.focus()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createDropdownView(){const e=this.locale,t=e.t,n=this.bindTemplate,s=this._createColorSelector(e),o=de(e),r=new E;return r.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:n.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",n.if("value","ck-hidden",a=>a!="")]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(r),o.buttonView.label=t("Color picker"),o.buttonView.tooltip=!0,o.panelPosition=e.uiLanguageDirection==="rtl"?"se":"sw",o.panelView.children.add(s),o.bind("isEnabled").to(this,"isReadOnly",a=>!a),this._focusables.add(s),this.focusTracker.add(s.element),o.on("change:isOpen",(a,l,c)=>{c&&(s.updateSelectedColors(),s.showColorGridsFragment())}),o}_createInputTextView(){const e=this.locale,t=new Ou(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",()=>{const n=t.element.value,s=this.options.colorDefinitions.find(o=>n===o.label);this._stillTyping=!0,this.value=s&&s.color||n}),t.on("blur",()=>{this._stillTyping=!1,this._setInputValue(t.element.value)}),t.delegate("input").to(this),t}_createColorSelector(e){const t=e.t,n=this.options.defaultColorValue||"",s=t(n?"Restore default":"Remove color"),o=new Hh(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:s,colorPickerLabel:t("Color picker"),colorPickerViewConfig:this.options.colorPickerConfig===!1?!1:{...this.options.colorPickerConfig,hideInput:!0}});o.appendUI(),o.on("execute",(a,l)=>{if(l.source==="colorPickerSaveButton"){this.dropdownView.isOpen=!1;return}this.value=l.value||n,this.fire("input"),l.source!=="colorPicker"&&(this.dropdownView.isOpen=!1)});let r=this.value;return o.on("colorPicker:cancel",()=>{this.value=r,this.fire("input"),this.dropdownView.isOpen=!1}),o.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{r=this.value}),o.bind("selectedColor").to(this,"value"),o}_setInputValue(e){if(!this._stillTyping){const t=Dd(e),n=this.options.colorDefinitions.find(s=>t===Dd(s.color));n?this.inputView.value=n.label:this.inputView.value=e||""}}}function Dd(i){return i.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Aa=i=>i==="";function Ea(i){return{none:i("None"),solid:i("Solid"),dotted:i("Dotted"),dashed:i("Dashed"),double:i("Double"),groove:i("Groove"),ridge:i("Ridge"),inset:i("Inset"),outset:i("Outset")}}function wf(i){return i('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function _f(i){return i('The value is invalid. Try "10px" or "2em" or simply "2".')}function Ns(i){return i=i.trim(),Aa(i)||Ih(i)}function fi(i){return i=i.trim(),Aa(i)||Cf(i)||Qs(i)||Rh(i)}function vf(i){return i=i.trim(),Aa(i)||Cf(i)||Qs(i)}function yf(i,e){const t=new ge,n=Ea(i.t);for(const s in n){const o={type:"button",model:new wt({_borderStyleValue:s,label:n[s],role:"menuitemradio",withText:!0})};s==="none"?o.model.bind("isOn").to(i,"borderStyle",r=>e==="none"?!r:r===s):o.model.bind("isOn").to(i,"borderStyle",r=>r===s),t.add(o)}return t}function Ir(i){const{view:e,icons:t,toolbar:n,labels:s,propertyName:o,nameToValue:r,defaultValue:a}=i;for(const l in s){const c=new I(e.locale);c.set({label:s[l],icon:t[l],tooltip:s[l]});const d=r?r(l):l;c.bind("isOn").to(e,o,u=>{let h=u;return u===""&&a&&(h=a),d===h}),c.on("execute",()=>{e[o]=d}),n.items.add(c)}}const Fs=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function Ls(i){return(e,t,n)=>{const s=new gx(e.locale,{colorDefinitions:px(i.colorConfig),columns:i.columns,defaultColorValue:i.defaultColorValue,colorPickerConfig:i.colorPickerConfig});return s.inputView.set({id:t,ariaDescribedById:n}),s.bind("isReadOnly").to(e,"isEnabled",o=>!o),s.bind("hasError").to(e,"errorText",o=>!!o),s.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused").to(s),s}}function Cf(i){const e=parseFloat(i);return!Number.isNaN(e)&&i===String(e)}function px(i){return i.map(e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}}))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ie extends E{constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach(s=>this.children.add(s)),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",n.to("class")],role:n.to("_role"),"aria-labelledby":n.to("_ariaLabelledBy")},children:this.children})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const zd={left:R.alignLeft,center:R.alignCenter,right:R.alignRight,justify:R.alignJustify,top:R.alignTop,middle:R.alignMiddle,bottom:R.alignBottom};class bx extends E{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:r}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:l}=this._createBackgroundFields(),{widthInput:c,operatorLabel:d,heightInput:u,dimensionsLabel:h}=this._createDimensionFields(),{horizontalAlignmentToolbar:m,verticalAlignmentToolbar:f,alignmentLabel:p}=this._createAlignmentFields();this.focusTracker=new ue,this.keystrokes=new _e,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=l,this.paddingInput=this._createPaddingField(),this.widthInput=c,this.heightInput=u,this.horizontalAlignmentToolbar=m,this.verticalAlignmentToolbar=f;const{saveButtonView:w,cancelButtonView:v}=this._createActionButtons();this.saveButtonView=w,this.cancelButtonView=v,this._focusables=new qe,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new qh(e,{label:this.t("Cell properties")})),this.children.add(new Ie(e,{labelView:r,children:[r,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new Ie(e,{labelView:a,children:[a,l],class:"ck-table-form__background-row"})),this.children.add(new Ie(e,{children:[new Ie(e,{labelView:h,children:[h,c,d,u],class:"ck-table-form__dimensions-row"}),new Ie(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new Ie(e,{labelView:p,children:[p,m,f],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new Ie(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ds({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderColorInput.fieldView.dropdownView.buttonView,this.borderWidthInput,this.backgroundInput,this.backgroundInput.fieldView.dropdownView.buttonView,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Ls({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,r=o("Style"),a=new ze(s);a.text=o("Border");const l=Ea(o),c=new pe(s,zh);c.set({label:r,class:"ck-table-form__border-style"}),c.fieldView.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),c.fieldView.buttonView.bind("label").to(this,"borderStyle",h=>l[h||"none"]),c.fieldView.on("execute",h=>{this.borderStyle=h.source._borderStyleValue}),c.bind("isEmpty").to(this,"borderStyle",h=>!h),kt(c.fieldView,yf(this,t.style),{role:"menu",ariaLabel:r});const d=new pe(s,nt);d.set({label:o("Width"),class:"ck-table-form__border-width"}),d.fieldView.bind("value").to(this,"borderWidth"),d.bind("isEnabled").to(this,"borderStyle",cs),d.fieldView.on("input",()=>{this.borderWidth=d.fieldView.element.value});const u=new pe(s,n);return u.set({label:o("Color"),class:"ck-table-form__border-color"}),u.fieldView.bind("value").to(this,"borderColor"),u.bind("isEnabled").to(this,"borderStyle",cs),u.fieldView.on("input",()=>{this.borderColor=u.fieldView.value}),this.on("change:borderStyle",(h,m,f,p)=>{cs(f)||(this.borderColor="",this.borderWidth=""),cs(p)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:a,borderStyleDropdown:c,borderColorInput:u,borderWidthInput:d}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Background");const s=Ls({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new pe(e,s);return o.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Dimensions");const s=new pe(e,nt);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new E(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const r=new pe(e,nt);return r.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),r.fieldView.bind("value").to(this,"height"),r.fieldView.on("input",()=>{this.height=r.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:r}}_createPaddingField(){const e=this.locale,t=this.t,n=new pe(e,nt);return n.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),n.fieldView.bind("value").to(this,"padding"),n.fieldView.on("input",()=>{this.padding=n.fieldView.element.value}),n}_createAlignmentFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Table cell text alignment");const s=new Fn(e),o=e.contentLanguageDirection==="rtl";s.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),Ir({view:this,icons:zd,toolbar:s,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:a=>{if(o){if(a==="left")return"right";if(a==="right")return"left"}return a},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const r=new Fn(e);return r.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),Ir({view:this,icons:zd,toolbar:r,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:s,verticalAlignmentToolbar:r,alignmentLabel:n}}_createActionButtons(){const e=this.locale,t=this.t,n=new I(e),s=new I(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return n.set({label:t("Save"),icon:R.check,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...r)=>r.every(a=>!a)),s.set({label:t("Cancel"),icon:R.cancel,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,n=t("Align cell text to the left"),s=t("Align cell text to the center"),o=t("Align cell text to the right"),r=t("Justify cell text");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n,justify:r}:{left:n,center:s,right:o,justify:r}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function cs(i){return i!=="none"}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Jt=we.defaultPositions,Rr=[Jt.northArrowSouth,Jt.northArrowSouthWest,Jt.northArrowSouthEast,Jt.southArrowNorth,Jt.southArrowNorthWest,Jt.southArrowNorthEast,Jt.viewportStickyNorth];function kf(i,e){const t=i.plugins.get("ContextualBalloon");if(so(i.editing.view.document.selection)){let n;e==="cell"?n=Ef(i):n=Af(i),t.updatePosition(n)}}function Af(i){const t=i.model.document.selection.getFirstPosition().findAncestor("table"),n=i.editing.mapper.toViewElement(t);return{target:i.editing.view.domConverter.mapViewToDom(n),positions:Rr}}function Ef(i){const e=i.editing.mapper,t=i.editing.view.domConverter,n=i.model.document.selection;if(n.rangeCount>1)return{target:()=>wx(n.getRanges(),i),positions:Rr};const s=Tf(n.getFirstPosition()),o=e.toViewElement(s);return{target:t.mapViewToDom(o),positions:Rr}}function Tf(i){return i.nodeAfter&&i.nodeAfter.is("element","tableCell")?i.nodeAfter:i.findAncestor("tableCell")}function wx(i,e){const t=e.editing.mapper,n=e.editing.view.domConverter,s=Array.from(i).map(o=>{const r=Tf(o.start),a=t.toViewElement(r);return new F(n.mapViewToDom(a))});return F.getBoundingRect(s)}const _x='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function mn(i){if(!i||!We(i))return i;const{top:e,right:t,bottom:n,left:s}=i;if(e==t&&t==n&&n==s)return e}function fn(i,e){const t=parseFloat(i);return Number.isNaN(t)||String(t)!==String(i)?i:`${t}${e}`}function Fi(i,e={}){const t={borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",...i};return e.includeAlignmentProperty&&!t.alignment&&(t.alignment="center"),e.includePaddingProperty&&!t.padding&&(t.padding=""),e.includeVerticalAlignmentProperty&&!t.verticalAlignment&&(t.verticalAlignment="middle"),e.includeHorizontalAlignmentProperty&&!t.horizontalAlignment&&(t.horizontalAlignment=e.isRightToLeftContent?"right":"left"),t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const vx=500,Hd={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class yx extends b{static get requires(){return[Nt]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:Fs,backgroundColors:Fs})}init(){const e=this.editor,t=e.t;this._defaultTableCellProperties=Fi(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._balloon=e.plugins.get(Nt),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",n=>{const s=new I(n);s.set({label:t("Cell properties"),icon:_x,tooltip:!0}),this.listenTo(s,"execute",()=>this._showView());const o=Object.values(Hd).map(r=>e.commands.get(r));return s.bind("isEnabled").toMany(o,"isEnabled",(...r)=>r.some(a=>a)),s})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableCellProperties"),n=pi(t.borderColors),s=gi(e.locale,n),o=pi(t.backgroundColors),r=gi(e.locale,o),a=t.colorPicker!==!1,l=new bx(e.locale,{borderColors:s,backgroundColors:r,defaultTableCellProperties:this._defaultTableCellProperties,colorPickerConfig:a?t.colorPicker||{}:!1}),c=e.t;l.render(),this.listenTo(l,"submit",()=>{this._hideView()}),this.listenTo(l,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),l.keystrokes.set("Esc",(h,m)=>{this._hideView(),m()}),Ii({emitter:l,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const d=wf(c),u=_f(c);return l.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),l.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:l.borderColorInput,commandName:"tableCellBorderColor",errorText:d,validator:Ns})),l.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:l.borderWidthInput,commandName:"tableCellBorderWidth",errorText:u,validator:vf})),l.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:l.paddingInput,commandName:"tableCellPadding",errorText:u,validator:fi})),l.on("change:width",this._getValidatedPropertyChangeCallback({viewField:l.widthInput,commandName:"tableCellWidth",errorText:u,validator:fi})),l.on("change:height",this._getValidatedPropertyChangeCallback({viewField:l.heightInput,commandName:"tableCellHeight",errorText:u,validator:fi})),l.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:l.backgroundInput,commandName:"tableCellBackgroundColor",errorText:d,validator:Ns})),l.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),l.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),l}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(Hd).map(([n,s])=>{const o=this._defaultTableCellProperties[n]||"";return[n,e.get(s).value||o]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:Ef(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;so(t.selection)?this._isViewVisible&&kf(e,"cell"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,r=Vt(()=>{n.errorText=o},vx);return(a,l,c)=>{r.cancel(),this._isReady&&(s(c)?(this.editor.execute(t,{value:c,batch:this._undoStepBatch}),n.errorText=null):r())}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class At extends T{constructor(e,t,n){super(e),this.attributeName=t,this._defaultValue=n}refresh(){const e=this.editor,n=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e.model.document.selection);this.isEnabled=!!n.length,this.value=this._getSingleValue(n)}execute(e={}){const{value:t,batch:n}=e,s=this.editor.model,r=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(s.document.selection),a=this._getValueToSet(t);s.enqueueChange(n,l=>{a?r.forEach(c=>l.setAttribute(this.attributeName,a,c)):r.forEach(c=>l.removeAttribute(this.attributeName,c))})}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]);return e.every(s=>this._getAttribute(s)===t)?t:void 0}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Cx extends At{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=fn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Sf extends b{static get pluginName(){return"TableCellWidthEditing"}static get requires(){return[Ni]}init(){const e=this.editor,t=Fi(e.config.get("table.tableCellProperties.defaultProperties"));_s(e.model.schema,e.conversion,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:t.width}),e.commands.add("tableCellWidth",new Cx(e,t.width))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kx extends At{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=fn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ax extends At{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){const t=fn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ex extends At{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Tx extends At{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Sx extends At{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xx extends At{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Px extends At{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ix extends At{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=fn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Wd=/^(top|middle|bottom)$/,$d=/^(left|center|right|justify)$/;class Rx extends b{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[Ni,Sf]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const s=Fi(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"});e.data.addStyleProcessorRules(Bh),Vx(t,n,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableCellBorderStyle",new xx(e,s.borderStyle)),e.commands.add("tableCellBorderColor",new Px(e,s.borderColor)),e.commands.add("tableCellBorderWidth",new Ix(e,s.borderWidth)),_s(t,n,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:s.height}),e.commands.add("tableCellHeight",new Ax(e,s.height)),e.data.addStyleProcessorRules(x0),_s(t,n,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:s.padding}),e.commands.add("tableCellPadding",new kx(e,s.padding)),e.data.addStyleProcessorRules(sa),_s(t,n,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),e.commands.add("tableCellBackgroundColor",new Ex(e,s.backgroundColor)),Bx(t,n,s.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new Sx(e,s.horizontalAlignment)),Mx(t,n,s.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new Tx(e,s.verticalAlignment))}}function Vx(i,e,t){const n={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};i.extend("tableCell",{allowAttributes:Object.values(n)}),kr(e,"td",n,t),kr(e,"th",n,t),mi(e,{modelElement:"tableCell",modelAttribute:n.style,styleName:"border-style"}),mi(e,{modelElement:"tableCell",modelAttribute:n.color,styleName:"border-color"}),mi(e,{modelElement:"tableCell",modelAttribute:n.width,styleName:"border-width"})}function Bx(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:n=>({key:"style",value:{"text-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":$d}},model:{key:"tableCellHorizontalAlignment",value:n=>{const s=n.getStyle("text-align");return s===t?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:$d}},model:{key:"tableCellHorizontalAlignment",value:n=>{const s=n.getAttribute("align");return s===t?null:s}}})}function Mx(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:n=>({key:"style",value:{"vertical-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":Wd}},model:{key:"tableCellVerticalAlignment",value:n=>{const s=n.getStyle("vertical-align");return s===t?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:Wd}},model:{key:"tableCellVerticalAlignment",value:n=>{const s=n.getAttribute("valign");return s===t?null:s}}})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class EP extends b{static get pluginName(){return"TableCellProperties"}static get requires(){return[Rx,yx]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gn extends T{constructor(e,t,n){super(e),this.attributeName=t,this._defaultValue=n}refresh(){const n=this.editor.model.document.selection.getFirstPosition().findAncestor("table");this.isEnabled=!!n,this.value=this._getValue(n)}execute(e={}){const t=this.editor.model,n=t.document.selection,{value:s,batch:o}=e,r=n.getFirstPosition().findAncestor("table"),a=this._getValueToSet(s);t.enqueueChange(o,l=>{a?l.setAttribute(this.attributeName,a,r):l.removeAttribute(this.attributeName,r)})}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ox extends gn{constructor(e,t){super(e,"tableBackgroundColor",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Nx extends gn{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fx extends gn{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lx extends gn{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=mn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=fn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Dx extends gn{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=fn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zx extends gn{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){if(e=fn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hx extends gn{constructor(e,t){super(e,"tableAlignment",t)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Wx=/^(left|center|right)$/,$x=/^(left|none|right)$/;class Ux extends b{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[Ni]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const s=Fi(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(Bh),qx(t,n,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableBorderColor",new Nx(e,s.borderColor)),e.commands.add("tableBorderStyle",new Fx(e,s.borderStyle)),e.commands.add("tableBorderWidth",new Lx(e,s.borderWidth)),jx(t,n,s.alignment),e.commands.add("tableAlignment",new Hx(e,s.alignment)),Ud(t,n,{modelAttribute:"tableWidth",styleName:"width",defaultValue:s.width}),e.commands.add("tableWidth",new Dx(e,s.width)),Ud(t,n,{modelAttribute:"tableHeight",styleName:"height",defaultValue:s.height}),e.commands.add("tableHeight",new zx(e,s.height)),e.data.addStyleProcessorRules(sa),Gx(t,n,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),e.commands.add("tableBackgroundColor",new Ox(e,s.backgroundColor))}}function qx(i,e,t){const n={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};i.extend("table",{allowAttributes:Object.values(n)}),kr(e,"table",n,t),bs(e,{modelAttribute:n.color,styleName:"border-color"}),bs(e,{modelAttribute:n.style,styleName:"border-style"}),bs(e,{modelAttribute:n.width,styleName:"border-width"})}function jx(i,e,t){i.extend("table",{allowAttributes:["tableAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:n=>({key:"style",value:{float:n==="center"?"none":n}}),converterPriority:"high"}),e.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:$x}},model:{key:"tableAlignment",value:n=>{let s=n.getStyle("float");return s==="none"&&(s="center"),s===t?null:s}}}).attributeToAttribute({view:{attributes:{align:Wx}},model:{name:"table",key:"tableAlignment",value:n=>{const s=n.getAttribute("align");return s===t?null:s}}})}function Gx(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),Ca(e,{viewElement:"table",...t}),bs(e,t)}function Ud(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),Ca(e,{viewElement:/^(table|figure)$/,shouldUpcast:s=>!(s.name=="table"&&s.parent.name=="figure"),...t}),mi(e,{modelElement:"table",...t})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Kx={left:R.objectLeft,center:R.objectCenter,right:R.objectRight};class Jx extends E{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:r}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:l}=this._createBackgroundFields(),{widthInput:c,operatorLabel:d,heightInput:u,dimensionsLabel:h}=this._createDimensionFields(),{alignmentToolbar:m,alignmentLabel:f}=this._createAlignmentFields();this.focusTracker=new ue,this.keystrokes=new _e,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=l,this.widthInput=c,this.heightInput=u,this.alignmentToolbar=m;const{saveButtonView:p,cancelButtonView:w}=this._createActionButtons();this.saveButtonView=p,this.cancelButtonView=w,this._focusables=new qe,this._focusCycler=new at({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new qh(e,{label:this.t("Table properties")})),this.children.add(new Ie(e,{labelView:r,children:[r,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new Ie(e,{labelView:a,children:[a,l],class:"ck-table-form__background-row"})),this.children.add(new Ie(e,{children:[new Ie(e,{labelView:h,children:[h,c,d,u],class:"ck-table-form__dimensions-row"}),new Ie(e,{labelView:f,children:[f,m],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new Ie(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ds({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderColorInput.fieldView.dropdownView.buttonView,this.borderWidthInput,this.backgroundInput,this.backgroundInput.fieldView.dropdownView.buttonView,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Ls({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,r=o("Style"),a=new ze(s);a.text=o("Border");const l=Ea(o),c=new pe(s,zh);c.set({label:r,class:"ck-table-form__border-style"}),c.fieldView.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),c.fieldView.buttonView.bind("label").to(this,"borderStyle",h=>l[h||"none"]),c.fieldView.on("execute",h=>{this.borderStyle=h.source._borderStyleValue}),c.bind("isEmpty").to(this,"borderStyle",h=>!h),kt(c.fieldView,yf(this,t.style),{role:"menu",ariaLabel:r});const d=new pe(s,nt);d.set({label:o("Width"),class:"ck-table-form__border-width"}),d.fieldView.bind("value").to(this,"borderWidth"),d.bind("isEnabled").to(this,"borderStyle",ds),d.fieldView.on("input",()=>{this.borderWidth=d.fieldView.element.value});const u=new pe(s,n);return u.set({label:o("Color"),class:"ck-table-form__border-color"}),u.fieldView.bind("value").to(this,"borderColor"),u.bind("isEnabled").to(this,"borderStyle",ds),u.fieldView.on("input",()=>{this.borderColor=u.fieldView.value}),this.on("change:borderStyle",(h,m,f,p)=>{ds(f)||(this.borderColor="",this.borderWidth=""),ds(p)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:a,borderStyleDropdown:c,borderColorInput:u,borderWidthInput:d}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Background");const s=Ls({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new pe(e,s);return o.set({label:t("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Dimensions");const s=new pe(e,nt);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new E(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const r=new pe(e,nt);return r.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),r.fieldView.bind("value").to(this,"height"),r.fieldView.on("input",()=>{this.height=r.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:r}}_createAlignmentFields(){const e=this.locale,t=this.t,n=new ze(e);n.text=t("Alignment");const s=new Fn(e);return s.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),Ir({view:this,icons:Kx,toolbar:s,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:n,alignmentToolbar:s}}_createActionButtons(){const e=this.locale,t=this.t,n=new I(e),s=new I(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return n.set({label:t("Save"),icon:R.check,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...r)=>r.every(a=>!a)),s.set({label:t("Cancel"),icon:R.cancel,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _alignmentLabels(){const e=this.locale,t=this.t,n=t("Align table to the left"),s=t("Center table"),o=t("Align table to the right");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n}:{left:n,center:s,right:o}}}function ds(i){return i!=="none"}const Qx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Yx=500,qd={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class Xx extends b{static get requires(){return[Nt]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),this.view=null,e.config.define("table.tableProperties",{borderColors:Fs,backgroundColors:Fs})}init(){const e=this.editor,t=e.t;this._defaultTableProperties=Fi(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(Nt),e.ui.componentFactory.add("tableProperties",n=>{const s=new I(n);s.set({label:t("Table properties"),icon:Qx,tooltip:!0}),this.listenTo(s,"execute",()=>this._showView());const o=Object.values(qd).map(r=>e.commands.get(r));return s.bind("isEnabled").toMany(o,"isEnabled",(...r)=>r.some(a=>a)),s})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),n=pi(t.borderColors),s=gi(e.locale,n),o=pi(t.backgroundColors),r=gi(e.locale,o),a=t.colorPicker!==!1,l=new Jx(e.locale,{borderColors:s,backgroundColors:r,defaultTableProperties:this._defaultTableProperties,colorPickerConfig:a?t.colorPicker||{}:!1}),c=e.t;l.render(),this.listenTo(l,"submit",()=>{this._hideView()}),this.listenTo(l,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),l.keystrokes.set("Esc",(h,m)=>{this._hideView(),m()}),Ii({emitter:l,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const d=wf(c),u=_f(c);return l.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),l.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:l.borderColorInput,commandName:"tableBorderColor",errorText:d,validator:Ns})),l.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:l.borderWidthInput,commandName:"tableBorderWidth",errorText:u,validator:vf})),l.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:l.backgroundInput,commandName:"tableBackgroundColor",errorText:d,validator:Ns})),l.on("change:width",this._getValidatedPropertyChangeCallback({viewField:l.widthInput,commandName:"tableWidth",errorText:u,validator:fi})),l.on("change:height",this._getValidatedPropertyChangeCallback({viewField:l.heightInput,commandName:"tableHeight",errorText:u,validator:fi})),l.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),l}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(qd).map(([n,s])=>{const o=n,r=this._defaultTableProperties[o]||"";return[o,e.get(s).value||r]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:Af(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;so(t.selection)?this._isViewVisible&&kf(e,"table"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,r=Vt(()=>{n.errorText=o},Yx);return(a,l,c)=>{r.cancel(),this._isReady&&(s(c)?(this.editor.execute(t,{value:c,batch:this._undoStepBatch}),n.errorText=null):r())}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class TP extends b{static get pluginName(){return"TableProperties"}static get requires(){return[Ux,Xx]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Zx(i){i.document.registerPostFixer(e=>e5(e,i))}function e5(i,e){const t=e.document.differ.getChanges();let n=!1;for(const s of t){if(s.type!="insert")continue;const o=s.position.parent;if(o.is("element","table")||s.name=="table"){const r=s.name=="table"?s.position.nodeAfter:o,a=Array.from(r.getChildren()).filter(c=>c.is("element","caption")),l=a.shift();if(!l)continue;for(const c of a)i.move(i.createRangeIn(c),l,"end"),i.remove(c);l.nextSibling&&(i.move(i.createRangeOn(l),r,"end"),n=!0),n=!!a.length||n}}return n}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jd(i){return!!i&&i.is("element","table")}function Vr(i){for(const e of i.getChildren())if(e.is("element","caption"))return e;return null}function t5(i){const e=vs(i);return e?Vr(e):null}function n5(i){const e=i.parent;return i.name=="figcaption"&&e&&e.is("element","figure")&&e.hasClass("table")?{name:!0}:i.name=="caption"&&e&&e.is("element","table")?{name:!0}:null}function vs(i){const e=i.getSelectedElement();return e&&e.is("element","table")?e:i.getFirstPosition().findAncestor("table")}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class i5 extends T{refresh(){const e=this.editor,t=vs(e.model.document.selection);this.isEnabled=!!t,this.isEnabled?this.value=!!Vr(t):this.value=!1}execute({focusCaptionOnShow:e=!1}={}){this.editor.model.change(t=>{this.value?this._hideTableCaption(t):this._showTableCaption(t,e)})}_showTableCaption(e,t){const n=this.editor.model,s=vs(n.document.selection),a=this.editor.plugins.get("TableCaptionEditing")._getSavedCaption(s)||e.createElement("caption");n.insertContent(a,s,"end"),t&&e.setSelection(a,"in")}_hideTableCaption(e){const t=this.editor.model,n=vs(t.document.selection),s=this.editor.plugins.get("TableCaptionEditing"),o=Vr(n);s._saveCaption(n,o),t.deleteContent(e.createSelection(o,"on"))}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class s5 extends b{static get pluginName(){return"TableCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema,n=e.editing.view,s=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new i5(this.editor)),e.conversion.for("upcast").elementToElement({view:n5,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(o,{writer:r})=>jd(o.parent)?r.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(o,{writer:r})=>{if(!jd(o.parent))return null;const a=r.createEditableElement("figcaption");return r.setCustomProperty("tableCaption",!0,a),a.placeholder=s("Enter table caption"),qr({view:n,element:a,keepOnFocus:!0}),cm(a,r)}}),Zx(e.model)}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?U.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class o5 extends b{static get pluginName(){return"TableCaptionUI"}init(){const e=this.editor,t=e.editing.view,n=e.t;e.ui.componentFactory.add("toggleTableCaption",s=>{const o=e.commands.get("toggleTableCaption"),r=new I(s);return r.set({icon:R.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.bind("label").to(o,"value",a=>n(a?"Toggle caption off":"Toggle caption on")),this.listenTo(r,"execute",()=>{if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),o.value){const a=t5(e.model.document.selection),l=e.editing.mapper.toViewElement(a);if(!l)return;t.scrollToTheSelection(),t.change(c=>{c.addClass("table__caption_highlighted",l)})}e.editing.view.focus()}),r})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SP extends b{static get pluginName(){return"TableCaption"}static get requires(){return[s5,o5]}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const r5=5,Br=40,a5=2;/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function l5(i){const e=new Set;for(const t of i.document.differ.getChanges()){let n=null;switch(t.type){case"insert":n=["table","tableRow","tableCell"].includes(t.name)?t.position:null;break;case"remove":n=["tableRow","tableCell"].includes(t.name)?t.position:null;break;case"attribute":t.range.start.nodeAfter&&(n=["table","tableRow","tableCell"].includes(t.range.start.nodeAfter.name)?t.range.start:null);break}if(!n)continue;const s=n.nodeAfter&&n.nodeAfter.is("element","table")?n.nodeAfter:n.findAncestor("table");for(const o of i.createRangeOn(s).getItems())o.is("element","table")&&Li(o)&&e.add(o)}return e}function c5(i,e){return Br*100/xf(i,e)}function xf(i,e){const t=Gd(i,"tbody",e)||Gd(i,"thead",e),n=e.editing.view.domConverter.mapViewToDom(t);return Mr(n)}function Gd(i,e,t){return[...[...t.editing.mapper.toViewElement(i).getChildren()].find(o=>o.is("element","table")).getChildren()].find(o=>o.is("element",e))}function Mr(i){const e=x.window.getComputedStyle(i);return e.boxSizing==="border-box"?parseFloat(e.width)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderLeftWidth)-parseFloat(e.borderRightWidth):parseFloat(e.width)}function d5(i,e){const t=e.getCellLocation(i).column,n=i.getAttribute("colspan")||1;return{leftEdge:t,rightEdge:t+n-1}}function Ae(i){const e=Math.pow(10,a5),t=typeof i=="number"?i:parseFloat(i);return Math.round(t*e)/e}function u5(i,e,t){return i<=e?Ae(e):i>=t?Ae(t):Ae(i)}function h5(i,e){return Array(i).fill(e)}function Pi(i){return i.map(e=>typeof e=="number"?e:parseFloat(e)).filter(e=>!Number.isNaN(e)).reduce((e,t)=>e+t,0)}function Ta(i){const e=i.map(s=>s==="auto"?s:parseFloat(s.replace("%","")));let t=m5(e);const n=Pi(t);return n!==100&&(t=t.map(s=>Ae(s*100/n)).map((s,o,r)=>{if(!(o===r.length-1))return s;const l=Pi(r);return Ae(s+100-l)})),t.map(s=>s+"%")}function m5(i){const e=i.filter(s=>s==="auto").length;if(e===0)return i.map(s=>Ae(s));const t=Pi(i),n=Math.max((100-t)/e,r5);return i.map(s=>s==="auto"?n:s).map(s=>Ae(s))}function f5(i){const e=x.window.getComputedStyle(i);return e.boxSizing==="border-box"?parseInt(e.width):parseFloat(e.width)+parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)+parseFloat(e.borderWidth)}function Pf(i,e,t,n){for(let s=0;s<Math.max(t.length,i.length);s++){const o=i[s],r=t[s];r?o?n.setAttribute("columnWidth",r,o):n.appendElement("tableColumn",{columnWidth:r},e):n.remove(o)}}function Li(i){if(i.is("element","tableColumnGroup"))return i;const e=i.getChildren();return Array.from(e).find(t=>t.is("element","tableColumnGroup"))}function Sa(i){return Array.from(Li(i).getChildren())}function If(i){return Sa(i).map(e=>e.getAttribute("columnWidth"))}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class g5 extends T{refresh(){this.isEnabled=!0}execute(e={}){const{model:t,plugins:n}=this.editor;let{table:s=t.document.selection.getSelectedElement(),columnWidths:o,tableWidth:r}=e;o&&(o=Array.isArray(o)?o:o.split(",")),t.change(a=>{r?a.setAttribute("tableWidth",r,s):a.removeAttribute("tableWidth",s);const l=n.get("TableColumnResizeEditing").getColumnGroupElement(s);if(!o&&!l)return;if(!o)return a.remove(l);const c=Ta(o);if(l)Array.from(l.getChildren()).forEach((d,u)=>a.setAttribute("columnWidth",c[u],d));else{const d=a.createElement("tableColumnGroup");c.forEach(u=>a.appendElement("tableColumn",{columnWidth:u},d)),a.append(d,s)}})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function p5(i){return e=>e.on("element:colgroup",(t,n,s)=>{const o=n.modelCursor.findAncestor("table"),r=Li(o);if(!r)return;const a=Sa(r);let l=If(r);const c=i.getColumns(o);l=Array.from({length:c},(d,u)=>l[u]||"auto"),(l.length!=a.length||l.includes("auto"))&&Pf(a,r,Ta(l),s.writer)},{priority:"low"})}function b5(){return i=>i.on("insert:table",(e,t,n)=>{const s=n.writer,o=t.item,r=n.mapper.toViewElement(o),a=r.is("element","table")?r:Array.from(r.getChildren()).find(c=>c.is("element","table"));Li(o)?s.addClass("ck-table-resized",a):s.removeClass("ck-table-resized",a)},{priority:"low"})}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class w5 extends b{static get requires(){return[Ni,be]}static get pluginName(){return"TableColumnResizeEditing"}constructor(e){super(e),this._isResizingActive=!1,this.set("_isResizingAllowed",!0),this._resizingData=null,this._domEmitter=new(rt()),this._tableUtilsPlugin=e.plugins.get("TableUtils"),this.on("change:_isResizingAllowed",(t,n,s)=>{const o=s?"removeClass":"addClass";e.editing.view.change(r=>{for(const a of e.editing.view.document.roots)r[o]("ck-column-resize_disabled",e.editing.view.document.getRoot(a.rootName))})})}init(){this._extendSchema(),this._registerPostFixer(),this._registerConverters(),this._registerResizingListeners(),this._registerResizerInserter();const e=this.editor,t=e.plugins.get("TableColumnResize");e.plugins.get("TableEditing").registerAdditionalSlot({filter:o=>o.is("element","tableColumnGroup"),positionOffset:0});const s=new g5(e);e.commands.add("resizeTableWidth",s),e.commands.add("resizeColumnWidths",s),this.bind("_isResizingAllowed").to(e,"isReadOnly",t,"isEnabled",s,"isEnabled",(o,r,a)=>!o&&r&&a)}destroy(){this._domEmitter.stopListening(),super.destroy()}getColumnGroupElement(e){return Li(e)}getTableColumnElements(e){return Sa(e)}getTableColumnsWidths(e){return If(e)}_extendSchema(){this.editor.model.schema.extend("table",{allowAttributes:["tableWidth"]}),this.editor.model.schema.register("tableColumnGroup",{allowIn:"table",isLimit:!0}),this.editor.model.schema.register("tableColumn",{allowIn:"tableColumnGroup",allowAttributes:["columnWidth"],isLimit:!0})}_registerPostFixer(){const t=this.editor.model;t.document.registerPostFixer(o=>{let r=!1;for(const a of l5(t)){const l=this.getColumnGroupElement(a),c=this.getTableColumnElements(l),d=this.getTableColumnsWidths(l);let u=Ta(d);u=n(u,a,this),!Vn(d,u)&&(Pf(c,l,u,o),r=!0)}return r});function n(o,r,a){const l=a._tableUtilsPlugin.getColumns(r);if(l-o.length===0)return o;const d=o.map(h=>Number(h.replace("%",""))),u=s(a.editor.model.document.differ,r);for(const h of u){const m=l-d.length;if(m===0)continue;const f=m>0,p=a._tableUtilsPlugin.getCellLocation(h).column;if(f){const w=c5(r,a.editor),v=h5(m,w);d.splice(p,0,...v)}else{const w=d.splice(p,Math.abs(m));d[p]+=Pi(w)}}return d.map(h=>h+"%")}function s(o,r){const a=new Set;for(const l of o.getChanges())if(l.type=="insert"&&l.position.nodeAfter&&l.position.nodeAfter.name=="tableCell"&&l.position.nodeAfter.getAncestors().includes(r))a.add(l.position.nodeAfter);else if(l.type=="remove"){const c=l.position.nodeBefore||l.position.nodeAfter;c.name=="tableCell"&&c.getAncestors().includes(r)&&a.add(c)}return a}}_registerConverters(){const t=this.editor.conversion;t.for("upcast").attributeToAttribute({view:{name:"figure",key:"style",value:{width:/[\s\S]+/}},model:{name:"table",key:"tableWidth",value:n=>n.getStyle("width")}}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableWidth"},view:n=>({name:"figure",key:"style",value:{width:n}})}),t.elementToElement({model:"tableColumnGroup",view:"colgroup"}),t.elementToElement({model:"tableColumn",view:"col"}),t.for("downcast").add(b5()),t.for("upcast").add(p5(this._tableUtilsPlugin)),t.for("upcast").attributeToAttribute({view:{name:"col",styles:{width:/.*/}},model:{key:"columnWidth",value:n=>{const s=n.getStyle("width");return!s||!s.endsWith("%")?"auto":s}}}),t.for("downcast").attributeToAttribute({model:{name:"tableColumn",key:"columnWidth"},view:n=>({key:"style",value:{width:n}})})}_registerResizingListeners(){const e=this.editor.editing.view;e.addObserver(pf),e.document.on("mousedown",this._onMouseDownHandler.bind(this),{priority:"high"}),this._domEmitter.listenTo(x.window.document,"mousemove",zn(this._onMouseMoveHandler.bind(this),50)),this._domEmitter.listenTo(x.window.document,"mouseup",this._onMouseUpHandler.bind(this))}_onMouseDownHandler(e,t){const n=t.target;if(!n.hasClass("ck-table-column-resizer")||!this._isResizingAllowed)return;const s=this.editor,o=s.editing.mapper.toModelElement(n.findAncestor("figure"));if(!s.model.canEditAt(o))return;t.preventDefault(),e.stop();const r=c(o,this._tableUtilsPlugin,s),a=n.findAncestor("table"),l=s.editing.view;Array.from(a.getChildren()).find(h=>h.is("element","colgroup"))||l.change(h=>{d(h,r,a)}),this._isResizingActive=!0,this._resizingData=this._getResizingData(t,r),l.change(h=>u(h,a,this._resizingData));function c(h,m,f){const p=Array(m.getColumns(h)),w=new W(h);for(const v of w){const C=f.editing.mapper.toViewElement(v.cell),B=f.editing.view.domConverter.mapViewToDom(C),D=f5(B);(!p[v.column]||D<p[v.column])&&(p[v.column]=Ae(D))}return p}function d(h,m,f){const p=h.createContainerElement("colgroup");for(let w=0;w<m.length;w++){const v=h.createEmptyElement("col"),C=`${Ae(m[w]/Pi(m)*100)}%`;h.setStyle("width",C,v),h.insert(h.createPositionAt(p,"end"),v)}h.insert(h.createPositionAt(f,0),p)}function u(h,m,f){const p=f.widths.viewFigureWidth/f.widths.viewFigureParentWidth;h.addClass("ck-table-resized",m),h.addClass("ck-table-column-resizer__active",f.elements.viewResizer),h.setStyle("width",`${Ae(p*100)}%`,m.findAncestor("figure"))}}_onMouseMoveHandler(e,t){if(!this._isResizingActive)return;if(!this._isResizingAllowed){this._onMouseUpHandler();return}const{columnPosition:n,flags:{isRightEdge:s,isTableCentered:o,isLtrContent:r},elements:{viewFigure:a,viewLeftColumn:l,viewRightColumn:c},widths:{viewFigureParentWidth:d,tableWidth:u,leftColumnWidth:h,rightColumnWidth:m}}=this._resizingData,f=-h+Br,p=s?d-u:m-Br,w=(r?1:-1)*(s&&o?2:1),v=u5((t.clientX-n)*w,Math.min(f,0),Math.max(p,0));v!==0&&this.editor.editing.view.change(C=>{const B=Ae((h+v)*100/u);if(C.setStyle("width",`${B}%`,l),s){const D=Ae((u+v)*100/d);C.setStyle("width",`${D}%`,a)}else{const D=Ae((m-v)*100/u);C.setStyle("width",`${D}%`,c)}})}_onMouseUpHandler(){if(!this._isResizingActive)return;const{viewResizer:e,modelTable:t,viewFigure:n,viewColgroup:s}=this._resizingData.elements,o=this.editor,r=o.editing.view,a=this.getColumnGroupElement(t),l=Array.from(s.getChildren()).filter(p=>p.is("view:element")),c=a?this.getTableColumnsWidths(a):null,d=l.map(p=>p.getStyle("width")),u=!Vn(c,d),h=t.getAttribute("tableWidth"),m=n.getStyle("width"),f=h!==m;(u||f)&&(this._isResizingAllowed?o.execute("resizeTableWidth",{table:t,tableWidth:`${Ae(m)}%`,columnWidths:d}):r.change(p=>{if(c)for(const w of l)p.setStyle("width",c.shift(),w);else p.remove(s);f&&(h?p.setStyle("width",h,n):p.removeStyle("width",n)),!c&&!h&&p.removeClass("ck-table-resized",[...n.getChildren()].find(w=>w.name==="table"))})),r.change(p=>{p.removeClass("ck-table-column-resizer__active",e)}),this._isResizingActive=!1,this._resizingData=null}_getResizingData(e,t){const n=this.editor,s=e.domEvent.clientX,o=e.target,r=o.findAncestor("td")||o.findAncestor("th"),a=n.editing.mapper.toModelElement(r),l=a.findAncestor("table"),c=d5(a,this._tableUtilsPlugin).rightEdge,d=this._tableUtilsPlugin.getColumns(l)-1,u=c===d,h=!l.hasAttribute("tableAlignment"),m=n.locale.contentLanguageDirection!=="rtl",f=r.findAncestor("table"),p=f.findAncestor("figure"),w=[...f.getChildren()].find(S=>S.is("element","colgroup")),v=w.getChild(c),C=u?void 0:w.getChild(c+1),B=Mr(n.editing.view.domConverter.mapViewToDom(p.parent)),D=Mr(n.editing.view.domConverter.mapViewToDom(p)),Z=xf(l,n),P=t[c],N=u?void 0:t[c+1];return{columnPosition:s,flags:{isRightEdge:u,isTableCentered:h,isLtrContent:m},elements:{viewResizer:o,modelTable:l,viewFigure:p,viewColgroup:w,viewLeftColumn:v,viewRightColumn:C},widths:{viewFigureParentWidth:B,viewFigureWidth:D,tableWidth:Z,leftColumnWidth:P,rightColumnWidth:N}}}_registerResizerInserter(){this.editor.conversion.for("editingDowncast").add(e=>{e.on("insert:tableCell",(t,n,s)=>{const o=n.item,r=s.mapper.toViewElement(o),a=s.writer;a.insert(a.createPositionAt(r,"end"),a.createUIElement("div",{class:"ck-table-column-resizer"}))},{priority:"lowest"})})}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xP extends b{static get requires(){return[w5,Sf]}static get pluginName(){return"TableColumnResize"}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Rf(i){if(i.is("$text")||i.is("$textProxy"))return i.data;const e=i;let t="",n=null;for(const s of e.getChildren()){const o=Rf(s);n&&n.is("element")&&(t+=`
`),t+=o,n=s}return t}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PP extends b{constructor(e){super(e),this.set("characters",0),this.set("words",0),Object.defineProperties(this,{characters:{get(){return this.characters=this._getCharacters(this._getText())}},words:{get(){return this.words=this._getWords(this._getText())}}}),this.set("_wordsLabel",void 0),this.set("_charactersLabel",void 0),this._config=e.config.get("wordCount")||{},this._outputView=void 0,this._wordsMatchRegExp=V.features.isRegExpUnicodePropertySupported?new RegExp("([\\p{L}\\p{N}]+\\S?)+","gu"):/([a-zA-Z0-9À-ž]+\S?)+/gu}static get pluginName(){return"WordCount"}init(){this.editor.model.document.on("change:data",zn(this._refreshStats.bind(this),250)),typeof this._config.onUpdate=="function"&&this.on("update",(t,n)=>{this._config.onUpdate(n)}),Rt(this._config.container)&&this._config.container.appendChild(this.wordCountContainer)}destroy(){this._outputView&&(this._outputView.element.remove(),this._outputView.destroy()),super.destroy()}get wordCountContainer(){const e=this.editor,t=e.t,n=e.config.get("wordCount.displayWords"),s=e.config.get("wordCount.displayCharacters"),o=ke.bind(this,this),r=[];return this._outputView||(this._outputView=new E,(n||n===void 0)&&(this.bind("_wordsLabel").to(this,"words",a=>t("Words: %0",a)),r.push({tag:"div",children:[{text:[o.to("_wordsLabel")]}],attributes:{class:"ck-word-count__words"}})),(s||s===void 0)&&(this.bind("_charactersLabel").to(this,"characters",a=>t("Characters: %0",a)),r.push({tag:"div",children:[{text:[o.to("_charactersLabel")]}],attributes:{class:"ck-word-count__characters"}})),this._outputView.setTemplate({tag:"div",attributes:{class:["ck","ck-word-count"]},children:r}),this._outputView.render()),this._outputView.element}_getText(){let e="";for(const t of this.editor.model.document.getRoots())e!==""&&(e+=`
`),e+=Rf(t);return e}_getCharacters(e){return e.replace(/\n/g,"").length}_getWords(e){return(e.match(this._wordsMatchRegExp)||[]).length}_refreshStats(){const e=this._getText(),t=this.words=this._getWords(e),n=this.characters=this._getCharacters(e);this.fire("update",{words:t,characters:n})}}export{D5 as $,F5 as A,L5 as B,G5 as C,gP as D,J5 as E,Z5 as F,sP as G,eP as H,aP as I,hP as J,mP as K,$5 as L,bP as M,wP as N,eo as O,_P as P,vP as Q,U5 as R,yP as S,CP as T,kP as U,SP as V,EP as W,xP as X,TP as Y,AP as Z,fP as _,A5 as a,tP as a0,q5 as a1,PP as a2,ra as a3,E5 as a4,rP as b,Ui as c,z5 as d,j5 as e,H5 as f,Qf as g,W5 as h,K5 as i,pP as j,X5 as k,Q5 as l,Y5 as m,nP as n,oP as o,iP as p,lP as q,cP as r,dP as s,uE as t,Lm as u,IA as v,VA as w,Am as x,uP as y,PA as z};
//# sourceMappingURL=@ckeditor-e83498ec.js.map
